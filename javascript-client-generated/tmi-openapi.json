{
  "openapi": "3.0.3",
  "info": {
    "title": "TMI (Threat Modeling Improved) API",
    "description": "A RESTful API for collaborative threat modeling with full X6 graph library compatibility. This API provides schemas that align with AntV X6 cell object models for seamless integration with modern diagramming libraries. Supports OAuth 2.0 authentication with client callback integration for seamless single-page application authentication flows.\n\n## API Design v1.1.0\n\n### Authorization Model\nTMI uses hierarchical authorization: access control is defined at the ThreatModel level via the authorization field (readers, writers, owners). All child resources (Assets, Diagrams, Documents, Notes, Repositories, Threats) inherit permissions from their parent ThreatModel. This simplifies permission management and ensures consistent access control.\n\n### Bulk Operations\nNotes and Diagrams do not support bulk operations due to their unique creation workflows and lack of valid bulk use cases. All other resources (Threats, Assets, Documents, Repositories) support full bulk operations: POST (create), PUT (upsert), PATCH (partial update), DELETE (batch delete).\n\nAll resources support bulk metadata operations regardless of resource-level bulk support.\n\n### List Response Strategy\n- ThreatModels return summary information (TMListItem) because they contain many child objects that can be large.\n- Diagrams return summary information (DiagramListItem) because diagram data (cells, images) can be large.\n- Notes return summary information (NoteListItem) because the content field can be large.\n- Threats, Assets, Documents, Repositories return full schemas as they are relatively small and static.\n\n### PATCH Support\nAll resources support PATCH for partial updates using JSON Patch (RFC 6902). This is particularly useful for:\n- Assets: Array field updates (affected_assets, trust_boundaries) ensuring no duplicates\n- Notes: Updating name/description without changing content field\n- All resources: Efficient updates without full object replacement\n",
    "version": "1.2.0",
    "contact": {
      "name": "TMI Development Team",
      "url": "https://github.com/ericfitz/tmi",
      "email": "api@tmi.local.dev"
    },
    "license": {
      "name": "Apache 2.0",
      "url": "https://www.apache.org/licenses/LICENSE-2.0.html"
    }
  },
  "externalDocs": {
    "description": "Find more information here",
    "url": "https://github.com/ericfitz/tmi/wiki"
  },
  "servers": [
    {
      "description": "Production server",
      "url": "https://api.tmi.dev"
    }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "JWT Bearer token for authenticated requests. This implementation follows RFC8725 JWT Best Current Practices for secure token validation, audience verification, and expiration enforcement."
      }
    },
    "schemas": {
      "ApiInfo": {
        "type": "object",
        "description": "API information response for the root endpoint",
        "properties": {
          "status": {
            "type": "object",
            "properties": {
              "code": {
                "type": "string",
                "enum": [
                  "OK",
                  "DEGRADED",
                  "ERROR"
                ],
                "description": "Status code indicating system health: OK (all components healthy), DEGRADED (server up but database or Redis unhealthy), ERROR (critical failure)",
                "pattern": "^[a-zA-Z0-9_-]*$",
                "maxLength": 512
              },
              "time": {
                "type": "string",
                "format": "date-time",
                "description": "Current server time in UTC, formatted as RFC 3339",
                "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
                "maxLength": 64
              }
            },
            "required": [
              "code",
              "time"
            ],
            "additionalProperties": false,
            "example": {
              "code": "OK",
              "time": "2026-01-17T12:00:00Z"
            }
          },
          "service": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "Name of the service",
                "maxLength": 256,
                "pattern": "^[^\\x00-\\x1F]*$"
              },
              "build": {
                "type": "string",
                "description": "Current build number",
                "maxLength": 32,
                "pattern": "^[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}(-[a-zA-Z0-9]{7})?$"
              }
            },
            "required": [
              "name",
              "build"
            ],
            "additionalProperties": false,
            "example": {
              "name": "TMI Threat Modeling Interface",
              "build": "1.0.0"
            }
          },
          "api": {
            "type": "object",
            "properties": {
              "version": {
                "type": "string",
                "description": "API version",
                "pattern": "^[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}$",
                "maxLength": 32
              },
              "specification": {
                "type": "string",
                "format": "uri",
                "description": "URL to the API specification",
                "maxLength": 1000,
                "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$"
              }
            },
            "required": [
              "version",
              "specification"
            ],
            "additionalProperties": false,
            "example": {
              "version": "1.0.0",
              "specification": "https://api.example.com/openapi.json"
            }
          },
          "operator": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "Operator name from environment variables",
                "maxLength": 256,
                "pattern": "^[^\\x00-\\x1F]*$"
              },
              "contact": {
                "type": "string",
                "description": "Operator contact information from environment variables",
                "maxLength": 1024,
                "pattern": "^[^\\x00-\\x1F]*$"
              }
            },
            "required": [
              "name",
              "contact"
            ],
            "additionalProperties": false,
            "example": {
              "name": "Acme Corporation",
              "contact": "support@acme.example.com"
            }
          },
          "health": {
            "type": "object",
            "description": "Detailed health status of system components. Only present when status is DEGRADED.",
            "properties": {
              "database": {
                "$ref": "#/components/schemas/ComponentHealth"
              },
              "redis": {
                "$ref": "#/components/schemas/ComponentHealth"
              }
            },
            "additionalProperties": false,
            "example": {
              "database": {
                "status": "healthy",
                "latency_ms": 5
              },
              "redis": {
                "status": "healthy",
                "latency_ms": 2
              }
            }
          }
        },
        "required": [
          "status",
          "service",
          "api"
        ],
        "example": {
          "status": {
            "code": "OK",
            "time": "2025-04-09T12:00:00Z"
          },
          "service": {
            "name": "TMI",
            "build": "1.0.0-386eea0"
          },
          "api": {
            "version": "1.0.0",
            "specification": "https://github.com/ericfitz/tmi/blob/main/api-schema/tmi-openapi.json"
          },
          "operator": {
            "name": "Example Organization",
            "contact": "api-support@example.com"
          }
        },
        "additionalProperties": false
      },
      "OAuthProtectedResourceMetadata": {
        "type": "object",
        "description": "OAuth 2.0 protected resource metadata as defined in RFC 9728",
        "properties": {
          "resource": {
            "type": "string",
            "format": "uri",
            "description": "The protected resource's resource identifier URL",
            "example": "http://localhost:8080",
            "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
            "maxLength": 1000
          },
          "scopes_supported": {
            "type": "array",
            "items": {
              "type": "string",
              "pattern": "^[\\x21\\x23-\\x5B\\x5D-\\x7E]*$",
              "maxLength": 64,
              "description": "OAuth 2.0 scope token (RFC 6749 Section 3.3 - printable ASCII excluding whitespace and double-quote)"
            },
            "description": "JSON array of OAuth scope values supported by this protected resource",
            "example": [
              "openid",
              "email",
              "profile"
            ],
            "maxItems": 100
          },
          "authorization_servers": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uri",
              "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
              "maxLength": 1000
            },
            "description": "List of authorization server issuer identifiers that can issue tokens for this resource",
            "example": [
              "http://localhost:8080"
            ],
            "maxItems": 100
          },
          "jwks_uri": {
            "type": "string",
            "format": "uri",
            "description": "URL of the protected resource's JSON Web Key Set (RFC 9728)",
            "example": "http://localhost:8080/.well-known/jwks.json",
            "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
            "maxLength": 1024
          },
          "bearer_methods_supported": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "header",
                "body",
                "query"
              ],
              "description": "OAuth 2.0 bearer token transmission method (RFC 6750)",
              "maxLength": 1000
            },
            "description": "Supported token presentation methods for bearer tokens",
            "example": [
              "header",
              "body",
              "query"
            ],
            "maxItems": 100
          },
          "resource_name": {
            "type": "string",
            "description": "Human-readable name of the protected resource",
            "example": "TMI (Threat Modeling Improved) API",
            "maxLength": 256,
            "pattern": "^[^\\x00-\\x1F]*$"
          },
          "resource_documentation": {
            "type": "string",
            "format": "uri",
            "description": "URL with information for developers on how to use this protected resource",
            "example": "https://github.com/ericfitz/tmi",
            "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
            "maxLength": 1000
          },
          "tls_client_certificate_bound_access_tokens": {
            "type": "boolean",
            "description": "Whether the protected resource supports TLS client certificate bound access tokens",
            "example": false
          }
        },
        "required": [
          "resource"
        ],
        "example": {
          "resource": "http://localhost:8080",
          "scopes_supported": [
            "openid",
            "email",
            "profile"
          ],
          "authorization_servers": [
            "http://localhost:8080"
          ],
          "jwks_uri": "http://localhost:8080/.well-known/jwks.json",
          "bearer_methods_supported": [
            "header"
          ],
          "resource_name": "TMI (Threat Modeling Improved) API",
          "resource_documentation": "https://github.com/ericfitz/tmi",
          "tls_client_certificate_bound_access_tokens": false
        },
        "additionalProperties": false
      },
      "Document": {
        "description": "Complete Document schema with server-generated fields",
        "allOf": [
          {
            "$ref": "#/components/schemas/DocumentBase"
          },
          {
            "type": "object",
            "required": [
              "id"
            ],
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid",
                "description": "Unique identifier for the document",
                "readOnly": true,
                "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
                "maxLength": 36
              },
              "metadata": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "description": "Optional metadata key-value pairs",
                "readOnly": true,
                "maxItems": 100
              },
              "created_at": {
                "type": "string",
                "format": "date-time",
                "maxLength": 32,
                "description": "Creation timestamp (RFC3339)",
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "modified_at": {
                "type": "string",
                "format": "date-time",
                "maxLength": 32,
                "description": "Last modification timestamp (RFC3339)",
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              }
            }
          }
        ],
        "example": {
          "id": "567e89ab-e89b-41d4-a716-446655440004",
          "threat_model_id": "123e4567-e89b-41d4-a716-446655440000",
          "name": "Security Architecture Review",
          "description": "Q1 2024 security review findings",
          "content": "# Security Review\n\nKey findings from architecture review...",
          "format": "markdown",
          "metadata": [
            {
              "key": "reviewer",
              "value": "Security Team"
            }
          ],
          "created_at": "2024-01-17T14:00:00Z",
          "modified_at": "2024-01-17T14:00:00Z",
          "uri": "https://example.com/docs/security-policy.pdf",
          "include_in_report": true
        }
      },
      "BaseDiagram": {
        "type": "object",
        "description": "Base diagram object with common properties - used for API responses",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the diagram (UUID)",
            "maxLength": 36,
            "readOnly": true,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          },
          "name": {
            "type": "string",
            "description": "Name of the diagram",
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "minLength": 1
          },
          "type": {
            "type": "string",
            "description": "Type of diagram with version",
            "enum": [
              "DFD-1.0.0"
            ],
            "maxLength": 64
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp (ISO3339)",
            "maxLength": 36,
            "readOnly": true,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "modified_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last modification timestamp (ISO3339)",
            "maxLength": 36,
            "readOnly": true,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "metadata": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Metadata"
            },
            "description": "Key-value pairs for additional diagram metadata",
            "nullable": true,
            "maxItems": 10000
          },
          "update_vector": {
            "type": "integer",
            "format": "int64",
            "description": "Server-managed monotonic version counter, incremented on each diagram update",
            "readOnly": true,
            "minimum": 0
          },
          "image": {
            "type": "object",
            "description": "Image data with version information",
            "properties": {
              "svg": {
                "type": "string",
                "format": "byte",
                "description": "BASE64 encoded SVG representation of the diagram, used for thumbnails and reports",
                "pattern": "^[A-Za-z0-9+/]*=*$",
                "maxLength": 102400
              },
              "update_vector": {
                "type": "integer",
                "format": "int64",
                "description": "Version of the diagram when this SVG was generated. If not provided when svg is updated, will be auto-set to BaseDiagram.update_vector",
                "minimum": 0
              }
            },
            "nullable": true,
            "additionalProperties": false
          },
          "description": {
            "type": "string",
            "maxLength": 1024,
            "nullable": true,
            "description": "Optional description of the diagram",
            "pattern": "^[^<>\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]*$"
          },
          "include_in_report": {
            "type": "boolean",
            "description": "Whether this item should be included in generated reports",
            "default": true
          }
        },
        "required": [
          "id",
          "name",
          "type",
          "created_at",
          "modified_at"
        ],
        "discriminator": {
          "propertyName": "type",
          "mapping": {
            "DFD-1.0.0": "#/components/schemas/DfdDiagram"
          }
        },
        "example": {
          "id": "550e8400-e29b-41d4-a716-446655440000",
          "type": "DFD-1.0.0",
          "name": "System Architecture",
          "description": "High-level system architecture diagram",
          "created_at": "2024-01-15T10:00:00Z",
          "modified_at": "2024-01-15T10:00:00Z",
          "include_in_report": true
        }
      },
      "BaseDiagramInput": {
        "type": "object",
        "description": "Base diagram input for PUT/PATCH requests - excludes readOnly server-managed fields",
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the diagram",
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "minLength": 1
          },
          "type": {
            "type": "string",
            "description": "Type of diagram with version",
            "enum": [
              "DFD-1.0.0"
            ],
            "maxLength": 64,
            "minLength": 1
          },
          "metadata": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Metadata"
            },
            "description": "Key-value pairs for additional diagram metadata",
            "nullable": true,
            "maxItems": 10000
          },
          "image": {
            "type": "object",
            "description": "Image data with version information",
            "properties": {
              "svg": {
                "type": "string",
                "format": "byte",
                "description": "BASE64 encoded SVG representation of the diagram, used for thumbnails and reports",
                "pattern": "^[A-Za-z0-9+/]*=*$",
                "maxLength": 102400
              },
              "update_vector": {
                "type": "integer",
                "format": "int64",
                "description": "Version of the diagram when this SVG was generated. If not provided when svg is updated, will be auto-set to BaseDiagram.update_vector",
                "minimum": 0
              }
            },
            "nullable": true,
            "additionalProperties": false
          },
          "description": {
            "type": "string",
            "maxLength": 1024,
            "nullable": true,
            "description": "Optional description of the diagram",
            "pattern": "^[^\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]*$"
          },
          "include_in_report": {
            "type": "boolean",
            "description": "Whether this item should be included in generated reports",
            "default": true
          }
        },
        "required": [
          "name",
          "type"
        ],
        "discriminator": {
          "propertyName": "type",
          "mapping": {
            "DFD-1.0.0": "#/components/schemas/DfdDiagramInput"
          }
        },
        "example": {
          "type": "DFD-1.0.0",
          "name": "New Architecture Diagram",
          "description": "Draft architecture for microservices migration",
          "include_in_report": true
        }
      },
      "DfdDiagram": {
        "x-discriminator-value": "DFD-1.0.0",
        "allOf": [
          {
            "$ref": "#/components/schemas/BaseDiagram"
          },
          {
            "type": "object",
            "description": "Data Flow Diagram (DFD) with cells - API response schema",
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "DFD-1.0.0"
                ],
                "description": "DFD diagram type with version",
                "maxLength": 1000
              },
              "cells": {
                "type": "array",
                "items": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/Node"
                    },
                    {
                      "$ref": "#/components/schemas/Edge"
                    }
                  ],
                  "discriminator": {
                    "propertyName": "shape",
                    "mapping": {
                      "actor": "#/components/schemas/Node",
                      "process": "#/components/schemas/Node",
                      "store": "#/components/schemas/Node",
                      "security-boundary": "#/components/schemas/Node",
                      "text-box": "#/components/schemas/Node",
                      "flow": "#/components/schemas/Edge"
                    }
                  }
                },
                "description": "List of diagram cells (nodes and edges) following X6 structure",
                "maxItems": 10000
              }
            },
            "required": [
              "cells"
            ]
          }
        ],
        "example": {
          "id": "234e5678-e89b-41d4-a716-446655440002",
          "type": "DFD-1.0.0",
          "name": "Payment Data Flow",
          "description": "Data flow through payment processing",
          "created_at": "2024-01-15T10:00:00Z",
          "modified_at": "2024-01-15T10:00:00Z",
          "cells": [
            {
              "id": "c30eabcd-e89b-41d4-a716-446655440022",
              "shape": "process",
              "x": 150,
              "y": 250,
              "width": 140,
              "height": 70
            }
          ],
          "include_in_report": true
        },
        "description": "Data Flow Diagram with cells, edges, and visual styling for JointJS rendering"
      },
      "DfdDiagramInput": {
        "x-discriminator-value": "DFD-1.0.0",
        "allOf": [
          {
            "$ref": "#/components/schemas/BaseDiagramInput"
          },
          {
            "type": "object",
            "description": "Data Flow Diagram (DFD) input for PUT requests - excludes readOnly fields",
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "DFD-1.0.0"
                ],
                "description": "DFD diagram type with version",
                "maxLength": 1000
              },
              "cells": {
                "type": "array",
                "items": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/Node"
                    },
                    {
                      "$ref": "#/components/schemas/Edge"
                    }
                  ],
                  "discriminator": {
                    "propertyName": "shape",
                    "mapping": {
                      "actor": "#/components/schemas/Node",
                      "process": "#/components/schemas/Node",
                      "store": "#/components/schemas/Node",
                      "security-boundary": "#/components/schemas/Node",
                      "text-box": "#/components/schemas/Node",
                      "flow": "#/components/schemas/Edge"
                    }
                  }
                },
                "description": "List of diagram cells (nodes and edges) following X6 structure",
                "maxItems": 10000
              }
            },
            "required": [
              "cells"
            ]
          }
        ],
        "example": {
          "type": "DFD-1.0.0",
          "name": "Authentication Flow",
          "description": "User authentication data flow",
          "cells": [
            {
              "id": "d40eabcd-e89b-41d4-a716-446655440023",
              "shape": "actor",
              "x": 50,
              "y": 100,
              "width": 60,
              "height": 60
            }
          ],
          "include_in_report": true
        },
        "description": "Input schema for creating or updating a Data Flow Diagram"
      },
      "CreateDiagramRequest": {
        "type": "object",
        "description": "Request body for creating a new diagram - only includes client-provided fields",
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the diagram",
            "maxLength": 256,
            "pattern": "^[^\\x00-\\x1F]*$",
            "minLength": 1
          },
          "type": {
            "type": "string",
            "description": "Type of diagram with version",
            "enum": [
              "DFD-1.0.0"
            ],
            "maxLength": 64,
            "minLength": 1
          }
        },
        "required": [
          "name",
          "type"
        ],
        "additionalProperties": false,
        "example": {
          "name": "Payment Flow Data Flow Diagram",
          "type": "DFD-1.0.0"
        }
      },
      "Diagram": {
        "deprecated": true,
        "description": "DEPRECATED: Empty wrapper schema for polymorphic diagram types. Use DfdDiagram directly instead. This schema is kept for backward compatibility but generates empty classes in client libraries.",
        "oneOf": [
          {
            "$ref": "#/components/schemas/DfdDiagram"
          }
        ],
        "discriminator": {
          "propertyName": "type",
          "mapping": {
            "DFD-1.0.0": "#/components/schemas/DfdDiagram"
          }
        },
        "example": {
          "id": "234e5678-e89b-41d4-a716-446655440001",
          "type": "DFD-1.0.0",
          "name": "Payment Flow Architecture",
          "description": "Data flow diagram showing payment processing",
          "created_at": "2024-01-15T10:35:00Z",
          "modified_at": "2024-01-20T16:00:00Z",
          "cells": []
        }
      },
      "Cell": {
        "type": "object",
        "description": "Base schema for all diagram cells (nodes and edges). Contains common properties shared by Node and Edge types.",
        "discriminator": {
          "propertyName": "shape"
        },
        "required": [
          "id",
          "shape"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier of the cell (UUID)",
            "format": "uuid",
            "example": "37EAEDFA-BF37-4996-8665-242FEC34BBFF",
            "maxLength": 36,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          },
          "shape": {
            "type": "string",
            "description": "Shape type identifier that determines cell structure and behavior",
            "example": "process",
            "pattern": "^[a-z][a-z0-9-]*$",
            "maxLength": 64
          },
          "data": {
            "type": "object",
            "description": "Flexible data storage compatible with X6, with reserved metadata namespace",
            "properties": {
              "_metadata": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "description": "Reserved namespace for structured business metadata",
                "maxItems": 100
              },
              "security_boundary": {
                "type": "boolean",
                "description": "Indicates whether this cell represents a security boundary in the threat model",
                "default": false
              },
              "data_assets": {
                "type": "array",
                "description": "References to Asset IDs associated with this cell. Each UUID must reference an existing Asset in the same threat model.",
                "items": {
                  "type": "string",
                  "format": "uuid",
                  "description": "UUID reference to an Asset object",
                  "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
                  "maxLength": 36
                },
                "minItems": 1,
                "maxItems": 100,
                "uniqueItems": true
              }
            },
            "additionalProperties": true,
            "default": {
              "_metadata": []
            }
          }
        },
        "example": {
          "id": "f60eabcd-e89b-41d4-a716-446655440015",
          "shape": "process"
        }
      },
      "Node": {
        "allOf": [
          {
            "$ref": "#/components/schemas/Cell"
          },
          {
            "type": "object",
            "description": "A diagram node representing an entity, process, store, or boundary. Supports both X6 position/size object format and flat x/y/width/height format. Input accepts either format. Output always uses flat format (x, y, width, height).",
            "properties": {
              "shape": {
                "type": "string",
                "enum": [
                  "actor",
                  "process",
                  "store",
                  "security-boundary",
                  "text-box"
                ],
                "description": "Node type determining its visual representation and behavior",
                "maxLength": 1000
              },
              "position": {
                "type": "object",
                "description": "Node position in X6 nested format. Use either this with size object OR use flat x/y/width/height properties.",
                "properties": {
                  "x": {
                    "type": "number",
                    "description": "X coordinate"
                  },
                  "y": {
                    "type": "number",
                    "description": "Y coordinate"
                  }
                },
                "required": [
                  "x",
                  "y"
                ],
                "additionalProperties": false
              },
              "size": {
                "type": "object",
                "description": "Node size in X6 nested format. Use either this with position object OR use flat x/y/width/height properties.",
                "properties": {
                  "width": {
                    "type": "number",
                    "description": "Width in pixels",
                    "minimum": 40
                  },
                  "height": {
                    "type": "number",
                    "description": "Height in pixels",
                    "minimum": 30
                  }
                },
                "required": [
                  "width",
                  "height"
                ],
                "additionalProperties": false
              },
              "angle": {
                "type": "number",
                "description": "Rotation angle in degrees",
                "default": 0
              },
              "attrs": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/NodeAttrs"
                  }
                ],
                "description": "Visual styling attributes for the node"
              },
              "ports": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/PortConfiguration"
                  }
                ],
                "description": "Port configuration for connections"
              },
              "parent": {
                "type": "string",
                "format": "uuid",
                "description": "ID of the parent cell for nested/grouped nodes (UUID)",
                "nullable": true,
                "maxLength": 36,
                "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
              },
              "children": {
                "type": "array",
                "description": "IDs of child cells contained within this node (UUIDs)",
                "items": {
                  "type": "string",
                  "format": "uuid",
                  "maxLength": 36,
                  "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
                },
                "maxItems": 1000
              },
              "x": {
                "type": "number",
                "description": "X coordinate (flat format). Use either this with y, width, height OR use position/size objects."
              },
              "y": {
                "type": "number",
                "description": "Y coordinate (flat format)"
              },
              "width": {
                "type": "number",
                "description": "Width in pixels (flat format)",
                "minimum": 40
              },
              "height": {
                "type": "number",
                "description": "Height in pixels (flat format)",
                "minimum": 30
              }
            }
          }
        ],
        "example": {
          "id": "c30eabcd-e89b-41d4-a716-446655440022",
          "shape": "process",
          "x": 150,
          "y": 250,
          "width": 140,
          "height": 70
        },
        "description": "Diagram node representing a process, data store, external entity, or trust boundary"
      },
      "Edge": {
        "allOf": [
          {
            "$ref": "#/components/schemas/Cell"
          },
          {
            "type": "object",
            "description": "A diagram edge representing a connection or data flow between nodes. Fully compatible with X6 Edge objects and supports X6 routing algorithms (manhattan, orth, oneSide, metro, er), connector styles (normal, rounded, smooth, jumpover), custom markup, tools, and convenience properties (label, style) for easier integration.",
            "required": [
              "source",
              "target"
            ],
            "properties": {
              "shape": {
                "type": "string",
                "enum": [
                  "flow"
                ],
                "description": "Edge type identifier",
                "maxLength": 1000
              },
              "source": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/EdgeTerminal"
                  }
                ],
                "description": "Source connection point"
              },
              "target": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/EdgeTerminal"
                  }
                ],
                "description": "Target connection point"
              },
              "attrs": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/EdgeAttrs"
                  }
                ],
                "description": "Visual styling attributes for the edge"
              },
              "labels": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/EdgeLabel"
                },
                "description": "Text labels positioned along the edge",
                "maxItems": 1000
              },
              "vertices": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Point"
                },
                "description": "Intermediate waypoints for edge routing",
                "maxItems": 1000
              },
              "router": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/EdgeRouter"
                  }
                ],
                "description": "Edge routing algorithm configuration for path calculation"
              },
              "connector": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/EdgeConnector"
                  }
                ],
                "description": "Edge connector style configuration for visual appearance"
              },
              "defaultLabel": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/EdgeLabel"
                  }
                ],
                "description": "Default label configuration applied to edges without explicit labels"
              }
            }
          }
        ],
        "example": {
          "id": "a90eabcd-e89b-41d4-a716-446655440018",
          "shape": "flow",
          "source": {
            "cell": "f60eabcd-e89b-41d4-a716-446655440015"
          },
          "target": {
            "cell": "b00eabcd-e89b-41d4-a716-446655440019"
          }
        },
        "description": "Diagram edge representing a data flow connection between nodes"
      },
      "ThreatModel": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ThreatModelBase"
          },
          {
            "type": "object",
            "description": "Complete ThreatModel with server-generated fields",
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid",
                "description": "Unique identifier for the threat model (UUID)",
                "maxLength": 36,
                "readOnly": true,
                "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
              },
              "created_at": {
                "type": "string",
                "format": "date-time",
                "description": "Creation timestamp (RFC3339)",
                "maxLength": 32,
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "modified_at": {
                "type": "string",
                "format": "date-time",
                "description": "Last modification timestamp (RFC3339)",
                "maxLength": 32,
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "created_by": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/User"
                  }
                ],
                "description": "User who created the threat model",
                "readOnly": true
              },
              "documents": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Document"
                },
                "description": "List of documents related to the threat model",
                "readOnly": true,
                "maxItems": 1000
              },
              "repositories": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Repository"
                },
                "description": "List of source code repositories related to the threat model",
                "readOnly": true,
                "maxItems": 1000
              },
              "diagrams": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Diagram"
                },
                "description": "List of diagram objects associated with this threat model",
                "readOnly": true,
                "maxItems": 10000
              },
              "threats": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Threat"
                },
                "description": "List of threats within the threat model",
                "readOnly": true,
                "maxItems": 1000
              },
              "notes": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Note"
                },
                "description": "List of notes associated with the threat model",
                "readOnly": true,
                "maxItems": 1000
              },
              "assets": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/ExtendedAsset"
                },
                "description": "List of assets associated with the threat model",
                "readOnly": true,
                "maxItems": 1000
              },
              "status_updated": {
                "type": "string",
                "format": "date-time",
                "nullable": true,
                "description": "Timestamp when the status field was last modified (RFC3339). Automatically updated by the server when status changes.",
                "maxLength": 32,
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "is_confidential": {
                "type": "boolean",
                "description": "Whether this threat model is confidential (set at creation, read-only after)",
                "readOnly": true
              }
            }
          }
        ],
        "description": "A threat model containing diagrams, threats, documents, and other security analysis artifacts"
      },
      "Threat": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ThreatBase"
          },
          {
            "type": "object",
            "description": "Complete Threat with server-generated fields",
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid",
                "description": "Unique identifier for the threat (UUID)",
                "maxLength": 36,
                "readOnly": true,
                "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
              },
              "threat_model_id": {
                "type": "string",
                "format": "uuid",
                "description": "Unique identifier of the parent threat model (UUID)",
                "maxLength": 36,
                "readOnly": true,
                "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
              },
              "created_at": {
                "type": "string",
                "format": "date-time",
                "description": "Creation timestamp (RFC3339)",
                "maxLength": 32,
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "modified_at": {
                "type": "string",
                "format": "date-time",
                "description": "Last modification timestamp (RFC3339)",
                "maxLength": 32,
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              }
            }
          }
        ],
        "example": {
          "id": "345e6789-e89b-41d4-a716-446655440002",
          "threat_model_id": "123e4567-e89b-41d4-a716-446655440000",
          "name": "SQL Injection in Payment Query",
          "description": "Unsanitized input in payment lookup query could allow SQL injection",
          "severity": "High",
          "stride_category": "Tampering",
          "status": "Open",
          "metadata": [
            {
              "key": "cwe",
              "value": "CWE-89"
            }
          ],
          "created_at": "2024-01-16T09:00:00Z",
          "modified_at": "2024-01-16T09:00:00Z",
          "threat_type": [
            "spoofing"
          ],
          "include_in_report": true
        },
        "description": "A security threat identified during threat modeling, with severity, status, and mitigation details"
      },
      "Authorization": {
        "allOf": [
          {
            "$ref": "#/components/schemas/Principal"
          },
          {
            "type": "object",
            "description": "Authorization entry with principal identity and role",
            "required": [
              "role"
            ],
            "properties": {
              "role": {
                "type": "string",
                "enum": [
                  "reader",
                  "writer",
                  "owner"
                ],
                "description": "Role: reader (view), writer (edit), owner (full control)",
                "maxLength": 6,
                "x-oapi-codegen-extra-tags": {
                  "binding": "required"
                }
              }
            }
          }
        ],
        "example": {
          "principal_type": "user",
          "provider": "tmi",
          "provider_id": "bob@example.com",
          "display_name": "Bob Smith",
          "email": "bob@example.com",
          "role": "writer"
        },
        "description": "Authorization record granting a user access to a resource with a specific role"
      },
      "Metadata": {
        "type": "object",
        "description": "A key-value pair for extensible metadata",
        "properties": {
          "key": {
            "type": "string",
            "description": "Metadata key",
            "minLength": 1,
            "maxLength": 256,
            "pattern": "^[a-zA-Z0-9_./:-]+$",
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          },
          "value": {
            "type": "string",
            "description": "Metadata value",
            "minLength": 1,
            "maxLength": 1024,
            "pattern": "^[^<>]*$",
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          }
        },
        "required": [
          "key",
          "value"
        ],
        "additionalProperties": false,
        "example": {
          "key": "environment",
          "value": "production"
        }
      },
      "Error": {
        "type": "object",
        "description": "Standard error response format",
        "properties": {
          "error": {
            "type": "string",
            "description": "Error code",
            "pattern": "^[^\\x00-\\x1F]*$",
            "maxLength": 1000
          },
          "error_description": {
            "type": "string",
            "description": "Human-readable error description",
            "pattern": "^[^\\x00-\\x1F]*$",
            "maxLength": 1000
          },
          "error_uri": {
            "type": "string",
            "format": "uri",
            "description": "URI to documentation about the error",
            "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
            "maxLength": 1000
          },
          "details": {
            "type": "object",
            "description": "Additional context-specific error information",
            "properties": {
              "code": {
                "type": "string",
                "description": "Machine-readable error code for programmatic handling",
                "example": "COLLABORATION_SESSION_NOT_FOUND",
                "pattern": "^[a-zA-Z0-9_-]*$",
                "maxLength": 512
              },
              "context": {
                "type": "object",
                "description": "Contextual information about the error",
                "additionalProperties": true,
                "example": {
                  "diagram_id": "550e8400-e29b-41d4-a716-446655440000",
                  "requested_operation": "end_session"
                }
              },
              "suggestion": {
                "type": "string",
                "description": "Human-readable suggestion for resolving the error",
                "example": "Start a collaboration session first using POST /diagrams/{id}/collaborate",
                "pattern": "^[^\\x00-\\x1F]*$",
                "maxLength": 1000
              }
            },
            "additionalProperties": false,
            "nullable": true
          }
        },
        "required": [
          "error",
          "error_description"
        ],
        "example": {
          "error": "invalid_request",
          "error_description": "The request is missing a required parameter",
          "error_uri": "https://docs.example.com/oauth2/errors/invalid_request"
        },
        "additionalProperties": false
      },
      "AuthTokenResponse": {
        "type": "object",
        "description": "JWT token response for authentication endpoints",
        "properties": {
          "access_token": {
            "type": "string",
            "description": "JWT access token",
            "pattern": "^[a-zA-Z0-9_.-]*$",
            "maxLength": 4096
          },
          "refresh_token": {
            "type": "string",
            "description": "Refresh token for obtaining new access tokens",
            "pattern": "^[a-zA-Z0-9_.-]*$",
            "maxLength": 1024
          },
          "token_type": {
            "type": "string",
            "enum": [
              "Bearer"
            ],
            "description": "Token type",
            "maxLength": 1000
          },
          "expires_in": {
            "type": "integer",
            "description": "Access token expiration time in seconds"
          }
        },
        "required": [
          "access_token",
          "refresh_token",
          "token_type",
          "expires_in"
        ],
        "example": {
          "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
          "refresh_token": "def456...",
          "token_type": "Bearer",
          "expires_in": 3600
        },
        "additionalProperties": false
      },
      "CollaborationSession": {
        "type": "object",
        "description": "Details of an active collaboration session for a diagram",
        "properties": {
          "session_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the session (UUID)",
            "maxLength": 36,
            "readOnly": true,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          },
          "host": {
            "allOf": [
              {
                "$ref": "#/components/schemas/User"
              }
            ],
            "description": "User hosting the collaboration session",
            "readOnly": true
          },
          "presenter": {
            "allOf": [
              {
                "$ref": "#/components/schemas/User"
              }
            ],
            "description": "User currently presenting (may be null if no active presenter)",
            "readOnly": true
          },
          "threat_model_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier of the associated threat model (UUID)",
            "maxLength": 36,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          },
          "threat_model_name": {
            "type": "string",
            "description": "Name of the associated threat model",
            "maxLength": 256,
            "pattern": "^[^\\x00-\\x1F]*$"
          },
          "diagram_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier of the associated diagram (UUID)",
            "maxLength": 36,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          },
          "diagram_name": {
            "type": "string",
            "description": "Name of the associated diagram",
            "maxLength": 256,
            "pattern": "^[^\\x00-\\x1F]*$"
          },
          "participants": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Participant"
            },
            "description": "List of active participants",
            "maxItems": 1000
          },
          "websocket_url": {
            "type": "string",
            "description": "WebSocket URL for real-time updates",
            "maxLength": 1024,
            "pattern": "^\\s*wss?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$"
          }
        },
        "required": [
          "session_id",
          "host",
          "threat_model_id",
          "threat_model_name",
          "diagram_id",
          "diagram_name",
          "participants",
          "websocket_url"
        ],
        "example": {
          "session_id": "D7744D3A-ED22-40AF-862B-29786CAD0007",
          "host": {
            "principal_type": "user",
            "provider": "tmi",
            "provider_id": "admin@example.com",
            "display_name": "Admin User",
            "email": "admin@example.com"
          },
          "presenter": {
            "principal_type": "user",
            "provider": "tmi",
            "provider_id": "presenter@example.com",
            "display_name": "Presenter User",
            "email": "presenter@example.com"
          },
          "threat_model_id": "5311D207-AFD5-4A1A-BA83-14C1445DC257",
          "threat_model_name": "E-commerce Platform Security Analysis",
          "diagram_id": "DFF7F4A9-CBCE-4001-9198-2706C86F7EF3",
          "diagram_name": "User Authentication Flow",
          "participants": [
            {
              "user": {
                "principal_type": "user",
                "provider": "tmi",
                "provider_id": "admin@example.com",
                "email": "admin@example.com",
                "display_name": "Admin User"
              },
              "last_activity": "2025-04-06T12:02:00Z",
              "permissions": "writer"
            }
          ],
          "websocket_url": "wss://api.example.com/threat_models/5311D207-AFD5-4A1A-BA83-14C1445DC257/diagrams/DFF7F4A9-CBCE-4001-9198-2706C86F7EF3/ws"
        },
        "additionalProperties": false
      },
      "DiagramListItem": {
        "type": "object",
        "description": "Summary diagram object for GET /diagrams list endpoints. Excludes large fields (cells) for performance. Includes image for thumbnail rendering and description for display. Full diagram details available via GET /diagrams/{id} which returns DfdDiagram.",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier of the diagram (UUID)",
            "maxLength": 36,
            "readOnly": true,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          },
          "name": {
            "type": "string",
            "description": "Name of the diagram",
            "maxLength": 256,
            "pattern": "^[^\\x00-\\x1F]*$"
          },
          "type": {
            "type": "string",
            "enum": [
              "DFD-1.0.0"
            ],
            "description": "Type of the diagram",
            "maxLength": 1000
          },
          "description": {
            "type": "string",
            "maxLength": 1024,
            "nullable": true,
            "description": "Optional description of the diagram",
            "pattern": "^[^<>\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]*$"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp (ISO3339)",
            "maxLength": 36,
            "readOnly": true,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "modified_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last modification timestamp (ISO3339)",
            "maxLength": 36,
            "readOnly": true,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "image": {
            "type": "object",
            "description": "Image data with version information for thumbnail rendering",
            "properties": {
              "svg": {
                "type": "string",
                "format": "byte",
                "description": "BASE64 encoded SVG representation of the diagram, used for thumbnails and reports",
                "pattern": "^[A-Za-z0-9+/]*=*$",
                "maxLength": 102400
              },
              "update_vector": {
                "type": "integer",
                "format": "int64",
                "description": "Version of the diagram when this SVG was generated",
                "minimum": 0
              }
            },
            "nullable": true,
            "additionalProperties": false
          },
          "include_in_report": {
            "type": "boolean",
            "description": "Whether this item should be included in generated reports",
            "default": true
          }
        },
        "required": [
          "id",
          "name",
          "type",
          "created_at",
          "modified_at"
        ],
        "additionalProperties": false,
        "example": {
          "id": "880e8400-e29b-41d4-a716-446655440003",
          "name": "Payment Flow Data Flow Diagram",
          "type": "DFD-1.0.0",
          "description": "Data flow diagram showing payment processing flow",
          "created_at": "2025-01-15T10:30:00Z",
          "modified_at": "2025-01-15T14:22:00Z",
          "image": null,
          "include_in_report": true
        }
      },
      "TMListItem": {
        "type": "object",
        "description": "Enhanced item for threat model list endpoints with key metadata and counts",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier of the threat model (UUID)",
            "maxLength": 36,
            "readOnly": true,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          },
          "name": {
            "type": "string",
            "description": "Name of the threat model",
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "minLength": 1
          },
          "description": {
            "type": "string",
            "description": "Description of the threat model",
            "maxLength": 1024,
            "pattern": "^[^\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]*$"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp (RFC3339)",
            "maxLength": 32,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "modified_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last modification timestamp (RFC3339)",
            "maxLength": 32,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "owner": {
            "allOf": [
              {
                "$ref": "#/components/schemas/User"
              }
            ],
            "description": "User who owns the threat model"
          },
          "created_by": {
            "allOf": [
              {
                "$ref": "#/components/schemas/User"
              }
            ],
            "description": "User who created the threat model"
          },
          "threat_model_framework": {
            "type": "string",
            "description": "The framework used for this threat model",
            "pattern": "^[A-Za-z0-9_-]*$",
            "maxLength": 30
          },
          "document_count": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of documents associated with this threat model"
          },
          "repo_count": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of source code repository entries associated with this threat model"
          },
          "diagram_count": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of diagrams associated with this threat model"
          },
          "threat_count": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of threats defined in this threat model"
          },
          "issue_uri": {
            "type": "string",
            "format": "uri",
            "description": "URL to an issue in an issue tracking system",
            "maxLength": 1000,
            "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$"
          },
          "asset_count": {
            "type": "integer",
            "description": "Number of assets associated with this threat model",
            "minimum": 0
          },
          "note_count": {
            "type": "integer",
            "description": "Number of notes associated with this threat model",
            "minimum": 0
          },
          "status": {
            "type": "string",
            "nullable": true,
            "description": "Status of the threat model in the organization's threat modeling or SDLC process. Examples: \"Not started\", \"In progress\", \"Review\", \"Approved\", \"Closed\"",
            "maxLength": 128,
            "pattern": "^[^\\x00-\\x1F]*$"
          },
          "status_updated": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "description": "Timestamp when the status field was last modified (RFC3339). Automatically updated by the server when status changes.",
            "maxLength": 32,
            "readOnly": true,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "security_reviewer": {
            "allOf": [
              {
                "$ref": "#/components/schemas/User"
              }
            ],
            "description": "Security reviewer assigned to this threat model. The assigned security reviewer automatically has the owner role on this threat model.",
            "nullable": true,
            "type": "object"
          }
        },
        "required": [
          "id",
          "name",
          "created_at",
          "modified_at",
          "owner",
          "created_by",
          "threat_model_framework",
          "document_count",
          "repo_count",
          "diagram_count",
          "threat_count",
          "asset_count",
          "note_count"
        ],
        "additionalProperties": false,
        "example": {
          "id": "660e8400-e29b-41d4-a716-446655440001",
          "name": "Payment Gateway Threat Model",
          "owner": {
            "principal_type": "user",
            "provider": "github",
            "provider_id": "alice@example.com",
            "display_name": "Alice Johnson",
            "email": "alice@example.com"
          },
          "created_by": {
            "principal_type": "user",
            "provider": "github",
            "provider_id": "alice@example.com",
            "display_name": "Alice Johnson",
            "email": "alice@example.com"
          },
          "threat_model_framework": "STRIDE",
          "created_at": "2024-01-15T10:30:00Z",
          "modified_at": "2024-01-20T15:45:30Z",
          "document_count": 3,
          "repo_count": 2,
          "diagram_count": 1,
          "threat_count": 5,
          "asset_count": 4,
          "note_count": 2
        }
      },
      "Point": {
        "type": "object",
        "description": "A 2D point with x and y coordinates",
        "required": [
          "x",
          "y"
        ],
        "properties": {
          "x": {
            "type": "number",
            "description": "X coordinate"
          },
          "y": {
            "type": "number",
            "description": "Y coordinate"
          }
        },
        "example": {
          "x": 100,
          "y": 200
        },
        "additionalProperties": false
      },
      "EdgeTerminal": {
        "type": "object",
        "description": "Connection point for an edge (source or target)",
        "required": [
          "cell"
        ],
        "properties": {
          "cell": {
            "type": "string",
            "format": "uuid",
            "description": "ID of the connected node (UUID)",
            "maxLength": 36,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          },
          "port": {
            "type": "string",
            "description": "ID of the specific port on the node (optional)",
            "nullable": true,
            "maxLength": 64,
            "pattern": "^[^\\x00-\\x1F]*$"
          }
        },
        "example": {
          "cell": "233598D2-8C6D-4A73-AFE1-647081C4F7AA",
          "port": "port_out_1"
        },
        "additionalProperties": false
      },
      "NodeAttrs": {
        "type": "object",
        "description": "Visual attributes for a node",
        "properties": {
          "body": {
            "type": "object",
            "description": "Body/shape styling attributes",
            "properties": {
              "fill": {
                "type": "string",
                "description": "Fill color",
                "maxLength": 32,
                "pattern": "^(#[0-9a-fA-F]*|#[0-9a-fA-F]*|rgb\\([0-9]*,[0-9]*,[0-9]*\\)|[a-z]+)$"
              },
              "stroke": {
                "type": "string",
                "description": "Stroke color",
                "maxLength": 32,
                "pattern": "^(#[0-9a-fA-F]*|#[0-9a-fA-F]*|rgb\\([0-9]*,[0-9]*,[0-9]*\\)|[a-z]+)$"
              },
              "strokeWidth": {
                "type": "number",
                "description": "Stroke width in pixels",
                "minimum": 0
              },
              "strokeDasharray": {
                "type": "string",
                "description": "Dash pattern for strokes",
                "nullable": true,
                "maxLength": 64,
                "pattern": "^[0-9]+(\\\\.[0-9]+)?(,[0-9]+(\\\\.[0-9]+)?)*$"
              }
            },
            "additionalProperties": false
          },
          "text": {
            "type": "object",
            "description": "Text/label styling attributes",
            "properties": {
              "text": {
                "type": "string",
                "description": "Label text content",
                "maxLength": 256,
                "pattern": "^[^\\x00-\\x1F]*$"
              },
              "fontSize": {
                "type": "number",
                "description": "Font size in pixels",
                "minimum": 1
              },
              "fill": {
                "type": "string",
                "description": "Text color",
                "maxLength": 32,
                "pattern": "^(#[0-9a-fA-F]*|#[0-9a-fA-F]*|rgb\\([0-9]*,[0-9]*,[0-9]*\\)|[a-z]+)$"
              },
              "fontFamily": {
                "type": "string",
                "description": "Font family",
                "maxLength": 64,
                "pattern": "^[a-zA-Z0-9 ,'-]*$"
              },
              "refX": {
                "type": "number",
                "description": "Horizontal position (0-1 relative or pixels)"
              },
              "refY": {
                "type": "number",
                "description": "Vertical position (0-1 relative or pixels)"
              },
              "refDx": {
                "type": "number",
                "description": "Horizontal offset from refX"
              },
              "refDy": {
                "type": "number",
                "description": "Vertical offset from refY"
              },
              "textAnchor": {
                "type": "string",
                "enum": [
                  "start",
                  "middle",
                  "end"
                ],
                "description": "Horizontal text alignment anchor point"
              },
              "textVerticalAnchor": {
                "type": "string",
                "enum": [
                  "top",
                  "middle",
                  "bottom"
                ],
                "description": "Vertical text alignment anchor point"
              }
            },
            "additionalProperties": false
          }
        },
        "additionalProperties": false,
        "example": {
          "body": {
            "fill": "#e0e0e0"
          },
          "text": {
            "fill": "#333333"
          }
        }
      },
      "EdgeAttrs": {
        "type": "object",
        "description": "Visual attributes for an edge",
        "properties": {
          "line": {
            "type": "object",
            "description": "Line styling attributes",
            "properties": {
              "stroke": {
                "type": "string",
                "description": "Line color",
                "maxLength": 32,
                "pattern": "^(#[0-9a-fA-F]*|#[0-9a-fA-F]*|rgb\\([0-9]*,[0-9]*,[0-9]*\\)|[a-z]+)$"
              },
              "strokeWidth": {
                "type": "number",
                "description": "Line width in pixels",
                "minimum": 0
              },
              "strokeDasharray": {
                "type": "string",
                "description": "Dash pattern for the line",
                "nullable": true,
                "maxLength": 64,
                "pattern": "^[0-9]+(\\\\.[0-9]+)?(,[0-9]+(\\\\.[0-9]+)?)*$"
              },
              "targetMarker": {
                "type": "object",
                "description": "Arrowhead marker configuration",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Marker type",
                    "enum": [
                      "classic",
                      "block",
                      "diamond",
                      "circle"
                    ],
                    "maxLength": 32,
                    "pattern": "^[^\\x00-\\x1F]*$"
                  },
                  "size": {
                    "type": "number",
                    "description": "Marker size in pixels",
                    "minimum": 1
                  }
                },
                "additionalProperties": false
              },
              "sourceMarker": {
                "type": "object",
                "description": "Source marker configuration",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Marker type",
                    "enum": [
                      "classic",
                      "block",
                      "diamond",
                      "circle"
                    ],
                    "maxLength": 32,
                    "pattern": "^[^\\x00-\\x1F]*$"
                  },
                  "size": {
                    "type": "number",
                    "description": "Marker size in pixels",
                    "minimum": 1
                  }
                },
                "additionalProperties": false
              }
            },
            "additionalProperties": false
          }
        },
        "additionalProperties": false,
        "example": {
          "line": {
            "stroke": "#666666",
            "strokeWidth": 2
          }
        }
      },
      "EdgeLabel": {
        "type": "object",
        "description": "Label positioned along an edge",
        "properties": {
          "attrs": {
            "type": "object",
            "description": "Label styling attributes",
            "properties": {
              "text": {
                "type": "object",
                "description": "Text styling",
                "properties": {
                  "text": {
                    "type": "string",
                    "description": "Label text content",
                    "maxLength": 256,
                    "pattern": "^[^\\x00-\\x1F]*$"
                  },
                  "fontSize": {
                    "type": "number",
                    "description": "Font size in pixels",
                    "minimum": 1
                  },
                  "fill": {
                    "type": "string",
                    "description": "Text color",
                    "maxLength": 32,
                    "pattern": "^(#[0-9a-fA-F]*|#[0-9a-fA-F]*|rgb\\([0-9]*,[0-9]*,[0-9]*\\)|[a-z]+)$"
                  },
                  "fontFamily": {
                    "type": "string",
                    "description": "Font family",
                    "maxLength": 64,
                    "pattern": "^[a-zA-Z0-9 ,'-]*$"
                  }
                },
                "additionalProperties": false
              }
            },
            "additionalProperties": false
          },
          "position": {
            "oneOf": [
              {
                "type": "number",
                "description": "Simple position: 0-1 for percentage, >1 for pixels from start, <0 for pixels from end"
              },
              {
                "type": "object",
                "description": "Advanced position with offset and angle (X6 LabelPositionObject format)",
                "required": [
                  "distance"
                ],
                "properties": {
                  "distance": {
                    "type": "number",
                    "description": "Position along the edge: 0-1 for percentage, >1 for pixels from start, <0 for pixels from end"
                  },
                  "offset": {
                    "oneOf": [
                      {
                        "type": "number",
                        "description": "Perpendicular offset from edge (positive = down/right, negative = up/left)"
                      },
                      {
                        "type": "object",
                        "description": "Absolute x,y offset",
                        "properties": {
                          "x": {
                            "type": "number"
                          },
                          "y": {
                            "type": "number"
                          }
                        },
                        "additionalProperties": false
                      }
                    ]
                  },
                  "angle": {
                    "type": "number",
                    "description": "Rotation angle in degrees (clockwise)"
                  },
                  "options": {
                    "type": "object",
                    "description": "Advanced positioning options",
                    "properties": {
                      "absoluteDistance": {
                        "type": "boolean",
                        "description": "Forces absolute coordinates for distance"
                      },
                      "reverseDistance": {
                        "type": "boolean",
                        "description": "Forces reverse absolute coordinates"
                      },
                      "absoluteOffset": {
                        "type": "boolean",
                        "description": "Forces absolute coordinates for offset"
                      },
                      "keepGradient": {
                        "type": "boolean",
                        "description": "Auto-adjusts angle to match path gradient"
                      },
                      "ensureLegibility": {
                        "type": "boolean",
                        "description": "Rotates labels to avoid upside-down text"
                      }
                    },
                    "additionalProperties": false
                  }
                },
                "additionalProperties": false
              }
            ]
          }
        },
        "example": {
          "attrs": {
            "text": {
              "text": "Data Flow",
              "fontSize": 12,
              "fill": "#333333"
            }
          },
          "position": 0.5
        },
        "additionalProperties": false
      },
      "PortConfiguration": {
        "type": "object",
        "description": "Port configuration for node connections",
        "properties": {
          "groups": {
            "type": "object",
            "description": "Port group definitions",
            "additionalProperties": {
              "type": "object",
              "properties": {
                "position": {
                  "type": "string",
                  "enum": [
                    "top",
                    "right",
                    "bottom",
                    "left"
                  ],
                  "description": "Port position on the node"
                }
              },
              "additionalProperties": false
            }
          },
          "items": {
            "type": "array",
            "description": "Individual port instances",
            "items": {
              "type": "object",
              "required": [
                "id",
                "group"
              ],
              "properties": {
                "id": {
                  "type": "string",
                  "description": "Unique port identifier",
                  "maxLength": 64,
                  "pattern": "^[^\\x00-\\x1F]*$"
                },
                "group": {
                  "type": "string",
                  "description": "Port group this port belongs to",
                  "maxLength": 32,
                  "pattern": "^[^\\x00-\\x1F]*$"
                }
              },
              "additionalProperties": false
            },
            "maxItems": 1000
          }
        },
        "additionalProperties": false,
        "example": {
          "groups": {
            "in": {
              "position": "left"
            },
            "out": {
              "position": "right"
            }
          },
          "items": [
            {
              "group": "in",
              "id": "port-in-1"
            },
            {
              "group": "out",
              "id": "port-out-1"
            }
          ]
        }
      },
      "EdgeRouter": {
        "oneOf": [
          {
            "type": "string",
            "enum": [
              "normal",
              "orth",
              "oneSide",
              "manhattan",
              "metro",
              "er"
            ],
            "description": "Built-in router name",
            "maxLength": 1000
          },
          {
            "type": "object",
            "description": "Router with custom configuration",
            "required": [
              "name"
            ],
            "properties": {
              "name": {
                "type": "string",
                "enum": [
                  "normal",
                  "orth",
                  "oneSide",
                  "manhattan",
                  "metro",
                  "er"
                ],
                "description": "Router algorithm name",
                "maxLength": 256,
                "pattern": "^[^\\x00-\\x1F]*$"
              },
              "args": {
                "type": "object",
                "description": "Router-specific arguments",
                "additionalProperties": true,
                "properties": {
                  "padding": {
                    "type": "number",
                    "description": "Padding around obstacles for routing"
                  },
                  "step": {
                    "type": "number",
                    "description": "Grid step size for orthogonal routing"
                  },
                  "directions": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "enum": [
                        "top",
                        "right",
                        "bottom",
                        "left"
                      ],
                      "maxLength": 1000
                    },
                    "description": "Allowed routing directions",
                    "maxItems": 1000
                  }
                }
              }
            },
            "additionalProperties": false
          }
        ],
        "description": "Edge routing algorithm configuration for pathfinding",
        "example": {
          "name": "manhattan"
        }
      },
      "EdgeConnector": {
        "oneOf": [
          {
            "type": "string",
            "enum": [
              "normal",
              "rounded",
              "smooth",
              "jumpover"
            ],
            "description": "Built-in connector name",
            "maxLength": 1000
          },
          {
            "type": "object",
            "description": "Connector with custom configuration",
            "required": [
              "name"
            ],
            "properties": {
              "name": {
                "type": "string",
                "enum": [
                  "normal",
                  "rounded",
                  "smooth",
                  "jumpover"
                ],
                "description": "Connector style name",
                "maxLength": 256,
                "pattern": "^[^\\x00-\\x1F]*$"
              },
              "args": {
                "type": "object",
                "description": "Connector-specific arguments",
                "additionalProperties": true,
                "properties": {
                  "radius": {
                    "type": "number",
                    "description": "Radius for rounded connectors"
                  },
                  "precision": {
                    "type": "number",
                    "description": "Precision for smooth connectors"
                  },
                  "size": {
                    "type": "number",
                    "description": "Jump size for jumpover connectors"
                  },
                  "jump": {
                    "type": "string",
                    "enum": [
                      "arc",
                      "gap",
                      "cubic"
                    ],
                    "description": "Jump style for jumpover connectors",
                    "maxLength": 1000
                  }
                }
              }
            },
            "additionalProperties": false
          }
        ],
        "description": "Edge connector style configuration for visual appearance",
        "example": {
          "name": "normal"
        }
      },
      "ThreatModelBase": {
        "type": "object",
        "description": "Base schema for ThreatModel with client-writable fields",
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the threat model",
            "minLength": 1,
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          },
          "description": {
            "type": "string",
            "description": "Description of the threat model",
            "maxLength": 1024,
            "pattern": "^[^<>\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]*$"
          },
          "owner": {
            "allOf": [
              {
                "$ref": "#/components/schemas/User"
              }
            ],
            "description": "User who owns the threat model (can be null for orphaned models)"
          },
          "threat_model_framework": {
            "type": "string",
            "description": "The framework used for this threat model",
            "pattern": "^[A-Za-z0-9_-]*$",
            "maxLength": 30
          },
          "authorization": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Authorization"
            },
            "description": "List of users and their roles for this threat model",
            "maxItems": 1000
          },
          "metadata": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Metadata"
            },
            "description": "Key-value pairs for additional threat model metadata",
            "nullable": true,
            "maxItems": 100
          },
          "issue_uri": {
            "type": "string",
            "format": "uri",
            "description": "URL to an issue in an issue tracking system for this threat model",
            "maxLength": 1000,
            "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$"
          },
          "status": {
            "type": "string",
            "nullable": true,
            "description": "Status of the threat model in the organization's threat modeling or SDLC process. Examples: \"Not started\", \"In progress\", \"Review\", \"Approved\", \"Closed\"",
            "maxLength": 128,
            "pattern": "^[^\\x00-\\x1F]*$"
          },
          "alias": {
            "type": "array",
            "description": "Alternative names or identifiers for the threat model",
            "items": {
              "type": "string",
              "minLength": 3,
              "maxLength": 30,
              "pattern": "^[a-zA-Z0-9_-]+$"
            },
            "minItems": 1,
            "maxItems": 20,
            "uniqueItems": true
          },
          "security_reviewer": {
            "allOf": [
              {
                "$ref": "#/components/schemas/User"
              }
            ],
            "description": "Security reviewer assigned to this threat model. When set, the security reviewer is automatically added to the authorization list with the owner role. The security reviewer's owner role cannot be removed via authorization changes while they remain assigned as security reviewer. To change the security reviewer's authorization, first unassign them as security reviewer.",
            "nullable": true,
            "type": "object"
          },
          "project_id": {
            "type": "string",
            "format": "uuid",
            "maxLength": 36,
            "nullable": true,
            "description": "Optional reference to the project this threat model belongs to",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          }
        },
        "required": [
          "name",
          "owner",
          "authorization",
          "threat_model_framework"
        ],
        "example": {
          "name": "Payment Gateway Threat Model",
          "owner": {
            "principal_type": "user",
            "provider": "github",
            "provider_id": "alice@example.com",
            "display_name": "Alice Johnson",
            "email": "alice@example.com"
          },
          "description": "Threat analysis for payment processing",
          "threat_model_framework": "STRIDE",
          "authorization": [
            {
              "principal_type": "user",
              "provider": "tmi",
              "provider_id": "alice@example.com",
              "display_name": "Alice Anderson",
              "email": "alice@example.com",
              "role": "owner"
            }
          ],
          "alias": [
            "payment-gateway-v2",
            "PG-TM-2024"
          ]
        }
      },
      "ThreatModelInput": {
        "type": "object",
        "description": "Input schema for creating/updating ThreatModel",
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the threat model",
            "maxLength": 256,
            "pattern": "^[^\\x00-\\x1F]*$",
            "minLength": 1
          },
          "description": {
            "type": "string",
            "description": "Description of the threat model and its purpose",
            "maxLength": 1024,
            "nullable": true,
            "pattern": "^[^\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]*$"
          },
          "threat_model_framework": {
            "type": "string",
            "description": "The framework used for this threat model",
            "pattern": "^[A-Za-z0-9_-]*$",
            "maxLength": 30
          },
          "authorization": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Authorization"
            },
            "description": "List of users and their roles for this threat model",
            "maxItems": 1000
          },
          "metadata": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Metadata"
            },
            "description": "Key-value pairs for additional threat model metadata",
            "nullable": true,
            "maxItems": 100
          },
          "issue_uri": {
            "type": "string",
            "format": "uri",
            "description": "URL to an issue in an issue tracking system for this threat model",
            "maxLength": 1000,
            "nullable": true,
            "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$"
          },
          "is_confidential": {
            "type": "boolean",
            "description": "If true, threat model is marked as confidential. Can only be set at creation.",
            "default": false
          }
        },
        "required": [
          "name"
        ],
        "additionalProperties": false,
        "example": {
          "name": "Payment Gateway Threat Model",
          "description": "Threat analysis for the payment processing system",
          "threat_model_framework": "STRIDE",
          "metadata": [
            {
              "key": "project",
              "value": "payment-service"
            },
            {
              "key": "version",
              "value": "2.0"
            }
          ],
          "issue_uri": "https://github.com/example/project/issues/123"
        }
      },
      "ThreatBase": {
        "type": "object",
        "description": "Base schema for Threat with client-writable fields",
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the threat",
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "minLength": 1
          },
          "description": {
            "type": "string",
            "description": "Description of the threat and risk to the organization",
            "maxLength": 1024,
            "pattern": "^[^<>\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]*$"
          },
          "mitigation": {
            "type": "string",
            "description": "Recommended or planned mitigation(s) for the threat",
            "maxLength": 1024,
            "pattern": "^[^\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]*$"
          },
          "diagram_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier of the associated diagram (if applicable) (UUID)",
            "nullable": true,
            "maxLength": 36,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          },
          "cell_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier of the associated cell (if applicable) (UUID)",
            "nullable": true,
            "maxLength": 36,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          },
          "severity": {
            "type": "string",
            "description": "Severity level of the threat",
            "maxLength": 50,
            "pattern": "^[^\\x00-\\x1F]*$"
          },
          "score": {
            "type": "number",
            "description": "Numeric score representing the risk or impact of the threat",
            "minimum": 0.0,
            "maximum": 10.0,
            "multipleOf": 0.1
          },
          "priority": {
            "type": "string",
            "description": "Priority level for addressing the threat",
            "maxLength": 256,
            "pattern": "^[^\\x00-\\x1F]*$"
          },
          "mitigated": {
            "type": "boolean",
            "description": "Whether the threat has been mitigated"
          },
          "status": {
            "type": "string",
            "description": "Current status of the threat",
            "maxLength": 256,
            "pattern": "^[^\\x00-\\x1F]*$"
          },
          "threat_type": {
            "type": "array",
            "description": "Types or categories of the threat. Supports multiple classifications within the same framework (e.g., ['Spoofing', 'Tampering']). Empty array indicates no types assigned.",
            "items": {
              "type": "string",
              "maxLength": 256,
              "pattern": "^[^\\x00-\\x1F]*$",
              "minLength": 1
            },
            "minItems": 0,
            "maxItems": 20,
            "uniqueItems": true,
            "default": []
          },
          "metadata": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Metadata"
            },
            "description": "Key-value pairs for additional threat metadata",
            "nullable": true,
            "maxItems": 100
          },
          "issue_uri": {
            "type": "string",
            "format": "uri",
            "description": "URL to an issue in an issue tracking system for this threat",
            "maxLength": 1000,
            "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$"
          },
          "asset_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier of the associated asset (if applicable) (UUID)",
            "nullable": true,
            "maxLength": 36,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          },
          "cwe_id": {
            "type": "array",
            "description": "CWE (Common Weakness Enumeration) identifiers associated with this threat",
            "items": {
              "type": "string",
              "minLength": 5,
              "maxLength": 16,
              "pattern": "^CWE-[0-9]+$"
            },
            "minItems": 1,
            "maxItems": 50,
            "uniqueItems": true
          },
          "cvss": {
            "type": "array",
            "description": "CVSS scoring information for this threat",
            "items": {
              "$ref": "#/components/schemas/CVSSScore"
            },
            "minItems": 1,
            "maxItems": 10
          },
          "include_in_report": {
            "type": "boolean",
            "description": "Whether this item should be included in generated reports",
            "default": true
          }
        },
        "required": [
          "name",
          "threat_type"
        ],
        "example": {
          "name": "SQL Injection via Payment Form",
          "threat_type": [
            "Tampering"
          ],
          "description": "Attacker could inject malicious SQL through payment form fields",
          "priority": "high",
          "cwe_id": [
            "CWE-89"
          ],
          "cvss": [
            {
              "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
              "score": 9.8
            }
          ],
          "include_in_report": true
        }
      },
      "ThreatInput": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ThreatBase"
          }
        ],
        "description": "Input schema for creating/updating Threat",
        "example": {
          "name": "Cross-Site Scripting (XSS)",
          "description": "User input not properly sanitized in dashboard",
          "severity": "Medium",
          "stride_category": "Tampering",
          "status": "Open",
          "metadata": [
            {
              "key": "cwe",
              "value": "CWE-79"
            }
          ],
          "threat_type": [
            "spoofing"
          ],
          "include_in_report": true
        }
      },
      "User": {
        "allOf": [
          {
            "$ref": "#/components/schemas/Principal"
          },
          {
            "type": "object",
            "description": "User principal with required email address",
            "required": [
              "email",
              "display_name"
            ],
            "properties": {
              "principal_type": {
                "type": "string",
                "enum": [
                  "user"
                ],
                "description": "Always \"user\" for User objects"
              },
              "email": {
                "type": "string",
                "format": "email",
                "description": "User email address (required)",
                "maxLength": 320
              },
              "display_name": {
                "type": "string",
                "description": "User full name for display",
                "minLength": 1,
                "maxLength": 256,
                "pattern": "^[^\\x00-\\x1F]*$"
              }
            }
          }
        ],
        "example": {
          "principal_type": "user",
          "provider": "github",
          "provider_id": "alice@example.com",
          "display_name": "Alice Johnson",
          "email": "alice@example.com"
        },
        "description": "User profile information retrieved from identity provider"
      },
      "Participant": {
        "type": "object",
        "description": "A participant in a collaboration session",
        "properties": {
          "user": {
            "$ref": "#/components/schemas/User"
          },
          "last_activity": {
            "type": "string",
            "format": "date-time",
            "description": "Last activity timestamp",
            "maxLength": 36,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "permissions": {
            "type": "string",
            "enum": [
              "reader",
              "writer"
            ],
            "description": "Access permissions in the collaboration session",
            "maxLength": 1000
          }
        },
        "required": [
          "user",
          "last_activity",
          "permissions"
        ],
        "additionalProperties": false,
        "example": {
          "user": {
            "principal_type": "user",
            "provider": "tmi",
            "provider_id": "bob@example.com",
            "email": "bob@example.com",
            "display_name": "Bob Smith"
          },
          "last_activity": "2024-01-20T15:50:00Z",
          "permissions": "writer"
        }
      },
      "DeletionChallenge": {
        "type": "object",
        "description": "Challenge response for user account deletion",
        "required": [
          "challenge_text",
          "expires_at"
        ],
        "properties": {
          "challenge_text": {
            "type": "string",
            "description": "The exact challenge string that must be provided to confirm deletion",
            "pattern": "^[^\\x00-\\x1F]*$",
            "maxLength": 1000
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the challenge expires (3 minutes from issuance)",
            "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
            "maxLength": 64
          }
        },
        "additionalProperties": false,
        "example": {
          "challenge_text": "delete-660e8400-e29b-41d4-a716-446655440001",
          "expires_at": "2024-01-20T16:00:00Z"
        }
      },
      "Repository": {
        "description": "Complete Repository schema with server-generated fields",
        "allOf": [
          {
            "$ref": "#/components/schemas/RepositoryBase"
          },
          {
            "type": "object",
            "required": [
              "id"
            ],
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid",
                "description": "Unique identifier for the repository",
                "readOnly": true,
                "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
                "maxLength": 36
              },
              "metadata": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "description": "Optional metadata key-value pairs",
                "readOnly": true,
                "maxItems": 100
              },
              "created_at": {
                "type": "string",
                "format": "date-time",
                "maxLength": 32,
                "description": "Creation timestamp (RFC3339)",
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "modified_at": {
                "type": "string",
                "format": "date-time",
                "maxLength": 32,
                "description": "Last modification timestamp (RFC3339)",
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              }
            }
          }
        ],
        "example": {
          "id": "789eabcd-e89b-41d4-a716-446655440006",
          "threat_model_id": "123e4567-e89b-41d4-a716-446655440000",
          "name": "payment-service",
          "description": "Main payment processing microservice",
          "url": "https://github.com/example/payment-service",
          "repo_type": "github",
          "metadata": [
            {
              "key": "language",
              "value": "Go"
            }
          ],
          "created_at": "2024-01-15T10:00:00Z",
          "modified_at": "2024-01-15T10:00:00Z",
          "uri": "https://github.com/example/repo",
          "include_in_report": true
        }
      },
      "Note": {
        "description": "Complete Note schema with server-generated fields",
        "allOf": [
          {
            "$ref": "#/components/schemas/NoteBase"
          },
          {
            "type": "object",
            "required": [
              "id"
            ],
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid",
                "description": "Unique identifier for the note",
                "readOnly": true,
                "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
                "maxLength": 36
              },
              "metadata": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "description": "Optional metadata key-value pairs",
                "readOnly": true,
                "maxItems": 100
              },
              "created_at": {
                "type": "string",
                "format": "date-time",
                "maxLength": 32,
                "description": "Creation timestamp (RFC3339)",
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "modified_at": {
                "type": "string",
                "format": "date-time",
                "maxLength": 32,
                "description": "Last modification timestamp (RFC3339)",
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              }
            }
          }
        ]
      },
      "Asset": {
        "description": "Complete Asset schema with server-generated fields",
        "allOf": [
          {
            "$ref": "#/components/schemas/AssetBase"
          },
          {
            "type": "object",
            "required": [
              "id"
            ],
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid",
                "description": "Unique identifier for the asset",
                "readOnly": true,
                "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
                "maxLength": 36
              },
              "metadata": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "description": "Optional metadata key-value pairs",
                "readOnly": true,
                "maxItems": 100
              },
              "created_at": {
                "type": "string",
                "format": "date-time",
                "maxLength": 32,
                "description": "Creation timestamp (RFC3339)",
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "modified_at": {
                "type": "string",
                "format": "date-time",
                "maxLength": 32,
                "description": "Last modification timestamp (RFC3339)",
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              }
            }
          }
        ]
      },
      "ExtendedAsset": {
        "allOf": [
          {
            "$ref": "#/components/schemas/Asset"
          },
          {
            "type": "object",
            "properties": {
              "threat_model_id": {
                "type": "string",
                "format": "uuid",
                "description": "ID of the threat model this asset belongs to",
                "maxLength": 36,
                "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
              },
              "created_at": {
                "type": "string",
                "format": "date-time",
                "description": "Creation timestamp (ISO3339)",
                "maxLength": 36,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "modified_at": {
                "type": "string",
                "format": "date-time",
                "description": "Last modification timestamp (ISO3339)",
                "maxLength": 36,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              }
            },
            "required": [
              "threat_model_id",
              "created_at",
              "modified_at"
            ]
          }
        ],
        "description": "Asset with extended metadata for detailed security analysis"
      },
      "AssetBase": {
        "type": "object",
        "description": "Base fields for Asset (user-writable only)",
        "required": [
          "name",
          "type"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Asset name",
            "minLength": 1,
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          },
          "description": {
            "type": "string",
            "description": "Description of the asset",
            "maxLength": 1024,
            "nullable": true,
            "pattern": "^[^<>\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]*$"
          },
          "type": {
            "type": "string",
            "description": "Type of asset",
            "enum": [
              "data",
              "hardware",
              "software",
              "infrastructure",
              "service",
              "personnel"
            ],
            "maxLength": 64,
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          },
          "criticality": {
            "type": "string",
            "description": "Criticality level of the asset",
            "maxLength": 128,
            "nullable": true,
            "pattern": "^[^\\x00-\\x1F]*$"
          },
          "classification": {
            "type": "array",
            "items": {
              "type": "string",
              "maxLength": 128,
              "pattern": "^[^\\x00-\\x1F]*$"
            },
            "description": "Classification tags for the asset",
            "maxItems": 50,
            "nullable": true
          },
          "sensitivity": {
            "type": "string",
            "description": "Sensitivity label for the asset",
            "maxLength": 128,
            "nullable": true,
            "pattern": "^[^\\x00-\\x1F]*$"
          },
          "include_in_report": {
            "type": "boolean",
            "description": "Whether this item should be included in generated reports",
            "default": true
          }
        },
        "example": {
          "name": "Payment Database",
          "type": "data",
          "description": "PostgreSQL database storing customer payment information",
          "criticality": "high",
          "include_in_report": true
        }
      },
      "AssetInput": {
        "description": "Input schema for creating or updating Asset",
        "allOf": [
          {
            "$ref": "#/components/schemas/AssetBase"
          }
        ],
        "example": {
          "name": "User Database",
          "type": "data",
          "description": "Primary database storing user credentials",
          "include_in_report": true
        }
      },
      "DocumentBase": {
        "type": "object",
        "description": "Base fields for Document (user-writable only)",
        "required": [
          "name",
          "uri"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Document name",
            "minLength": 1,
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          },
          "description": {
            "type": "string",
            "description": "Description of document purpose or content",
            "maxLength": 1024,
            "nullable": true,
            "pattern": "^[^<>\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]*$"
          },
          "uri": {
            "type": "string",
            "format": "uri",
            "description": "URL location of the document",
            "maxLength": 1000,
            "x-oapi-codegen-extra-tags": {
              "binding": "required,url"
            },
            "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$"
          },
          "include_in_report": {
            "type": "boolean",
            "description": "Whether this item should be included in generated reports",
            "default": true
          }
        },
        "example": {
          "name": "Payment System Architecture",
          "uri": "https://docs.example.com/architecture/payment-system.pdf",
          "description": "High-level architecture diagram and documentation",
          "include_in_report": true
        }
      },
      "DocumentInput": {
        "description": "Input schema for creating or updating Document",
        "allOf": [
          {
            "$ref": "#/components/schemas/DocumentBase"
          }
        ],
        "example": {
          "name": "Penetration Test Results",
          "description": "External security assessment findings",
          "content": "# Penetration Test Report\n\n## Executive Summary\n\nKey findings...",
          "format": "markdown",
          "metadata": [
            {
              "key": "vendor",
              "value": "SecureTest Inc"
            }
          ],
          "uri": "https://example.com/docs/security-policy.pdf",
          "include_in_report": true
        }
      },
      "NoteBase": {
        "type": "object",
        "description": "Base fields for Note (user-writable only)",
        "required": [
          "name",
          "content"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Note name",
            "minLength": 1,
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          },
          "content": {
            "type": "string",
            "description": "Note content in markdown format",
            "minLength": 1,
            "maxLength": 65536,
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            },
            "pattern": "^[^\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]*$"
          },
          "description": {
            "type": "string",
            "description": "Description of note purpose or context",
            "maxLength": 1024,
            "nullable": true,
            "pattern": "^[^<>\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]*$"
          },
          "include_in_report": {
            "type": "boolean",
            "description": "Whether this item should be included in generated reports",
            "default": true
          }
        },
        "example": {
          "name": "Security Review Notes",
          "content": "Reviewed payment flow with security team. Key findings:\n- Need additional input validation\n- Consider rate limiting on payment endpoint",
          "include_in_report": true
        }
      },
      "NoteInput": {
        "description": "Input schema for creating or updating Note",
        "allOf": [
          {
            "$ref": "#/components/schemas/NoteBase"
          }
        ],
        "example": {
          "name": "Security Analysis Notes",
          "content": "Initial security analysis of the authentication flow.",
          "include_in_report": true
        }
      },
      "NoteListItem": {
        "type": "object",
        "description": "Summary information for Note in list responses",
        "required": [
          "name",
          "id"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Note name",
            "minLength": 1,
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          },
          "description": {
            "type": "string",
            "description": "Description of note purpose or context",
            "maxLength": 1024,
            "nullable": true,
            "pattern": "^[^\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]*$"
          },
          "metadata": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Metadata"
            },
            "description": "Key-value pairs for additional note metadata",
            "nullable": true,
            "maxItems": 100
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the note",
            "readOnly": true,
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "maxLength": 36
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "maxLength": 32,
            "description": "Creation timestamp (RFC3339)",
            "readOnly": true,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "modified_at": {
            "type": "string",
            "format": "date-time",
            "maxLength": 32,
            "description": "Last modification timestamp (RFC3339)",
            "readOnly": true,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "include_in_report": {
            "type": "boolean",
            "description": "Whether this item should be included in generated reports",
            "default": true
          }
        },
        "additionalProperties": false,
        "example": {
          "id": "ff0e8400-e29b-41d4-a716-44665544000a",
          "name": "Security Review Notes",
          "created_at": "2024-01-17T14:30:00Z",
          "modified_at": "2024-01-17T15:00:00Z",
          "include_in_report": true
        }
      },
      "RepositoryBase": {
        "type": "object",
        "description": "Base fields for Repository (user-writable only)",
        "required": [
          "uri"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Name for the source code reference",
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "minLength": 1
          },
          "description": {
            "type": "string",
            "description": "Description of the referenced source code",
            "maxLength": 1024,
            "nullable": true,
            "pattern": "^[^<>\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]*$"
          },
          "type": {
            "type": "string",
            "description": "Source code repository type",
            "enum": [
              "git",
              "svn",
              "mercurial",
              "other"
            ],
            "maxLength": 16
          },
          "parameters": {
            "type": "object",
            "description": "repo-specific parameters for retrieving the source",
            "properties": {
              "refType": {
                "type": "string",
                "enum": [
                  "branch",
                  "tag",
                  "commit"
                ],
                "description": "Reference type (branch, tag, or commit)",
                "maxLength": 6
              },
              "refValue": {
                "type": "string",
                "description": "Reference value (branch name, tag value, or commit id)",
                "maxLength": 256,
                "pattern": "^[^\\x00-\\x1F]*$"
              },
              "subPath": {
                "type": "string",
                "description": "Sub-path within the repository",
                "maxLength": 256,
                "pattern": "^[^\\x00-\\x1F]*$"
              }
            },
            "required": [
              "refType",
              "refValue"
            ],
            "additionalProperties": false
          },
          "uri": {
            "type": "string",
            "format": "uri",
            "description": "URL to retrieve the referenced source code",
            "maxLength": 1000,
            "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$"
          },
          "include_in_report": {
            "type": "boolean",
            "description": "Whether this item should be included in generated reports",
            "default": true
          }
        },
        "example": {
          "uri": "https://github.com/example/payment-service",
          "description": "Main repository for payment processing service",
          "include_in_report": true
        }
      },
      "RepositoryInput": {
        "description": "Input schema for creating or updating Repository",
        "allOf": [
          {
            "$ref": "#/components/schemas/RepositoryBase"
          }
        ],
        "example": {
          "name": "authentication-service",
          "description": "OAuth and SAML authentication microservice",
          "url": "https://github.com/example/auth-service",
          "repo_type": "github",
          "metadata": [
            {
              "key": "team",
              "value": "Security"
            }
          ],
          "uri": "https://github.com/example/repo",
          "include_in_report": true
        }
      },
      "WebhookSubscription": {
        "type": "object",
        "required": [
          "id",
          "owner_id",
          "name",
          "url",
          "events",
          "status",
          "created_at",
          "modified_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "maxLength": 36
          },
          "owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "Owner user ID",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "maxLength": 36
          },
          "threat_model_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true,
            "description": "Optional threat model filter (null means all threat models)",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "maxLength": 36
          },
          "name": {
            "type": "string",
            "minLength": 1,
            "maxLength": 255,
            "description": "Descriptive name",
            "pattern": "^[^\\x00-\\x1F]*$"
          },
          "url": {
            "type": "string",
            "format": "uri",
            "minLength": 8,
            "maxLength": 1024,
            "description": "Webhook endpoint URL (must be HTTPS)",
            "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$"
          },
          "events": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/WebhookEventType"
            },
            "minItems": 1,
            "maxItems": 1000,
            "description": "List of event types to subscribe to. See WebhookEventType for available events."
          },
          "secret": {
            "type": "string",
            "maxLength": 128,
            "description": "HMAC secret for signing payloads (not returned in GET responses)",
            "pattern": "^[^\\x00-\\x1F]*$"
          },
          "status": {
            "type": "string",
            "enum": [
              "pending_verification",
              "active",
              "pending_delete"
            ],
            "description": "Subscription status",
            "maxLength": 1000
          },
          "challenges_sent": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of verification challenges sent"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp",
            "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
            "maxLength": 64
          },
          "modified_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last modification timestamp",
            "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
            "maxLength": 64
          },
          "last_successful_use": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "description": "Last successful delivery timestamp",
            "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
            "maxLength": 64
          },
          "publication_failures": {
            "type": "integer",
            "minimum": 0,
            "description": "Count of consecutive failed deliveries"
          }
        },
        "additionalProperties": false,
        "example": {
          "id": "550e8400-e29b-41d4-a716-446655440000",
          "owner_id": "550e8400-e29b-41d4-a716-446655440020",
          "threat_model_id": "660e8400-e29b-41d4-a716-446655440001",
          "name": "Production Slack Notifications",
          "url": "https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXX",
          "events": [
            "diagram.updated",
            "threat_model.created"
          ],
          "status": "active",
          "secret": "whsec_abc123def456",
          "created_at": "2024-01-15T10:30:00Z",
          "modified_at": "2024-01-15T10:30:00Z",
          "last_successful_use": "2024-01-20T14:22:15Z",
          "challenges_sent": 0,
          "publication_failures": 0
        },
        "description": "Webhook subscription configuration for event notifications"
      },
      "WebhookSubscriptionInput": {
        "type": "object",
        "required": [
          "name",
          "url",
          "events"
        ],
        "properties": {
          "threat_model_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true,
            "description": "Optional threat model filter",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "maxLength": 36
          },
          "name": {
            "type": "string",
            "minLength": 1,
            "maxLength": 255,
            "description": "Descriptive name for the subscription",
            "pattern": "^[^\\x00-\\x1F]*$"
          },
          "url": {
            "type": "string",
            "format": "uri",
            "minLength": 8,
            "maxLength": 1024,
            "description": "Webhook endpoint URL (must be HTTPS)",
            "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$"
          },
          "events": {
            "type": "array",
            "items": {
              "type": "string",
              "pattern": "^[^\\x00-\\x1F]*$",
              "maxLength": 1000
            },
            "minItems": 1,
            "maxItems": 50,
            "description": "List of event types to subscribe to"
          },
          "secret": {
            "type": "string",
            "minLength": 16,
            "maxLength": 128,
            "description": "Optional HMAC secret for signing payloads (auto-generated if not provided)",
            "pattern": "^[^\\x00-\\x1F]*$"
          }
        },
        "additionalProperties": false,
        "example": {
          "name": "Production Slack Notifications",
          "url": "https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXX",
          "events": [
            "diagram.updated",
            "threat_model.created"
          ],
          "threat_model_id": "660e8400-e29b-41d4-a716-446655440001"
        },
        "description": "Input schema for creating or updating a webhook subscription"
      },
      "WebhookDelivery": {
        "type": "object",
        "required": [
          "id",
          "subscription_id",
          "event_type",
          "status",
          "attempts",
          "created_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier (UUIDv7)",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "maxLength": 36
          },
          "subscription_id": {
            "type": "string",
            "format": "uuid",
            "description": "Subscription that triggered this delivery",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "maxLength": 36
          },
          "event_type": {
            "$ref": "#/components/schemas/WebhookEventType"
          },
          "payload": {
            "type": "object",
            "description": "Event payload (JSON)",
            "additionalProperties": false
          },
          "status": {
            "type": "string",
            "enum": [
              "pending",
              "delivered",
              "failed"
            ],
            "description": "Delivery status",
            "maxLength": 1000
          },
          "attempts": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of delivery attempts"
          },
          "next_retry_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "description": "Next retry timestamp",
            "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
            "maxLength": 64
          },
          "last_error": {
            "type": "string",
            "description": "Last error message",
            "pattern": "^[^\\x00-\\x1F]*$",
            "maxLength": 1000
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp",
            "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
            "maxLength": 64
          },
          "delivered_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "description": "Successful delivery timestamp",
            "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
            "maxLength": 64
          }
        },
        "additionalProperties": false,
        "example": {
          "id": "aa0e8400-e29b-41d4-a716-446655440005",
          "subscription_id": "550e8400-e29b-41d4-a716-446655440000",
          "event_type": "diagram.updated",
          "status": "delivered",
          "attempts": 1,
          "created_at": "2024-01-20T15:45:30Z",
          "delivered_at": "2024-01-20T15:45:31Z",
          "payload": {}
        },
        "description": "Record of a webhook delivery attempt including status and response"
      },
      "WebhookTestRequest": {
        "type": "object",
        "properties": {
          "event_type": {
            "type": "string",
            "enum": [
              "threat_model.created",
              "threat_model.updated",
              "threat_model.deleted",
              "diagram.created",
              "diagram.updated",
              "diagram.deleted",
              "document.created",
              "document.updated",
              "document.deleted",
              "note.created",
              "note.updated",
              "note.deleted",
              "repository.created",
              "repository.updated",
              "repository.deleted",
              "asset.created",
              "asset.updated",
              "asset.deleted",
              "threat.created",
              "threat.updated",
              "threat.deleted",
              "metadata.created",
              "metadata.updated",
              "metadata.deleted"
            ],
            "description": "Webhook event type following {resource}.{action} pattern",
            "maxLength": 1000
          }
        },
        "additionalProperties": false,
        "example": {
          "event_type": "diagram.updated"
        },
        "description": "Request to test a webhook subscription with a sample event"
      },
      "WebhookTestResponse": {
        "type": "object",
        "required": [
          "delivery_id",
          "status"
        ],
        "properties": {
          "delivery_id": {
            "type": "string",
            "format": "uuid",
            "description": "Test delivery ID",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "maxLength": 36
          },
          "status": {
            "type": "string",
            "description": "Test result status",
            "pattern": "^[^\\x00-\\x1F]*$",
            "maxLength": 1000
          },
          "message": {
            "type": "string",
            "description": "Result message",
            "pattern": "^[^\\x00-\\x1F]*$",
            "maxLength": 1000
          }
        },
        "additionalProperties": false,
        "example": {
          "delivery_id": "bb0e8400-e29b-41d4-a716-446655440006",
          "status": "success",
          "message": "Test webhook delivered successfully"
        },
        "description": "Response from a webhook test including delivery status"
      },
      "CreateAddonRequest": {
        "type": "object",
        "required": [
          "name",
          "webhook_id"
        ],
        "properties": {
          "name": {
            "type": "string",
            "maxLength": 255,
            "description": "Display name for the add-on",
            "minLength": 1
          },
          "webhook_id": {
            "type": "string",
            "format": "uuid",
            "description": "UUID of the associated webhook subscription"
          },
          "description": {
            "type": "string",
            "description": "Description of what the add-on does",
            "maxLength": 1024,
            "minLength": 0
          },
          "icon": {
            "type": "string",
            "maxLength": 60,
            "pattern": "^(material-symbols:[a-z]([a-z0-9_]*[a-z0-9])?|fa-[a-z]([a-z]*[a-z])?(\\-[a-z]+)? fa-([a-z]+)(-[a-z]+)*)$",
            "description": "Icon identifier (Material Symbols or FontAwesome format)"
          },
          "objects": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "threat_model",
                "diagram",
                "asset",
                "threat",
                "document",
                "note",
                "repository",
                "metadata",
                "survey",
                "survey_response"
              ]
            },
            "description": "TMI object types this add-on can operate on",
            "maxItems": 100
          },
          "threat_model_id": {
            "type": "string",
            "format": "uuid",
            "description": "Optional: Scope add-on to specific threat model"
          }
        },
        "example": {
          "name": "Security Scanner",
          "description": "Automated security vulnerability scanner for threat models",
          "webhook_id": "550e8400-e29b-41d4-a716-446655440000",
          "threat_model_id": "660e8400-e29b-41d4-a716-446655440001",
          "icon": "material-symbols:security",
          "objects": [
            "threat_model",
            "diagram"
          ]
        },
        "additionalProperties": false,
        "description": "Request schema for registering a new addon"
      },
      "AddonResponse": {
        "type": "object",
        "required": [
          "id",
          "created_at",
          "name",
          "webhook_id"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Add-on identifier"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp"
          },
          "name": {
            "type": "string",
            "description": "Display name"
          },
          "webhook_id": {
            "type": "string",
            "format": "uuid",
            "description": "Associated webhook subscription ID"
          },
          "description": {
            "type": "string",
            "description": "Add-on description"
          },
          "icon": {
            "type": "string",
            "description": "Icon identifier"
          },
          "objects": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Supported TMI object types",
            "maxItems": 100
          },
          "threat_model_id": {
            "type": "string",
            "format": "uuid",
            "description": "Threat model scope (if scoped)"
          }
        },
        "example": {
          "id": "770e8400-e29b-41d4-a716-446655440002",
          "name": "Security Scanner",
          "description": "Automated security vulnerability scanner for threat models",
          "webhook_id": "550e8400-e29b-41d4-a716-446655440000",
          "threat_model_id": "660e8400-e29b-41d4-a716-446655440001",
          "icon": "https://example.com/icons/scanner.svg",
          "objects": [
            "threat_model",
            "diagram"
          ],
          "created_at": "2024-01-15T10:30:00Z"
        },
        "description": "Addon details including configuration and status"
      },
      "ListAddonsResponse": {
        "type": "object",
        "required": [
          "addons",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "addons": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AddonResponse"
            },
            "maxItems": 1000
          },
          "total": {
            "type": "integer",
            "description": "Total number of add-ons matching criteria"
          },
          "limit": {
            "type": "integer",
            "description": "Pagination limit"
          },
          "offset": {
            "type": "integer",
            "description": "Pagination offset"
          }
        },
        "example": {
          "addons": [
            {
              "id": "770e8400-e29b-41d4-a716-446655440002",
              "name": "Security Scanner",
              "description": "Automated security vulnerability scanner",
              "webhook_id": "550e8400-e29b-41d4-a716-446655440000",
              "created_at": "2024-01-15T10:30:00Z"
            }
          ],
          "total": 1,
          "limit": 50,
          "offset": 0
        },
        "description": "Paginated list of registered addons"
      },
      "InvokeAddonRequest": {
        "type": "object",
        "required": [
          "threat_model_id"
        ],
        "properties": {
          "threat_model_id": {
            "type": "string",
            "format": "uuid",
            "description": "Threat model context for invocation"
          },
          "object_type": {
            "type": "string",
            "enum": [
              "threat_model",
              "diagram",
              "asset",
              "threat",
              "document",
              "note",
              "repository",
              "metadata"
            ],
            "description": "Optional: Specific object type to operate on"
          },
          "object_id": {
            "type": "string",
            "format": "uuid",
            "description": "Optional: Specific object ID to operate on"
          },
          "payload": {
            "type": "object",
            "description": "User-provided data for the add-on (max 1KB JSON-serialized)",
            "additionalProperties": true
          }
        },
        "example": {
          "threat_model_id": "660e8400-e29b-41d4-a716-446655440001",
          "object_type": "diagram",
          "object_id": "880e8400-e29b-41d4-a716-446655440003",
          "payload": {
            "scan_type": "full",
            "include_recommendations": true
          }
        },
        "additionalProperties": false,
        "description": "Request to invoke an addon with parameters and payload"
      },
      "InvokeAddonResponse": {
        "type": "object",
        "required": [
          "invocation_id",
          "status",
          "created_at"
        ],
        "properties": {
          "invocation_id": {
            "type": "string",
            "format": "uuid",
            "description": "Invocation identifier for tracking"
          },
          "status": {
            "type": "string",
            "enum": [
              "pending",
              "in_progress",
              "completed",
              "failed"
            ],
            "description": "Current invocation status"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Invocation creation timestamp"
          }
        },
        "example": {
          "invocation_id": "990e8400-e29b-41d4-a716-446655440004",
          "status": "pending",
          "created_at": "2024-01-20T15:45:30Z"
        },
        "description": "Response from addon invocation including result or invocation ID"
      },
      "InvocationResponse": {
        "type": "object",
        "required": [
          "id",
          "addon_id",
          "threat_model_id",
          "invoked_by",
          "status",
          "status_percent",
          "created_at",
          "status_updated_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Invocation identifier"
          },
          "addon_id": {
            "type": "string",
            "format": "uuid",
            "description": "Add-on that was invoked"
          },
          "threat_model_id": {
            "type": "string",
            "format": "uuid",
            "description": "Threat model context"
          },
          "object_type": {
            "type": "string",
            "description": "Object type (if specified)"
          },
          "object_id": {
            "type": "string",
            "format": "uuid",
            "description": "Object ID (if specified)"
          },
          "invoked_by": {
            "allOf": [
              {
                "$ref": "#/components/schemas/User"
              }
            ],
            "description": "User who triggered the invocation"
          },
          "payload": {
            "type": "string",
            "description": "JSON-encoded payload"
          },
          "status": {
            "type": "string",
            "enum": [
              "pending",
              "in_progress",
              "completed",
              "failed"
            ],
            "description": "Current status"
          },
          "status_percent": {
            "type": "integer",
            "minimum": 0,
            "maximum": 100,
            "description": "Progress percentage (0-100)"
          },
          "status_message": {
            "type": "string",
            "description": "Optional status description"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp"
          },
          "status_updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last status update timestamp"
          }
        },
        "example": {
          "id": "990e8400-e29b-41d4-a716-446655440004",
          "addon_id": "770e8400-e29b-41d4-a716-446655440002",
          "threat_model_id": "660e8400-e29b-41d4-a716-446655440001",
          "object_type": "diagram",
          "object_id": "880e8400-e29b-41d4-a716-446655440003",
          "invoked_by": {
            "principal_type": "user",
            "provider": "tmi",
            "provider_id": "alice@example.com",
            "email": "alice@example.com",
            "display_name": "Alice Anderson"
          },
          "status": "completed",
          "status_percent": 100,
          "status_message": "Security scan completed successfully",
          "created_at": "2024-01-20T15:45:30Z",
          "status_updated_at": "2024-01-20T15:50:00Z",
          "completed_at": "2024-01-20T15:50:00Z"
        },
        "description": "Status and result of an addon invocation"
      },
      "ListInvocationsResponse": {
        "type": "object",
        "required": [
          "invocations",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "invocations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/InvocationResponse"
            },
            "maxItems": 1000
          },
          "total": {
            "type": "integer",
            "description": "Total number of invocations"
          },
          "limit": {
            "type": "integer",
            "description": "Pagination limit"
          },
          "offset": {
            "type": "integer",
            "description": "Pagination offset"
          }
        },
        "example": {
          "invocations": [
            {
              "id": "990e8400-e29b-41d4-a716-446655440004",
              "addon_id": "770e8400-e29b-41d4-a716-446655440002",
              "threat_model_id": "660e8400-e29b-41d4-a716-446655440001",
              "invoked_by": {
                "principal_type": "user",
                "provider": "tmi",
                "provider_id": "alice@example.com",
                "email": "alice@example.com",
                "display_name": "Alice Anderson"
              },
              "status": "completed",
              "status_percent": 100,
              "created_at": "2024-01-20T15:45:30Z",
              "status_updated_at": "2024-01-20T15:50:00Z"
            }
          ],
          "total": 1,
          "limit": 50,
          "offset": 0
        },
        "description": "Paginated list of addon invocations"
      },
      "UpdateInvocationStatusRequest": {
        "type": "object",
        "required": [
          "status"
        ],
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "in_progress",
              "completed",
              "failed"
            ],
            "description": "New status (cannot transition back to pending)"
          },
          "status_percent": {
            "type": "integer",
            "minimum": 0,
            "maximum": 100,
            "description": "Progress percentage"
          },
          "status_message": {
            "type": "string",
            "description": "Optional status description",
            "maxLength": 1024
          }
        },
        "example": {
          "status": "completed",
          "status_percent": 100,
          "status_message": "Security scan completed successfully. Found 3 vulnerabilities."
        },
        "additionalProperties": false,
        "description": "Request to update the status of an async addon invocation"
      },
      "UpdateInvocationStatusResponse": {
        "type": "object",
        "required": [
          "id",
          "status",
          "status_percent",
          "status_updated_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Invocation identifier"
          },
          "status": {
            "type": "string",
            "enum": [
              "pending",
              "in_progress",
              "completed",
              "failed"
            ],
            "description": "Current status"
          },
          "status_percent": {
            "type": "integer",
            "minimum": 0,
            "maximum": 100,
            "description": "Progress percentage"
          },
          "status_updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Status update timestamp"
          }
        },
        "example": {
          "id": "990e8400-e29b-41d4-a716-446655440004",
          "status": "completed",
          "status_percent": 100,
          "status_updated_at": "2024-01-20T15:50:00Z"
        },
        "additionalProperties": false,
        "description": "Response confirming invocation status update"
      },
      "Principal": {
        "type": "object",
        "description": "Base identity representation for users and groups with portable, globally-unique identifiers",
        "required": [
          "principal_type",
          "provider",
          "provider_id"
        ],
        "properties": {
          "principal_type": {
            "type": "string",
            "enum": [
              "user",
              "group"
            ],
            "description": "Type of principal: user (individual) or group"
          },
          "provider": {
            "type": "string",
            "description": "Identity provider name (e.g., \"google\", \"github\", \"microsoft\", \"tmi\"). Use \"*\" for provider-independent groups.",
            "pattern": "^(\\*|[a-zA-Z][a-zA-Z0-9_*-]*)$",
            "maxLength": 100
          },
          "provider_id": {
            "type": "string",
            "description": "Provider-assigned identifier. For users: provider_user_id (e.g., email or OAuth sub). For groups: group_name.",
            "minLength": 1,
            "maxLength": 500,
            "pattern": "^[^<>\"'&]*$"
          },
          "display_name": {
            "type": "string",
            "description": "Human-readable display name for UI presentation",
            "minLength": 1,
            "maxLength": 256,
            "pattern": "^[^\\x00-\\x1F]*$"
          },
          "email": {
            "type": "string",
            "format": "email",
            "description": "Email address (required for users, optional for groups)",
            "maxLength": 320
          }
        },
        "example": {
          "principal_type": "user",
          "provider": "google",
          "provider_id": "alice@example.com",
          "display_name": "Alice Anderson",
          "email": "alice@example.com"
        }
      },
      "SAMLProviderInfo": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Provider identifier",
            "maxLength": 1000
          },
          "name": {
            "type": "string",
            "description": "Display name of the provider",
            "maxLength": 256,
            "pattern": "^[^\\x00-\\x1F]*$"
          },
          "icon": {
            "type": "string",
            "description": "Icon identifier for the provider (Font Awesome class, URL, or path)",
            "maxLength": 1000
          },
          "auth_url": {
            "type": "string",
            "format": "uri",
            "description": "TMI SAML login endpoint URL",
            "pattern": "^(https?|wss?|file)://[^\\s]*$",
            "maxLength": 1024
          },
          "metadata_url": {
            "type": "string",
            "format": "uri",
            "description": "SAML service provider metadata URL",
            "pattern": "^(https?|wss?|file)://[^\\s]*$",
            "maxLength": 1024
          },
          "entity_id": {
            "type": "string",
            "description": "Service Provider entity ID",
            "maxLength": 1000
          },
          "acs_url": {
            "type": "string",
            "format": "uri",
            "description": "Assertion Consumer Service URL",
            "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
            "maxLength": 1024
          },
          "slo_url": {
            "type": "string",
            "format": "uri",
            "description": "Single Logout URL",
            "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
            "maxLength": 1024
          },
          "initialized": {
            "type": "boolean",
            "description": "Whether the SAML provider was successfully initialized and is available for authentication"
          }
        },
        "required": [
          "id",
          "name",
          "icon",
          "auth_url",
          "metadata_url",
          "entity_id",
          "acs_url",
          "initialized"
        ],
        "additionalProperties": false,
        "example": {
          "id": "azure-ad",
          "name": "Azure Active Directory",
          "icon": "https://example.com/icons/azure.png",
          "auth_url": "https://login.microsoftonline.com/common/saml2",
          "metadata_url": "https://login.microsoftonline.com/common/FederationMetadata/2007-06/FederationMetadata.xml",
          "entity_id": "https://sts.windows.net/common/",
          "acs_url": "https://tmi.example.com/saml/acs",
          "initialized": true
        },
        "description": "SAML identity provider configuration and metadata"
      },
      "UserWithAdminStatus": {
        "allOf": [
          {
            "$ref": "#/components/schemas/User"
          },
          {
            "type": "object",
            "description": "User profile with role status and group memberships (only returned by GET /me)",
            "properties": {
              "is_admin": {
                "type": "boolean",
                "description": "Whether the user has administrator privileges (computed dynamically based on Administrators group membership)",
                "example": false
              },
              "is_security_reviewer": {
                "type": "boolean",
                "description": "Whether the user is a security reviewer (computed dynamically based on Security Reviewers group membership)",
                "example": false
              },
              "groups": {
                "type": "array",
                "description": "TMI-managed groups that the user belongs to (direct membership only, excludes the implicit everyone pseudo-group)",
                "items": {
                  "$ref": "#/components/schemas/UserGroupMembership"
                },
                "maxItems": 100
              }
            },
            "required": [
              "is_admin",
              "is_security_reviewer",
              "groups"
            ]
          }
        ],
        "example": {
          "user_id": "550e8400-e29b-41d4-a716-446655440000",
          "email": "alice@example.com",
          "name": "Alice Johnson",
          "provider": "github",
          "is_admin": false,
          "principal_type": "user",
          "provider_id": "admin@example.com",
          "display_name": "Admin User",
          "is_security_reviewer": false,
          "groups": [
            {
              "internal_uuid": "00000000-0000-0000-0000-000000000002",
              "group_name": "administrators",
              "name": "Administrators"
            }
          ]
        },
        "description": "User profile with role status and group memberships (only returned by GET /me)"
      },
      "UserAPIQuota": {
        "type": "object",
        "required": [
          "user_id",
          "max_requests_per_minute",
          "created_at",
          "modified_at"
        ],
        "properties": {
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "User ID"
          },
          "max_requests_per_minute": {
            "type": "integer",
            "minimum": 1,
            "description": "Maximum API requests per minute"
          },
          "max_requests_per_hour": {
            "type": "integer",
            "minimum": 1,
            "nullable": true,
            "description": "Maximum API requests per hour (optional)"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp"
          },
          "modified_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last modification timestamp"
          }
        },
        "example": {
          "user_id": "550e8400-e29b-41d4-a716-446655440000",
          "max_requests_per_minute": 60,
          "created_at": "2024-01-01T00:00:00Z",
          "modified_at": "2024-01-01T00:00:00Z"
        },
        "description": "API rate limit and quota configuration for a user"
      },
      "WebhookQuota": {
        "type": "object",
        "required": [
          "owner_id",
          "max_subscriptions",
          "max_events_per_minute",
          "max_subscription_requests_per_minute",
          "max_subscription_requests_per_day"
        ],
        "properties": {
          "owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "Owner ID"
          },
          "max_subscriptions": {
            "type": "integer",
            "minimum": 1,
            "description": "Maximum number of webhook subscriptions"
          },
          "max_events_per_minute": {
            "type": "integer",
            "minimum": 1,
            "description": "Maximum webhook events per minute"
          },
          "max_subscription_requests_per_minute": {
            "type": "integer",
            "minimum": 1,
            "description": "Maximum subscription requests per minute"
          },
          "max_subscription_requests_per_day": {
            "type": "integer",
            "minimum": 1,
            "description": "Maximum subscription requests per day"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp when the quota was created"
          },
          "modified_at": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp when the quota was last modified"
          }
        },
        "example": {
          "user_id": "550e8400-e29b-41d4-a716-446655440000",
          "owner_id": "550e8400-e29b-41d4-a716-446655440000",
          "max_subscriptions": 20,
          "max_events_per_minute": 100,
          "max_subscription_requests_per_minute": 10,
          "max_subscription_requests_per_day": 1000,
          "created_at": "2024-01-01T00:00:00Z",
          "modified_at": "2024-01-01T00:00:00Z"
        },
        "description": "Webhook subscription quota configuration for a user"
      },
      "AdminUser": {
        "type": "object",
        "description": "User object with administrative fields and enriched data",
        "required": [
          "internal_uuid",
          "provider",
          "provider_user_id",
          "email",
          "name",
          "email_verified",
          "created_at",
          "modified_at"
        ],
        "properties": {
          "internal_uuid": {
            "type": "string",
            "format": "uuid",
            "description": "Internal system UUID for the user"
          },
          "provider": {
            "type": "string",
            "description": "OAuth/SAML provider identifier",
            "maxLength": 256
          },
          "provider_user_id": {
            "type": "string",
            "description": "Provider-assigned user identifier",
            "maxLength": 500
          },
          "email": {
            "type": "string",
            "format": "email",
            "description": "User email address",
            "maxLength": 320
          },
          "name": {
            "type": "string",
            "description": "User display name",
            "maxLength": 256
          },
          "email_verified": {
            "type": "boolean",
            "description": "Whether the email has been verified"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Account creation timestamp"
          },
          "modified_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last modification timestamp"
          },
          "last_login": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "description": "Last login timestamp"
          },
          "is_admin": {
            "type": "boolean",
            "description": "Whether the user has administrator privileges (enriched)",
            "readOnly": true
          },
          "groups": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "List of group names the user belongs to (enriched)",
            "readOnly": true,
            "maxItems": 100
          },
          "active_threat_models": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of active threat models owned by user (enriched)",
            "readOnly": true
          }
        },
        "example": {
          "internal_uuid": "550e8400-e29b-41d4-a716-446655440000",
          "user_id": "alice@example.com",
          "email": "alice@example.com",
          "name": "Alice Johnson",
          "provider": "github",
          "provider_user_id": "alice-github-123",
          "email_verified": true,
          "is_admin": false,
          "created_at": "2024-01-01T00:00:00Z",
          "modified_at": "2024-01-01T00:00:00Z"
        }
      },
      "AdminUserListResponse": {
        "type": "object",
        "required": [
          "users",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "users": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AdminUser"
            },
            "description": "List of users",
            "maxItems": 1000
          },
          "total": {
            "type": "integer",
            "minimum": 0,
            "description": "Total number of users matching the filter"
          },
          "limit": {
            "type": "integer",
            "minimum": 0,
            "description": "Maximum number of results returned"
          },
          "offset": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of results skipped"
          }
        },
        "example": {
          "users": [
            {
              "user_id": "550e8400-e29b-41d4-a716-446655440000",
              "email": "admin@example.com",
              "name": "Admin User",
              "provider": "github",
              "is_admin": true,
              "created_at": "2024-01-01T00:00:00Z",
              "internal_uuid": "123e4567-e89b-12d3-a456-426614174000",
              "provider_user_id": "github_123456",
              "email_verified": true,
              "modified_at": "2024-01-15T00:00:00Z"
            }
          ],
          "total": 1,
          "limit": 50,
          "offset": 0
        },
        "description": "Paginated list of users for administrative management"
      },
      "UpdateAdminUserRequest": {
        "type": "object",
        "description": "Request body for updating user metadata",
        "properties": {
          "email": {
            "type": "string",
            "format": "email",
            "maxLength": 320,
            "description": "Updated email address"
          },
          "name": {
            "type": "string",
            "maxLength": 256,
            "description": "Updated display name"
          },
          "email_verified": {
            "type": "boolean",
            "description": "Updated email verification status"
          }
        },
        "additionalProperties": false,
        "example": {
          "email": "alice.updated@example.com",
          "name": "Alice Johnson Updated"
        }
      },
      "AdminGroup": {
        "type": "object",
        "description": "Group object with administrative fields and enriched data",
        "required": [
          "internal_uuid",
          "provider",
          "group_name",
          "first_used",
          "last_used",
          "usage_count"
        ],
        "properties": {
          "internal_uuid": {
            "type": "string",
            "format": "uuid",
            "description": "Internal system UUID for the group"
          },
          "provider": {
            "type": "string",
            "description": "OAuth/SAML provider identifier, or \"*\" for provider-independent groups",
            "maxLength": 256
          },
          "group_name": {
            "type": "string",
            "description": "Provider-assigned group name",
            "maxLength": 500
          },
          "name": {
            "type": "string",
            "description": "Human-readable group name",
            "maxLength": 256
          },
          "description": {
            "type": "string",
            "description": "Group description",
            "maxLength": 1000
          },
          "first_used": {
            "type": "string",
            "format": "date-time",
            "description": "First time this group was referenced"
          },
          "last_used": {
            "type": "string",
            "format": "date-time",
            "description": "Last time this group was referenced"
          },
          "usage_count": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of times this group has been referenced"
          },
          "used_in_authorizations": {
            "type": "boolean",
            "description": "Whether this group is used in any authorizations (enriched)",
            "readOnly": true
          },
          "used_in_admin_grants": {
            "type": "boolean",
            "description": "Whether this group is used in any admin grants (enriched)",
            "readOnly": true
          },
          "member_count": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of members in the group from IdP (enriched, if available)",
            "readOnly": true
          }
        },
        "example": {
          "internal_uuid": "e50eabcd-e89b-41d4-a716-446655440014",
          "group_name": "engineering-team",
          "name": "Engineering",
          "description": "Engineering team members",
          "provider": "github",
          "provider_group_id": "org-engineering",
          "member_count": 25,
          "first_used": "2024-01-02T10:00:00Z",
          "last_used": "2024-01-20T15:00:00Z",
          "usage_count": 150,
          "created_at": "2024-01-02T10:00:00Z",
          "modified_at": "2024-01-02T10:00:00Z"
        }
      },
      "AdminGroupListResponse": {
        "type": "object",
        "required": [
          "groups",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "groups": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AdminGroup"
            },
            "description": "List of groups",
            "maxItems": 1000
          },
          "total": {
            "type": "integer",
            "minimum": 0,
            "description": "Total number of groups matching the filter"
          },
          "limit": {
            "type": "integer",
            "minimum": 0,
            "description": "Maximum number of results returned"
          },
          "offset": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of results skipped"
          }
        },
        "example": {
          "groups": [
            {
              "internal_uuid": "e50eabcd-e89b-41d4-a716-446655440014",
              "name": "Engineering",
              "description": "Engineering team members",
              "provider": "github",
              "provider_group_id": "org-engineering",
              "member_count": 25,
              "created_at": "2024-01-02T10:00:00Z",
              "modified_at": "2024-01-02T10:00:00Z",
              "group_name": "Engineering",
              "first_used": "2024-01-02T10:00:00Z",
              "last_used": "2024-01-15T14:30:00Z",
              "usage_count": 150
            }
          ],
          "total": 1,
          "limit": 50,
          "offset": 0
        },
        "description": "Paginated list of groups for administrative management"
      },
      "CreateAdminGroupRequest": {
        "type": "object",
        "description": "Request body for creating a provider-independent group",
        "required": [
          "group_name",
          "name"
        ],
        "properties": {
          "group_name": {
            "type": "string",
            "maxLength": 128,
            "pattern": "^[a-zA-Z0-9_-]+$",
            "description": "Group identifier (alphanumeric, hyphens, underscores only)",
            "minLength": 1
          },
          "name": {
            "type": "string",
            "maxLength": 128,
            "description": "Human-readable group name",
            "minLength": 1
          },
          "description": {
            "type": "string",
            "maxLength": 1000,
            "description": "Optional group description"
          }
        },
        "additionalProperties": false,
        "example": {
          "group_name": "devops-team",
          "name": "DevOps Team",
          "description": "Infrastructure and operations engineers"
        }
      },
      "UpdateAdminGroupRequest": {
        "type": "object",
        "description": "Request body for updating group metadata",
        "properties": {
          "name": {
            "type": "string",
            "maxLength": 128,
            "description": "Updated human-readable group name",
            "minLength": 1
          },
          "description": {
            "type": "string",
            "maxLength": 1000,
            "description": "Updated group description"
          }
        },
        "additionalProperties": false,
        "example": {
          "name": "Platform Engineering",
          "description": "Updated team name and scope"
        }
      },
      "WebhookEventType": {
        "type": "string",
        "enum": [
          "threat_model.created",
          "threat_model.updated",
          "threat_model.deleted",
          "diagram.created",
          "diagram.updated",
          "diagram.deleted",
          "document.created",
          "document.updated",
          "document.deleted",
          "note.created",
          "note.updated",
          "note.deleted",
          "repository.created",
          "repository.updated",
          "repository.deleted",
          "asset.created",
          "asset.updated",
          "asset.deleted",
          "threat.created",
          "threat.updated",
          "threat.deleted",
          "metadata.created",
          "metadata.updated",
          "metadata.deleted",
          "addon.invoked",
          "survey.created",
          "survey.updated",
          "survey.deleted",
          "survey_response.created",
          "survey_response.updated",
          "survey_response.deleted"
        ],
        "description": "Webhook event type following {resource}.{action} pattern. CRUD events are emitted for resource lifecycle changes (created, updated, deleted). The addon.invoked event is emitted when an add-on is invoked.",
        "maxLength": 1000,
        "x-event-categories": {
          "threat_model": [
            "threat_model.created",
            "threat_model.updated",
            "threat_model.deleted"
          ],
          "diagram": [
            "diagram.created",
            "diagram.updated",
            "diagram.deleted"
          ],
          "document": [
            "document.created",
            "document.updated",
            "document.deleted"
          ],
          "note": [
            "note.created",
            "note.updated",
            "note.deleted"
          ],
          "repository": [
            "repository.created",
            "repository.updated",
            "repository.deleted"
          ],
          "asset": [
            "asset.created",
            "asset.updated",
            "asset.deleted"
          ],
          "threat": [
            "threat.created",
            "threat.updated",
            "threat.deleted"
          ],
          "metadata": [
            "metadata.created",
            "metadata.updated",
            "metadata.deleted"
          ],
          "addon": [
            "addon.invoked"
          ],
          "survey": [
            "survey.created",
            "survey.updated",
            "survey.deleted"
          ],
          "survey_response": [
            "survey_response.created",
            "survey_response.updated",
            "survey_response.deleted"
          ]
        },
        "example": "threat_model.created"
      },
      "GroupMember": {
        "type": "object",
        "required": [
          "id",
          "group_internal_uuid",
          "subject_type",
          "added_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the membership record"
          },
          "group_internal_uuid": {
            "type": "string",
            "format": "uuid",
            "description": "Internal UUID of the group"
          },
          "user_internal_uuid": {
            "type": "string",
            "format": "uuid",
            "description": "Internal UUID of the user",
            "nullable": true
          },
          "user_email": {
            "type": "string",
            "format": "email",
            "description": "Email address of the user",
            "nullable": true
          },
          "user_name": {
            "type": "string",
            "description": "Display name of the user",
            "nullable": true
          },
          "user_provider": {
            "type": "string",
            "description": "OAuth/SAML provider for the user",
            "nullable": true
          },
          "user_provider_user_id": {
            "type": "string",
            "description": "Provider-specific user identifier",
            "nullable": true
          },
          "added_by_internal_uuid": {
            "type": "string",
            "format": "uuid",
            "description": "Internal UUID of the administrator who added this member",
            "nullable": true
          },
          "added_by_email": {
            "type": "string",
            "format": "email",
            "description": "Email of the administrator who added this member",
            "nullable": true
          },
          "added_at": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp when the user was added to the group (RFC3339)"
          },
          "notes": {
            "type": "string",
            "description": "Optional notes about this membership",
            "nullable": true
          },
          "subject_type": {
            "type": "string",
            "enum": [
              "user",
              "group"
            ],
            "default": "user",
            "description": "Type of member: user (direct user membership) or group (group-in-group membership)"
          },
          "member_group_internal_uuid": {
            "type": "string",
            "format": "uuid",
            "description": "Internal UUID of the member group (when subject_type is group)",
            "nullable": true
          },
          "member_group_name": {
            "type": "string",
            "description": "Display name of the member group (when subject_type is group)",
            "nullable": true
          }
        },
        "example": {
          "id": "a10eabcd-e89b-41d4-a716-446655440001",
          "group_internal_uuid": "e50eabcd-e89b-41d4-a716-446655440014",
          "user_internal_uuid": "660e8400-e29b-41d4-a716-446655440001",
          "user_id": "bob@example.com",
          "user_email": "bob@example.com",
          "user_name": "Bob Smith",
          "user_provider": "github",
          "user_provider_user_id": "bob-github-456",
          "added_at": "2024-01-06T09:00:00Z",
          "subject_type": "user"
        },
        "description": "Member of a group with role information"
      },
      "GroupMemberListResponse": {
        "type": "object",
        "required": [
          "members",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "members": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/GroupMember"
            },
            "maxItems": 1000
          },
          "total": {
            "type": "integer",
            "description": "Total number of members in the group"
          },
          "limit": {
            "type": "integer",
            "description": "Maximum number of results per page"
          },
          "offset": {
            "type": "integer",
            "description": "Number of results skipped"
          }
        },
        "example": {
          "members": [
            {
              "id": "880e8400-e29b-41d4-a716-446655440020",
              "group_internal_uuid": "e50eabcd-e89b-41d4-a716-446655440014",
              "user_internal_uuid": "123e4567-e89b-12d3-a456-426614174001",
              "user_email": "bob@example.com",
              "user_name": "Bob Smith",
              "user_provider": "github",
              "user_provider_user_id": "github_456789",
              "added_at": "2024-01-06T09:00:00Z",
              "subject_type": "user"
            }
          ],
          "total": 1,
          "limit": 50,
          "offset": 0
        },
        "description": "List of members in a group"
      },
      "AddGroupMemberRequest": {
        "type": "object",
        "properties": {
          "user_internal_uuid": {
            "type": "string",
            "format": "uuid",
            "description": "Internal UUID of the user to add to the group"
          },
          "notes": {
            "type": "string",
            "maxLength": 1000,
            "description": "Optional notes about this membership"
          },
          "subject_type": {
            "type": "string",
            "enum": [
              "user",
              "group"
            ],
            "default": "user",
            "description": "Type of member to add: user or group"
          },
          "member_group_internal_uuid": {
            "type": "string",
            "format": "uuid",
            "description": "Internal UUID of the group to add as a member (required when subject_type is group)"
          }
        },
        "example": {
          "user_internal_uuid": "550e8400-e29b-41d4-a716-446655440000"
        },
        "additionalProperties": false,
        "description": "Request to add a user or group to a group. Provide user_internal_uuid for user members or member_group_internal_uuid for group members."
      },
      "AddonInvocationQuota": {
        "type": "object",
        "description": "Addon invocation quota for a user",
        "properties": {
          "owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "User ID"
          },
          "max_active_invocations": {
            "type": "integer",
            "minimum": 1,
            "description": "Maximum concurrent active addon invocations"
          },
          "max_invocations_per_hour": {
            "type": "integer",
            "minimum": 1,
            "description": "Maximum addon invocations per hour"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp"
          },
          "modified_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last modification timestamp"
          }
        },
        "required": [
          "owner_id",
          "max_active_invocations",
          "max_invocations_per_hour",
          "created_at",
          "modified_at"
        ],
        "example": {
          "user_id": "550e8400-e29b-41d4-a716-446655440000",
          "owner_id": "550e8400-e29b-41d4-a716-446655440000",
          "max_active_invocations": 10,
          "max_invocations_per_hour": 100,
          "created_at": "2024-01-01T00:00:00Z",
          "modified_at": "2024-01-01T00:00:00Z"
        }
      },
      "ClientCredentialResponse": {
        "type": "object",
        "required": [
          "id",
          "client_id",
          "client_secret",
          "name",
          "created_at"
        ],
        "description": "Response from creating a client credential. WARNING: The client_secret is ONLY returned once and cannot be retrieved later.",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the credential"
          },
          "client_id": {
            "type": "string",
            "description": "OAuth 2.0 client ID (format: tmi_cc_*)",
            "pattern": "^tmi_cc_[A-Za-z0-9_-]+$"
          },
          "client_secret": {
            "type": "string",
            "description": "OAuth 2.0 client secret - ONLY returned at creation time, cannot be retrieved later"
          },
          "name": {
            "type": "string",
            "description": "Human-readable name for the credential"
          },
          "description": {
            "type": "string",
            "description": "Optional description of the credential's purpose"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp (ISO 8601)"
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "Optional expiration timestamp (ISO 8601)"
          }
        },
        "example": {
          "id": "990eabcd-e89b-41d4-a716-446655440008",
          "owner_id": "550e8400-e29b-41d4-a716-446655440000",
          "client_id": "tmi_cc_abcdef1234567890",
          "client_secret": "tmi_cs_1234567890abcdefghijklmnopqrstuvwxyz",
          "name": "CI/CD Pipeline",
          "description": "Automated testing and deployment",
          "is_active": true,
          "expires_at": "2025-12-31T23:59:59Z",
          "created_at": "2024-01-21T11:00:00Z",
          "modified_at": "2024-01-21T11:00:00Z"
        }
      },
      "ClientCredentialInfo": {
        "type": "object",
        "required": [
          "id",
          "client_id",
          "name",
          "is_active",
          "created_at",
          "modified_at"
        ],
        "description": "Client credential information without the secret",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the credential"
          },
          "client_id": {
            "type": "string",
            "description": "OAuth 2.0 client ID (format: tmi_cc_*)",
            "pattern": "^tmi_cc_[A-Za-z0-9_-]+$"
          },
          "name": {
            "type": "string",
            "description": "Human-readable name for the credential"
          },
          "description": {
            "type": "string",
            "description": "Optional description of the credential's purpose"
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the credential is active"
          },
          "last_used_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last time this credential was used (ISO 8601)"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp (ISO 8601)"
          },
          "modified_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last modification timestamp (ISO 8601)"
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "Optional expiration timestamp (ISO 8601)"
          }
        },
        "example": {
          "id": "970eabcd-e89b-41d4-a716-446655440016",
          "owner_id": "550e8400-e29b-41d4-a716-446655440000",
          "name": "Monitoring Service",
          "description": "Metrics collection service",
          "client_id": "tmi_cc_monitoring123",
          "is_active": true,
          "last_used_at": "2024-01-21T09:00:00Z",
          "created_at": "2024-01-15T10:00:00Z",
          "modified_at": "2024-01-15T10:00:00Z"
        }
      },
      "MinimalDiagramModel": {
        "type": "object",
        "description": "Minimal diagram representation optimized for automated threat modeling, containing threat model context and simplified cell data without visual styling",
        "required": [
          "id",
          "name",
          "description",
          "metadata",
          "cells",
          "assets"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Threat model unique identifier",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "maxLength": 36
          },
          "name": {
            "type": "string",
            "description": "Threat model name",
            "maxLength": 256
          },
          "description": {
            "type": "string",
            "description": "Threat model description",
            "maxLength": 4096
          },
          "metadata": {
            "type": "object",
            "description": "Flattened metadata from threat model (converted from array format to key-value pairs)",
            "additionalProperties": {
              "type": "string"
            }
          },
          "cells": {
            "type": "array",
            "description": "Minimal cell data (nodes and edges) without visual styling",
            "items": {
              "$ref": "#/components/schemas/MinimalCell"
            },
            "maxItems": 10000
          },
          "assets": {
            "type": "array",
            "description": "Asset objects referenced by cells in this diagram via dataAssetIds",
            "items": {
              "$ref": "#/components/schemas/Asset"
            },
            "maxItems": 1000
          }
        },
        "additionalProperties": false,
        "example": {
          "id": "550e8400-e29b-41d4-a716-446655440000",
          "name": "Payment Processing System",
          "description": "Threat model for credit card payment flow",
          "metadata": {
            "environment": "production",
            "compliance": "PCI-DSS"
          },
          "cells": [],
          "assets": []
        }
      },
      "MinimalCell": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/MinimalNode"
          },
          {
            "$ref": "#/components/schemas/MinimalEdge"
          }
        ],
        "discriminator": {
          "propertyName": "shape",
          "mapping": {
            "actor": "#/components/schemas/MinimalNode",
            "process": "#/components/schemas/MinimalNode",
            "store": "#/components/schemas/MinimalNode",
            "security-boundary": "#/components/schemas/MinimalNode",
            "text-box": "#/components/schemas/MinimalNode",
            "flow": "#/components/schemas/MinimalEdge"
          }
        },
        "example": {
          "shape": "process",
          "id": "550e8400-e29b-41d4-a716-446655440000",
          "children": [],
          "labels": [],
          "metadata": {},
          "security_boundary": false
        },
        "description": "Minimal diagram cell data for WebSocket collaboration updates"
      },
      "MinimalNode": {
        "type": "object",
        "description": "Minimal node representation without visual styling or layout information",
        "required": [
          "id",
          "shape",
          "children",
          "labels",
          "metadata",
          "security_boundary"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Cell unique identifier",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "maxLength": 36
          },
          "shape": {
            "type": "string",
            "enum": [
              "actor",
              "process",
              "store",
              "security-boundary",
              "text-box"
            ],
            "description": "Node shape type determining its semantic role in the diagram",
            "maxLength": 64
          },
          "parent": {
            "type": "string",
            "format": "uuid",
            "description": "Parent cell ID for nested nodes (null for top-level nodes)",
            "nullable": true,
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "maxLength": 36
          },
          "children": {
            "type": "array",
            "description": "Child cell IDs (computed bidirectional relationship including reverse parent references)",
            "items": {
              "type": "string",
              "format": "uuid",
              "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
              "maxLength": 36
            },
            "maxItems": 1000
          },
          "labels": {
            "type": "array",
            "description": "Text labels extracted from node attrs and embedded text-box children",
            "items": {
              "type": "string",
              "maxLength": 1000
            },
            "maxItems": 100
          },
          "dataAssetIds": {
            "type": "array",
            "description": "References to Asset IDs associated with this node",
            "items": {
              "type": "string",
              "format": "uuid",
              "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
              "maxLength": 36
            },
            "maxItems": 100
          },
          "metadata": {
            "type": "object",
            "description": "Flattened cell metadata (converted from _metadata array in cell.data)",
            "additionalProperties": {
              "type": "string"
            }
          },
          "security_boundary": {
            "type": "boolean",
            "description": "Indicates whether this node represents a security boundary. Always true for shape='security-boundary', otherwise derived from cell data.",
            "default": false
          }
        },
        "additionalProperties": false,
        "example": {
          "id": "760e8400-e29b-41d4-a716-446655440002",
          "shape": "process",
          "parent": "550e8400-e29b-41d4-a716-446655440001",
          "children": [
            "860e8400-e29b-41d4-a716-446655440003"
          ],
          "labels": [
            "Payment Gateway"
          ],
          "dataAssetIds": [
            "960e8400-e29b-41d4-a716-446655440004"
          ],
          "metadata": {
            "technology": "Java"
          },
          "security_boundary": false
        }
      },
      "MinimalEdge": {
        "type": "object",
        "description": "Minimal edge representation without visual styling or routing information",
        "required": [
          "id",
          "shape",
          "source",
          "target",
          "labels",
          "metadata"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Cell unique identifier",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "maxLength": 36
          },
          "shape": {
            "type": "string",
            "enum": [
              "flow"
            ],
            "description": "Edge shape type",
            "maxLength": 64
          },
          "source": {
            "allOf": [
              {
                "$ref": "#/components/schemas/EdgeTerminal"
              }
            ],
            "description": "Source node connection details"
          },
          "target": {
            "allOf": [
              {
                "$ref": "#/components/schemas/EdgeTerminal"
              }
            ],
            "description": "Target node connection details"
          },
          "labels": {
            "type": "array",
            "description": "Text labels extracted from edge labels array",
            "items": {
              "type": "string",
              "maxLength": 1000
            },
            "maxItems": 100
          },
          "dataAssetIds": {
            "type": "array",
            "description": "References to Asset IDs associated with this edge",
            "items": {
              "type": "string",
              "format": "uuid",
              "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
              "maxLength": 36
            },
            "maxItems": 100
          },
          "metadata": {
            "type": "object",
            "description": "Flattened edge metadata (converted from _metadata array in edge.data)",
            "additionalProperties": {
              "type": "string"
            }
          }
        },
        "additionalProperties": false,
        "example": {
          "id": "970e8400-e29b-41d4-a716-446655440005",
          "shape": "flow",
          "source": {
            "cell": "760e8400-e29b-41d4-a716-446655440002"
          },
          "target": {
            "cell": "a80e8400-e29b-41d4-a716-446655440006"
          },
          "labels": [
            "Credit Card Data"
          ],
          "dataAssetIds": [],
          "metadata": {
            "protocol": "https"
          }
        }
      },
      "JsonPatchDocument": {
        "type": "array",
        "description": "JSON Patch document as defined in RFC 6902",
        "items": {
          "type": "object",
          "properties": {
            "op": {
              "type": "string",
              "enum": [
                "add",
                "replace",
                "remove",
                "move",
                "copy",
                "test"
              ],
              "description": "Patch operation type",
              "maxLength": 1000,
              "pattern": "^[^\\x00-\\x1F]*$"
            },
            "path": {
              "type": "string",
              "description": "JSON path to target",
              "pattern": "^(/[^/]*)*$",
              "maxLength": 512
            },
            "value": {
              "description": "The value to use for add/replace/test operations. Can be any JSON value per RFC 6902 (string, number, boolean, object, array, or null).",
              "oneOf": [
                {
                  "type": "string",
                  "nullable": true
                },
                {
                  "type": "number"
                },
                {
                  "type": "integer"
                },
                {
                  "type": "boolean"
                },
                {
                  "type": "object"
                },
                {
                  "type": "array",
                  "maxItems": 10000,
                  "items": {
                    "description": "Any JSON value (string, number, integer, boolean, object, or null)",
                    "oneOf": [
                      {
                        "type": "string",
                        "nullable": true
                      },
                      {
                        "type": "number"
                      },
                      {
                        "type": "integer"
                      },
                      {
                        "type": "boolean"
                      },
                      {
                        "type": "object"
                      }
                    ]
                  }
                }
              ]
            }
          },
          "required": [
            "op",
            "path"
          ],
          "additionalProperties": false
        },
        "maxItems": 1000
      },
      "TokenRequest": {
        "type": "object",
        "properties": {
          "grant_type": {
            "type": "string",
            "description": "OAuth 2.0 grant type (RFC 6749)",
            "enum": [
              "authorization_code",
              "client_credentials",
              "refresh_token"
            ],
            "example": "client_credentials"
          },
          "code": {
            "type": "string",
            "description": "Authorization code (required for authorization_code grant)",
            "example": "0AX4XfWiXY2BZ_example_auth_code",
            "nullable": true
          },
          "client_id": {
            "type": "string",
            "description": "Client identifier (required for client_credentials grant)",
            "example": "tmi_cc_AbCdEf123456",
            "nullable": true
          },
          "client_secret": {
            "type": "string",
            "description": "Client secret (required for client_credentials grant)",
            "example": "secret_value",
            "nullable": true
          },
          "refresh_token": {
            "type": "string",
            "description": "Refresh token (required for refresh_token grant)",
            "example": "refresh_token_value",
            "nullable": true
          },
          "redirect_uri": {
            "type": "string",
            "description": "Redirect URI (required for authorization_code grant)",
            "nullable": true,
            "example": "http://localhost:8079/callback"
          },
          "code_verifier": {
            "type": "string",
            "description": "PKCE code verifier (required for authorization_code grant)",
            "nullable": true,
            "example": "dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk"
          },
          "state": {
            "type": "string",
            "description": "State parameter for CSRF protection",
            "nullable": true,
            "example": "xyz123abc456"
          }
        },
        "required": [
          "grant_type"
        ],
        "additionalProperties": false,
        "description": "OAuth 2.0 token exchange request"
      },
      "TokenIntrospectionRequest": {
        "type": "object",
        "properties": {
          "token": {
            "type": "string",
            "description": "The JWT token to introspect",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
            "maxLength": 1000,
            "pattern": "^[^\\x00-\\x1F]*$",
            "minLength": 1
          },
          "token_type_hint": {
            "type": "string",
            "description": "Optional hint about the type of token being introspected",
            "example": "access_token",
            "nullable": true,
            "maxLength": 1000,
            "pattern": "^[^\\x00-\\x1F]*$"
          }
        },
        "required": [
          "token"
        ],
        "additionalProperties": false,
        "description": "OAuth 2.0 token introspection request per RFC 7662"
      },
      "AddonQuotaUpdate": {
        "type": "object",
        "required": [
          "max_active_invocations",
          "max_invocations_per_hour"
        ],
        "properties": {
          "max_active_invocations": {
            "type": "integer",
            "minimum": 1,
            "description": "Maximum concurrent active addon invocations",
            "maximum": 10,
            "example": 10
          },
          "max_invocations_per_hour": {
            "type": "integer",
            "minimum": 1,
            "description": "Maximum addon invocations per hour",
            "maximum": 1000,
            "example": 1000
          }
        },
        "additionalProperties": false,
        "description": "Configuration update for addon invocation quotas"
      },
      "UserQuotaUpdate": {
        "type": "object",
        "required": [
          "max_requests_per_minute"
        ],
        "properties": {
          "max_requests_per_minute": {
            "type": "integer",
            "minimum": 1,
            "description": "Maximum API requests per minute",
            "maximum": 10000,
            "example": 60
          },
          "max_requests_per_hour": {
            "type": "integer",
            "minimum": 1,
            "nullable": true,
            "description": "Maximum API requests per hour (optional)",
            "maximum": 600000,
            "example": 10000
          }
        },
        "additionalProperties": false,
        "description": "Configuration update for user API quotas"
      },
      "WebhookQuotaUpdate": {
        "type": "object",
        "required": [
          "max_subscriptions",
          "max_events_per_minute",
          "max_subscription_requests_per_minute",
          "max_subscription_requests_per_day"
        ],
        "properties": {
          "max_subscriptions": {
            "type": "integer",
            "minimum": 1,
            "description": "Maximum webhook subscriptions",
            "maximum": 100,
            "example": 5
          },
          "max_events_per_minute": {
            "type": "integer",
            "minimum": 1,
            "description": "Maximum webhook events per minute",
            "maximum": 1000,
            "example": 100
          },
          "max_subscription_requests_per_minute": {
            "type": "integer",
            "minimum": 1,
            "description": "Maximum subscription requests per minute",
            "maximum": 100,
            "example": 60
          },
          "max_subscription_requests_per_day": {
            "type": "integer",
            "minimum": 1,
            "description": "Maximum subscription requests per day",
            "maximum": 10000,
            "example": 1440
          }
        },
        "additionalProperties": false,
        "description": "Configuration update for webhook subscription quotas"
      },
      "SamlAssertionConsumerRequest": {
        "type": "object",
        "properties": {
          "SAMLResponse": {
            "type": "string",
            "description": "Base64-encoded SAML response",
            "maxLength": 100000,
            "pattern": "^[^\\x00-\\x1F]*$",
            "example": "PHNhbWxwOlJlc3BvbnNlLi4uPg==",
            "minLength": 1
          },
          "RelayState": {
            "type": "string",
            "description": "State parameter for CSRF protection",
            "maxLength": 10000,
            "pattern": "^[^\\x00-\\x1F]*$",
            "example": "https://app.example.com/dashboard"
          }
        },
        "required": [
          "SAMLResponse"
        ],
        "additionalProperties": false,
        "description": "SAML assertion consumer service POST request"
      },
      "SamlSingleLogoutRequest": {
        "type": "object",
        "properties": {
          "SAMLRequest": {
            "type": "string",
            "description": "Base64-encoded SAML logout request",
            "maxLength": 1000,
            "pattern": "^[^\\x00-\\x1F]*$",
            "example": "PHNhbWxwOkxvZ291dFJlcXVlc3QuLi4+",
            "minLength": 1
          }
        },
        "required": [
          "SAMLRequest"
        ],
        "additionalProperties": false,
        "description": "SAML single logout request"
      },
      "TokenRefreshRequest": {
        "type": "object",
        "properties": {
          "refresh_token": {
            "type": "string",
            "description": "Valid refresh token",
            "example": "8xLOxBtZp8_example_refresh_token",
            "maxLength": 1000,
            "pattern": "^[^\\x00-\\x1F]*$",
            "minLength": 1
          }
        },
        "required": [
          "refresh_token"
        ],
        "additionalProperties": false,
        "description": "OAuth 2.0 refresh token request"
      },
      "ComponentHealth": {
        "type": "object",
        "description": "Health status of a system component",
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "healthy",
              "unhealthy",
              "unknown"
            ],
            "description": "Component health status",
            "maxLength": 32
          },
          "latency_ms": {
            "type": "integer",
            "format": "int64",
            "description": "Response latency in milliseconds",
            "minimum": 0,
            "maximum": 10000
          },
          "message": {
            "type": "string",
            "description": "Human-readable status message or error description",
            "maxLength": 256,
            "pattern": "^[^\\x00-\\x1F]*$"
          }
        },
        "required": [
          "status"
        ],
        "additionalProperties": false
      },
      "UserPreferences": {
        "type": "object",
        "description": "User preferences organized by client application. Keys are client identifiers (1-64 chars, alphanumeric + underscore/hyphen), values are preference objects. Maximum 20 clients, 1KB total size.",
        "additionalProperties": {
          "type": "object",
          "additionalProperties": true,
          "description": "Client-specific preferences (any valid JSON object)"
        },
        "maxProperties": 20,
        "example": {
          "tmi-ux": {
            "theme": "dark",
            "locale": "en-US",
            "sidebar_collapsed": false
          },
          "tmi-cli": {
            "output_format": "json",
            "color": true
          }
        }
      },
      "TokenRevocationRequest": {
        "type": "object",
        "description": "OAuth 2.0 token revocation request per RFC 7009",
        "properties": {
          "token": {
            "type": "string",
            "description": "The token to be revoked (access token or refresh token)",
            "minLength": 1,
            "maxLength": 2000,
            "pattern": "^[^\\x00-\\x1F]*$",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
          },
          "token_type_hint": {
            "type": "string",
            "description": "A hint about the type of the token. If omitted, the server will attempt to determine the token type.",
            "enum": [
              "access_token",
              "refresh_token",
              null
            ],
            "nullable": true,
            "example": "access_token"
          },
          "client_id": {
            "type": "string",
            "description": "Client identifier for client credentials authentication (alternative to Bearer token)",
            "maxLength": 256,
            "nullable": true,
            "example": "tmi_cc_abc123..."
          },
          "client_secret": {
            "type": "string",
            "description": "Client secret (required if client_id is provided)",
            "maxLength": 256,
            "nullable": true,
            "example": "secret123..."
          }
        },
        "required": [
          "token"
        ],
        "additionalProperties": false
      },
      "CVSSScore": {
        "type": "object",
        "description": "CVSS vector and score pair",
        "properties": {
          "vector": {
            "type": "string",
            "description": "CVSS vector string (e.g., CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)",
            "minLength": 26,
            "maxLength": 250,
            "pattern": "^[A-Za-z0-9.:/_-]+$"
          },
          "score": {
            "type": "number",
            "description": "CVSS score (0.0-10.0)",
            "minimum": 0.0,
            "maximum": 10.0,
            "multipleOf": 0.1
          }
        },
        "required": [
          "vector",
          "score"
        ],
        "additionalProperties": false,
        "example": {
          "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "score": 9.8
        }
      },
      "ClientConfig": {
        "type": "object",
        "description": "Client configuration for tmi-ux and other client applications",
        "properties": {
          "features": {
            "type": "object",
            "description": "Feature flags indicating enabled functionality",
            "properties": {
              "websocket_enabled": {
                "type": "boolean",
                "description": "Whether WebSocket collaboration is enabled"
              },
              "saml_enabled": {
                "type": "boolean",
                "description": "Whether SAML authentication is enabled"
              },
              "webhooks_enabled": {
                "type": "boolean",
                "description": "Whether webhook subscriptions are enabled"
              }
            },
            "additionalProperties": false
          },
          "operator": {
            "type": "object",
            "description": "Operator information",
            "properties": {
              "name": {
                "type": "string",
                "description": "Name of the service operator",
                "maxLength": 256
              },
              "contact": {
                "type": "string",
                "description": "Contact information for the operator",
                "maxLength": 1024
              }
            },
            "additionalProperties": false
          },
          "limits": {
            "type": "object",
            "description": "System limits and quotas",
            "properties": {
              "max_file_upload_mb": {
                "type": "integer",
                "description": "Maximum file upload size in megabytes",
                "minimum": 1,
                "maximum": 100
              },
              "max_diagram_participants": {
                "type": "integer",
                "description": "Maximum participants per collaboration session",
                "minimum": 1,
                "maximum": 100
              }
            },
            "additionalProperties": false
          },
          "ui": {
            "type": "object",
            "description": "UI configuration defaults",
            "properties": {
              "default_theme": {
                "type": "string",
                "description": "Default UI theme",
                "enum": [
                  "auto",
                  "light",
                  "dark"
                ]
              }
            },
            "additionalProperties": false
          }
        },
        "additionalProperties": false,
        "example": {
          "features": {
            "websocket_enabled": true,
            "saml_enabled": false,
            "webhooks_enabled": true
          },
          "operator": {
            "name": "TMI Project",
            "contact": "https://github.com/ericfitz/tmi"
          },
          "limits": {
            "max_file_upload_mb": 10,
            "max_diagram_participants": 10
          },
          "ui": {
            "default_theme": "auto"
          }
        }
      },
      "SystemSetting": {
        "type": "object",
        "description": "A system-wide configuration setting",
        "properties": {
          "key": {
            "type": "string",
            "description": "Unique setting identifier using dot notation (e.g., rate_limit.requests_per_minute)",
            "maxLength": 256,
            "pattern": "^[a-z][a-z0-9_.]*$"
          },
          "value": {
            "type": "string",
            "description": "Setting value as a string (interpreted based on type)",
            "maxLength": 4000
          },
          "type": {
            "type": "string",
            "description": "Data type of the setting value",
            "enum": [
              "string",
              "int",
              "bool",
              "json"
            ]
          },
          "description": {
            "type": "string",
            "description": "Human-readable description of the setting",
            "maxLength": 1024
          },
          "modified_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the setting was last modified"
          },
          "modified_by": {
            "type": "string",
            "format": "uuid",
            "description": "UUID of the user who last modified the setting"
          }
        },
        "required": [
          "key",
          "value",
          "type"
        ],
        "additionalProperties": false,
        "example": {
          "key": "rate_limit.requests_per_minute",
          "value": "100",
          "type": "int",
          "description": "Maximum API requests per minute per user",
          "modified_at": "2026-01-15T10:30:00Z",
          "modified_by": "550e8400-e29b-41d4-a716-446655440000"
        }
      },
      "SystemSettingUpdate": {
        "type": "object",
        "description": "Request body for creating or updating a system setting",
        "properties": {
          "value": {
            "type": "string",
            "description": "Setting value as a string (interpreted based on type)",
            "maxLength": 4000
          },
          "type": {
            "type": "string",
            "description": "Data type of the setting value",
            "enum": [
              "string",
              "int",
              "bool",
              "json"
            ]
          },
          "description": {
            "type": "string",
            "description": "Human-readable description of the setting",
            "maxLength": 1024
          }
        },
        "required": [
          "value",
          "type"
        ],
        "additionalProperties": false,
        "example": {
          "value": "150",
          "type": "int",
          "description": "Maximum API requests per minute per user"
        }
      },
      "ThreatBulkUpdateItem": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ThreatBase"
          },
          {
            "type": "object",
            "description": "Threat update item with required ID for bulk operations",
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid",
                "description": "Unique identifier of the threat to update (required for bulk updates)",
                "maxLength": 36,
                "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
              }
            },
            "required": [
              "id"
            ]
          }
        ],
        "description": "Threat data for bulk update operations, including required ID field",
        "example": {
          "id": "750e8400-e29b-41d4-a716-446655440001",
          "name": "Updated SQL Injection Attack",
          "threat_type": [
            "tampering"
          ],
          "severity": "High",
          "status": "Mitigated"
        }
      },
      "BulkPatchRequest": {
        "type": "object",
        "description": "Request body for bulk patching multiple threats",
        "properties": {
          "patches": {
            "type": "array",
            "description": "Array of patch operations, each targeting a specific threat by ID",
            "items": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "string",
                  "format": "uuid",
                  "description": "ID of the threat to patch",
                  "maxLength": 36,
                  "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
                },
                "operations": {
                  "$ref": "#/components/schemas/JsonPatchDocument"
                }
              },
              "required": [
                "id",
                "operations"
              ],
              "additionalProperties": false
            },
            "minItems": 1,
            "maxItems": 20
          }
        },
        "required": [
          "patches"
        ],
        "additionalProperties": false,
        "example": {
          "patches": [
            {
              "id": "750e8400-e29b-41d4-a716-446655440001",
              "operations": [
                {
                  "op": "replace",
                  "path": "/status",
                  "value": "Closed"
                },
                {
                  "op": "replace",
                  "path": "/severity",
                  "value": "Low"
                }
              ]
            },
            {
              "id": "750e8400-e29b-41d4-a716-446655440002",
              "operations": [
                {
                  "op": "replace",
                  "path": "/status",
                  "value": "Mitigated"
                }
              ]
            }
          ]
        }
      },
      "ListThreatModelsResponse": {
        "type": "object",
        "description": "Paginated list of threat models",
        "required": [
          "threat_models",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "threat_models": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TMListItem"
            },
            "maxItems": 1000,
            "example": [
              {
                "id": "660e8400-e29b-41d4-a716-446655440001",
                "name": "Payment Gateway Threat Model",
                "owner": {
                  "principal_type": "user",
                  "provider": "github",
                  "provider_id": "alice@example.com",
                  "display_name": "Alice Johnson",
                  "email": "alice@example.com"
                },
                "created_by": {
                  "principal_type": "user",
                  "provider": "github",
                  "provider_id": "alice@example.com",
                  "display_name": "Alice Johnson",
                  "email": "alice@example.com"
                },
                "threat_model_framework": "STRIDE",
                "created_at": "2024-01-15T10:30:00Z",
                "modified_at": "2024-01-20T15:45:30Z",
                "document_count": 3,
                "repo_count": 2,
                "diagram_count": 1,
                "threat_count": 5,
                "asset_count": 4,
                "note_count": 2
              }
            ]
          },
          "total": {
            "type": "integer",
            "description": "Total number of threat models matching criteria",
            "example": 42
          },
          "limit": {
            "type": "integer",
            "description": "Pagination limit",
            "example": 20
          },
          "offset": {
            "type": "integer",
            "description": "Pagination offset",
            "example": 0
          }
        }
      },
      "ListThreatsResponse": {
        "type": "object",
        "description": "Paginated list of threats",
        "required": [
          "threats",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "threats": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Threat"
            },
            "maxItems": 1000,
            "example": [
              {
                "id": "345e6789-e89b-41d4-a716-446655440002",
                "threat_model_id": "123e4567-e89b-41d4-a716-446655440000",
                "name": "SQL Injection in Payment Query",
                "description": "Unsanitized input in payment lookup query could allow SQL injection",
                "severity": "High",
                "stride_category": "Tampering",
                "status": "Open",
                "threat_type": [
                  "spoofing"
                ],
                "created_at": "2024-01-16T09:00:00Z",
                "modified_at": "2024-01-16T09:00:00Z"
              }
            ]
          },
          "total": {
            "type": "integer",
            "description": "Total number of threats matching criteria",
            "example": 15
          },
          "limit": {
            "type": "integer",
            "description": "Pagination limit",
            "example": 20
          },
          "offset": {
            "type": "integer",
            "description": "Pagination offset",
            "example": 0
          }
        }
      },
      "ListDiagramsResponse": {
        "type": "object",
        "description": "Paginated list of diagrams",
        "required": [
          "diagrams",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "diagrams": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DiagramListItem"
            },
            "maxItems": 1000,
            "example": [
              {
                "id": "880e8400-e29b-41d4-a716-446655440003",
                "name": "Payment Flow Data Flow Diagram",
                "type": "DFD-1.0.0",
                "created_at": "2025-01-15T10:30:00Z",
                "modified_at": "2025-01-15T14:22:00Z"
              }
            ]
          },
          "total": {
            "type": "integer",
            "description": "Total number of diagrams matching criteria",
            "example": 5
          },
          "limit": {
            "type": "integer",
            "description": "Pagination limit",
            "example": 20
          },
          "offset": {
            "type": "integer",
            "description": "Pagination offset",
            "example": 0
          }
        }
      },
      "ListDocumentsResponse": {
        "type": "object",
        "description": "Paginated list of documents",
        "required": [
          "documents",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "documents": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Document"
            },
            "maxItems": 1000,
            "example": [
              {
                "id": "567e89ab-e89b-41d4-a716-446655440004",
                "threat_model_id": "123e4567-e89b-41d4-a716-446655440000",
                "name": "Security Architecture Review",
                "description": "Q1 2024 security review findings",
                "uri": "https://example.com/docs/security-policy.pdf",
                "format": "markdown",
                "created_at": "2024-01-17T14:00:00Z",
                "modified_at": "2024-01-17T14:00:00Z"
              }
            ]
          },
          "total": {
            "type": "integer",
            "description": "Total number of documents matching criteria",
            "example": 8
          },
          "limit": {
            "type": "integer",
            "description": "Pagination limit",
            "example": 20
          },
          "offset": {
            "type": "integer",
            "description": "Pagination offset",
            "example": 0
          }
        }
      },
      "ListNotesResponse": {
        "type": "object",
        "description": "Paginated list of notes",
        "required": [
          "notes",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "notes": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/NoteListItem"
            },
            "maxItems": 1000,
            "example": [
              {
                "id": "ff0e8400-e29b-41d4-a716-44665544000a",
                "name": "Security Review Notes",
                "created_at": "2024-01-17T14:30:00Z",
                "modified_at": "2024-01-17T15:00:00Z"
              }
            ]
          },
          "total": {
            "type": "integer",
            "description": "Total number of notes matching criteria",
            "example": 12
          },
          "limit": {
            "type": "integer",
            "description": "Pagination limit",
            "example": 20
          },
          "offset": {
            "type": "integer",
            "description": "Pagination offset",
            "example": 0
          }
        }
      },
      "ListAssetsResponse": {
        "type": "object",
        "description": "Paginated list of assets",
        "required": [
          "assets",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "assets": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Asset"
            },
            "maxItems": 1000,
            "example": [
              {
                "id": "b50e8400-e29b-41d4-a716-446655440001",
                "name": "Payment Database",
                "type": "data",
                "description": "PostgreSQL database storing customer payment information",
                "criticality": "high",
                "created_at": "2024-01-15T10:30:00Z",
                "modified_at": "2024-01-20T15:45:30Z"
              }
            ]
          },
          "total": {
            "type": "integer",
            "description": "Total number of assets matching criteria",
            "example": 10
          },
          "limit": {
            "type": "integer",
            "description": "Pagination limit",
            "example": 20
          },
          "offset": {
            "type": "integer",
            "description": "Pagination offset",
            "example": 0
          }
        }
      },
      "ListRepositoriesResponse": {
        "type": "object",
        "description": "Paginated list of repositories",
        "required": [
          "repositories",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "repositories": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Repository"
            },
            "maxItems": 1000,
            "example": [
              {
                "id": "789eabcd-e89b-41d4-a716-446655440006",
                "threat_model_id": "123e4567-e89b-41d4-a716-446655440000",
                "name": "payment-service",
                "description": "Main payment processing microservice",
                "url": "https://github.com/example/payment-service",
                "repo_type": "github",
                "uri": "https://github.com/example/repo",
                "created_at": "2024-01-15T10:00:00Z",
                "modified_at": "2024-01-15T10:00:00Z"
              }
            ]
          },
          "total": {
            "type": "integer",
            "description": "Total number of repositories matching criteria",
            "example": 3
          },
          "limit": {
            "type": "integer",
            "description": "Pagination limit",
            "example": 20
          },
          "offset": {
            "type": "integer",
            "description": "Pagination offset",
            "example": 0
          }
        }
      },
      "ListWebhookSubscriptionsResponse": {
        "type": "object",
        "description": "Paginated list of webhook subscriptions",
        "required": [
          "subscriptions",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "subscriptions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/WebhookSubscription"
            },
            "maxItems": 1000,
            "example": [
              {
                "id": "550e8400-e29b-41d4-a716-446655440000",
                "owner_id": "550e8400-e29b-41d4-a716-446655440020",
                "name": "Production Slack Notifications",
                "url": "https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXX",
                "events": [
                  "diagram.updated",
                  "threat_model.created"
                ],
                "status": "active",
                "created_at": "2024-01-15T10:30:00Z",
                "modified_at": "2024-01-15T10:30:00Z"
              }
            ]
          },
          "total": {
            "type": "integer",
            "description": "Total number of subscriptions matching criteria",
            "example": 6
          },
          "limit": {
            "type": "integer",
            "description": "Pagination limit",
            "example": 20
          },
          "offset": {
            "type": "integer",
            "description": "Pagination offset",
            "example": 0
          }
        }
      },
      "ListWebhookDeliveriesResponse": {
        "type": "object",
        "description": "Paginated list of webhook deliveries",
        "required": [
          "deliveries",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "deliveries": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/WebhookDelivery"
            },
            "maxItems": 1000,
            "example": [
              {
                "id": "aa0e8400-e29b-41d4-a716-446655440005",
                "subscription_id": "550e8400-e29b-41d4-a716-446655440000",
                "event_type": "diagram.updated",
                "status": "delivered",
                "attempts": 1,
                "created_at": "2024-01-20T15:45:30Z",
                "delivered_at": "2024-01-20T15:45:31Z"
              }
            ]
          },
          "total": {
            "type": "integer",
            "description": "Total number of deliveries matching criteria",
            "example": 100
          },
          "limit": {
            "type": "integer",
            "description": "Pagination limit",
            "example": 20
          },
          "offset": {
            "type": "integer",
            "description": "Pagination offset",
            "example": 0
          }
        }
      },
      "ListUserQuotasResponse": {
        "type": "object",
        "description": "Paginated list of user API quotas",
        "required": [
          "quotas",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "quotas": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/UserAPIQuota"
            },
            "maxItems": 1000,
            "example": [
              {
                "user_id": "550e8400-e29b-41d4-a716-446655440000",
                "max_requests_per_minute": 60,
                "created_at": "2024-01-01T00:00:00Z",
                "modified_at": "2024-01-01T00:00:00Z"
              }
            ]
          },
          "total": {
            "type": "integer",
            "description": "Total number of quotas matching criteria",
            "example": 25
          },
          "limit": {
            "type": "integer",
            "description": "Pagination limit",
            "example": 20
          },
          "offset": {
            "type": "integer",
            "description": "Pagination offset",
            "example": 0
          }
        }
      },
      "ListWebhookQuotasResponse": {
        "type": "object",
        "description": "Paginated list of webhook quotas",
        "required": [
          "quotas",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "quotas": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/WebhookQuota"
            },
            "maxItems": 1000,
            "example": [
              {
                "owner_id": "550e8400-e29b-41d4-a716-446655440000",
                "max_subscriptions": 20,
                "max_events_per_minute": 100,
                "max_subscription_requests_per_minute": 10,
                "max_subscription_requests_per_day": 1000,
                "created_at": "2024-01-01T00:00:00Z",
                "modified_at": "2024-01-01T00:00:00Z"
              }
            ]
          },
          "total": {
            "type": "integer",
            "description": "Total number of quotas matching criteria",
            "example": 15
          },
          "limit": {
            "type": "integer",
            "description": "Pagination limit",
            "example": 20
          },
          "offset": {
            "type": "integer",
            "description": "Pagination offset",
            "example": 0
          }
        }
      },
      "ListAddonQuotasResponse": {
        "type": "object",
        "description": "Paginated list of addon quotas",
        "required": [
          "quotas",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "quotas": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AddonInvocationQuota"
            },
            "maxItems": 1000,
            "example": [
              {
                "owner_id": "550e8400-e29b-41d4-a716-446655440000",
                "max_active_invocations": 10,
                "max_invocations_per_hour": 100,
                "created_at": "2024-01-01T00:00:00Z",
                "modified_at": "2024-01-01T00:00:00Z"
              }
            ]
          },
          "total": {
            "type": "integer",
            "description": "Total number of quotas matching criteria",
            "example": 8
          },
          "limit": {
            "type": "integer",
            "description": "Pagination limit",
            "example": 20
          },
          "offset": {
            "type": "integer",
            "description": "Pagination offset",
            "example": 0
          }
        }
      },
      "ListClientCredentialsResponse": {
        "type": "object",
        "description": "Paginated list of client credentials",
        "required": [
          "credentials",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "credentials": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ClientCredentialInfo"
            },
            "maxItems": 1000,
            "example": [
              {
                "id": "970eabcd-e89b-41d4-a716-446655440016",
                "owner_id": "550e8400-e29b-41d4-a716-446655440000",
                "name": "Monitoring Service",
                "description": "Metrics collection service",
                "client_id": "tmi_cc_monitoring123",
                "is_active": true,
                "created_at": "2024-01-15T10:00:00Z",
                "modified_at": "2024-01-15T10:00:00Z"
              }
            ]
          },
          "total": {
            "type": "integer",
            "description": "Total number of credentials matching criteria",
            "example": 4
          },
          "limit": {
            "type": "integer",
            "description": "Pagination limit",
            "example": 20
          },
          "offset": {
            "type": "integer",
            "description": "Pagination offset",
            "example": 0
          }
        }
      },
      "SurveyResponseBase": {
        "type": "object",
        "description": "Base schema for SurveyResponse with client-writable fields",
        "required": [
          "survey_id"
        ],
        "properties": {
          "answers": {
            "type": "object",
            "description": "Question answers keyed by question name. Values can be any JSON type to support all SurveyJS question types including dynamic panels (arrays of objects), matrix questions (objects of objects), and scalar values (strings, numbers, booleans).",
            "additionalProperties": true
          },
          "linked_threat_model_id": {
            "type": "string",
            "format": "uuid",
            "description": "Optional link to existing threat model for re-reviews",
            "maxLength": 36,
            "nullable": true
          },
          "authorization": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Authorization"
            },
            "description": "List of users and groups with access to this response",
            "maxItems": 1000
          },
          "ui_state": {
            "type": "object",
            "description": "Client-managed UI state for draft resumption (e.g., current page, scroll position). Cleared on submission.",
            "nullable": true,
            "additionalProperties": true
          },
          "survey_id": {
            "type": "string",
            "format": "uuid",
            "description": "ID of the survey this response is based on",
            "maxLength": 36,
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          },
          "survey_version": {
            "description": "Survey version captured at creation time - responses always complete on the original version",
            "type": "string",
            "maxLength": 64,
            "readOnly": true
          },
          "project_id": {
            "type": "string",
            "format": "uuid",
            "maxLength": 36,
            "nullable": true,
            "description": "Optional reference to the project this survey response belongs to",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          }
        },
        "example": {
          "survey_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
          "answers": {
            "project_name": "My New Service",
            "data_classification": "confidential"
          },
          "authorization": [
            {
              "principal_type": "user",
              "provider": "google",
              "provider_id": "alice@example.com",
              "role": "writer"
            }
          ]
        }
      },
      "SurveyResponseCreateRequest": {
        "allOf": [
          {
            "$ref": "#/components/schemas/SurveyResponseBase"
          },
          {
            "type": "object",
            "description": "Request to create a new survey response",
            "properties": {
              "is_confidential": {
                "type": "boolean",
                "description": "If true, Security Reviewers group is NOT auto-added. Can only be set at creation.",
                "default": false
              }
            }
          }
        ],
        "example": {
          "survey_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
          "answers": {
            "project_name": "My New Service"
          },
          "authorization": [
            {
              "principal_type": "user",
              "provider": "google",
              "provider_id": "alice@example.com",
              "role": "writer"
            }
          ],
          "is_confidential": false
        },
        "description": "Request to create a new survey response, combining base fields with creation-specific options"
      },
      "SurveyResponse": {
        "allOf": [
          {
            "$ref": "#/components/schemas/SurveyResponseBase"
          },
          {
            "type": "object",
            "description": "Complete SurveyResponse with server-generated fields",
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid",
                "description": "Unique identifier for the response (UUID)",
                "maxLength": 36,
                "readOnly": true,
                "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
              },
              "status": {
                "type": "string",
                "maxLength": 256,
                "pattern": "^[^\\x00-\\x1F]*$",
                "description": "Current status of the survey response in the triage workflow"
              },
              "is_confidential": {
                "type": "boolean",
                "description": "Whether Security Reviewers group was excluded (set at creation, read-only after)",
                "readOnly": true
              },
              "revision_notes": {
                "type": "string",
                "description": "Notes from security reviewer when returning for revision",
                "maxLength": 4096,
                "nullable": true,
                "readOnly": true
              },
              "created_threat_model_id": {
                "type": "string",
                "format": "uuid",
                "description": "ID of threat model created from this response",
                "maxLength": 36,
                "nullable": true,
                "readOnly": true
              },
              "owner": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/User"
                  }
                ],
                "description": "User who created the response",
                "nullable": true,
                "readOnly": true,
                "type": "object"
              },
              "created_at": {
                "type": "string",
                "format": "date-time",
                "description": "Creation timestamp (RFC3339)",
                "maxLength": 32,
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "modified_at": {
                "type": "string",
                "format": "date-time",
                "description": "Last modification timestamp (RFC3339)",
                "maxLength": 32,
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "submitted_at": {
                "type": "string",
                "format": "date-time",
                "description": "When the response was submitted for review",
                "maxLength": 32,
                "nullable": true,
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "reviewed_at": {
                "type": "string",
                "format": "date-time",
                "description": "When the response was last reviewed",
                "maxLength": 32,
                "nullable": true,
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "reviewed_by": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/User"
                  }
                ],
                "description": "Security engineer who last reviewed the response",
                "nullable": true,
                "readOnly": true,
                "type": "object"
              },
              "survey_json": {
                "type": "object",
                "description": "Snapshot of the survey survey_json at the time this response was created. Used to render historical responses against the correct survey version.",
                "readOnly": true,
                "additionalProperties": true
              },
              "metadata": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "description": "Optional metadata key-value pairs",
                "nullable": true,
                "maxItems": 100
              },
              "created_by": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/User"
                  }
                ],
                "description": "User who created the response",
                "nullable": true,
                "readOnly": true,
                "type": "object"
              }
            }
          }
        ],
        "description": "A survey response containing answers to survey questions"
      },
      "SurveyResponseListItem": {
        "type": "object",
        "description": "Summary of a survey response for list endpoints",
        "required": [
          "id",
          "survey_id",
          "status",
          "created_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the response (UUID)",
            "maxLength": 36,
            "readOnly": true,
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          },
          "status": {
            "type": "string",
            "maxLength": 256,
            "pattern": "^[^\\x00-\\x1F]*$",
            "description": "Current status of the survey response"
          },
          "is_confidential": {
            "type": "boolean",
            "description": "Whether this is a secret project (no auto Security Reviewers access)"
          },
          "owner": {
            "allOf": [
              {
                "$ref": "#/components/schemas/User"
              }
            ],
            "description": "User who created the response",
            "nullable": true,
            "type": "object"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp (RFC3339)",
            "maxLength": 32,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "submitted_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the response was submitted",
            "maxLength": 32,
            "nullable": true,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "modified_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last modification timestamp (RFC3339)",
            "maxLength": 32,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "survey_id": {
            "type": "string",
            "format": "uuid",
            "description": "ID of the survey",
            "maxLength": 36
          },
          "survey_name": {
            "type": "string",
            "description": "Name of the survey",
            "maxLength": 256
          },
          "survey_version": {
            "type": "string",
            "description": "Version of the survey",
            "maxLength": 64
          }
        },
        "additionalProperties": false,
        "example": {
          "id": "b2c3d4e5-f6a7-8901-bcde-f12345678901",
          "survey_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
          "survey_name": "Security Review Intake",
          "survey_version": "2024-Q1",
          "status": "submitted",
          "is_confidential": false,
          "owner": {
            "principal_type": "user",
            "provider": "google",
            "provider_id": "109876543210987654321",
            "display_name": "Alice Developer",
            "email": "alice@example.com"
          },
          "created_at": "2024-02-15T09:00:00Z",
          "submitted_at": "2024-02-15T10:30:00Z",
          "modified_at": "2024-02-15T10:30:00Z"
        }
      },
      "ListSurveyResponsesResponse": {
        "type": "object",
        "description": "Paginated list of survey responses",
        "required": [
          "survey_responses",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "survey_responses": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SurveyResponseListItem"
            },
            "maxItems": 1000,
            "example": [
              {
                "id": "b2c3d4e5-f6a7-8901-bcde-f12345678901",
                "survey_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                "survey_name": "Security Review Intake",
                "survey_version": "2024-Q1",
                "status": "submitted",
                "is_confidential": false,
                "owner": {
                  "principal_type": "user",
                  "provider": "google",
                  "provider_id": "109876543210987654321",
                  "display_name": "Alice Developer",
                  "email": "alice@example.com"
                },
                "created_at": "2024-02-15T09:00:00Z",
                "submitted_at": "2024-02-15T10:30:00Z",
                "modified_at": "2024-02-15T10:30:00Z"
              }
            ]
          },
          "total": {
            "type": "integer",
            "description": "Total number of responses matching criteria",
            "example": 42
          },
          "limit": {
            "type": "integer",
            "description": "Pagination limit",
            "example": 20
          },
          "offset": {
            "type": "integer",
            "description": "Pagination offset",
            "example": 0
          }
        }
      },
      "CreateThreatModelFromSurveyResponse": {
        "type": "object",
        "description": "Response after creating a threat model from a survey response",
        "required": [
          "threat_model_id",
          "survey_response_id"
        ],
        "properties": {
          "threat_model_id": {
            "type": "string",
            "format": "uuid",
            "description": "ID of the newly created threat model",
            "maxLength": 36
          },
          "survey_response_id": {
            "type": "string",
            "format": "uuid",
            "description": "ID of the source survey response",
            "maxLength": 36
          }
        },
        "example": {
          "threat_model_id": "c3d4e5f6-a7b8-9012-cdef-123456789012",
          "survey_response_id": "b2c3d4e5-f6a7-8901-bcde-f12345678901"
        }
      },
      "SurveyBase": {
        "type": "object",
        "description": "Base schema for Survey with client-writable fields",
        "required": [
          "name",
          "version",
          "survey_json"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the survey",
            "minLength": 1,
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          },
          "description": {
            "type": "string",
            "description": "Description of the survey and its purpose",
            "maxLength": 1024,
            "pattern": "^[^<>\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]*$"
          },
          "version": {
            "type": "string",
            "description": "Custom version string (e.g., '2024-Q1', 'v2-pilot')",
            "minLength": 1,
            "maxLength": 64,
            "pattern": "^[a-zA-Z0-9._-]+$",
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          },
          "status": {
            "type": "string",
            "maxLength": 128,
            "pattern": "^[^\\x00-\\x1F]*$",
            "description": "Survey status: active surveys appear in intake, inactive are hidden but editable, archived are read-only and preserved for historical reference"
          },
          "settings": {
            "$ref": "#/components/schemas/SurveySettings"
          },
          "survey_json": {
            "type": "object",
            "description": "Complete SurveyJS JSON definition. Opaque to the server; validated only for top-level structure (must contain a pages array).",
            "additionalProperties": true,
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          }
        },
        "example": {
          "name": "Security Review Intake",
          "description": "Standard security review intake questionnaire for new projects",
          "version": "2024-Q1",
          "status": "active",
          "settings": {
            "allow_threat_model_linking": true
          },
          "survey_json": {
            "pages": [
              {
                "name": "project_info",
                "elements": [
                  {
                    "type": "text",
                    "name": "project_name",
                    "title": "Project Name"
                  }
                ]
              }
            ]
          }
        }
      },
      "SurveySettings": {
        "type": "object",
        "description": "Configuration settings for a survey",
        "properties": {
          "allow_threat_model_linking": {
            "type": "boolean",
            "description": "Whether responses can link to existing threat models for re-reviews",
            "default": true
          }
        },
        "additionalProperties": false,
        "example": {
          "allow_threat_model_linking": true
        }
      },
      "SurveyListItem": {
        "type": "object",
        "description": "Summary of a survey for list responses",
        "required": [
          "id",
          "name",
          "version",
          "status",
          "created_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the survey (UUID)",
            "maxLength": 36,
            "readOnly": true,
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          },
          "name": {
            "type": "string",
            "description": "Name of the survey",
            "maxLength": 256
          },
          "description": {
            "type": "string",
            "description": "Description of the survey",
            "maxLength": 1024
          },
          "version": {
            "type": "string",
            "description": "Version string",
            "maxLength": 64
          },
          "status": {
            "type": "string",
            "maxLength": 128,
            "pattern": "^[^\\x00-\\x1F]*$",
            "description": "Survey status"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp (RFC3339)",
            "maxLength": 32,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "modified_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last modification timestamp (RFC3339)",
            "maxLength": 32,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "created_by": {
            "allOf": [
              {
                "$ref": "#/components/schemas/User"
              }
            ],
            "description": "Administrator who created the survey"
          }
        },
        "additionalProperties": false,
        "example": {
          "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
          "name": "Security Review Intake",
          "description": "Standard security review intake questionnaire",
          "version": "2024-Q1",
          "status": "active",
          "created_at": "2024-01-15T10:30:00Z",
          "modified_at": "2024-02-01T14:00:00Z",
          "created_by": {
            "principal_type": "user",
            "provider": "google",
            "provider_id": "118234567890123456789",
            "display_name": "Admin User",
            "email": "admin@example.com"
          }
        }
      },
      "Survey": {
        "allOf": [
          {
            "$ref": "#/components/schemas/SurveyBase"
          },
          {
            "type": "object",
            "description": "Complete Survey with server-generated fields",
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid",
                "description": "Unique identifier for the survey (UUID)",
                "maxLength": 36,
                "readOnly": true,
                "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
              },
              "created_at": {
                "type": "string",
                "format": "date-time",
                "description": "Creation timestamp (RFC3339)",
                "maxLength": 32,
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "modified_at": {
                "type": "string",
                "format": "date-time",
                "description": "Last modification timestamp (RFC3339)",
                "maxLength": 32,
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "created_by": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/User"
                  }
                ],
                "description": "Administrator who created the survey",
                "readOnly": true
              },
              "metadata": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "description": "Optional metadata key-value pairs",
                "nullable": true,
                "maxItems": 100
              }
            }
          }
        ],
        "description": "A survey defining questions for security review intake"
      },
      "ListSurveysResponse": {
        "type": "object",
        "description": "Paginated list of surveys",
        "required": [
          "surveys",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "total": {
            "type": "integer",
            "description": "Total number of surveys matching criteria",
            "example": 5
          },
          "limit": {
            "type": "integer",
            "description": "Pagination limit",
            "example": 20
          },
          "offset": {
            "type": "integer",
            "description": "Pagination offset",
            "example": 0
          },
          "surveys": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SurveyListItem"
            },
            "maxItems": 1000,
            "example": [
              {
                "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                "name": "Security Review Intake",
                "description": "Standard security review intake questionnaire",
                "version": "2024-Q1",
                "status": "active",
                "created_at": "2024-01-15T10:30:00Z",
                "modified_at": "2024-02-01T14:00:00Z",
                "created_by": {
                  "principal_type": "user",
                  "provider": "google",
                  "provider_id": "118234567890123456789",
                  "display_name": "Admin User",
                  "email": "admin@example.com"
                }
              }
            ]
          }
        }
      },
      "SurveyInput": {
        "allOf": [
          {
            "$ref": "#/components/schemas/SurveyBase"
          }
        ],
        "description": "Input schema for creating or updating Survey",
        "example": {
          "name": "Security Review Intake",
          "description": "Standard security review intake questionnaire for new projects",
          "version": "2024-Q1",
          "status": "active",
          "settings": {
            "allow_threat_model_linking": true
          },
          "survey_json": {
            "pages": [
              {
                "name": "project_info",
                "elements": [
                  {
                    "type": "text",
                    "name": "project_name",
                    "title": "Project Name"
                  }
                ]
              }
            ]
          }
        }
      },
      "SurveyResponseInput": {
        "allOf": [
          {
            "$ref": "#/components/schemas/SurveyResponseBase"
          }
        ],
        "description": "Input schema for updating a SurveyResponse",
        "example": {
          "survey_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
          "answers": {
            "project_name": "My New Service",
            "data_classification": "confidential"
          },
          "authorization": [
            {
              "principal_type": "user",
              "provider": "google",
              "provider_id": "alice@example.com",
              "role": "writer"
            }
          ]
        }
      },
      "UserGroupMembership": {
        "type": "object",
        "description": "TMI-managed group that a user belongs to",
        "required": [
          "internal_uuid",
          "group_name"
        ],
        "properties": {
          "internal_uuid": {
            "type": "string",
            "format": "uuid",
            "description": "Group internal UUID"
          },
          "group_name": {
            "type": "string",
            "description": "Group name (e.g. administrators, security-reviewers)"
          },
          "name": {
            "type": "string",
            "description": "Display name for the group"
          }
        }
      },
      "TriageNoteBase": {
        "type": "object",
        "description": "Base fields for TriageNote (user-writable only)",
        "required": [
          "name",
          "content"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Triage note name",
            "minLength": 1,
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          },
          "content": {
            "type": "string",
            "description": "Triage note content in markdown format",
            "minLength": 1,
            "maxLength": 32768,
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            },
            "pattern": "^[^\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]*$"
          }
        },
        "example": {
          "name": "Initial Triage Assessment",
          "content": "Reviewed survey response. Key observations:\n- Data classification is confidential\n- Requires security architecture review"
        }
      },
      "TriageNote": {
        "description": "Complete TriageNote schema with server-generated fields",
        "allOf": [
          {
            "$ref": "#/components/schemas/TriageNoteBase"
          },
          {
            "type": "object",
            "required": [
              "id"
            ],
            "properties": {
              "id": {
                "type": "integer",
                "description": "Sequential identifier for the triage note within its survey response",
                "readOnly": true,
                "minimum": 1
              },
              "created_at": {
                "type": "string",
                "format": "date-time",
                "maxLength": 32,
                "description": "Creation timestamp (RFC3339)",
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "created_by": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/User"
                  }
                ],
                "description": "User who created this triage note",
                "readOnly": true,
                "nullable": true,
                "type": "object"
              },
              "modified_at": {
                "type": "string",
                "format": "date-time",
                "maxLength": 32,
                "description": "Last modification timestamp (RFC3339)",
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "modified_by": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/User"
                  }
                ],
                "description": "User who last modified this triage note",
                "readOnly": true,
                "nullable": true,
                "type": "object"
              }
            }
          }
        ]
      },
      "TriageNoteInput": {
        "description": "Input schema for creating a TriageNote",
        "allOf": [
          {
            "$ref": "#/components/schemas/TriageNoteBase"
          }
        ],
        "example": {
          "name": "Initial Triage Assessment",
          "content": "Reviewed survey response. Key observations:\n- Data classification is confidential\n- Requires security architecture review"
        }
      },
      "TriageNoteListItem": {
        "type": "object",
        "description": "Summary information for TriageNote in list responses",
        "required": [
          "name",
          "id"
        ],
        "properties": {
          "id": {
            "type": "integer",
            "description": "Sequential identifier for the triage note within its survey response",
            "readOnly": true,
            "minimum": 1
          },
          "name": {
            "type": "string",
            "description": "Triage note name",
            "minLength": 1,
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "maxLength": 32,
            "description": "Creation timestamp (RFC3339)",
            "readOnly": true,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "created_by": {
            "allOf": [
              {
                "$ref": "#/components/schemas/User"
              }
            ],
            "description": "User who created this triage note",
            "readOnly": true,
            "nullable": true,
            "type": "object"
          }
        },
        "additionalProperties": false,
        "example": {
          "id": 1,
          "name": "Initial Triage Assessment",
          "created_at": "2026-02-08T14:30:00Z",
          "created_by": {
            "principal_type": "user",
            "provider": "google",
            "provider_id": "109876543210987654321",
            "display_name": "Security Reviewer",
            "email": "reviewer@example.com"
          }
        }
      },
      "ListTriageNotesResponse": {
        "type": "object",
        "description": "Paginated list of triage notes",
        "required": [
          "triage_notes",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "triage_notes": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TriageNoteListItem"
            },
            "maxItems": 1000,
            "example": [
              {
                "id": 1,
                "name": "Initial Triage Assessment",
                "created_at": "2026-02-08T14:30:00Z"
              }
            ]
          },
          "total": {
            "type": "integer",
            "description": "Total number of triage notes",
            "example": 3
          },
          "limit": {
            "type": "integer",
            "description": "Pagination limit",
            "example": 20
          },
          "offset": {
            "type": "integer",
            "description": "Pagination offset",
            "example": 0
          }
        }
      },
      "TransferOwnershipRequest": {
        "type": "object",
        "description": "Request to transfer ownership of all owned threat models and survey responses to another user",
        "required": [
          "target_user_id"
        ],
        "properties": {
          "target_user_id": {
            "type": "string",
            "format": "uuid",
            "description": "Internal UUID of the user to receive ownership",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          }
        },
        "additionalProperties": false,
        "example": {
          "target_user_id": "550e8400-e29b-41d4-a716-446655440000"
        }
      },
      "TransferOwnershipResult": {
        "type": "object",
        "description": "Result of an ownership transfer operation",
        "required": [
          "threat_models_transferred",
          "survey_responses_transferred"
        ],
        "properties": {
          "threat_models_transferred": {
            "type": "object",
            "description": "Threat models that were transferred",
            "required": [
              "count",
              "threat_model_ids"
            ],
            "properties": {
              "count": {
                "type": "integer",
                "minimum": 0,
                "description": "Number of threat models transferred"
              },
              "threat_model_ids": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                },
                "description": "IDs of the transferred threat models",
                "maxItems": 10000
              }
            },
            "additionalProperties": false
          },
          "survey_responses_transferred": {
            "type": "object",
            "description": "Survey responses that were transferred",
            "required": [
              "count",
              "survey_response_ids"
            ],
            "properties": {
              "count": {
                "type": "integer",
                "minimum": 0,
                "description": "Number of survey responses transferred"
              },
              "survey_response_ids": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                },
                "description": "IDs of the transferred survey responses",
                "maxItems": 10000
              }
            },
            "additionalProperties": false
          }
        },
        "additionalProperties": false,
        "example": {
          "threat_models_transferred": {
            "count": 3,
            "threat_model_ids": [
              "550e8400-e29b-41d4-a716-446655440001",
              "550e8400-e29b-41d4-a716-446655440002",
              "550e8400-e29b-41d4-a716-446655440003"
            ]
          },
          "survey_responses_transferred": {
            "count": 1,
            "survey_response_ids": [
              "660e8400-e29b-41d4-a716-446655440001"
            ]
          }
        }
      },
      "TeamMemberRole": {
        "type": "string",
        "enum": [
          "engineering_lead",
          "engineer",
          "product_manager",
          "business_leader",
          "security_specialist",
          "other"
        ],
        "description": "Role of a team member or responsible party"
      },
      "RelationshipType": {
        "type": "string",
        "enum": [
          "parent",
          "child",
          "dependency",
          "dependent",
          "supersedes",
          "superseded_by",
          "related",
          "other"
        ],
        "description": "Type of relationship between teams or projects"
      },
      "TeamMember": {
        "type": "object",
        "description": "A member of a team with their role",
        "required": [
          "user_id"
        ],
        "properties": {
          "user_id": {
            "type": "string",
            "format": "uuid",
            "maxLength": 36,
            "description": "UUID of the team member user",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          },
          "user": {
            "allOf": [
              {
                "$ref": "#/components/schemas/User"
              }
            ],
            "description": "Resolved user details (read-only, populated by server)",
            "readOnly": true,
            "nullable": true,
            "type": "object"
          },
          "role": {
            "$ref": "#/components/schemas/TeamMemberRole"
          },
          "custom_role": {
            "type": "string",
            "maxLength": 128,
            "pattern": "^[^\\x00-\\x1F]*$",
            "description": "Custom role description when role is 'other'"
          }
        },
        "additionalProperties": false
      },
      "ResponsibleParty": {
        "type": "object",
        "description": "A responsible party for a team or project with their role",
        "required": [
          "user_id"
        ],
        "properties": {
          "user_id": {
            "type": "string",
            "format": "uuid",
            "maxLength": 36,
            "description": "UUID of the responsible party user",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          },
          "user": {
            "allOf": [
              {
                "$ref": "#/components/schemas/User"
              }
            ],
            "description": "Resolved user details (read-only, populated by server)",
            "readOnly": true,
            "nullable": true,
            "type": "object"
          },
          "role": {
            "$ref": "#/components/schemas/TeamMemberRole"
          },
          "custom_role": {
            "type": "string",
            "maxLength": 128,
            "pattern": "^[^\\x00-\\x1F]*$",
            "description": "Custom role description when role is 'other'"
          }
        },
        "additionalProperties": false
      },
      "RelatedTeam": {
        "type": "object",
        "description": "A relationship entry linking to another team",
        "required": [
          "related_team_id",
          "relationship"
        ],
        "properties": {
          "related_team_id": {
            "type": "string",
            "format": "uuid",
            "maxLength": 36,
            "description": "UUID of the related team",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          },
          "relationship": {
            "$ref": "#/components/schemas/RelationshipType"
          },
          "custom_relationship": {
            "type": "string",
            "maxLength": 128,
            "pattern": "^[^\\x00-\\x1F]*$",
            "description": "Custom relationship description when relationship is 'other'"
          }
        },
        "additionalProperties": false
      },
      "RelatedProject": {
        "type": "object",
        "description": "A relationship entry linking to another project",
        "required": [
          "related_project_id",
          "relationship"
        ],
        "properties": {
          "related_project_id": {
            "type": "string",
            "format": "uuid",
            "maxLength": 36,
            "description": "UUID of the related project",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          },
          "relationship": {
            "$ref": "#/components/schemas/RelationshipType"
          },
          "custom_relationship": {
            "type": "string",
            "maxLength": 128,
            "pattern": "^[^\\x00-\\x1F]*$",
            "description": "Custom relationship description when relationship is 'other'"
          }
        },
        "additionalProperties": false
      },
      "TeamBase": {
        "type": "object",
        "description": "Client-writable fields for a team",
        "required": [
          "name"
        ],
        "properties": {
          "name": {
            "type": "string",
            "minLength": 1,
            "maxLength": 256,
            "pattern": "^[^\\x00-\\x1F]*$",
            "description": "Team name",
            "example": "Platform Engineering"
          },
          "description": {
            "type": "string",
            "maxLength": 1024,
            "pattern": "^[^\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]*$",
            "description": "Team description",
            "example": "Core platform infrastructure team"
          },
          "members": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TeamMember"
            },
            "maxItems": 1000,
            "description": "List of team members with their roles",
            "example": [
              {
                "user_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                "role": "engineering_lead"
              }
            ]
          },
          "responsible_parties": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ResponsibleParty"
            },
            "maxItems": 100,
            "description": "Responsible parties for this team (in lieu of owner)",
            "example": []
          },
          "related_teams": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RelatedTeam"
            },
            "maxItems": 100,
            "description": "Relationships to other teams",
            "example": []
          },
          "uri": {
            "type": "string",
            "format": "uri",
            "maxLength": 1000,
            "description": "URL or reference to internal team page",
            "example": "https://wiki.example.com/teams/platform-engineering"
          },
          "email_address": {
            "type": "string",
            "format": "email",
            "maxLength": 320,
            "description": "Team email address",
            "example": "platform-eng@example.com"
          },
          "status": {
            "type": "string",
            "maxLength": 128,
            "pattern": "^[^\\x00-\\x1F]*$",
            "description": "Team status (lifecycle, archival, deprecation, etc.)",
            "example": "active"
          }
        }
      },
      "Team": {
        "allOf": [
          {
            "$ref": "#/components/schemas/TeamBase"
          },
          {
            "type": "object",
            "description": "Complete Team with server-generated fields",
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid",
                "description": "Unique identifier for the team (UUID)",
                "maxLength": 36,
                "readOnly": true,
                "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
              },
              "created_by": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/User"
                  }
                ],
                "description": "User who created the team",
                "readOnly": true,
                "nullable": true,
                "type": "object"
              },
              "created_at": {
                "type": "string",
                "format": "date-time",
                "description": "Creation timestamp (RFC3339)",
                "maxLength": 32,
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "modified_by": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/User"
                  }
                ],
                "description": "User who last modified the team",
                "readOnly": true,
                "nullable": true,
                "type": "object"
              },
              "modified_at": {
                "type": "string",
                "format": "date-time",
                "description": "Last modification timestamp (RFC3339)",
                "maxLength": 32,
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "reviewed_by": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/User"
                  }
                ],
                "description": "User who last reviewed the team",
                "nullable": true,
                "type": "object"
              },
              "reviewed_at": {
                "type": "string",
                "format": "date-time",
                "description": "Last review timestamp (RFC3339)",
                "maxLength": 32,
                "nullable": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "metadata": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "description": "Optional metadata key-value pairs",
                "nullable": true,
                "maxItems": 100
              }
            }
          }
        ],
        "description": "A team representing an organizational unit"
      },
      "TeamListItem": {
        "type": "object",
        "description": "Summary of a team for list views",
        "required": [
          "id",
          "name",
          "created_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "maxLength": 36,
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          },
          "name": {
            "type": "string",
            "maxLength": 256
          },
          "description": {
            "type": "string",
            "maxLength": 1024,
            "nullable": true
          },
          "status": {
            "type": "string",
            "maxLength": 128,
            "nullable": true
          },
          "member_count": {
            "type": "integer",
            "description": "Number of team members"
          },
          "project_count": {
            "type": "integer",
            "description": "Number of projects associated with this team"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "maxLength": 32,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "modified_at": {
            "type": "string",
            "format": "date-time",
            "maxLength": 32,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          }
        },
        "additionalProperties": false
      },
      "TeamInput": {
        "$ref": "#/components/schemas/TeamBase"
      },
      "ListTeamsResponse": {
        "type": "object",
        "description": "Paginated list of teams",
        "required": [
          "teams",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "teams": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TeamListItem"
            },
            "maxItems": 1000,
            "example": [
              {
                "id": "550e8400-e29b-41d4-a716-446655440000",
                "name": "Platform Engineering",
                "description": "Core platform infrastructure team",
                "status": "active",
                "created_at": "2025-01-15T10:30:00Z",
                "modified_at": "2025-06-20T14:22:00Z"
              }
            ]
          },
          "total": {
            "type": "integer",
            "description": "Total number of teams matching the filter",
            "example": 1
          },
          "limit": {
            "type": "integer",
            "description": "Maximum number of results per page",
            "example": 20
          },
          "offset": {
            "type": "integer",
            "description": "Number of results skipped",
            "example": 0
          }
        },
        "additionalProperties": false
      },
      "ProjectBase": {
        "type": "object",
        "description": "Client-writable fields for a project",
        "required": [
          "name",
          "team_id"
        ],
        "properties": {
          "name": {
            "type": "string",
            "minLength": 1,
            "maxLength": 256,
            "pattern": "^[^\\x00-\\x1F]*$",
            "description": "Project name",
            "example": "API Gateway Modernization"
          },
          "description": {
            "type": "string",
            "maxLength": 1024,
            "pattern": "^[^\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]*$",
            "description": "Project description",
            "example": "Migrate legacy API gateway to cloud-native architecture"
          },
          "team_id": {
            "type": "string",
            "format": "uuid",
            "maxLength": 36,
            "description": "UUID of the team this project belongs to",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "responsible_parties": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ResponsibleParty"
            },
            "maxItems": 100,
            "description": "Responsible parties for this project",
            "example": []
          },
          "related_projects": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RelatedProject"
            },
            "maxItems": 100,
            "description": "Relationships to other projects",
            "example": []
          },
          "uri": {
            "type": "string",
            "format": "uri",
            "maxLength": 1000,
            "description": "URL or reference to internal project page",
            "example": "https://wiki.example.com/projects/api-gateway"
          },
          "status": {
            "type": "string",
            "maxLength": 128,
            "pattern": "^[^\\x00-\\x1F]*$",
            "description": "Project status (lifecycle, archival, deprecation, etc.)",
            "example": "active"
          }
        }
      },
      "Project": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ProjectBase"
          },
          {
            "type": "object",
            "description": "Complete Project with server-generated fields",
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid",
                "description": "Unique identifier for the project (UUID)",
                "maxLength": 36,
                "readOnly": true,
                "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
              },
              "team": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/Team"
                  }
                ],
                "description": "The team this project belongs to (resolved)",
                "readOnly": true,
                "nullable": true,
                "type": "object"
              },
              "created_by": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/User"
                  }
                ],
                "description": "User who created the project",
                "readOnly": true,
                "nullable": true,
                "type": "object"
              },
              "created_at": {
                "type": "string",
                "format": "date-time",
                "description": "Creation timestamp (RFC3339)",
                "maxLength": 32,
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "modified_by": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/User"
                  }
                ],
                "description": "User who last modified the project",
                "readOnly": true,
                "nullable": true,
                "type": "object"
              },
              "modified_at": {
                "type": "string",
                "format": "date-time",
                "description": "Last modification timestamp (RFC3339)",
                "maxLength": 32,
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "reviewed_by": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/User"
                  }
                ],
                "description": "User who last reviewed the project",
                "nullable": true,
                "type": "object"
              },
              "reviewed_at": {
                "type": "string",
                "format": "date-time",
                "description": "Last review timestamp (RFC3339)",
                "maxLength": 32,
                "nullable": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "metadata": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "description": "Optional metadata key-value pairs",
                "nullable": true,
                "maxItems": 100
              }
            }
          }
        ],
        "description": "A project representing a product, service, or application"
      },
      "ProjectListItem": {
        "type": "object",
        "description": "Summary of a project for list views",
        "required": [
          "id",
          "name",
          "team_id",
          "created_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "maxLength": 36,
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          },
          "name": {
            "type": "string",
            "maxLength": 256
          },
          "description": {
            "type": "string",
            "maxLength": 1024,
            "nullable": true
          },
          "status": {
            "type": "string",
            "maxLength": 128,
            "nullable": true
          },
          "team_id": {
            "type": "string",
            "format": "uuid",
            "maxLength": 36
          },
          "team_name": {
            "type": "string",
            "maxLength": 256,
            "description": "Name of the associated team"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "maxLength": 32,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "modified_at": {
            "type": "string",
            "format": "date-time",
            "maxLength": 32,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          }
        },
        "additionalProperties": false
      },
      "ProjectInput": {
        "$ref": "#/components/schemas/ProjectBase"
      },
      "ListProjectsResponse": {
        "type": "object",
        "description": "Paginated list of projects",
        "required": [
          "projects",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "projects": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProjectListItem"
            },
            "maxItems": 1000,
            "example": [
              {
                "id": "660e8400-e29b-41d4-a716-446655440001",
                "name": "API Gateway Modernization",
                "description": "Migrate legacy API gateway to cloud-native architecture",
                "team_id": "550e8400-e29b-41d4-a716-446655440000",
                "status": "active",
                "created_at": "2025-02-01T09:00:00Z",
                "modified_at": "2025-07-10T16:45:00Z"
              }
            ]
          },
          "total": {
            "type": "integer",
            "description": "Total number of projects matching the filter",
            "example": 1
          },
          "limit": {
            "type": "integer",
            "description": "Maximum number of results per page",
            "example": 20
          },
          "offset": {
            "type": "integer",
            "description": "Number of results skipped",
            "example": 0
          }
        },
        "additionalProperties": false
      },
      "MyGroupListResponse": {
        "type": "object",
        "description": "List of TMI-managed groups that the authenticated user belongs to",
        "required": [
          "groups",
          "total"
        ],
        "properties": {
          "groups": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/UserGroupMembership"
            },
            "description": "List of groups the user is a direct member of",
            "maxItems": 100
          },
          "total": {
            "type": "integer",
            "minimum": 0,
            "description": "Total number of groups"
          }
        },
        "example": {
          "groups": [
            {
              "internal_uuid": "e50eabcd-e89b-41d4-a716-446655440014",
              "group_name": "security-reviewers",
              "name": "Security Reviewers"
            }
          ],
          "total": 1
        }
      }
    },
    "responses": {
      "Error": {
        "description": "Error response",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            },
            "examples": {
              "authorizationError": {
                "summary": "Insufficient permissions for sub-resource access",
                "value": {
                  "error": "access_denied",
                  "error_description": "User does not have sufficient permissions to access this sub-resource",
                  "details": {
                    "code": "INSUFFICIENT_PERMISSIONS",
                    "context": {
                      "required_role": "writer",
                      "user_role": "reader",
                      "threat_model_id": "550e8400-e29b-41d4-a716-446655440000",
                      "resource_type": "threat"
                    },
                    "suggestion": "Request write access from the threat model owner"
                  }
                }
              },
              "notFoundError": {
                "summary": "Sub-resource not found",
                "value": {
                  "error": "not_found",
                  "error_description": "The requested sub-resource does not exist or does not belong to the specified threat model",
                  "details": {
                    "code": "RESOURCE_NOT_FOUND",
                    "context": {
                      "resource_id": "550e8400-e29b-41d4-a716-446655440999",
                      "resource_type": "document",
                      "threat_model_id": "550e8400-e29b-41d4-a716-446655440000"
                    },
                    "suggestion": "Verify the resource ID and threat model association"
                  }
                }
              },
              "validationError": {
                "summary": "Invalid input data",
                "value": {
                  "error": "invalid_input",
                  "error_description": "The provided data does not meet validation requirements",
                  "details": {
                    "code": "VALIDATION_FAILED",
                    "context": {
                      "field_errors": [
                        {
                          "field": "name",
                          "error": "must not be empty"
                        }
                      ]
                    },
                    "suggestion": "Correct the validation errors and retry the request"
                  }
                }
              }
            }
          }
        },
        "headers": {
          "X-RateLimit-Limit": {
            "description": "Maximum number of requests allowed in the current time window",
            "schema": {
              "type": "integer",
              "example": 1000
            }
          },
          "X-RateLimit-Remaining": {
            "description": "Number of requests remaining in the current time window",
            "schema": {
              "type": "integer",
              "example": 999
            }
          },
          "X-RateLimit-Reset": {
            "description": "Unix epoch seconds when the rate limit window resets",
            "schema": {
              "type": "integer",
              "example": 1640995200
            }
          }
        }
      },
      "TooManyRequests": {
        "description": "Too Many Requests - Rate limit exceeded. The client has sent too many requests in a given amount of time. See rate limit headers for details.",
        "headers": {
          "X-RateLimit-Limit": {
            "description": "Maximum number of requests allowed in the current time window",
            "schema": {
              "type": "integer",
              "example": 100
            }
          },
          "X-RateLimit-Remaining": {
            "description": "Number of requests remaining in the current time window",
            "schema": {
              "type": "integer",
              "example": 0
            }
          },
          "X-RateLimit-Reset": {
            "description": "Unix timestamp (seconds since epoch) when the rate limit window resets",
            "schema": {
              "type": "integer",
              "example": 1640000000
            }
          },
          "Retry-After": {
            "description": "Number of seconds to wait before retrying the request",
            "schema": {
              "type": "integer",
              "example": 60
            }
          }
        },
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            },
            "example": {
              "error": "rate_limit_exceeded",
              "error_description": "Rate limit exceeded: 100 requests per minute. Retry after 45 seconds.",
              "details": {
                "code": "RATE_LIMIT_EXCEEDED",
                "context": {
                  "limit": 100,
                  "window": "minute",
                  "retry_after": 45
                }
              }
            }
          }
        }
      },
      "MethodNotAllowed": {
        "description": "Method Not Allowed - The HTTP method is not supported for this endpoint",
        "headers": {
          "Allow": {
            "description": "List of allowed HTTP methods for this endpoint",
            "schema": {
              "type": "string",
              "example": "GET, POST"
            }
          },
          "X-RateLimit-Limit": {
            "description": "Maximum number of requests allowed in the current time window",
            "schema": {
              "type": "integer",
              "example": 1000
            }
          },
          "X-RateLimit-Remaining": {
            "description": "Number of requests remaining in the current time window",
            "schema": {
              "type": "integer",
              "example": 999
            }
          },
          "X-RateLimit-Reset": {
            "description": "Unix epoch seconds when the rate limit window resets",
            "schema": {
              "type": "integer",
              "example": 1640995200
            }
          }
        },
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            },
            "example": {
              "error": "method_not_allowed",
              "error_description": "The HTTP method is not supported for this endpoint"
            }
          }
        }
      },
      "NotAcceptable": {
        "description": "Not Acceptable - The requested media type is not supported. This API only supports application/json",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            },
            "example": {
              "error": "not_acceptable",
              "error_description": "The requested Accept header media type is not supported. Supported types: application/json"
            }
          }
        },
        "headers": {
          "X-RateLimit-Limit": {
            "description": "Maximum number of requests allowed in the current time window",
            "schema": {
              "type": "integer",
              "example": 1000
            }
          },
          "X-RateLimit-Remaining": {
            "description": "Number of requests remaining in the current time window",
            "schema": {
              "type": "integer",
              "example": 999
            }
          },
          "X-RateLimit-Reset": {
            "description": "Unix epoch seconds when the rate limit window resets",
            "schema": {
              "type": "integer",
              "example": 1640995200
            }
          }
        }
      },
      "InternalServerError": {
        "description": "Internal server error",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "error": {
                  "type": "string",
                  "description": "Error message describing what went wrong",
                  "example": "internal_server_error"
                },
                "request_id": {
                  "type": "string",
                  "description": "Unique request identifier for troubleshooting",
                  "example": "req_abc123xyz789"
                }
              },
              "required": [
                "error"
              ]
            },
            "example": {
              "error": "An internal server error occurred",
              "request_id": "550e8400-e29b-41d4-a716-446655440000"
            }
          }
        },
        "headers": {
          "X-RateLimit-Limit": {
            "description": "Maximum number of requests allowed in the current time window",
            "schema": {
              "type": "integer",
              "example": 1000
            }
          },
          "X-RateLimit-Remaining": {
            "description": "Number of requests remaining in the current time window",
            "schema": {
              "type": "integer",
              "example": 999
            }
          },
          "X-RateLimit-Reset": {
            "description": "Unix epoch seconds when the rate limit window resets",
            "schema": {
              "type": "integer",
              "example": 1640995200
            }
          }
        }
      },
      "NotFound": {
        "description": "Resource not found",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            },
            "examples": {
              "notFoundError": {
                "summary": "Resource not found",
                "value": {
                  "error": "not_found",
                  "error_description": "The requested resource does not exist"
                }
              }
            }
          }
        },
        "headers": {
          "X-RateLimit-Limit": {
            "description": "Maximum number of requests allowed in the current time window",
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          "X-RateLimit-Remaining": {
            "description": "Number of requests remaining in the current time window",
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          "X-RateLimit-Reset": {
            "description": "Unix epoch seconds when the rate limit window resets",
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        }
      },
      "ServiceUnavailable": {
        "description": "Service Unavailable - A required backend service (authentication, database, or cache) is temporarily unavailable. The client should retry the request after the delay indicated in the Retry-After header.",
        "headers": {
          "Retry-After": {
            "description": "Number of seconds to wait before retrying the request",
            "schema": {
              "type": "integer",
              "example": 30
            }
          },
          "X-RateLimit-Limit": {
            "description": "Maximum number of requests allowed in the current time window",
            "schema": {
              "type": "integer",
              "example": 1000
            }
          },
          "X-RateLimit-Remaining": {
            "description": "Number of requests remaining in the current time window",
            "schema": {
              "type": "integer",
              "example": 999
            }
          },
          "X-RateLimit-Reset": {
            "description": "Unix epoch seconds when the rate limit window resets",
            "schema": {
              "type": "integer",
              "example": 1640995200
            }
          }
        },
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            },
            "examples": {
              "authServiceUnavailable": {
                "summary": "Authentication service unavailable",
                "value": {
                  "error": "service_unavailable",
                  "error_description": "Authentication service temporarily unavailable - please retry"
                }
              },
              "storageServiceUnavailable": {
                "summary": "Storage service unavailable",
                "value": {
                  "error": "service_unavailable",
                  "error_description": "Storage service temporarily unavailable - please retry"
                }
              },
              "cacheServiceUnavailable": {
                "summary": "Cache service unavailable",
                "value": {
                  "error": "service_unavailable",
                  "error_description": "Cache service temporarily unavailable - please retry"
                }
              }
            }
          }
        }
      }
    },
    "parameters": {
      "ThreatModelId": {
        "name": "threat_model_id",
        "in": "path",
        "required": true,
        "schema": {
          "type": "string",
          "format": "uuid"
        },
        "description": "Threat model identifier"
      },
      "DiagramId": {
        "name": "diagram_id",
        "in": "path",
        "required": true,
        "schema": {
          "type": "string",
          "format": "uuid"
        },
        "description": "Diagram identifier"
      },
      "ThreatId": {
        "name": "threat_id",
        "in": "path",
        "required": true,
        "schema": {
          "type": "string",
          "format": "uuid"
        },
        "description": "Threat identifier"
      },
      "AssetId": {
        "name": "asset_id",
        "in": "path",
        "required": true,
        "schema": {
          "type": "string",
          "format": "uuid"
        },
        "description": "Asset identifier"
      },
      "DocumentId": {
        "name": "document_id",
        "in": "path",
        "required": true,
        "schema": {
          "type": "string",
          "format": "uuid"
        },
        "description": "Document identifier"
      },
      "NoteId": {
        "name": "note_id",
        "in": "path",
        "required": true,
        "schema": {
          "type": "string",
          "format": "uuid"
        },
        "description": "Note identifier"
      },
      "RepositoryId": {
        "name": "repository_id",
        "in": "path",
        "required": true,
        "schema": {
          "type": "string",
          "format": "uuid"
        },
        "description": "Repository identifier"
      },
      "MetadataKey": {
        "name": "key",
        "in": "path",
        "required": true,
        "schema": {
          "type": "string",
          "maxLength": 255
        },
        "description": "Metadata key"
      },
      "GenericId": {
        "name": "id",
        "in": "path",
        "required": true,
        "schema": {
          "type": "string",
          "format": "uuid"
        },
        "description": "Resource identifier"
      },
      "WebhookId": {
        "name": "webhook_id",
        "in": "path",
        "required": true,
        "schema": {
          "type": "string",
          "format": "uuid"
        },
        "description": "Webhook subscription identifier"
      },
      "DeliveryId": {
        "name": "delivery_id",
        "in": "path",
        "required": true,
        "schema": {
          "type": "string",
          "format": "uuid"
        },
        "description": "Webhook delivery identifier"
      },
      "PaginationLimit": {
        "name": "limit",
        "in": "query",
        "required": false,
        "schema": {
          "type": "integer",
          "minimum": 1,
          "maximum": 100,
          "default": 20
        },
        "description": "Maximum number of results to return"
      },
      "PaginationOffset": {
        "name": "offset",
        "in": "query",
        "required": false,
        "schema": {
          "type": "integer",
          "minimum": 0,
          "default": 0,
          "maximum": 1000000000
        },
        "description": "Number of results to skip"
      },
      "CreatedAfter": {
        "name": "created_after",
        "in": "query",
        "required": false,
        "schema": {
          "type": "string",
          "format": "date-time"
        },
        "description": "Filter results created after this timestamp (ISO 8601)"
      },
      "CreatedBefore": {
        "name": "created_before",
        "in": "query",
        "required": false,
        "schema": {
          "type": "string",
          "format": "date-time"
        },
        "description": "Filter results created before this timestamp (ISO 8601)"
      },
      "ModifiedAfter": {
        "name": "modified_after",
        "in": "query",
        "required": false,
        "schema": {
          "type": "string",
          "format": "date-time"
        },
        "description": "Filter results modified after this timestamp (ISO 8601)"
      },
      "ModifiedBefore": {
        "name": "modified_before",
        "in": "query",
        "required": false,
        "schema": {
          "type": "string",
          "format": "date-time"
        },
        "description": "Filter results modified before this timestamp (ISO 8601)"
      },
      "IdpPathParam": {
        "name": "idp",
        "in": "path",
        "required": true,
        "description": "Identity provider ID (e.g., saml_okta, saml_azure)",
        "schema": {
          "type": "string",
          "pattern": "^[a-zA-Z][a-zA-Z0-9_-]*$",
          "maxLength": 100
        }
      },
      "IdpQueryParam": {
        "name": "idp",
        "in": "query",
        "required": false,
        "description": "OAuth provider identifier. Defaults to 'tmi' provider in non-production builds if not specified.",
        "schema": {
          "type": "string",
          "pattern": "^[a-zA-Z][a-zA-Z0-9_-]*$",
          "maxLength": 100
        }
      },
      "ClientCallbackQueryParam": {
        "name": "client_callback",
        "in": "query",
        "required": false,
        "description": "Client callback URL where TMI should redirect after successful OAuth completion with tokens in URL fragment (#access_token=...). If not provided, tokens are returned as JSON response. Per OAuth 2.0 implicit flow spec, tokens are in fragments to prevent logging.",
        "schema": {
          "type": "string",
          "format": "uri",
          "example": "http://localhost:4200/oauth2/callback",
          "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
          "maxLength": 1000
        }
      },
      "StateQueryParam": {
        "name": "state",
        "in": "query",
        "required": false,
        "description": "CSRF protection state parameter. Recommended for security. Will be included in the callback response.",
        "schema": {
          "type": "string",
          "example": "random_state_abc123",
          "pattern": "^[a-zA-Z0-9_~.+/=-]*$",
          "maxLength": 256
        }
      },
      "LoginHintQueryParam": {
        "name": "login_hint",
        "in": "query",
        "required": false,
        "description": "User identity hint for TMI OAuth provider. Allows specifying a desired user identity for testing and automation. Only supported by the TMI provider (ignored by production providers like Google, GitHub, etc.). Must be 3-20 characters, alphanumeric and hyphens only.",
        "schema": {
          "type": "string",
          "pattern": "^[a-zA-Z0-9-]{3,20}$",
          "example": "alice",
          "maxLength": 1000
        }
      },
      "ScopeQueryParam": {
        "name": "scope",
        "in": "query",
        "required": true,
        "description": "OAuth 2.0 scope parameter. For OpenID Connect, must include \"openid\". Supports \"profile\" and \"email\" scopes. Other scopes are silently ignored. Space-separated values.",
        "schema": {
          "type": "string",
          "example": "openid profile email",
          "pattern": "^[a-zA-Z0-9_][a-zA-Z0-9_ ]*[a-zA-Z0-9_]$",
          "maxLength": 256
        }
      },
      "CodeChallengeQueryParam": {
        "name": "code_challenge",
        "in": "query",
        "required": true,
        "description": "PKCE code challenge (RFC 7636) - Base64url-encoded SHA256 hash of the code_verifier. Must be 43-128 characters using unreserved characters [A-Za-z0-9-._~]. The server associates this with the authorization code for later verification during token exchange.",
        "schema": {
          "type": "string",
          "pattern": "^[A-Za-z0-9\\-._~]{43,128}$",
          "minLength": 43,
          "maxLength": 128,
          "example": "E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM"
        }
      },
      "CodeChallengeMethodQueryParam": {
        "name": "code_challenge_method",
        "in": "query",
        "required": true,
        "description": "PKCE code challenge method (RFC 7636) - Specifies the transformation applied to the code_verifier. Only \"S256\" (SHA256) is supported for security. The \"plain\" method is not supported.",
        "schema": {
          "type": "string",
          "enum": [
            "S256"
          ],
          "example": "S256"
        }
      },
      "CodeQueryParam": {
        "name": "code",
        "in": "query",
        "required": true,
        "schema": {
          "type": "string",
          "pattern": "^[a-zA-Z0-9_~.+/=-]*$",
          "maxLength": 512
        },
        "description": "Authorization code from the OAuth provider"
      },
      "OwnerQueryParam": {
        "name": "owner",
        "in": "query",
        "schema": {
          "type": "string",
          "maxLength": 256,
          "pattern": "^[^\\x00-\\x1F]*$"
        },
        "description": "Filter by owner name or email"
      },
      "NameQueryParam": {
        "name": "name",
        "in": "query",
        "schema": {
          "type": "string",
          "maxLength": 256,
          "pattern": "^[^\\x00-\\x1F]*$"
        },
        "description": "Filter by threat model name (partial match)"
      },
      "DescriptionQueryParam": {
        "name": "description",
        "in": "query",
        "schema": {
          "type": "string",
          "maxLength": 1000,
          "pattern": "^[^\\x00-\\x1F]*$"
        },
        "description": "Filter by threat model description (partial match)"
      },
      "IssueUriQueryParam": {
        "name": "issue_uri",
        "in": "query",
        "schema": {
          "type": "string",
          "maxLength": 1000,
          "pattern": "^[^\\x00-\\x1F]*$"
        },
        "description": "Filter by issue URI (partial match)"
      },
      "StatusQueryParam": {
        "name": "status",
        "in": "query",
        "schema": {
          "type": "string",
          "maxLength": 256,
          "pattern": "^[^\\x00-\\x1F]*$"
        },
        "description": "Filter by status value (exact match). To filter by multiple statuses, use multiple status parameters or comma-separated values."
      },
      "StatusUpdatedAfterQueryParam": {
        "name": "status_updated_after",
        "in": "query",
        "schema": {
          "type": "string",
          "format": "date-time",
          "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
          "maxLength": 64
        },
        "description": "Filter threat models where status was updated after this timestamp (RFC3339)"
      },
      "StatusUpdatedBeforeQueryParam": {
        "name": "status_updated_before",
        "in": "query",
        "schema": {
          "type": "string",
          "format": "date-time",
          "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
          "maxLength": 64
        },
        "description": "Filter threat models where status was updated before this timestamp (RFC3339)"
      },
      "SortQueryParam": {
        "name": "sort",
        "in": "query",
        "schema": {
          "type": "string",
          "default": "created_at:desc",
          "maxLength": 1000,
          "pattern": "^[^\\x00-\\x1F]*$"
        },
        "description": "Sort order (e.g., created_at:desc, name:asc, severity:desc, score:desc)"
      },
      "ThreatTypeQueryParam": {
        "name": "threat_type",
        "in": "query",
        "schema": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "maxItems": 50,
          "example": [
            "spoofing",
            "tampering"
          ]
        },
        "description": "Filter by threat types (AND logic). Threat must contain ALL specified types. Example: ?threat_type=Tampering&threat_type=Spoofing",
        "style": "form",
        "explode": true,
        "example": [
          "spoofing",
          "tampering"
        ]
      },
      "SeverityQueryParam": {
        "name": "severity",
        "in": "query",
        "schema": {
          "type": "string",
          "enum": [
            "Unknown",
            "None",
            "Low",
            "Medium",
            "High",
            "Critical"
          ],
          "maxLength": 1000,
          "pattern": "^[^\\x00-\\x1F]*$"
        },
        "description": "Filter by severity level (exact match)"
      },
      "PriorityQueryParam": {
        "name": "priority",
        "in": "query",
        "schema": {
          "type": "string",
          "maxLength": 256,
          "pattern": "^[^\\x00-\\x1F]*$"
        },
        "description": "Filter by priority (exact match)"
      },
      "DiagramIdQueryParam": {
        "name": "diagram_id",
        "in": "query",
        "schema": {
          "type": "string",
          "format": "uuid",
          "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
          "maxLength": 36
        },
        "description": "Filter by diagram ID (exact match)"
      },
      "CellIdQueryParam": {
        "name": "cell_id",
        "in": "query",
        "schema": {
          "type": "string",
          "format": "uuid",
          "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
          "maxLength": 36
        },
        "description": "Filter by cell ID (exact match)"
      },
      "ScoreGtQueryParam": {
        "name": "score_gt",
        "in": "query",
        "schema": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 10.0
        },
        "description": "Filter threats with score greater than this value"
      },
      "ScoreLtQueryParam": {
        "name": "score_lt",
        "in": "query",
        "schema": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 10.0
        },
        "description": "Filter threats with score less than this value"
      },
      "ScoreEqQueryParam": {
        "name": "score_eq",
        "in": "query",
        "schema": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 10.0
        },
        "description": "Filter threats with score equal to this value"
      },
      "ScoreGeQueryParam": {
        "name": "score_ge",
        "in": "query",
        "schema": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 10.0
        },
        "description": "Filter threats with score greater than or equal to this value"
      },
      "ScoreLeQueryParam": {
        "name": "score_le",
        "in": "query",
        "schema": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 10.0
        },
        "description": "Filter threats with score less than or equal to this value"
      },
      "ThreatIdsQueryParam": {
        "name": "threat_ids",
        "in": "query",
        "required": true,
        "schema": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "maxLength": 36
          },
          "minItems": 1,
          "maxItems": 20,
          "example": [
            "550e8400-e29b-41d4-a716-446655440001",
            "550e8400-e29b-41d4-a716-446655440002"
          ]
        },
        "description": "Comma-separated list of threat IDs to delete (UUID format)",
        "style": "form",
        "explode": false,
        "example": [
          "550e8400-e29b-41d4-a716-446655440001",
          "550e8400-e29b-41d4-a716-446655440002"
        ]
      },
      "ChallengeQueryParam": {
        "name": "challenge",
        "in": "query",
        "required": false,
        "schema": {
          "type": "string",
          "maxLength": 1000,
          "pattern": "^[^\\x00-\\x1F]*$"
        },
        "description": "Challenge string from first request (step 2 only). Must match exactly."
      },
      "SamlrequestQueryParam": {
        "name": "SAMLRequest",
        "in": "query",
        "required": true,
        "description": "Base64-encoded SAML logout request",
        "schema": {
          "type": "string",
          "maxLength": 1000,
          "pattern": "^[^\\x00-\\x1F]*$"
        }
      },
      "ThreatModelIdQueryParam": {
        "name": "threat_model_id",
        "in": "query",
        "description": "Filter subscriptions by threat model ID",
        "required": false,
        "schema": {
          "type": "string",
          "format": "uuid",
          "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
          "maxLength": 36
        }
      },
      "SubscriptionIdQueryParam": {
        "name": "subscription_id",
        "in": "query",
        "description": "Filter by subscription ID",
        "required": false,
        "schema": {
          "type": "string",
          "format": "uuid",
          "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
          "maxLength": 36
        }
      },
      "AddonIdQueryParam": {
        "name": "addon_id",
        "in": "query",
        "schema": {
          "type": "string",
          "format": "uuid"
        },
        "description": "Filter by add-on"
      },
      "X-Webhook-SignatureHeaderParam": {
        "name": "X-Webhook-Signature",
        "in": "header",
        "required": true,
        "schema": {
          "type": "string"
        },
        "description": "HMAC-SHA256 signature (format: sha256={hex_signature})"
      },
      "ProviderPathParam": {
        "name": "provider",
        "in": "path",
        "required": true,
        "description": "SAML provider identifier",
        "schema": {
          "type": "string"
        }
      },
      "ProviderQueryParam": {
        "name": "provider",
        "in": "query",
        "schema": {
          "type": "string",
          "maxLength": 256
        },
        "description": "Filter by OAuth/SAML provider"
      },
      "LimitQueryParam": {
        "name": "limit",
        "in": "query",
        "schema": {
          "type": "integer",
          "minimum": 0,
          "default": 50,
          "maximum": 1000
        },
        "description": "Maximum number of results to return"
      },
      "OffsetQueryParam": {
        "name": "offset",
        "in": "query",
        "schema": {
          "type": "integer",
          "minimum": 0,
          "default": 0,
          "maximum": 1000000
        },
        "description": "Number of results to skip"
      },
      "IdPathParam": {
        "name": "id",
        "in": "path",
        "required": true,
        "schema": {
          "type": "string",
          "format": "uuid"
        },
        "description": "Administrator grant ID"
      },
      "UserIdPathParam": {
        "name": "user_id",
        "in": "path",
        "required": true,
        "schema": {
          "type": "string",
          "format": "uuid"
        },
        "description": "User ID"
      },
      "EmailQueryParam": {
        "name": "email",
        "in": "query",
        "schema": {
          "type": "string",
          "maxLength": 1024
        },
        "description": "Filter by email (case-insensitive substring match)"
      },
      "CreatedAfterQueryParam": {
        "name": "created_after",
        "in": "query",
        "schema": {
          "type": "string",
          "format": "date-time"
        },
        "description": "Filter users created after this timestamp (RFC3339)"
      },
      "CreatedBeforeQueryParam": {
        "name": "created_before",
        "in": "query",
        "schema": {
          "type": "string",
          "format": "date-time"
        },
        "description": "Filter users created before this timestamp (RFC3339)"
      },
      "LastLoginAfterQueryParam": {
        "name": "last_login_after",
        "in": "query",
        "schema": {
          "type": "string",
          "format": "date-time"
        },
        "description": "Filter users who logged in after this timestamp (RFC3339)"
      },
      "LastLoginBeforeQueryParam": {
        "name": "last_login_before",
        "in": "query",
        "schema": {
          "type": "string",
          "format": "date-time"
        },
        "description": "Filter users who logged in before this timestamp (RFC3339)"
      },
      "SortByQueryParam": {
        "name": "sort_by",
        "in": "query",
        "schema": {
          "type": "string",
          "enum": [
            "created_at",
            "last_login",
            "email"
          ],
          "default": "created_at"
        },
        "description": "Field to sort by"
      },
      "SortOrderQueryParam": {
        "name": "sort_order",
        "in": "query",
        "schema": {
          "type": "string",
          "enum": [
            "asc",
            "desc"
          ],
          "default": "desc"
        },
        "description": "Sort direction"
      },
      "InternalUuidPathParam": {
        "name": "internal_uuid",
        "in": "path",
        "required": true,
        "schema": {
          "type": "string",
          "format": "uuid"
        },
        "description": "Internal system UUID of the user"
      },
      "GroupNameQueryParam": {
        "name": "group_name",
        "in": "query",
        "schema": {
          "type": "string",
          "maxLength": 1024
        },
        "description": "Filter by group name (case-insensitive substring match)"
      },
      "UsedInAuthorizationsQueryParam": {
        "name": "used_in_authorizations",
        "in": "query",
        "schema": {
          "type": "boolean"
        },
        "description": "Filter groups used (true) or not used (false) in authorizations"
      },
      "MemberUuidPathParam": {
        "name": "member_uuid",
        "in": "path",
        "required": true,
        "schema": {
          "type": "string",
          "format": "uuid"
        },
        "description": "Internal system UUID of the member to remove (user UUID when subject_type is user, group UUID when subject_type is group)"
      },
      "ThreatModelIdPathParam": {
        "name": "threat_model_id",
        "in": "path",
        "required": true,
        "description": "Threat model UUID",
        "schema": {
          "type": "string",
          "format": "uuid",
          "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
          "maxLength": 36
        }
      },
      "DiagramIdPathParam": {
        "name": "diagram_id",
        "in": "path",
        "required": true,
        "description": "Diagram UUID",
        "schema": {
          "type": "string",
          "format": "uuid",
          "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
          "maxLength": 36
        }
      },
      "FormatQueryParam": {
        "name": "format",
        "in": "query",
        "required": false,
        "description": "Output format for the diagram model (case-insensitive). Defaults to json if not specified.",
        "schema": {
          "type": "string",
          "enum": [
            "json",
            "yaml",
            "graphml"
          ],
          "default": "json"
        }
      },
      "SurveyResponseStatusQueryParam": {
        "name": "status",
        "in": "query",
        "description": "Filter by response status",
        "schema": {
          "type": "string",
          "maxLength": 256,
          "pattern": "^[^\\x00-\\x1F]*$"
        }
      },
      "IsConfidentialQueryParam": {
        "name": "is_confidential",
        "in": "query",
        "description": "Filter by secret_project flag",
        "schema": {
          "type": "boolean"
        }
      },
      "SurveyIdQueryParam": {
        "name": "survey_id",
        "in": "query",
        "description": "Filter by survey ID",
        "schema": {
          "type": "string",
          "format": "uuid"
        }
      },
      "SurveyStatusQueryParam": {
        "name": "status",
        "in": "query",
        "description": "Filter by survey status",
        "schema": {
          "type": "string",
          "maxLength": 128,
          "pattern": "^[^\\x00-\\x1F]*$"
        }
      },
      "SurveyId": {
        "name": "survey_id",
        "in": "path",
        "required": true,
        "description": "Unique identifier of the survey",
        "schema": {
          "type": "string",
          "format": "uuid"
        }
      },
      "SurveyResponseId": {
        "name": "survey_response_id",
        "in": "path",
        "required": true,
        "description": "Unique identifier of the survey response",
        "schema": {
          "type": "string",
          "format": "uuid"
        }
      },
      "TriageNoteId": {
        "name": "triage_note_id",
        "in": "path",
        "required": true,
        "schema": {
          "type": "integer",
          "minimum": 1
        },
        "description": "Triage note identifier (sequential within survey response)"
      }
    }
  },
  "paths": {
    "/": {
      "get": {
        "tags": [
          "General"
        ],
        "summary": "Get API information",
        "description": "Returns service, API, and operator information without authentication",
        "operationId": "getApiInfo",
        "responses": {
          "200": {
            "description": "Service and API information",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiInfo"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [],
        "x-rate-limit": {
          "scope": "ip",
          "tier": "public-discovery",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 10,
              "configurable": false,
              "tracking_method": "Source IP address"
            }
          ]
        },
        "x-public-endpoint": true,
        "x-authentication-required": false,
        "x-public-endpoint-purpose": "Health Check"
      }
    },
    "/.well-known/openid-configuration": {
      "get": {
        "tags": [
          "OIDC Discovery"
        ],
        "summary": "OpenID Connect Discovery Configuration",
        "description": "Returns OpenID Connect provider configuration metadata as per RFC 8414",
        "operationId": "getOpenIDConfiguration",
        "security": [],
        "responses": {
          "200": {
            "description": "OpenID Connect configuration metadata",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "issuer": {
                      "type": "string",
                      "format": "uri",
                      "example": "http://localhost:8080",
                      "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
                      "maxLength": 1000
                    },
                    "authorization_endpoint": {
                      "type": "string",
                      "format": "uri",
                      "example": "http://localhost:8080/oauth2/authorize",
                      "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
                      "maxLength": 1000
                    },
                    "token_endpoint": {
                      "type": "string",
                      "format": "uri",
                      "example": "http://localhost:8080/oauth2/token",
                      "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
                      "maxLength": 1000
                    },
                    "userinfo_endpoint": {
                      "type": "string",
                      "format": "uri",
                      "example": "http://localhost:8080/oauth2/userinfo",
                      "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
                      "maxLength": 1000
                    },
                    "jwks_uri": {
                      "type": "string",
                      "format": "uri",
                      "example": "http://localhost:8080/.well-known/jwks.json",
                      "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
                      "maxLength": 1000
                    },
                    "response_types_supported": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "maxLength": 1000
                      },
                      "example": [
                        "code",
                        "token",
                        "id_token",
                        "code token",
                        "code id_token",
                        "token id_token",
                        "code token id_token"
                      ],
                      "maxItems": 1000
                    },
                    "subject_types_supported": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "maxLength": 1000
                      },
                      "example": [
                        "public"
                      ],
                      "maxItems": 1000
                    },
                    "id_token_signing_alg_values_supported": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "maxLength": 1000
                      },
                      "example": [
                        "HS256"
                      ],
                      "maxItems": 1000
                    },
                    "scopes_supported": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "maxLength": 1000
                      },
                      "example": [
                        "openid",
                        "email",
                        "profile"
                      ],
                      "maxItems": 1000
                    },
                    "claims_supported": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "maxLength": 1000
                      },
                      "example": [
                        "sub",
                        "email",
                        "email_verified",
                        "name",
                        "given_name",
                        "family_name",
                        "picture",
                        "locale"
                      ],
                      "maxItems": 1000
                    },
                    "introspection_endpoint": {
                      "type": "string",
                      "format": "uri",
                      "example": "http://localhost:8080/oauth2/introspect",
                      "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
                      "maxLength": 1000
                    }
                  },
                  "required": [
                    "issuer",
                    "authorization_endpoint",
                    "token_endpoint",
                    "jwks_uri",
                    "response_types_supported",
                    "subject_types_supported",
                    "id_token_signing_alg_values_supported"
                  ],
                  "additionalProperties": false
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "ip",
          "tier": "public-discovery",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 10,
              "configurable": false,
              "tracking_method": "Source IP address"
            }
          ]
        },
        "x-public-endpoint": true,
        "x-authentication-required": false,
        "x-public-endpoint-purpose": "OIDC Discovery",
        "x-cacheable-endpoint": true,
        "x-cacheable-endpoint-reason": "OIDC discovery metadata is static configuration data, cacheable per RFC 8414"
      }
    },
    "/.well-known/oauth-authorization-server": {
      "get": {
        "tags": [
          "OIDC Discovery"
        ],
        "summary": "OAuth 2.0 Authorization Server Metadata",
        "description": "Returns OAuth 2.0 authorization server metadata as per RFC 8414",
        "operationId": "getOAuthAuthorizationServerMetadata",
        "security": [],
        "responses": {
          "200": {
            "description": "OAuth 2.0 authorization server metadata",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "issuer": {
                      "type": "string",
                      "format": "uri",
                      "example": "http://localhost:8080",
                      "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
                      "maxLength": 1000
                    },
                    "authorization_endpoint": {
                      "type": "string",
                      "format": "uri",
                      "example": "http://localhost:8080/oauth2/authorize",
                      "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
                      "maxLength": 1000
                    },
                    "token_endpoint": {
                      "type": "string",
                      "format": "uri",
                      "example": "http://localhost:8080/oauth2/token",
                      "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
                      "maxLength": 1000
                    },
                    "introspection_endpoint": {
                      "type": "string",
                      "format": "uri",
                      "example": "http://localhost:8080/oauth2/introspect",
                      "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
                      "maxLength": 1000
                    },
                    "response_types_supported": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "maxLength": 1000
                      },
                      "example": [
                        "code",
                        "token",
                        "id_token"
                      ],
                      "maxItems": 1000
                    },
                    "grant_types_supported": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "maxLength": 1000
                      },
                      "example": [
                        "authorization_code",
                        "implicit",
                        "refresh_token"
                      ],
                      "maxItems": 1000
                    },
                    "token_endpoint_auth_methods_supported": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "maxLength": 1000
                      },
                      "example": [
                        "client_secret_post",
                        "none"
                      ],
                      "maxItems": 1000
                    }
                  },
                  "required": [
                    "issuer",
                    "authorization_endpoint",
                    "token_endpoint",
                    "response_types_supported"
                  ],
                  "additionalProperties": false
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "ip",
          "tier": "public-discovery",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 10,
              "configurable": false,
              "tracking_method": "Source IP address"
            }
          ]
        },
        "x-public-endpoint": true,
        "x-authentication-required": false,
        "x-public-endpoint-purpose": "OIDC Discovery",
        "x-cacheable-endpoint": true,
        "x-cacheable-endpoint-reason": "OAuth AS metadata is static configuration data, cacheable per RFC 8414"
      }
    },
    "/.well-known/jwks.json": {
      "get": {
        "tags": [
          "OIDC Discovery"
        ],
        "summary": "JSON Web Key Set",
        "description": "Returns the JSON Web Key Set (JWKS) for JWT signature verification",
        "operationId": "getJWKS",
        "security": [],
        "responses": {
          "200": {
            "description": "JSON Web Key Set",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "keys": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "kty": {
                            "type": "string",
                            "example": "oct",
                            "maxLength": 1000
                          },
                          "use": {
                            "type": "string",
                            "example": "sig",
                            "maxLength": 1000
                          },
                          "alg": {
                            "type": "string",
                            "example": "HS256",
                            "maxLength": 1000
                          },
                          "kid": {
                            "type": "string",
                            "example": "tmi-signing-key",
                            "maxLength": 1000
                          }
                        },
                        "required": [
                          "kty",
                          "use",
                          "alg",
                          "kid"
                        ],
                        "additionalProperties": false
                      },
                      "maxItems": 1000,
                      "example": [
                        {
                          "kty": "RSA",
                          "use": "sig",
                          "kid": "tmi-key-1",
                          "alg": "RS256"
                        }
                      ]
                    }
                  },
                  "required": [
                    "keys"
                  ],
                  "additionalProperties": false
                },
                "example": {
                  "keys": [
                    {
                      "kty": "RSA",
                      "use": "sig",
                      "kid": "tmi-key-1",
                      "alg": "RS256"
                    }
                  ]
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "ip",
          "tier": "public-discovery",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 10,
              "configurable": false,
              "tracking_method": "Source IP address"
            }
          ]
        },
        "x-public-endpoint": true,
        "x-authentication-required": false,
        "x-public-endpoint-purpose": "OIDC Discovery",
        "x-cacheable-endpoint": true,
        "x-cacheable-endpoint-reason": "JWKS contains public keys that change infrequently, cacheable per RFC 7517"
      }
    },
    "/.well-known/oauth-protected-resource": {
      "get": {
        "tags": [
          "OAuth Discovery"
        ],
        "summary": "OAuth 2.0 Protected Resource Metadata",
        "description": "Returns OAuth 2.0 protected resource metadata as per RFC 9728",
        "operationId": "getOAuthProtectedResourceMetadata",
        "security": [],
        "responses": {
          "200": {
            "description": "OAuth 2.0 protected resource metadata",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OAuthProtectedResourceMetadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "ip",
          "tier": "public-discovery",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 10,
              "configurable": false,
              "tracking_method": "Source IP address"
            }
          ]
        },
        "x-public-endpoint": true,
        "x-authentication-required": false,
        "x-public-endpoint-purpose": "OIDC Discovery",
        "x-cacheable-endpoint": true,
        "x-cacheable-endpoint-reason": "OAuth protected resource metadata is static configuration data, cacheable per RFC 9728"
      }
    },
    "/oauth2/introspect": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "summary": "Token Introspection",
        "description": "Introspects a JWT token to determine its validity and metadata as per RFC 7662",
        "operationId": "introspectToken",
        "requestBody": {
          "required": true,
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "$ref": "#/components/schemas/TokenIntrospectionRequest"
              }
            }
          },
          "description": "Token introspection request parameters"
        },
        "responses": {
          "200": {
            "description": "Token introspection result",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "active": {
                      "type": "boolean",
                      "description": "Whether the token is active/valid",
                      "example": true
                    },
                    "sub": {
                      "type": "string",
                      "description": "Subject (user identifier)",
                      "example": "user@example.com",
                      "maxLength": 1000
                    },
                    "email": {
                      "type": "string",
                      "description": "User email address",
                      "example": "user@example.com",
                      "maxLength": 1000
                    },
                    "name": {
                      "type": "string",
                      "description": "User's full name",
                      "example": "John Doe",
                      "maxLength": 256,
                      "pattern": "^[^\\x00-\\x1F]*$"
                    },
                    "exp": {
                      "type": "integer",
                      "description": "Token expiration time (Unix timestamp)",
                      "example": 1640995200
                    },
                    "iat": {
                      "type": "integer",
                      "description": "Token issued at time (Unix timestamp)",
                      "example": 1640991600
                    },
                    "iss": {
                      "type": "string",
                      "description": "Token issuer",
                      "example": "http://localhost:8080",
                      "maxLength": 1000
                    },
                    "token_type": {
                      "type": "string",
                      "description": "Type of the token (RFC 7662)",
                      "example": "Bearer",
                      "maxLength": 50
                    },
                    "scope": {
                      "type": "string",
                      "description": "Space-separated list of scopes (RFC 7662)",
                      "example": "openid profile email",
                      "maxLength": 1000
                    }
                  },
                  "required": [
                    "active"
                  ],
                  "additionalProperties": false
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          }
        },
        "security": [],
        "x-rate-limit": {
          "strategy": "multi-scope",
          "tier": "auth-flows",
          "scopes": [
            {
              "name": "session",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 5,
                  "configurable": false,
                  "tracking_method": "OAuth state parameter or SAML request ID"
                }
              ]
            },
            {
              "name": "ip",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 100,
                  "configurable": false,
                  "tracking_method": "Source IP address"
                }
              ]
            },
            {
              "name": "user_identifier",
              "limits": [
                {
                  "type": "attempts_per_hour",
                  "default": 10,
                  "configurable": false,
                  "tracking_method": "login_hint parameter or email address"
                }
              ]
            }
          ],
          "enforcement": "Most restrictive limit applies"
        },
        "x-public-endpoint": true,
        "x-authentication-required": false,
        "x-public-endpoint-purpose": "OAuth Flow"
      }
    },
    "/oauth2/providers": {
      "get": {
        "tags": [
          "Authentication"
        ],
        "summary": "List available OAuth providers",
        "description": "Returns a list of configured OAuth providers available for authentication",
        "operationId": "getAuthProviders",
        "responses": {
          "200": {
            "description": "List of available OAuth providers",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "providers": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "description": "Provider identifier",
                            "maxLength": 1000
                          },
                          "name": {
                            "type": "string",
                            "description": "Display name of the provider",
                            "maxLength": 256,
                            "pattern": "^[^\\x00-\\x1F]*$"
                          },
                          "icon": {
                            "type": "string",
                            "description": "Icon identifier for the provider",
                            "maxLength": 1000
                          },
                          "auth_url": {
                            "type": "string",
                            "format": "uri",
                            "description": "TMI authorization endpoint URL for this provider",
                            "pattern": "^(https?|wss?|file)://[^\\s]*$",
                            "maxLength": 1024
                          },
                          "token_url": {
                            "type": "string",
                            "format": "uri",
                            "description": "TMI token exchange endpoint URL for this provider",
                            "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
                            "maxLength": 1024
                          },
                          "redirect_uri": {
                            "type": "string",
                            "format": "uri",
                            "description": "OAuth callback URI configured for this provider",
                            "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
                            "maxLength": 1000
                          },
                          "client_id": {
                            "type": "string",
                            "description": "OAuth client ID for this provider",
                            "maxLength": 1000
                          }
                        },
                        "required": [
                          "id",
                          "name",
                          "icon",
                          "auth_url",
                          "token_url",
                          "redirect_uri",
                          "client_id"
                        ],
                        "additionalProperties": false
                      },
                      "maxItems": 1000,
                      "example": [
                        {
                          "id": "tmi",
                          "name": "TMI Development",
                          "icon": "shield",
                          "auth_url": "http://localhost:8080/oauth2/authorize?idp=tmi",
                          "token_url": "http://localhost:8080/oauth2/token",
                          "redirect_uri": "http://localhost:8079/callback",
                          "client_id": "tmi-client"
                        }
                      ]
                    }
                  },
                  "required": [
                    "providers"
                  ],
                  "additionalProperties": false
                },
                "example": {
                  "providers": [
                    {
                      "id": "tmi",
                      "name": "TMI Development",
                      "icon": "shield",
                      "auth_url": "http://localhost:8080/oauth2/authorize?idp=tmi",
                      "token_url": "http://localhost:8080/oauth2/token",
                      "redirect_uri": "http://localhost:8079/callback",
                      "client_id": "tmi-client"
                    }
                  ]
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "$ref": "#/components/responses/Error"
          }
        },
        "security": [],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        },
        "x-public-endpoint": true,
        "x-authentication-required": false,
        "x-public-endpoint-purpose": "OAuth Flow",
        "x-cacheable-endpoint": true,
        "x-cacheable-endpoint-reason": "OAuth provider list is static configuration data"
      }
    },
    "/oauth2/providers/{idp}/groups": {
      "get": {
        "tags": [
          "Authentication"
        ],
        "summary": "Get groups for identity provider",
        "description": "Returns groups available from a specific identity provider for autocomplete and discovery",
        "operationId": "getProviderGroups",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/IdpPathParam"
          }
        ],
        "responses": {
          "200": {
            "description": "List of groups from the identity provider",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "idp": {
                      "type": "string",
                      "description": "Identity provider ID",
                      "pattern": "^[a-zA-Z][a-zA-Z0-9_-]*$",
                      "maxLength": 100,
                      "example": "azure"
                    },
                    "groups": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "name": {
                            "type": "string",
                            "description": "Group name",
                            "maxLength": 256,
                            "pattern": "^[^\\x00-\\x1F]*$"
                          },
                          "display_name": {
                            "type": "string",
                            "description": "Display name for the group",
                            "maxLength": 256,
                            "pattern": "^[^\\x00-\\x1F]*$"
                          },
                          "used_in_authorizations": {
                            "type": "boolean",
                            "description": "Whether this group is used in any threat model authorizations"
                          }
                        },
                        "required": [
                          "name"
                        ],
                        "additionalProperties": false
                      },
                      "maxItems": 1000,
                      "example": [
                        {
                          "name": "admins",
                          "display_name": "Administrators",
                          "used_in_authorizations": true
                        },
                        {
                          "name": "developers",
                          "display_name": "Development Team",
                          "used_in_authorizations": false
                        },
                        {
                          "name": "users",
                          "display_name": "General Users",
                          "used_in_authorizations": false
                        }
                      ]
                    }
                  },
                  "required": [
                    "idp",
                    "groups"
                  ],
                  "additionalProperties": false
                },
                "example": {
                  "idp": "azure",
                  "groups": [
                    {
                      "name": "Security Team"
                    },
                    {
                      "name": "Developers"
                    }
                  ]
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/oauth2/authorize": {
      "get": {
        "tags": [
          "Authentication"
        ],
        "summary": "Initiate OAuth authorization flow",
        "description": "Redirects user to OAuth provider's authorization page. Supports client callback URL for seamless client integration. Generates state parameter for CSRF protection.",
        "operationId": "authorizeOAuthProvider",
        "parameters": [
          {
            "$ref": "#/components/parameters/IdpQueryParam"
          },
          {
            "$ref": "#/components/parameters/ClientCallbackQueryParam"
          },
          {
            "$ref": "#/components/parameters/StateQueryParam"
          },
          {
            "$ref": "#/components/parameters/LoginHintQueryParam"
          },
          {
            "$ref": "#/components/parameters/ScopeQueryParam"
          },
          {
            "$ref": "#/components/parameters/CodeChallengeQueryParam"
          },
          {
            "$ref": "#/components/parameters/CodeChallengeMethodQueryParam"
          }
        ],
        "responses": {
          "302": {
            "description": "Redirect to OAuth provider authorization page",
            "headers": {
              "Location": {
                "schema": {
                  "type": "string",
                  "format": "uri",
                  "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
                  "maxLength": 1000
                },
                "description": "OAuth provider authorization URL with client_id, redirect_uri, response_type, scope, and state parameters"
              }
            }
          },
          "400": {
            "description": "Invalid provider or provider not configured",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal server error generating authorization URL",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [],
        "x-rate-limit": {
          "strategy": "multi-scope",
          "tier": "auth-flows",
          "scopes": [
            {
              "name": "session",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 5,
                  "configurable": false,
                  "tracking_method": "OAuth state parameter or SAML request ID"
                }
              ]
            },
            {
              "name": "ip",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 100,
                  "configurable": false,
                  "tracking_method": "Source IP address"
                }
              ]
            },
            {
              "name": "user_identifier",
              "limits": [
                {
                  "type": "attempts_per_hour",
                  "default": 10,
                  "configurable": false,
                  "tracking_method": "login_hint parameter or email address"
                }
              ]
            }
          ],
          "enforcement": "Most restrictive limit applies"
        },
        "x-public-endpoint": true,
        "x-authentication-required": false,
        "x-public-endpoint-purpose": "OAuth Flow"
      }
    },
    "/oauth2/token": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "summary": "Exchange OAuth credentials for JWT tokens",
        "description": "Provider-neutral endpoint to exchange OAuth credentials for TMI JWT tokens. Supports three grant types: (1) authorization_code for OAuth provider flows (Google, GitHub, Microsoft), (2) client_credentials for machine-to-machine authentication (RFC 6749 Section 4.4), and (3) refresh_token for token renewal. Accepts both application/json and application/x-www-form-urlencoded content types.",
        "operationId": "exchangeOAuthCode",
        "parameters": [
          {
            "$ref": "#/components/parameters/IdpQueryParam"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "grant_type": {
                    "type": "string",
                    "description": "OAuth 2.0 grant type (RFC 6749)",
                    "enum": [
                      "authorization_code",
                      "client_credentials",
                      "refresh_token"
                    ],
                    "example": "authorization_code"
                  },
                  "code": {
                    "type": "string",
                    "description": "Authorization code received from OAuth provider. Per RFC 6749, can contain any visible ASCII characters (VSCHAR: 0x20-0x7E).",
                    "example": "0AX4XfWiXY2BZ_example_auth_code_from_google",
                    "pattern": "^[\\x20-\\x7E]+$",
                    "maxLength": 512,
                    "nullable": true
                  },
                  "state": {
                    "type": "string",
                    "description": "State parameter for CSRF protection (optional but recommended)",
                    "example": "random_state_value_abc123",
                    "pattern": "^[a-zA-Z0-9_=-]*$",
                    "maxLength": 256,
                    "nullable": true
                  },
                  "redirect_uri": {
                    "type": "string",
                    "format": "uri",
                    "description": "Redirect URI used in the authorization request (must match exactly)",
                    "example": "https://your-web-app.com/oauth2/callback",
                    "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
                    "maxLength": 1000,
                    "nullable": true
                  },
                  "code_verifier": {
                    "type": "string",
                    "description": "PKCE code verifier (RFC 7636) - High-entropy cryptographic random string used to mitigate authorization code interception attacks. Must be 43-128 characters using [A-Za-z0-9-._~] characters.",
                    "example": "dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk",
                    "pattern": "^[A-Za-z0-9\\-._~]+$",
                    "minLength": 43,
                    "maxLength": 128,
                    "nullable": true
                  },
                  "client_id": {
                    "type": "string",
                    "description": "Client identifier (required for client_credentials grant)",
                    "example": "tmi_cc_AbCdEf123456",
                    "nullable": true
                  },
                  "client_secret": {
                    "type": "string",
                    "description": "Client secret (required for client_credentials grant)",
                    "example": "secret_value",
                    "nullable": true
                  },
                  "refresh_token": {
                    "type": "string",
                    "description": "Refresh token (required for refresh_token grant)",
                    "example": "refresh_token_value",
                    "nullable": true
                  }
                },
                "required": [
                  "grant_type"
                ],
                "additionalProperties": false
              }
            },
            "application/x-www-form-urlencoded": {
              "schema": {
                "$ref": "#/components/schemas/TokenRequest"
              },
              "example": {
                "grant_type": "authorization_code",
                "code": "auth-code-12345",
                "redirect_uri": "http://localhost:8079/callback",
                "code_verifier": "dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk"
              }
            }
          },
          "description": "OAuth 2.0 token exchange request parameters"
        },
        "responses": {
          "200": {
            "description": "OAuth exchange successful, TMI JWT tokens issued",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthTokenResponse"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad request - invalid provider, missing parameters, or invalid state",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "examples": {
                  "invalid_provider": {
                    "summary": "Invalid provider",
                    "value": {
                      "error": "Invalid provider: invalid_provider",
                      "error_description": "Provider 'invalid_provider' is not configured or supported"
                    }
                  },
                  "missing_code": {
                    "summary": "Missing authorization code",
                    "value": {
                      "error": "Invalid request: missing required fields",
                      "error_description": "The 'code' parameter is required"
                    }
                  },
                  "invalid_state": {
                    "summary": "Invalid state parameter",
                    "value": {
                      "error": "Invalid state parameter",
                      "error_description": "State parameter validation failed - possible CSRF attack"
                    }
                  }
                }
              },
              "text/plain": {
                "schema": {
                  "type": "string",
                  "description": "Plain text error from transport layer",
                  "example": "400 Bad Request"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal server error - OAuth provider communication failed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "examples": {
                  "provider_error": {
                    "summary": "OAuth provider communication failed",
                    "value": {
                      "error": "Failed to exchange authorization code: oauth2: cannot fetch token: 400 Bad Request",
                      "error_description": "Unable to communicate with OAuth provider or invalid authorization code"
                    }
                  },
                  "user_info_error": {
                    "summary": "Failed to get user information",
                    "value": {
                      "error": "Failed to get user info: 401 Unauthorized",
                      "error_description": "OAuth provider denied access to user information"
                    }
                  }
                }
              }
            }
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [],
        "x-rate-limit": {
          "strategy": "multi-scope",
          "tier": "auth-flows",
          "scopes": [
            {
              "name": "session",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 5,
                  "configurable": false,
                  "tracking_method": "OAuth state parameter or SAML request ID"
                }
              ]
            },
            {
              "name": "ip",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 100,
                  "configurable": false,
                  "tracking_method": "Source IP address"
                }
              ]
            },
            {
              "name": "user_identifier",
              "limits": [
                {
                  "type": "attempts_per_hour",
                  "default": 10,
                  "configurable": false,
                  "tracking_method": "login_hint parameter or email address"
                }
              ]
            }
          ],
          "enforcement": "Most restrictive limit applies"
        },
        "x-public-endpoint": true,
        "x-authentication-required": false,
        "x-public-endpoint-purpose": "OAuth Flow"
      }
    },
    "/oauth2/refresh": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "summary": "Refresh JWT token",
        "description": "Exchanges a refresh token for a new JWT access token",
        "operationId": "refreshToken",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TokenRefreshRequest"
              }
            }
          },
          "description": "OAuth 2.0 token refresh request parameters"
        },
        "responses": {
          "200": {
            "description": "New JWT issued successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthTokenResponse"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad request - missing or invalid refresh token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "examples": {
                  "missing_token": {
                    "summary": "Missing refresh token",
                    "value": {
                      "error": "Invalid request: missing required fields",
                      "error_description": "The 'refresh_token' parameter is required"
                    }
                  },
                  "invalid_format": {
                    "summary": "Invalid token format",
                    "value": {
                      "error": "Invalid refresh token format",
                      "error_description": "Refresh token must be a valid UUID string"
                    }
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - invalid or expired refresh token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "examples": {
                  "expired_token": {
                    "summary": "Expired refresh token",
                    "value": {
                      "error": "Invalid refresh token",
                      "error_description": "The refresh token has expired or has been revoked"
                    }
                  },
                  "invalid_token": {
                    "summary": "Invalid refresh token",
                    "value": {
                      "error": "Invalid refresh token",
                      "error_description": "The provided refresh token is not valid"
                    }
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [],
        "x-rate-limit": {
          "strategy": "multi-scope",
          "tier": "auth-flows",
          "scopes": [
            {
              "name": "session",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 5,
                  "configurable": false,
                  "tracking_method": "OAuth state parameter or SAML request ID"
                }
              ]
            },
            {
              "name": "ip",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 100,
                  "configurable": false,
                  "tracking_method": "Source IP address"
                }
              ]
            },
            {
              "name": "user_identifier",
              "limits": [
                {
                  "type": "attempts_per_hour",
                  "default": 10,
                  "configurable": false,
                  "tracking_method": "login_hint parameter or email address"
                }
              ]
            }
          ],
          "enforcement": "Most restrictive limit applies"
        },
        "x-public-endpoint": true,
        "x-authentication-required": false,
        "x-public-endpoint-purpose": "OAuth Flow"
      }
    },
    "/oauth2/userinfo": {
      "get": {
        "tags": [
          "Authentication"
        ],
        "summary": "Get current user information",
        "description": "Returns information about the currently authenticated user",
        "operationId": "getCurrentUser",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Current user information",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "description": "OIDC-compliant userinfo response per OpenID Connect Core 1.0 Section 5.1",
                  "properties": {
                    "sub": {
                      "type": "string",
                      "description": "Subject identifier - unique identifier for the user (required per OIDC)",
                      "maxLength": 1000,
                      "example": "alice"
                    },
                    "email": {
                      "type": "string",
                      "format": "email",
                      "description": "User email address",
                      "pattern": "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$",
                      "maxLength": 254,
                      "example": "user@example.com"
                    },
                    "name": {
                      "type": "string",
                      "description": "User display name",
                      "maxLength": 256,
                      "pattern": "^[^\\x00-\\x1F]*$",
                      "example": "John Doe"
                    },
                    "idp": {
                      "type": "string",
                      "description": "Identity provider that authenticated the user",
                      "maxLength": 100,
                      "pattern": "^[a-zA-Z][a-zA-Z0-9_-]*$",
                      "example": "github"
                    },
                    "groups": {
                      "type": "array",
                      "description": "Groups the user belongs to",
                      "items": {
                        "type": "string",
                        "maxLength": 1000
                      },
                      "maxItems": 1000,
                      "example": [
                        "admins",
                        "users"
                      ]
                    }
                  },
                  "required": [
                    "sub"
                  ],
                  "additionalProperties": false
                },
                "example": {
                  "sub": "alice",
                  "name": "Alice Smith",
                  "email": "alice@example.com",
                  "idp": "github"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/oauth2/callback": {
      "get": {
        "tags": [
          "Authentication"
        ],
        "summary": "Handle OAuth callback",
        "description": "Exchanges OAuth authorization code for JWT tokens. If client_callback was provided during authorization, redirects to client with tokens. Otherwise returns tokens as JSON response.",
        "operationId": "handleOAuthCallback",
        "parameters": [
          {
            "$ref": "#/components/parameters/CodeQueryParam"
          },
          {
            "$ref": "#/components/parameters/StateQueryParam"
          }
        ],
        "responses": {
          "200": {
            "description": "JWT tokens issued successfully (legacy mode when no client_callback provided)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthTokenResponse"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "302": {
            "description": "Redirect to client callback URL with tokens (when client_callback was provided)",
            "headers": {
              "Location": {
                "schema": {
                  "type": "string",
                  "format": "uri",
                  "example": "http://localhost:4200/oauth2/callback#access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...&refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...&expires_in=3600&token_type=Bearer&state=random_state_abc123",
                  "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
                  "maxLength": 1000
                },
                "description": "Client callback URL with access_token, refresh_token, expires_in, token_type, and state in URL fragment (after #)"
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [],
        "x-rate-limit": {
          "strategy": "multi-scope",
          "tier": "auth-flows",
          "scopes": [
            {
              "name": "session",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 5,
                  "configurable": false,
                  "tracking_method": "OAuth state parameter or SAML request ID"
                }
              ]
            },
            {
              "name": "ip",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 100,
                  "configurable": false,
                  "tracking_method": "Source IP address"
                }
              ]
            },
            {
              "name": "user_identifier",
              "limits": [
                {
                  "type": "attempts_per_hour",
                  "default": 10,
                  "configurable": false,
                  "tracking_method": "login_hint parameter or email address"
                }
              ]
            }
          ],
          "enforcement": "Most restrictive limit applies"
        },
        "x-public-endpoint": true,
        "x-authentication-required": false,
        "x-public-endpoint-purpose": "OAuth Flow"
      }
    },
    "/oauth2/revoke": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "summary": "Revoke token",
        "description": "Revokes an OAuth 2.0 token per RFC 7009. The token to revoke is passed in the request body. Supports both access tokens and refresh tokens. Authentication is required via Bearer token in the Authorization header OR client credentials (client_id/client_secret) in the request body. Per RFC 7009, the response is always 200 OK regardless of whether the token was valid, to prevent token existence disclosure.",
        "operationId": "revokeToken",
        "security": [],
        "x-authentication-required": true,
        "x-public-endpoint-purpose": "OAuth token revocation with flexible authentication (Bearer or client credentials)",
        "requestBody": {
          "description": "Token revocation request per RFC 7009",
          "required": true,
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "$ref": "#/components/schemas/TokenRevocationRequest"
              }
            },
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TokenRevocationRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Token revocation processed. Per RFC 7009, this response is returned regardless of whether the token was valid, already revoked, or never existed - to prevent token existence disclosure.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {},
                  "additionalProperties": false
                },
                "example": {}
              }
            },
            "headers": {
              "X-Request-ID": {
                "description": "Unique request identifier for tracking",
                "schema": {
                  "type": "string",
                  "example": "req_abc123def456"
                }
              },
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid request - missing required 'token' parameter",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "error": "invalid_request",
                  "error_description": "Missing required 'token' parameter"
                }
              },
              "text/plain": {
                "schema": {
                  "type": "string",
                  "description": "Plain text error from transport layer",
                  "example": "400 Bad Request"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Authentication failed - no valid Bearer token or client credentials provided",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "error": "invalid_client",
                  "error_description": "Client authentication failed"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        },
        "x-skip-idor-check": true,
        "x-skip-idor-check-reason": "Token revocation accepts any valid client_id the caller has access to - this is expected behavior per RFC 7009"
      }
    },
    "/me/sessions": {
      "get": {
        "tags": [
          "Collaboration"
        ],
        "summary": "List active collaboration sessions",
        "description": "Returns all currently active collaboration sessions for diagrams. Clients can use this endpoint to discover existing sessions before connecting via WebSocket.",
        "operationId": "getCurrentUserSessions",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                },
                "example": {
                  "sessions": [
                    {
                      "session_id": "550e8400-e29b-41d4-a716-446655440000",
                      "diagram_id": "550e8400-e29b-41d4-a716-446655440001",
                      "host_user_id": "alice@example.com",
                      "participants": [
                        "alice@example.com",
                        "bob@example.com"
                      ],
                      "created_at": "2026-01-17T12:00:00Z"
                    }
                  ]
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Authentication failed - invalid, missing, or malformed token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models": {
      "get": {
        "tags": [
          "Threat Models"
        ],
        "summary": "List threat models",
        "description": "Returns a list of threat models accessible to the authenticated user with enhanced metadata and entity counts",
        "operationId": "listThreatModels",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/PaginationLimit"
          },
          {
            "$ref": "#/components/parameters/PaginationOffset"
          },
          {
            "$ref": "#/components/parameters/OwnerQueryParam"
          },
          {
            "$ref": "#/components/parameters/NameQueryParam"
          },
          {
            "$ref": "#/components/parameters/DescriptionQueryParam"
          },
          {
            "$ref": "#/components/parameters/IssueUriQueryParam"
          },
          {
            "$ref": "#/components/parameters/CreatedAfter"
          },
          {
            "$ref": "#/components/parameters/CreatedBefore"
          },
          {
            "$ref": "#/components/parameters/ModifiedAfter"
          },
          {
            "$ref": "#/components/parameters/ModifiedBefore"
          },
          {
            "$ref": "#/components/parameters/StatusQueryParam"
          },
          {
            "$ref": "#/components/parameters/StatusUpdatedAfterQueryParam"
          },
          {
            "$ref": "#/components/parameters/StatusUpdatedBeforeQueryParam"
          }
        ],
        "responses": {
          "200": {
            "description": "Paginated list of threat models with enhanced metadata and entity counts",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListThreatModelsResponse"
                },
                "example": {
                  "threat_models": [
                    {
                      "id": "660e8400-e29b-41d4-a716-446655440001",
                      "name": "Payment Gateway Threat Model",
                      "owner": {
                        "principal_type": "user",
                        "provider": "github",
                        "provider_id": "alice@example.com",
                        "display_name": "Alice Johnson",
                        "email": "alice@example.com"
                      },
                      "created_by": {
                        "principal_type": "user",
                        "provider": "github",
                        "provider_id": "alice@example.com",
                        "display_name": "Alice Johnson",
                        "email": "alice@example.com"
                      },
                      "threat_model_framework": "STRIDE",
                      "created_at": "2024-01-15T10:30:00Z",
                      "modified_at": "2024-01-20T15:45:30Z",
                      "document_count": 3,
                      "repo_count": 2,
                      "diagram_count": 1,
                      "threat_count": 5,
                      "asset_count": 4,
                      "note_count": 2
                    }
                  ],
                  "total": 42,
                  "limit": 20,
                  "offset": 0
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Models"
        ],
        "summary": "Create a threat model",
        "description": "Creates a new threat model with the authenticated user as owner",
        "operationId": "createThreatModel",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ThreatModelInput"
              }
            }
          },
          "description": "Threat Model creation data"
        },
        "responses": {
          "201": {
            "description": "Threat model created successfully",
            "headers": {
              "Location": {
                "schema": {
                  "type": "string"
                },
                "description": "URL of the new threat model"
              },
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ThreatModel"
                },
                "example": {
                  "id": "123e4567-e89b-41d4-a716-446655440000",
                  "name": "Payment Gateway Threat Model",
                  "description": "Threat analysis for payment processing system",
                  "owner": {
                    "principal_type": "user",
                    "provider": "github",
                    "provider_id": "alice@example.com",
                    "display_name": "Alice Johnson",
                    "email": "alice@example.com"
                  },
                  "threat_model_framework": "STRIDE",
                  "authorization": [
                    {
                      "principal_type": "user",
                      "provider": "github",
                      "provider_id": "alice@example.com",
                      "display_name": "Alice Johnson",
                      "email": "alice@example.com",
                      "role": "owner"
                    }
                  ],
                  "status": "In Progress",
                  "alias": [
                    "payment-gateway-v2",
                    "PG-TM-2024"
                  ],
                  "created_at": "2024-01-15T10:30:00Z",
                  "modified_at": "2024-01-15T10:30:00Z",
                  "is_confidential": false,
                  "created_by": {
                    "principal_type": "user",
                    "provider": "github",
                    "provider_id": "alice@example.com",
                    "display_name": "Alice Johnson",
                    "email": "alice@example.com"
                  },
                  "diagrams": [],
                  "threats": [],
                  "documents": [],
                  "repositories": [],
                  "notes": [],
                  "assets": []
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}": {
      "get": {
        "tags": [
          "Threat Models"
        ],
        "summary": "Retrieve a threat model",
        "description": "Retrieves the full details of a specific threat model if the user has access",
        "operationId": "getThreatModel",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "responses": {
          "200": {
            "description": "Full threat model details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ThreatModel"
                },
                "example": {
                  "id": "123e4567-e89b-41d4-a716-446655440000",
                  "name": "Payment Gateway Threat Model",
                  "description": "Threat analysis for payment processing system",
                  "owner": {
                    "principal_type": "user",
                    "provider": "github",
                    "provider_id": "alice@example.com",
                    "display_name": "Alice Johnson",
                    "email": "alice@example.com"
                  },
                  "threat_model_framework": "STRIDE",
                  "authorization": [
                    {
                      "principal_type": "user",
                      "provider": "github",
                      "provider_id": "alice@example.com",
                      "display_name": "Alice Johnson",
                      "email": "alice@example.com",
                      "role": "owner"
                    },
                    {
                      "principal_type": "user",
                      "provider": "github",
                      "provider_id": "bob@example.com",
                      "display_name": "Bob Smith",
                      "email": "bob@example.com",
                      "role": "writer"
                    }
                  ],
                  "status": "In Progress",
                  "alias": [
                    "payment-gateway-v2",
                    "PG-TM-2024"
                  ],
                  "issue_uri": "https://github.com/example/project/issues/42",
                  "created_at": "2024-01-15T10:30:00Z",
                  "modified_at": "2024-01-20T14:45:00Z",
                  "is_confidential": false,
                  "created_by": {
                    "principal_type": "user",
                    "provider": "github",
                    "provider_id": "alice@example.com",
                    "display_name": "Alice Johnson",
                    "email": "alice@example.com"
                  },
                  "diagrams": [
                    {
                      "id": "234e5678-e89b-41d4-a716-446655440001",
                      "name": "Payment Flow DFD",
                      "type": "DFD-1.0.0",
                      "cells": [],
                      "created_at": "2024-01-15T10:35:00Z",
                      "modified_at": "2024-01-20T16:00:00Z"
                    }
                  ],
                  "threats": [
                    {
                      "id": "345e6789-e89b-41d4-a716-446655440002",
                      "name": "SQL Injection in Payment API",
                      "threat_type": [
                        "Tampering"
                      ],
                      "severity": "high",
                      "status": "open"
                    }
                  ],
                  "documents": [],
                  "repositories": [],
                  "notes": [],
                  "assets": []
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Models"
        ],
        "summary": "Update a threat model",
        "description": "Fully updates a threat model; restricted to writer/owner roles",
        "operationId": "updateThreatModel",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ThreatModelInput"
              }
            }
          },
          "description": "Complete threat model data for replacement"
        },
        "responses": {
          "200": {
            "description": "Threat model updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ThreatModel"
                },
                "example": {
                  "id": "123e4567-e89b-41d4-a716-446655440000",
                  "name": "Payment Gateway Threat Model v2",
                  "description": "Updated threat analysis for payment processing system",
                  "owner": {
                    "principal_type": "user",
                    "provider": "github",
                    "provider_id": "alice@example.com",
                    "display_name": "Alice Johnson",
                    "email": "alice@example.com"
                  },
                  "threat_model_framework": "STRIDE",
                  "authorization": [
                    {
                      "principal_type": "user",
                      "provider": "github",
                      "provider_id": "alice@example.com",
                      "display_name": "Alice Johnson",
                      "email": "alice@example.com",
                      "role": "owner"
                    }
                  ],
                  "status": "Review",
                  "alias": [
                    "payment-gateway-v2",
                    "PG-TM-2024"
                  ],
                  "created_at": "2024-01-15T10:30:00Z",
                  "modified_at": "2024-01-25T09:00:00Z",
                  "is_confidential": false,
                  "created_by": {
                    "principal_type": "user",
                    "provider": "github",
                    "provider_id": "alice@example.com",
                    "display_name": "Alice Johnson",
                    "email": "alice@example.com"
                  },
                  "diagrams": [],
                  "threats": [],
                  "documents": [],
                  "repositories": [],
                  "notes": [],
                  "assets": []
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "tags": [
          "Threat Models"
        ],
        "summary": "Partially update a threat model",
        "description": "Applies JSON Patch operations to a threat model; restricted to writer/owner roles",
        "operationId": "patchThreatModel",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "requestBody": {
          "content": {
            "application/json-patch+json": {
              "schema": {
                "$ref": "#/components/schemas/JsonPatchDocument"
              },
              "example": [
                {
                  "op": "replace",
                  "path": "/name",
                  "value": "Updated Name"
                },
                {
                  "op": "add",
                  "path": "/description",
                  "value": "New description"
                }
              ]
            }
          },
          "description": "JSON Patch operations to apply to the threat model"
        },
        "responses": {
          "200": {
            "description": "Threat model updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ThreatModel"
                },
                "example": {
                  "id": "123e4567-e89b-41d4-a716-446655440000",
                  "name": "Payment Gateway Threat Model",
                  "description": "Threat analysis for payment processing system - updated via patch",
                  "owner": {
                    "principal_type": "user",
                    "provider": "github",
                    "provider_id": "alice@example.com",
                    "display_name": "Alice Johnson",
                    "email": "alice@example.com"
                  },
                  "threat_model_framework": "STRIDE",
                  "authorization": [
                    {
                      "principal_type": "user",
                      "provider": "github",
                      "provider_id": "alice@example.com",
                      "display_name": "Alice Johnson",
                      "email": "alice@example.com",
                      "role": "owner"
                    }
                  ],
                  "status": "Approved",
                  "alias": [
                    "payment-gateway-v2",
                    "PG-TM-2024"
                  ],
                  "created_at": "2024-01-15T10:30:00Z",
                  "modified_at": "2024-01-26T16:20:00Z",
                  "is_confidential": false,
                  "created_by": {
                    "principal_type": "user",
                    "provider": "github",
                    "provider_id": "alice@example.com",
                    "display_name": "Alice Johnson",
                    "email": "alice@example.com"
                  },
                  "diagrams": [],
                  "threats": [],
                  "documents": [],
                  "repositories": [],
                  "notes": [],
                  "assets": []
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Models"
        ],
        "summary": "Delete a threat model",
        "description": "Deletes a threat model; restricted to owner role",
        "operationId": "deleteThreatModel",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "responses": {
          "204": {
            "description": "Threat model deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Conflict - Cannot delete threat model while a diagram has an active collaboration session",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/threats": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "List threats in a threat model",
        "description": "Returns a paginated list of threats within the specified threat model",
        "operationId": "getThreatModelThreats",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/PaginationLimit"
          },
          {
            "$ref": "#/components/parameters/PaginationOffset"
          },
          {
            "$ref": "#/components/parameters/SortQueryParam"
          },
          {
            "$ref": "#/components/parameters/NameQueryParam"
          },
          {
            "$ref": "#/components/parameters/DescriptionQueryParam"
          },
          {
            "$ref": "#/components/parameters/ThreatTypeQueryParam"
          },
          {
            "$ref": "#/components/parameters/SeverityQueryParam"
          },
          {
            "$ref": "#/components/parameters/PriorityQueryParam"
          },
          {
            "$ref": "#/components/parameters/StatusQueryParam"
          },
          {
            "$ref": "#/components/parameters/DiagramIdQueryParam"
          },
          {
            "$ref": "#/components/parameters/CellIdQueryParam"
          },
          {
            "$ref": "#/components/parameters/ScoreGtQueryParam"
          },
          {
            "$ref": "#/components/parameters/ScoreLtQueryParam"
          },
          {
            "$ref": "#/components/parameters/ScoreEqQueryParam"
          },
          {
            "$ref": "#/components/parameters/ScoreGeQueryParam"
          },
          {
            "$ref": "#/components/parameters/ScoreLeQueryParam"
          },
          {
            "$ref": "#/components/parameters/CreatedAfter"
          },
          {
            "$ref": "#/components/parameters/CreatedBefore"
          },
          {
            "$ref": "#/components/parameters/ModifiedAfter"
          },
          {
            "$ref": "#/components/parameters/ModifiedBefore"
          }
        ],
        "responses": {
          "200": {
            "description": "List of threats",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListThreatsResponse"
                },
                "examples": {
                  "threatList": {
                    "summary": "List of threats with metadata",
                    "value": {
                      "threats": [
                        {
                          "id": "550e8400-e29b-41d4-a716-446655440003",
                          "threat_type": [
                            "spoofing"
                          ],
                          "name": "SQL Injection Vulnerability",
                          "description": "Database injection through malicious SQL queries",
                          "severity": "High",
                          "priority": "urgent",
                          "status": "active",
                          "mitigated": false,
                          "threat_model_id": "550e8400-e29b-41d4-a716-446655440000",
                          "created_at": "2025-01-15T10:30:00Z",
                          "modified_at": "2025-01-15T14:45:00Z",
                          "metadata": [],
                          "include_in_report": true
                        },
                        {
                          "id": "550e8400-e29b-41d4-a716-446655440004",
                          "threat_type": [
                            "tampering"
                          ],
                          "name": "Cross-Site Scripting (XSS)",
                          "description": "Client-side script injection vulnerability",
                          "severity": "Medium",
                          "priority": "medium",
                          "status": "identified",
                          "mitigated": false,
                          "threat_model_id": "550e8400-e29b-41d4-a716-446655440000",
                          "created_at": "2025-01-15T11:00:00Z",
                          "modified_at": "2025-01-15T11:00:00Z",
                          "metadata": [],
                          "include_in_report": true
                        }
                      ],
                      "total": 2,
                      "limit": 20,
                      "offset": 0
                    }
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create a new threat",
        "description": "Creates a new threat within the specified threat model",
        "operationId": "createThreatModelThreat",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ThreatInput"
              }
            }
          },
          "description": "Threat creation data"
        },
        "responses": {
          "201": {
            "description": "Threat created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Threat"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/threats/{threat_id}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get a specific threat",
        "description": "Returns details of a specific threat within the threat model",
        "operationId": "getThreatModelThreat",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/ThreatId"
          }
        ],
        "responses": {
          "200": {
            "description": "Threat details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Threat"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update a threat",
        "description": "Updates a specific threat within the threat model",
        "operationId": "updateThreatModelThreat",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/ThreatId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ThreatInput"
              }
            }
          },
          "description": "Complete threat data for replacement"
        },
        "responses": {
          "200": {
            "description": "Threat updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Threat"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Partially update a threat",
        "description": "Applies JSON patch operations to a specific threat within the threat model",
        "operationId": "patchThreatModelThreat",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/ThreatId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json-patch+json": {
              "schema": {
                "$ref": "#/components/schemas/JsonPatchDocument"
              },
              "examples": {
                "updateThreatDetails": {
                  "summary": "Update threat name and severity",
                  "value": [
                    {
                      "op": "replace",
                      "path": "/name",
                      "value": "Updated SQL Injection Threat"
                    },
                    {
                      "op": "replace",
                      "path": "/severity",
                      "value": "Critical"
                    },
                    {
                      "op": "replace",
                      "path": "/description",
                      "value": "Updated description with more details"
                    }
                  ]
                },
                "addMetadata": {
                  "summary": "Add metadata to a threat",
                  "value": [
                    {
                      "op": "add",
                      "path": "/metadata/-",
                      "value": {
                        "key": "priority",
                        "value": "urgent"
                      }
                    },
                    {
                      "op": "add",
                      "path": "/metadata/-",
                      "value": {
                        "key": "assigned_to",
                        "value": "security-team"
                      }
                    }
                  ]
                },
                "updateStatus": {
                  "summary": "Update threat status and mitigation",
                  "value": [
                    {
                      "op": "replace",
                      "path": "/status",
                      "value": "mitigated"
                    },
                    {
                      "op": "replace",
                      "path": "/mitigated",
                      "value": true
                    },
                    {
                      "op": "replace",
                      "path": "/mitigation",
                      "value": "Implemented input validation and parameterized queries"
                    }
                  ]
                }
              }
            }
          },
          "description": "JSON Patch operations to apply to the threat"
        },
        "responses": {
          "200": {
            "description": "Threat patched successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Threat"
                },
                "examples": {
                  "patchedThreat": {
                    "summary": "Successfully patched threat with updated fields",
                    "value": {
                      "id": "550e8400-e29b-41d4-a716-446655440003",
                      "name": "Updated SQL Injection Threat",
                      "description": "Updated description with more details",
                      "severity": "Critical",
                      "priority": "urgent",
                      "status": "active",
                      "mitigated": false,
                      "threat_model_id": "550e8400-e29b-41d4-a716-446655440000",
                      "created_at": "2025-01-15T10:30:00Z",
                      "modified_at": "2025-01-15T14:45:00Z",
                      "metadata": [
                        {
                          "key": "priority",
                          "value": "urgent"
                        },
                        {
                          "key": "assigned_to",
                          "value": "security-team"
                        },
                        {
                          "key": "cve_reference",
                          "value": "CVE-2024-1234"
                        }
                      ],
                      "threat_type": [
                        "tampering"
                      ],
                      "include_in_report": true
                    }
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete a threat",
        "description": "Deletes a specific threat from the threat model",
        "operationId": "deleteThreatModelThreat",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/ThreatId"
          }
        ],
        "responses": {
          "204": {
            "description": "Threat deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/threats/{threat_id}/metadata": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get threat metadata",
        "description": "Returns all metadata key-value pairs for the specified threat",
        "operationId": "getThreatMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/ThreatId"
          }
        ],
        "responses": {
          "200": {
            "description": "Threat metadata list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create threat metadata",
        "description": "Creates new metadata entry for the specified threat. Returns 409 Conflict if the key already exists.",
        "operationId": "createThreatMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/ThreatId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          },
          "description": "Metadata key-value pair to create"
        },
        "responses": {
          "201": {
            "description": "Metadata entry created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "409": {
            "description": "Conflict - Metadata key already exists for this entity",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/threats/{threat_id}/metadata/{key}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get threat metadata by key",
        "description": "Returns a specific metadata entry by key for the specified threat",
        "operationId": "getThreatMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/ThreatId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "responses": {
          "200": {
            "description": "Metadata entry",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update threat metadata by key",
        "description": "Updates a specific metadata entry by key for the specified threat",
        "operationId": "updateThreatMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/ThreatId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "value": {
                    "type": "string",
                    "description": "New value for the metadata entry",
                    "maxLength": 1000,
                    "pattern": "^[^\\x00-\\x1F]*$",
                    "example": "example-metadata-value"
                  }
                },
                "required": [
                  "value"
                ],
                "additionalProperties": false
              },
              "example": {
                "value": "example-metadata-value"
              }
            }
          },
          "description": "Metadata value to set"
        },
        "responses": {
          "200": {
            "description": "Metadata entry updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete threat metadata by key",
        "description": "Deletes a specific metadata entry by key for the specified threat",
        "operationId": "deleteThreatMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/ThreatId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "responses": {
          "204": {
            "description": "Metadata entry deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/threats/{threat_id}/metadata/bulk": {
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create threat metadata",
        "description": "Creates multiple metadata entries in a single operation for the specified threat. Returns 409 Conflict if any of the specified keys already exist.",
        "operationId": "bulkCreateThreatMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/ThreatId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          },
          "description": "Bulk metadata key-value pairs to create"
        },
        "responses": {
          "201": {
            "description": "Metadata entries created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "409": {
            "description": "Conflict - One or more metadata keys already exist for this entity",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk replace threat metadata",
        "description": "Replaces all metadata for the entity. All existing metadata is deleted and replaced with the provided set. To clear all metadata, send an empty array.",
        "operationId": "bulkReplaceThreatMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/ThreatId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          },
          "description": "Complete set of metadata key-value pairs to replace existing metadata"
        },
        "responses": {
          "200": {
            "description": "Metadata replaced successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk upsert threat metadata",
        "description": "Creates or updates only the provided metadata keys. Keys not included in the request are left unchanged. This is a merge/upsert operation.",
        "operationId": "bulkUpsertThreatMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/ThreatId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          },
          "description": "Metadata key-value pairs to create or update (merge)"
        },
        "responses": {
          "200": {
            "description": "Metadata upserted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/threats/bulk": {
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create threats",
        "description": "Creates multiple threats in a single operation for the specified threat model",
        "operationId": "bulkCreateThreatModelThreats",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Threat"
                },
                "maxItems": 20,
                "description": "Array of threats to create"
              },
              "examples": {
                "bulkCreateThreats": {
                  "summary": "Create multiple threats at once",
                  "value": [
                    {
                      "name": "SQL Injection Attack",
                      "description": "Attacker injects malicious SQL code through user input",
                      "metadata": [
                        {
                          "key": "category",
                          "value": "injection"
                        },
                        {
                          "key": "stride",
                          "value": "tampering"
                        }
                      ],
                      "threat_type": [
                        "spoofing"
                      ]
                    },
                    {
                      "name": "Cross-Site Scripting (XSS)",
                      "threat_type": [
                        "information-disclosure"
                      ],
                      "description": "Malicious scripts executed in user's browser",
                      "severity": "Medium",
                      "status": "identified"
                    }
                  ]
                }
              }
            }
          },
          "description": "Array of threats to create in bulk"
        },
        "responses": {
          "201": {
            "description": "Threats created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Threat"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk update threats",
        "description": "Updates multiple threats in a single operation for the specified threat model",
        "operationId": "bulkUpdateThreatModelThreats",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/ThreatBulkUpdateItem"
                },
                "maxItems": 20,
                "description": "Array of threats to update (each must include id field)"
              },
              "examples": {
                "bulkUpdateThreats": {
                  "summary": "Update multiple threats at once",
                  "value": [
                    {
                      "id": "750e8400-e29b-41d4-a716-446655440001",
                      "name": "Updated SQL Injection Attack",
                      "description": "Updated description for SQL injection vulnerability",
                      "impact": "High",
                      "likelihood": "Low",
                      "risk_rating": "Medium",
                      "metadata": [
                        {
                          "key": "category",
                          "value": "injection"
                        },
                        {
                          "key": "mitigation",
                          "value": "parameterized-queries"
                        }
                      ],
                      "threat_type": [
                        "tampering"
                      ]
                    }
                  ]
                }
              }
            }
          },
          "description": "Array of threats to upsert in bulk"
        },
        "responses": {
          "200": {
            "description": "Threats updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Threat"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "summary": "Bulk PATCH threats",
        "description": "Apply JSON Patch operations to multiple threats. Each patch specifies a threat ID and an array of RFC 6902 operations to apply.",
        "operationId": "bulkPatchThreatModelThreats",
        "tags": [
          "Threats"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BulkPatchRequest"
              },
              "example": {
                "patches": [
                  {
                    "id": "750e8400-e29b-41d4-a716-446655440001",
                    "operations": [
                      {
                        "op": "replace",
                        "path": "/status",
                        "value": "Closed"
                      }
                    ]
                  }
                ]
              }
            }
          },
          "description": "JSON Patch operations to apply to multiple threats"
        },
        "responses": {
          "200": {
            "description": "Successfully patched threats",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Threat"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "summary": "Bulk DELETE threats",
        "description": "Delete multiple threats in a single request",
        "operationId": "bulkDeleteThreatModelThreats",
        "tags": [
          "Threats"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/ThreatIdsQueryParam"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully deleted threats",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "deleted_count": {
                      "type": "integer",
                      "description": "Number of threats deleted",
                      "example": 3
                    },
                    "deleted_ids": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "format": "uuid",
                        "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
                        "maxLength": 36
                      },
                      "description": "IDs of deleted threats",
                      "maxItems": 1000,
                      "example": [
                        "550e8400-e29b-41d4-a716-446655440001",
                        "550e8400-e29b-41d4-a716-446655440002"
                      ]
                    }
                  },
                  "additionalProperties": false
                },
                "example": {
                  "deleted_count": 3
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/documents": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "List documents in a threat model",
        "description": "Returns a paginated list of documents within the specified threat model",
        "operationId": "getThreatModelDocuments",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/PaginationLimit"
          },
          {
            "$ref": "#/components/parameters/PaginationOffset"
          }
        ],
        "responses": {
          "200": {
            "description": "List of documents",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListDocumentsResponse"
                },
                "examples": {
                  "documentList": {
                    "summary": "List of documents with pagination",
                    "value": {
                      "documents": [
                        {
                          "id": "770e8400-e29b-41d4-a716-446655440008",
                          "name": "Security Architecture",
                          "description": "System security architecture document",
                          "created_at": "2025-01-10T09:00:00Z",
                          "modified_at": "2025-01-10T09:00:00Z",
                          "uri": "https://docs.example.com/security-arch.pdf"
                        }
                      ],
                      "total": 1,
                      "limit": 20,
                      "offset": 0
                    }
                  },
                  "emptyList": {
                    "summary": "Empty document list",
                    "value": {
                      "documents": [],
                      "total": 0,
                      "limit": 20,
                      "offset": 0
                    }
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create a new document",
        "description": "Creates a new document within the specified threat model",
        "operationId": "createThreatModelDocument",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DocumentInput"
              },
              "examples": {
                "createDocument": {
                  "summary": "Create a new security document",
                  "value": {
                    "name": "Security Requirements",
                    "description": "Application security requirements specification",
                    "uri": "https://docs.example.com/security-requirements.pdf"
                  }
                }
              }
            }
          },
          "description": "Document creation data"
        },
        "responses": {
          "201": {
            "description": "Document created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Document"
                },
                "examples": {
                  "createdDocument": {
                    "summary": "Successfully created document with generated ID",
                    "value": {
                      "name": "Security Requirements Document",
                      "description": "Detailed security requirements and compliance standards",
                      "uri": "https://docs.company.com/security-requirements.pdf",
                      "id": "770e8400-e29b-41d4-a716-446655440008"
                    }
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/documents/{document_id}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get a specific document",
        "description": "Returns details of a specific document within the threat model",
        "operationId": "getThreatModelDocument",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DocumentId"
          }
        ],
        "responses": {
          "200": {
            "description": "Document details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Document"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update a document",
        "description": "Updates a specific document within the threat model",
        "operationId": "updateThreatModelDocument",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DocumentId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DocumentInput"
              }
            }
          },
          "description": "Complete document data for replacement"
        },
        "responses": {
          "200": {
            "description": "Document updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Document"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete a document",
        "description": "Deletes a specific document from the threat model",
        "operationId": "deleteThreatModelDocument",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DocumentId"
          }
        ],
        "responses": {
          "204": {
            "description": "Document deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "summary": "Partially update document",
        "description": "Apply JSON Patch operations to partially update a document",
        "operationId": "patchThreatModelDocument",
        "tags": [
          "Documents"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DocumentId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json-patch+json": {
              "schema": {
                "$ref": "#/components/schemas/JsonPatchDocument"
              },
              "example": [
                {
                  "op": "replace",
                  "path": "/name",
                  "value": "Updated Name"
                },
                {
                  "op": "add",
                  "path": "/description",
                  "value": "New description"
                }
              ]
            }
          },
          "description": "JSON Patch operations to apply to the document"
        },
        "responses": {
          "200": {
            "description": "Successfully patched document",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Document"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/documents/{document_id}/metadata": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get document metadata",
        "description": "Returns all metadata key-value pairs for the specified document",
        "operationId": "getDocumentMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DocumentId"
          }
        ],
        "responses": {
          "200": {
            "description": "Document metadata list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create document metadata",
        "description": "Creates new metadata entry for the specified document. Returns 409 Conflict if the key already exists.",
        "operationId": "createDocumentMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DocumentId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          },
          "description": "Metadata key-value pair to create"
        },
        "responses": {
          "201": {
            "description": "Metadata entry created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "409": {
            "description": "Conflict - Metadata key already exists for this entity",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/documents/{document_id}/metadata/{key}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get document metadata by key",
        "description": "Returns a specific metadata entry by key for the specified document",
        "operationId": "getDocumentMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DocumentId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "responses": {
          "200": {
            "description": "Metadata entry",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update document metadata by key",
        "description": "Updates a specific metadata entry by key for the specified document",
        "operationId": "updateDocumentMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DocumentId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "value": {
                    "type": "string",
                    "description": "New value for the metadata entry",
                    "maxLength": 1000,
                    "pattern": "^[^\\x00-\\x1F]*$",
                    "example": "example-metadata-value"
                  }
                },
                "required": [
                  "value"
                ],
                "additionalProperties": false
              },
              "example": {
                "value": "example-metadata-value"
              }
            }
          },
          "description": "Metadata value to set"
        },
        "responses": {
          "200": {
            "description": "Metadata entry updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete document metadata by key",
        "description": "Deletes a specific metadata entry by key for the specified document",
        "operationId": "deleteDocumentMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DocumentId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "responses": {
          "204": {
            "description": "Metadata entry deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/documents/{document_id}/metadata/bulk": {
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create document metadata",
        "description": "Creates multiple metadata entries in a single operation for the specified document. Returns 409 Conflict if any of the specified keys already exist.",
        "operationId": "bulkCreateDocumentMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DocumentId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          },
          "description": "Bulk metadata key-value pairs to create"
        },
        "responses": {
          "201": {
            "description": "Metadata entries created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "409": {
            "description": "Conflict - One or more metadata keys already exist for this entity",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk replace document metadata",
        "description": "Replaces all metadata for the entity. All existing metadata is deleted and replaced with the provided set. To clear all metadata, send an empty array.",
        "operationId": "bulkReplaceDocumentMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DocumentId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          },
          "description": "Complete set of metadata key-value pairs to replace existing metadata"
        },
        "responses": {
          "200": {
            "description": "Metadata replaced successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk upsert document metadata",
        "description": "Creates or updates only the provided metadata keys. Keys not included in the request are left unchanged. This is a merge/upsert operation.",
        "operationId": "bulkUpsertDocumentMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DocumentId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          },
          "description": "Metadata key-value pairs to create or update (merge)"
        },
        "responses": {
          "200": {
            "description": "Metadata upserted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/documents/bulk": {
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create documents",
        "description": "Creates multiple documents in a single operation for the specified threat model",
        "operationId": "bulkCreateThreatModelDocuments",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Document"
                },
                "maxItems": 20,
                "description": "Array of documents to create"
              },
              "examples": {
                "bulkCreateDocuments": {
                  "summary": "Create multiple documents at once",
                  "value": [
                    {
                      "id": "770e8400-e29b-41d4-a716-446655440009",
                      "name": "Threat Model Report",
                      "uri": "https://docs.example.com/threat-report-v1.pdf",
                      "description": "Comprehensive threat assessment document",
                      "threat_model_id": "550e8400-e29b-41d4-a716-446655440000",
                      "created_at": "2025-01-10T09:00:00Z",
                      "modified_at": "2025-01-10T09:00:00Z"
                    },
                    {
                      "name": "Security Requirements",
                      "description": "Security requirements and compliance standards",
                      "metadata": [
                        {
                          "key": "classification",
                          "value": "internal"
                        },
                        {
                          "key": "department",
                          "value": "security"
                        }
                      ],
                      "uri": "https://docs.company.com/security.pdf",
                      "id": "550e8400-e29b-41d4-a716-446655440001"
                    }
                  ]
                }
              }
            }
          },
          "description": "Array of documents to create in bulk"
        },
        "responses": {
          "201": {
            "description": "Documents created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Document"
                  },
                  "maxItems": 1000
                },
                "examples": {
                  "bulkCreatedDocuments": {
                    "summary": "Successfully created documents with generated IDs",
                    "value": [
                      {
                        "name": "Architecture Document",
                        "description": "System architecture documentation",
                        "created_at": "2025-04-06T12:00:00Z",
                        "modified_at": "2025-04-06T12:00:00Z",
                        "uri": "https://docs.company.com/architecture.pdf",
                        "id": "770e8400-e29b-41d4-a716-446655440020"
                      },
                      {
                        "id": "550e8400-e29b-41d4-a716-446655440002",
                        "name": "Security Requirements",
                        "description": "Security requirements and compliance standards",
                        "metadata": [
                          {
                            "key": "classification",
                            "value": "internal"
                          },
                          {
                            "key": "department",
                            "value": "security"
                          }
                        ],
                        "created_at": "2025-04-06T12:00:00Z",
                        "modified_at": "2025-04-06T12:00:00Z",
                        "uri": "https://docs.company.com/security.pdf"
                      }
                    ]
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk upsert documents",
        "description": "Create or update multiple documents in a single request",
        "operationId": "bulkUpsertThreatModelDocuments",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Document"
                },
                "maxItems": 20,
                "description": "Array of documents to create"
              },
              "examples": {
                "bulkCreateDocuments": {
                  "summary": "Create multiple documents at once",
                  "value": [
                    {
                      "id": "770e8400-e29b-41d4-a716-446655440010",
                      "name": "Threat Model Report Updated",
                      "uri": "https://docs.example.com/threat-report-v2.pdf",
                      "description": "Updated threat assessment document",
                      "threat_model_id": "550e8400-e29b-41d4-a716-446655440000",
                      "created_at": "2025-01-10T09:00:00Z",
                      "modified_at": "2025-01-10T09:00:00Z"
                    },
                    {
                      "name": "Security Requirements",
                      "description": "Security requirements and compliance standards",
                      "metadata": [
                        {
                          "key": "classification",
                          "value": "internal"
                        },
                        {
                          "key": "department",
                          "value": "security"
                        }
                      ],
                      "uri": "https://docs.company.com/security.pdf",
                      "id": "550e8400-e29b-41d4-a716-446655440001"
                    }
                  ]
                }
              }
            }
          },
          "description": "Array of documents to upsert in bulk"
        },
        "responses": {
          "201": {
            "description": "Documents created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Document"
                  },
                  "maxItems": 1000
                },
                "examples": {
                  "bulkCreatedDocuments": {
                    "summary": "Successfully created documents with generated IDs",
                    "value": [
                      {
                        "name": "Architecture Document",
                        "description": "System architecture documentation",
                        "created_at": "2025-04-06T12:00:00Z",
                        "modified_at": "2025-04-06T12:00:00Z",
                        "uri": "https://docs.company.com/architecture.pdf",
                        "id": "770e8400-e29b-41d4-a716-446655440021"
                      },
                      {
                        "id": "550e8400-e29b-41d4-a716-446655440002",
                        "name": "Security Requirements",
                        "description": "Security requirements and compliance standards",
                        "metadata": [
                          {
                            "key": "classification",
                            "value": "internal"
                          },
                          {
                            "key": "department",
                            "value": "security"
                          }
                        ],
                        "created_at": "2025-04-06T12:00:00Z",
                        "modified_at": "2025-04-06T12:00:00Z",
                        "uri": "https://docs.company.com/security.pdf"
                      }
                    ]
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/repositories": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "List sources in a threat model",
        "description": "Returns a paginated list of source code references within the specified threat model",
        "operationId": "getThreatModelRepositories",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/PaginationLimit"
          },
          {
            "$ref": "#/components/parameters/PaginationOffset"
          }
        ],
        "responses": {
          "200": {
            "description": "List of source code references",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListRepositoriesResponse"
                },
                "examples": {
                  "sourceList": {
                    "summary": "List of source code references",
                    "value": {
                      "repositories": [
                        {
                          "id": "990e8400-e29b-41d4-a716-446655440011",
                          "name": "Main Application Repository",
                          "description": "Primary source code repository",
                          "uri": "https://github.com/example/application",
                          "created_at": "2025-01-12T08:00:00Z",
                          "modified_at": "2025-01-12T08:00:00Z"
                        }
                      ],
                      "total": 1,
                      "limit": 20,
                      "offset": 0
                    }
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create a new source reference",
        "description": "Creates a new source code reference within the specified threat model",
        "operationId": "createThreatModelRepository",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RepositoryInput"
              }
            }
          },
          "description": "Repository creation data"
        },
        "responses": {
          "201": {
            "description": "Source reference created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Repository"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/repositories/{repository_id}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get a specific source reference",
        "description": "Returns details of a specific source code reference within the threat model",
        "operationId": "getThreatModelRepository",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/RepositoryId"
          }
        ],
        "responses": {
          "200": {
            "description": "Source reference details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Repository"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update a source reference",
        "description": "Updates a specific source code reference within the threat model",
        "operationId": "updateThreatModelRepository",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/RepositoryId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RepositoryInput"
              }
            }
          },
          "description": "Complete repository data for replacement"
        },
        "responses": {
          "200": {
            "description": "Source reference updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Repository"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete a source reference",
        "description": "Deletes a specific source code reference from the threat model",
        "operationId": "deleteThreatModelRepository",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/RepositoryId"
          }
        ],
        "responses": {
          "204": {
            "description": "Source reference deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "summary": "Partially update repository",
        "description": "Apply JSON Patch operations to partially update a repository",
        "operationId": "patchThreatModelRepository",
        "tags": [
          "Repositories"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/RepositoryId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json-patch+json": {
              "schema": {
                "$ref": "#/components/schemas/JsonPatchDocument"
              },
              "example": [
                {
                  "op": "replace",
                  "path": "/name",
                  "value": "Updated Name"
                },
                {
                  "op": "add",
                  "path": "/description",
                  "value": "New description"
                }
              ]
            }
          },
          "description": "JSON Patch operations to apply to the repository"
        },
        "responses": {
          "200": {
            "description": "Successfully patched repository",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Repository"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/repositories/{repository_id}/metadata": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get source metadata",
        "description": "Returns all metadata key-value pairs for the specified source reference",
        "operationId": "getRepositoryMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/RepositoryId"
          }
        ],
        "responses": {
          "200": {
            "description": "Source metadata list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create source metadata",
        "description": "Creates new metadata entry for the specified source reference. Returns 409 Conflict if the key already exists.",
        "operationId": "createRepositoryMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/RepositoryId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          },
          "description": "Metadata key-value pair to create"
        },
        "responses": {
          "201": {
            "description": "Metadata entry created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "409": {
            "description": "Conflict - Metadata key already exists for this entity",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/repositories/{repository_id}/metadata/{key}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get source metadata by key",
        "description": "Returns a specific metadata entry by key for the specified source reference",
        "operationId": "getRepositoryMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/RepositoryId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "responses": {
          "200": {
            "description": "Metadata entry",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update source metadata by key",
        "description": "Updates a specific metadata entry by key for the specified source reference",
        "operationId": "updateRepositoryMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/RepositoryId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "value": {
                    "type": "string",
                    "description": "New value for the metadata entry",
                    "maxLength": 1000,
                    "pattern": "^[^\\x00-\\x1F]*$",
                    "example": "example-metadata-value"
                  }
                },
                "required": [
                  "value"
                ],
                "additionalProperties": false
              },
              "example": {
                "value": "example-metadata-value"
              }
            }
          },
          "description": "Metadata value to set"
        },
        "responses": {
          "200": {
            "description": "Metadata entry updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete source metadata by key",
        "description": "Deletes a specific metadata entry by key for the specified source reference",
        "operationId": "deleteRepositoryMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/RepositoryId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "responses": {
          "204": {
            "description": "Metadata entry deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/repositories/{repository_id}/metadata/bulk": {
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create source metadata",
        "description": "Creates multiple metadata entries in a single operation for the specified source reference. Returns 409 Conflict if any of the specified keys already exist.",
        "operationId": "bulkCreateRepositoryMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/RepositoryId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          },
          "description": "Bulk metadata key-value pairs to create"
        },
        "responses": {
          "201": {
            "description": "Metadata entries created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "409": {
            "description": "Conflict - One or more metadata keys already exist for this entity",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk replace repository metadata",
        "description": "Replaces all metadata for the entity. All existing metadata is deleted and replaced with the provided set. To clear all metadata, send an empty array.",
        "operationId": "bulkReplaceRepositoryMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/RepositoryId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          },
          "description": "Complete set of metadata key-value pairs to replace existing metadata"
        },
        "responses": {
          "200": {
            "description": "Metadata replaced successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk upsert repository metadata",
        "description": "Creates or updates only the provided metadata keys. Keys not included in the request are left unchanged. This is a merge/upsert operation.",
        "operationId": "bulkUpsertRepositoryMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/RepositoryId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          },
          "description": "Metadata key-value pairs to create or update (merge)"
        },
        "responses": {
          "200": {
            "description": "Metadata upserted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/repositories/bulk": {
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create sources",
        "description": "Creates multiple source references in a single operation for the specified threat model",
        "operationId": "bulkCreateThreatModelRepositories",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Repository"
                },
                "maxItems": 20,
                "description": "Array of source references to create"
              },
              "examples": {
                "bulkCreateSources": {
                  "summary": "Create multiple source references at once",
                  "value": [
                    {
                      "id": "990e8400-e29b-41d4-a716-446655440012",
                      "name": "API Repository",
                      "uri": "https://github.com/example/api",
                      "description": "Backend API source code",
                      "threat_model_id": "550e8400-e29b-41d4-a716-446655440000",
                      "created_at": "2025-01-12T08:00:00Z",
                      "modified_at": "2025-01-12T08:00:00Z"
                    },
                    {
                      "name": "Database Connection Pool",
                      "description": "Database connection management",
                      "metadata": [
                        {
                          "key": "type",
                          "value": "infrastructure"
                        },
                        {
                          "key": "criticality",
                          "value": "high"
                        }
                      ],
                      "uri": "https://github.com/company/repo/blob/main/db/pool.go",
                      "id": "550e8400-e29b-41d4-a716-446655440001"
                    }
                  ]
                }
              }
            }
          },
          "description": "Array of repositorys to create in bulk"
        },
        "responses": {
          "201": {
            "description": "Sources created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Repository"
                  },
                  "maxItems": 1000
                },
                "examples": {
                  "bulkCreatedSources": {
                    "summary": "Successfully created sources with generated IDs",
                    "value": [
                      {
                        "name": "User Authentication Module",
                        "description": "Core user authentication logic",
                        "created_at": "2025-04-06T12:00:00Z",
                        "modified_at": "2025-04-06T12:00:00Z",
                        "uri": "https://github.com/company/repo/blob/main/oauth2/user.go",
                        "id": "990e8400-e29b-41d4-a716-446655440022"
                      },
                      {
                        "id": "650e8400-e29b-41d4-a716-446655440002",
                        "name": "Database Connection Pool",
                        "description": "Database connection management",
                        "metadata": [
                          {
                            "key": "type",
                            "value": "infrastructure"
                          },
                          {
                            "key": "criticality",
                            "value": "high"
                          }
                        ],
                        "created_at": "2025-04-06T12:00:00Z",
                        "modified_at": "2025-04-06T12:00:00Z",
                        "uri": "https://github.com/company/repo/blob/main/db/pool.go"
                      }
                    ]
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk upsert repositories",
        "description": "Create or update multiple repositories in a single request",
        "operationId": "bulkUpsertThreatModelRepositories",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Repository"
                },
                "maxItems": 20,
                "description": "Array of source references to create"
              },
              "examples": {
                "bulkCreateSources": {
                  "summary": "Create multiple source references at once",
                  "value": [
                    {
                      "id": "990e8400-e29b-41d4-a716-446655440013",
                      "name": "API Repository Updated",
                      "uri": "https://github.com/example/api-v2",
                      "description": "Updated backend API source code",
                      "threat_model_id": "550e8400-e29b-41d4-a716-446655440000",
                      "created_at": "2025-01-12T08:00:00Z",
                      "modified_at": "2025-01-12T08:00:00Z"
                    },
                    {
                      "name": "Database Connection Pool",
                      "description": "Database connection management",
                      "metadata": [
                        {
                          "key": "type",
                          "value": "infrastructure"
                        },
                        {
                          "key": "criticality",
                          "value": "high"
                        }
                      ],
                      "uri": "https://github.com/company/repo/blob/main/db/pool.go",
                      "id": "550e8400-e29b-41d4-a716-446655440001"
                    }
                  ]
                }
              }
            }
          },
          "description": "Array of repositorys to upsert in bulk"
        },
        "responses": {
          "201": {
            "description": "Sources created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Repository"
                  },
                  "maxItems": 1000
                },
                "examples": {
                  "bulkCreatedSources": {
                    "summary": "Successfully created sources with generated IDs",
                    "value": [
                      {
                        "name": "User Authentication Module",
                        "description": "Core user authentication logic",
                        "created_at": "2025-04-06T12:00:00Z",
                        "modified_at": "2025-04-06T12:00:00Z",
                        "uri": "https://github.com/company/repo/blob/main/oauth2/user.go",
                        "id": "990e8400-e29b-41d4-a716-446655440023"
                      },
                      {
                        "id": "650e8400-e29b-41d4-a716-446655440002",
                        "name": "Database Connection Pool",
                        "description": "Database connection management",
                        "metadata": [
                          {
                            "key": "type",
                            "value": "infrastructure"
                          },
                          {
                            "key": "criticality",
                            "value": "high"
                          }
                        ],
                        "created_at": "2025-04-06T12:00:00Z",
                        "modified_at": "2025-04-06T12:00:00Z",
                        "uri": "https://github.com/company/repo/blob/main/db/pool.go"
                      }
                    ]
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/metadata": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get threat model metadata",
        "description": "Returns all metadata key-value pairs for the specified threat model",
        "operationId": "getThreatModelMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "responses": {
          "200": {
            "description": "Threat model metadata list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create threat model metadata",
        "description": "Creates new metadata entry for the specified threat model. Returns 409 Conflict if the key already exists.",
        "operationId": "createThreatModelMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          },
          "description": "Metadata key-value pair to create"
        },
        "responses": {
          "201": {
            "description": "Metadata entry created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "409": {
            "description": "Conflict - Metadata key already exists for this entity",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/metadata/{key}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get threat model metadata by key",
        "description": "Returns a specific metadata entry by key for the specified threat model",
        "operationId": "getThreatModelMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "responses": {
          "200": {
            "description": "Metadata entry",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update threat model metadata by key",
        "description": "Updates a specific metadata entry by key for the specified threat model",
        "operationId": "updateThreatModelMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "value": {
                    "type": "string",
                    "description": "New value for the metadata entry",
                    "maxLength": 1000,
                    "pattern": "^[^\\x00-\\x1F]*$",
                    "example": "example-metadata-value"
                  }
                },
                "required": [
                  "value"
                ],
                "additionalProperties": false
              },
              "example": {
                "value": "example-metadata-value"
              }
            }
          },
          "description": "Metadata value to set"
        },
        "responses": {
          "200": {
            "description": "Metadata entry updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete threat model metadata by key",
        "description": "Deletes a specific metadata entry by key for the specified threat model",
        "operationId": "deleteThreatModelMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "responses": {
          "204": {
            "description": "Metadata entry deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/metadata/bulk": {
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create threat model metadata",
        "description": "Creates multiple metadata entries in a single operation for the specified threat model. Returns 409 Conflict if any of the specified keys already exist.",
        "operationId": "bulkCreateThreatModelMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          },
          "description": "Bulk metadata key-value pairs to create"
        },
        "responses": {
          "201": {
            "description": "Metadata entries created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "409": {
            "description": "Conflict - One or more metadata keys already exist for this entity",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk replace threat model metadata",
        "description": "Replaces all metadata for the entity. All existing metadata is deleted and replaced with the provided set. To clear all metadata, send an empty array.",
        "operationId": "bulkReplaceThreatModelMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          },
          "description": "Complete set of metadata key-value pairs to replace existing metadata"
        },
        "responses": {
          "200": {
            "description": "Metadata replaced successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk upsert threat model metadata",
        "description": "Creates or updates only the provided metadata keys. Keys not included in the request are left unchanged. This is a merge/upsert operation.",
        "operationId": "bulkUpsertThreatModelMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          },
          "description": "Metadata key-value pairs to create or update (merge)"
        },
        "responses": {
          "200": {
            "description": "Metadata upserted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/diagrams": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "List threat model diagrams",
        "description": "Returns all diagrams associated with a specific threat model",
        "operationId": "getThreatModelDiagrams",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/PaginationLimit"
          },
          {
            "$ref": "#/components/parameters/PaginationOffset"
          }
        ],
        "responses": {
          "200": {
            "description": "List of diagrams",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListDiagramsResponse"
                },
                "example": {
                  "diagrams": [
                    {
                      "id": "880e8400-e29b-41d4-a716-446655440003",
                      "name": "Payment Flow Data Flow Diagram",
                      "type": "DFD-1.0.0",
                      "description": "Data flow diagram showing payment processing flow",
                      "created_at": "2025-01-15T10:30:00Z",
                      "modified_at": "2025-01-15T14:22:00Z",
                      "image": null
                    }
                  ],
                  "total": 5,
                  "limit": 20,
                  "offset": 0
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create a new diagram",
        "description": "Creates a new diagram within the specified threat model",
        "operationId": "createThreatModelDiagram",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateDiagramRequest"
              }
            }
          },
          "description": "Diagram creation data"
        },
        "responses": {
          "201": {
            "description": "Diagram created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DfdDiagram"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/diagrams/{diagram_id}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get a specific diagram",
        "description": "Retrieves a specific diagram from the threat model",
        "operationId": "getThreatModelDiagram",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DiagramId"
          }
        ],
        "responses": {
          "200": {
            "description": "Diagram details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DfdDiagram"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update a diagram",
        "description": "Completely replaces a diagram with new data. Use DfdDiagramInput schema which excludes readOnly fields (id, created_at, modified_at, update_vector).",
        "operationId": "updateThreatModelDiagram",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DiagramId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DfdDiagramInput"
              }
            }
          },
          "description": "Complete diagram data for replacement"
        },
        "responses": {
          "200": {
            "description": "Diagram updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DfdDiagram"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "409": {
            "description": "Conflict - Cannot modify diagram while collaboration session is active",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Partially update a diagram",
        "description": "Apply JSON Patch operations to update specific parts of a diagram",
        "operationId": "patchThreatModelDiagram",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DiagramId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json-patch+json": {
              "schema": {
                "$ref": "#/components/schemas/JsonPatchDocument"
              },
              "examples": {
                "updateName": {
                  "summary": "Update diagram name",
                  "value": [
                    {
                      "op": "replace",
                      "path": "/name",
                      "value": "Updated Diagram Name"
                    }
                  ]
                },
                "addCell": {
                  "summary": "Add a new cell to the diagram",
                  "value": [
                    {
                      "op": "add",
                      "path": "/cells/-",
                      "value": {
                        "id": "new-cell-id",
                        "shape": "process",
                        "x": 100,
                        "y": 100,
                        "width": 120,
                        "height": 60,
                        "label": "New Process"
                      }
                    }
                  ]
                },
                "addMetadata": {
                  "summary": "Add metadata to diagram",
                  "value": [
                    {
                      "op": "add",
                      "path": "/metadata/-",
                      "value": {
                        "key": "version",
                        "value": "2.0"
                      }
                    }
                  ]
                }
              }
            }
          },
          "description": "JSON Patch operations to apply to the diagram"
        },
        "responses": {
          "200": {
            "description": "Diagram updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DfdDiagram"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "422": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "409": {
            "description": "Conflict - Cannot modify diagram while collaboration session is active",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete a diagram",
        "description": "Permanently removes a diagram from the threat model",
        "operationId": "deleteThreatModelDiagram",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DiagramId"
          }
        ],
        "responses": {
          "204": {
            "description": "Diagram deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Conflict - Cannot delete diagram while collaboration session is active",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/diagrams/{diagram_id}/collaborate": {
      "get": {
        "tags": [
          "Collaboration"
        ],
        "summary": "Get diagram collaboration session",
        "description": "Retrieves the current collaboration session details for a diagram. The session payload indicates who has been authorized to the session, not who is currently active in the WebSocket session. The 200 status indicates successful retrieval - clients must NOT evaluate the payload to determine session status.",
        "operationId": "getDiagramCollaborationSession",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DiagramId"
          }
        ],
        "responses": {
          "200": {
            "description": "Collaboration session details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CollaborationSession"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Collaboration"
        ],
        "summary": "Create diagram collaboration session",
        "description": "Creates a new collaboration session for real-time diagram editing. Only one collaboration session can exist per diagram at a time. If a session already exists, returns 409 with a link to join the existing session.",
        "operationId": "createDiagramCollaborationSession",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DiagramId"
          }
        ],
        "responses": {
          "201": {
            "description": "Collaboration session created successfully. The 201 status indicates successful creation - clients must NOT evaluate the payload to determine success.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CollaborationSession"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "409": {
            "description": "Collaboration session already exists for this diagram",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": [
                    "error",
                    "join_url"
                  ],
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message indicating session already exists",
                      "maxLength": 1000,
                      "example": "collaboration_session_exists"
                    },
                    "join_url": {
                      "type": "string",
                      "description": "URL to join the existing collaboration session",
                      "example": "http://localhost:8080/threat_models/{threat_model_id}/diagrams/{diagram_id}/collaborate",
                      "pattern": "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\s*$",
                      "maxLength": 1024
                    }
                  },
                  "additionalProperties": false
                },
                "example": {
                  "error": "collaboration_session_exists",
                  "join_url": "http://localhost:8080/ws/diagrams/550e8400-e29b-41d4-a716-446655440000"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Collaboration"
        ],
        "summary": "End diagram collaboration session",
        "description": "Terminates the active collaboration session for a diagram",
        "operationId": "endDiagramCollaborationSession",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DiagramId"
          }
        ],
        "responses": {
          "204": {
            "description": "Collaboration session ended successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/diagrams/{diagram_id}/metadata": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get diagram metadata",
        "description": "Retrieves all metadata entries for the specified diagram",
        "operationId": "getDiagramMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DiagramId"
          }
        ],
        "responses": {
          "200": {
            "description": "List of metadata entries",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create diagram metadata",
        "description": "Creates a new metadata entry for the specified diagram. Returns 409 Conflict if the key already exists.",
        "operationId": "createDiagramMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DiagramId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          },
          "description": "Metadata key-value pair to create"
        },
        "responses": {
          "201": {
            "description": "Metadata entry created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "409": {
            "description": "Conflict - Metadata key already exists for this entity",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/diagrams/{diagram_id}/metadata/{key}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get diagram metadata by key",
        "description": "Retrieves a specific metadata entry for the diagram by key",
        "operationId": "getDiagramMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DiagramId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "responses": {
          "200": {
            "description": "Metadata entry",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update diagram metadata by key",
        "description": "Updates or creates a metadata entry for the diagram with the specified key",
        "operationId": "updateDiagramMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DiagramId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "value": {
                    "type": "string",
                    "maxLength": 1024,
                    "description": "Metadata value",
                    "pattern": "^[^\\x00-\\x1F]*$",
                    "example": "example-metadata-value"
                  }
                },
                "required": [
                  "value"
                ],
                "additionalProperties": false
              },
              "example": {
                "value": "example-metadata-value"
              }
            }
          },
          "description": "Metadata value to set"
        },
        "responses": {
          "200": {
            "description": "Metadata entry updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete diagram metadata by key",
        "description": "Removes a specific metadata entry for the diagram by key",
        "operationId": "deleteDiagramMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DiagramId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "responses": {
          "204": {
            "description": "Metadata entry deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/diagrams/{diagram_id}/metadata/bulk": {
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create diagram metadata",
        "description": "Creates multiple metadata entries in a single operation for the specified diagram. Returns 409 Conflict if any of the specified keys already exist.",
        "operationId": "bulkCreateDiagramMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DiagramId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          },
          "description": "Bulk metadata key-value pairs to create"
        },
        "responses": {
          "201": {
            "description": "Metadata entries created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "409": {
            "description": "Conflict - One or more metadata keys already exist for this entity",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk replace diagram metadata",
        "description": "Replaces all metadata for the entity. All existing metadata is deleted and replaced with the provided set. To clear all metadata, send an empty array.",
        "operationId": "bulkReplaceDiagramMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DiagramId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          },
          "description": "Complete set of metadata key-value pairs to replace existing metadata"
        },
        "responses": {
          "200": {
            "description": "Metadata replaced successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk upsert diagram metadata",
        "description": "Creates or updates only the provided metadata keys. Keys not included in the request are left unchanged. This is a merge/upsert operation.",
        "operationId": "bulkUpsertDiagramMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/DiagramId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          },
          "description": "Metadata key-value pairs to create or update (merge)"
        },
        "responses": {
          "200": {
            "description": "Metadata upserted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/me": {
      "delete": {
        "summary": "Delete authenticated user account and all data",
        "description": "Two-step deletion process:\n1. First call (no challenge parameter) - Returns challenge string\n2. Second call (with challenge parameter) - Confirms deletion\n\nOwnership behavior:\n- Shared threat models: Transfers ownership to another owner from authorization list\n- Unshared threat models: Deletes completely along with all child resources",
        "operationId": "deleteUserAccount",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ChallengeQueryParam"
          }
        ],
        "responses": {
          "200": {
            "description": "Challenge issued (step 1)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeletionChallenge"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "204": {
            "description": "User deleted successfully (step 2)",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid or expired challenge, or challenge provided on first request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - valid JWT token required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "get": {
        "tags": [
          "Authentication"
        ],
        "summary": "Get current user profile",
        "description": "Returns detailed information about the currently authenticated user including groups and identity provider",
        "operationId": "getCurrentUserProfile",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Current user profile",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserWithAdminStatus"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        },
        "x-skip-deleted-resource-check": true,
        "x-skip-deleted-resource-check-reason": "GET /me returns current user profile - user cannot delete themselves and then expect 404"
      }
    },
    "/threat_models/{threat_model_id}/notes": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "List notes in a threat model",
        "description": "Returns a paginated list of notes within the specified threat model",
        "operationId": "getThreatModelNotes",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/PaginationLimit"
          },
          {
            "$ref": "#/components/parameters/PaginationOffset"
          }
        ],
        "responses": {
          "200": {
            "description": "List of notes",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListNotesResponse"
                },
                "example": {
                  "notes": [
                    {
                      "id": "ff0e8400-e29b-41d4-a716-44665544000a",
                      "name": "Security Review Notes",
                      "created_at": "2024-01-17T14:30:00Z",
                      "modified_at": "2024-01-17T15:00:00Z"
                    }
                  ],
                  "total": 12,
                  "limit": 20,
                  "offset": 0
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create a new note",
        "description": "Creates a new note within the specified threat model",
        "operationId": "createThreatModelNote",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NoteInput"
              }
            }
          },
          "description": "Note creation data"
        },
        "responses": {
          "201": {
            "description": "Note created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Note"
                },
                "example": {
                  "id": "550e8400-e29b-41d4-a716-446655440001",
                  "name": "Security Analysis Notes",
                  "content": "Initial security analysis of the authentication flow.",
                  "created_at": "2026-01-15T10:00:00Z",
                  "modified_at": "2026-01-15T10:00:00Z"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/notes/{note_id}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get a specific note",
        "description": "Returns details of a specific note within the threat model",
        "operationId": "getThreatModelNote",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/NoteId"
          }
        ],
        "responses": {
          "200": {
            "description": "Note details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Note"
                },
                "example": {
                  "id": "550e8400-e29b-41d4-a716-446655440001",
                  "name": "Security Analysis Notes",
                  "content": "Initial security analysis of the authentication flow.",
                  "created_at": "2026-01-15T10:00:00Z",
                  "modified_at": "2026-01-16T14:30:00Z"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update a note",
        "description": "Updates a specific note within the threat model",
        "operationId": "updateThreatModelNote",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/NoteId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NoteInput"
              }
            }
          },
          "description": "Complete note data for replacement"
        },
        "responses": {
          "200": {
            "description": "Note updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Note"
                },
                "example": {
                  "id": "550e8400-e29b-41d4-a716-446655440001",
                  "name": "Security Analysis Notes - Replaced",
                  "content": "Completely revised security analysis document.",
                  "created_at": "2026-01-15T10:00:00Z",
                  "modified_at": "2026-01-17T09:00:00Z"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete a note",
        "description": "Deletes a specific note from the threat model",
        "operationId": "deleteThreatModelNote",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/NoteId"
          }
        ],
        "responses": {
          "204": {
            "description": "Note deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "summary": "Partially update note",
        "description": "Apply JSON Patch operations to partially update a note",
        "operationId": "patchThreatModelNote",
        "tags": [
          "Notes"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/NoteId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json-patch+json": {
              "schema": {
                "$ref": "#/components/schemas/JsonPatchDocument"
              },
              "example": [
                {
                  "op": "replace",
                  "path": "/name",
                  "value": "Updated Name"
                },
                {
                  "op": "add",
                  "path": "/description",
                  "value": "New description"
                }
              ]
            }
          },
          "description": "JSON Patch operations to apply to the note"
        },
        "responses": {
          "200": {
            "description": "Successfully patched note",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Note"
                },
                "example": {
                  "id": "550e8400-e29b-41d4-a716-446655440001",
                  "name": "Security Analysis Notes - Updated",
                  "content": "Updated security analysis with additional findings.",
                  "created_at": "2026-01-15T10:00:00Z",
                  "modified_at": "2026-01-17T09:00:00Z"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/notes/{note_id}/metadata": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get note metadata",
        "description": "Returns all metadata key-value pairs for the specified note",
        "operationId": "getNoteMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/NoteId"
          }
        ],
        "responses": {
          "200": {
            "description": "Note metadata list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create note metadata",
        "description": "Creates new metadata entry for the specified note. Returns 409 Conflict if the key already exists.",
        "operationId": "createNoteMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/NoteId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          },
          "description": "Metadata key-value pair to create"
        },
        "responses": {
          "201": {
            "description": "Metadata entry created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "409": {
            "description": "Conflict - Metadata key already exists for this entity",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/notes/{note_id}/metadata/{key}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get note metadata by key",
        "description": "Returns a specific metadata entry by key for the specified note",
        "operationId": "getNoteMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/NoteId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "responses": {
          "200": {
            "description": "Metadata entry",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update note metadata by key",
        "description": "Updates a specific metadata entry by key for the specified note",
        "operationId": "updateNoteMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/NoteId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "value": {
                    "type": "string",
                    "description": "New value for the metadata entry",
                    "maxLength": 1000,
                    "pattern": "^[^\\x00-\\x1F]*$",
                    "example": "example-metadata-value"
                  }
                },
                "required": [
                  "value"
                ],
                "additionalProperties": false
              },
              "example": {
                "value": "example-metadata-value"
              }
            }
          },
          "description": "Metadata value to set"
        },
        "responses": {
          "200": {
            "description": "Metadata entry updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete note metadata by key",
        "description": "Deletes a specific metadata entry by key for the specified note",
        "operationId": "deleteNoteMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/NoteId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "responses": {
          "204": {
            "description": "Metadata entry deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/notes/{note_id}/metadata/bulk": {
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk replace note metadata",
        "description": "Replaces all metadata for the entity. All existing metadata is deleted and replaced with the provided set. To clear all metadata, send an empty array.",
        "operationId": "bulkReplaceNoteMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/NoteId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 100
              }
            }
          },
          "description": "Complete set of metadata key-value pairs to replace existing metadata"
        },
        "responses": {
          "200": {
            "description": "Metadata replaced successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create note metadata",
        "description": "Creates multiple metadata key-value pairs for the specified note. Returns 409 Conflict if any of the specified keys already exist.",
        "operationId": "bulkCreateNoteMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/NoteId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 100
              }
            }
          },
          "description": "Bulk metadata key-value pairs to create"
        },
        "responses": {
          "201": {
            "description": "Metadata created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "409": {
            "description": "Conflict - One or more metadata keys already exist for this entity",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk upsert note metadata",
        "description": "Creates or updates only the provided metadata keys. Keys not included in the request are left unchanged. This is a merge/upsert operation.",
        "operationId": "bulkUpsertNoteMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/NoteId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 100
              }
            }
          },
          "description": "Metadata key-value pairs to create or update (merge)"
        },
        "responses": {
          "200": {
            "description": "Metadata upserted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/assets": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "List assets in a threat model",
        "description": "Returns a paginated list of assets within the specified threat model",
        "operationId": "getThreatModelAssets",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/PaginationLimit"
          },
          {
            "$ref": "#/components/parameters/PaginationOffset"
          }
        ],
        "responses": {
          "200": {
            "description": "List of assets",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListAssetsResponse"
                },
                "example": {
                  "assets": [
                    {
                      "id": "550e8400-e29b-41d4-a716-446655440001",
                      "name": "User Database",
                      "type": "data",
                      "description": "Primary database storing user credentials",
                      "created_at": "2026-01-15T10:00:00Z",
                      "modified_at": "2026-01-16T14:30:00Z"
                    }
                  ],
                  "total": 1,
                  "limit": 20,
                  "offset": 0
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create a new asset",
        "description": "Creates a new asset within the specified threat model",
        "operationId": "createThreatModelAsset",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AssetInput"
              }
            }
          },
          "description": "Asset creation data"
        },
        "responses": {
          "201": {
            "description": "Asset created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Asset"
                },
                "example": {
                  "id": "550e8400-e29b-41d4-a716-446655440001",
                  "name": "User Database",
                  "type": "data",
                  "description": "Primary database storing user credentials",
                  "created_at": "2026-01-15T10:00:00Z",
                  "modified_at": "2026-01-16T14:30:00Z"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/assets/bulk": {
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create assets",
        "description": "Creates multiple assets within the specified threat model (maximum 50 per request)",
        "operationId": "bulkCreateThreatModelAssets",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/AssetBase"
                },
                "maxItems": 50
              },
              "example": [
                {
                  "name": "API Gateway",
                  "type": "software",
                  "description": "Main API gateway service"
                },
                {
                  "name": "Redis Cache",
                  "type": "infrastructure",
                  "description": "Caching layer"
                }
              ]
            }
          },
          "description": "Array of assets to create in bulk"
        },
        "responses": {
          "201": {
            "description": "Assets created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Asset"
                  },
                  "maxItems": 1000
                },
                "example": [
                  {
                    "id": "550e8400-e29b-41d4-a716-446655440001",
                    "name": "API Gateway",
                    "type": "software",
                    "description": "Main API gateway service",
                    "created_at": "2026-01-17T10:00:00Z",
                    "modified_at": "2026-01-17T10:00:00Z"
                  },
                  {
                    "id": "550e8400-e29b-41d4-a716-446655440002",
                    "name": "Redis Cache",
                    "type": "infrastructure",
                    "description": "Caching layer",
                    "created_at": "2026-01-17T10:00:00Z",
                    "modified_at": "2026-01-17T10:00:00Z"
                  }
                ]
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk upsert assets",
        "description": "Create or update multiple assets in a single request",
        "operationId": "bulkUpsertThreatModelAssets",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Asset"
                },
                "maxItems": 50
              },
              "example": [
                {
                  "id": "550e8400-e29b-41d4-a716-446655440001",
                  "name": "API Gateway Updated",
                  "type": "software",
                  "description": "Updated gateway service"
                }
              ]
            }
          },
          "description": "Array of assets to upsert in bulk"
        },
        "responses": {
          "201": {
            "description": "Assets created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Asset"
                  },
                  "maxItems": 1000
                },
                "example": [
                  {
                    "id": "550e8400-e29b-41d4-a716-446655440001",
                    "name": "API Gateway Updated",
                    "type": "software",
                    "description": "Updated gateway service",
                    "created_at": "2026-01-17T10:00:00Z",
                    "modified_at": "2026-01-17T11:00:00Z"
                  }
                ]
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/assets/{asset_id}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get a specific asset",
        "description": "Returns a single asset by its ID",
        "operationId": "getThreatModelAsset",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/AssetId"
          }
        ],
        "responses": {
          "200": {
            "description": "Asset details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Asset"
                },
                "example": {
                  "id": "550e8400-e29b-41d4-a716-446655440001",
                  "name": "User Database",
                  "type": "data",
                  "description": "Primary database storing user credentials",
                  "created_at": "2026-01-15T10:00:00Z",
                  "modified_at": "2026-01-16T14:30:00Z"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update an asset",
        "description": "Updates an existing asset within the specified threat model",
        "operationId": "updateThreatModelAsset",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/AssetId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AssetInput"
              }
            }
          },
          "description": "Complete asset data for replacement"
        },
        "responses": {
          "200": {
            "description": "Asset updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Asset"
                },
                "example": {
                  "id": "550e8400-e29b-41d4-a716-446655440001",
                  "name": "User Database",
                  "type": "data",
                  "description": "Primary database storing user credentials - replaced",
                  "created_at": "2026-01-15T10:00:00Z",
                  "modified_at": "2026-01-17T09:00:00Z"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete an asset",
        "description": "Deletes an asset from the specified threat model",
        "operationId": "deleteThreatModelAsset",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/AssetId"
          }
        ],
        "responses": {
          "204": {
            "description": "Asset deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "summary": "Partially update asset",
        "description": "Apply JSON Patch operations to partially update a asset",
        "operationId": "patchThreatModelAsset",
        "tags": [
          "Assets"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/AssetId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json-patch+json": {
              "schema": {
                "$ref": "#/components/schemas/JsonPatchDocument"
              },
              "example": [
                {
                  "op": "replace",
                  "path": "/name",
                  "value": "Updated Name"
                },
                {
                  "op": "add",
                  "path": "/description",
                  "value": "New description"
                }
              ]
            }
          },
          "description": "JSON Patch operations to apply to the asset"
        },
        "responses": {
          "200": {
            "description": "Successfully patched asset",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Asset"
                },
                "example": {
                  "id": "550e8400-e29b-41d4-a716-446655440001",
                  "name": "User Database",
                  "type": "data",
                  "description": "Primary database storing user credentials - updated",
                  "created_at": "2026-01-15T10:00:00Z",
                  "modified_at": "2026-01-17T09:00:00Z"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/assets/{asset_id}/metadata": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get all metadata for an asset",
        "description": "Returns all metadata key-value pairs for the specified asset",
        "operationId": "getThreatModelAssetMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/AssetId"
          }
        ],
        "responses": {
          "200": {
            "description": "Asset metadata",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Add metadata to an asset",
        "description": "Adds a new metadata key-value pair to the specified asset. Returns 409 Conflict if the key already exists.",
        "operationId": "createThreatModelAssetMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/AssetId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          },
          "description": "Metadata key-value pair to create"
        },
        "responses": {
          "201": {
            "description": "Metadata created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "409": {
            "description": "Conflict - Metadata key already exists for this entity",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/assets/{asset_id}/metadata/{key}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get specific metadata for an asset",
        "description": "Returns a single metadata value by its key",
        "operationId": "getThreatModelAssetMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/AssetId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "responses": {
          "200": {
            "description": "Metadata value",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update asset metadata",
        "description": "Updates an existing metadata value by its key",
        "operationId": "updateThreatModelAssetMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/AssetId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          },
          "description": "Metadata value to set"
        },
        "responses": {
          "200": {
            "description": "Metadata updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete asset metadata",
        "description": "Deletes a metadata key-value pair from the specified asset",
        "operationId": "deleteThreatModelAssetMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/AssetId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "responses": {
          "204": {
            "description": "Metadata deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/assets/{asset_id}/metadata/bulk": {
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create asset metadata",
        "description": "Creates multiple metadata key-value pairs for the specified asset. Returns 409 Conflict if any of the specified keys already exist.",
        "operationId": "bulkCreateThreatModelAssetMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/AssetId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 100
              }
            }
          },
          "description": "Bulk metadata key-value pairs to create"
        },
        "responses": {
          "201": {
            "description": "Metadata created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "409": {
            "description": "Conflict - One or more metadata keys already exist for this entity",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk replace asset metadata",
        "description": "Replaces all metadata for the entity. All existing metadata is deleted and replaced with the provided set. To clear all metadata, send an empty array.",
        "operationId": "bulkReplaceThreatModelAssetMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/AssetId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 100
              }
            }
          },
          "description": "Complete set of metadata key-value pairs to replace existing metadata"
        },
        "responses": {
          "200": {
            "description": "Metadata replaced successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk upsert asset metadata",
        "description": "Creates or updates only the provided metadata keys. Keys not included in the request are left unchanged. This is a merge/upsert operation.",
        "operationId": "bulkUpsertThreatModelAssetMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelId"
          },
          {
            "$ref": "#/components/parameters/AssetId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 100
              }
            }
          },
          "description": "Metadata key-value pairs to create or update (merge)"
        },
        "responses": {
          "200": {
            "description": "Metadata upserted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/saml/acs": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "summary": "SAML Assertion Consumer Service",
        "description": "Processes SAML responses from IdP after authentication",
        "operationId": "processSAMLResponse",
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "$ref": "#/components/schemas/SamlAssertionConsumerRequest"
              },
              "example": {
                "SAMLResponse": "PHNhbWxwOlJlc3BvbnNlLi4uPg==",
                "RelayState": "state123"
              }
            }
          },
          "description": "SAML assertion consumer service request"
        },
        "responses": {
          "200": {
            "description": "Authentication successful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthTokenResponse"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "302": {
            "description": "Redirect to client callback with token"
          },
          "400": {
            "description": "Invalid SAML response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Authentication failed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        },
        "security": [],
        "x-rate-limit": {
          "strategy": "multi-scope",
          "tier": "auth-flows",
          "scopes": [
            {
              "name": "session",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 5,
                  "configurable": false,
                  "tracking_method": "OAuth state parameter or SAML request ID"
                }
              ]
            },
            {
              "name": "ip",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 100,
                  "configurable": false,
                  "tracking_method": "Source IP address"
                }
              ]
            },
            {
              "name": "user_identifier",
              "limits": [
                {
                  "type": "attempts_per_hour",
                  "default": 10,
                  "configurable": false,
                  "tracking_method": "login_hint parameter or email address"
                }
              ]
            }
          ],
          "enforcement": "Most restrictive limit applies"
        },
        "x-public-endpoint": true,
        "x-authentication-required": false,
        "x-public-endpoint-purpose": "SAML Flow"
      }
    },
    "/saml/slo": {
      "get": {
        "tags": [
          "Authentication"
        ],
        "summary": "SAML Single Logout",
        "description": "Handles SAML logout requests from IdP",
        "operationId": "processSAMLLogout",
        "parameters": [
          {
            "$ref": "#/components/parameters/SamlrequestQueryParam"
          }
        ],
        "responses": {
          "200": {
            "description": "Logout successful",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "maxLength": 1000,
                      "example": "Logout successful"
                    }
                  },
                  "additionalProperties": false
                },
                "example": {
                  "message": "Logout successful"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid SAML logout request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        },
        "security": [],
        "x-rate-limit": {
          "strategy": "multi-scope",
          "tier": "auth-flows",
          "scopes": [
            {
              "name": "session",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 5,
                  "configurable": false,
                  "tracking_method": "OAuth state parameter or SAML request ID"
                }
              ]
            },
            {
              "name": "ip",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 100,
                  "configurable": false,
                  "tracking_method": "Source IP address"
                }
              ]
            },
            {
              "name": "user_identifier",
              "limits": [
                {
                  "type": "attempts_per_hour",
                  "default": 10,
                  "configurable": false,
                  "tracking_method": "login_hint parameter or email address"
                }
              ]
            }
          ],
          "enforcement": "Most restrictive limit applies"
        },
        "x-public-endpoint": true,
        "x-authentication-required": false,
        "x-public-endpoint-purpose": "SAML Flow"
      },
      "post": {
        "tags": [
          "Authentication"
        ],
        "summary": "SAML Single Logout (POST)",
        "description": "Handles SAML logout requests from IdP via POST",
        "operationId": "processSAMLLogoutPost",
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "$ref": "#/components/schemas/SamlSingleLogoutRequest"
              },
              "example": {
                "SAMLRequest": "PHNhbWxwOkxvZ291dFJlcXVlc3QuLi4+"
              }
            }
          },
          "description": "SAML single logout request"
        },
        "responses": {
          "200": {
            "description": "Logout successful",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "maxLength": 1000,
                      "example": "Logout successful"
                    }
                  },
                  "additionalProperties": false
                },
                "example": {
                  "message": "Logout successful"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid SAML logout request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        },
        "security": [],
        "x-rate-limit": {
          "strategy": "multi-scope",
          "tier": "auth-flows",
          "scopes": [
            {
              "name": "session",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 5,
                  "configurable": false,
                  "tracking_method": "OAuth state parameter or SAML request ID"
                }
              ]
            },
            {
              "name": "ip",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 100,
                  "configurable": false,
                  "tracking_method": "Source IP address"
                }
              ]
            },
            {
              "name": "user_identifier",
              "limits": [
                {
                  "type": "attempts_per_hour",
                  "default": 10,
                  "configurable": false,
                  "tracking_method": "login_hint parameter or email address"
                }
              ]
            }
          ],
          "enforcement": "Most restrictive limit applies"
        },
        "x-public-endpoint": true,
        "x-authentication-required": false,
        "x-public-endpoint-purpose": "SAML Flow"
      }
    },
    "/webhooks/subscriptions": {
      "get": {
        "summary": "List webhook subscriptions",
        "description": "List all webhook subscriptions. Requires administrator privileges.",
        "operationId": "listWebhookSubscriptions",
        "tags": [
          "webhooks"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelIdQueryParam"
          },
          {
            "$ref": "#/components/parameters/PaginationOffset"
          },
          {
            "$ref": "#/components/parameters/PaginationLimit"
          }
        ],
        "responses": {
          "200": {
            "description": "List of webhook subscriptions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListWebhookSubscriptionsResponse"
                },
                "example": {
                  "subscriptions": [
                    {
                      "id": "550e8400-e29b-41d4-a716-446655440000",
                      "owner_id": "550e8400-e29b-41d4-a716-446655440020",
                      "name": "Production Slack Notifications",
                      "url": "https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXX",
                      "events": [
                        "diagram.updated",
                        "threat_model.created"
                      ],
                      "status": "active",
                      "created_at": "2024-01-15T10:30:00Z",
                      "modified_at": "2024-01-15T10:30:00Z"
                    }
                  ],
                  "total": 6,
                  "limit": 20,
                  "offset": 0
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "webhooks",
          "limits": [
            {
              "type": "subscription_requests_per_minute",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_minute"
            },
            {
              "type": "subscription_requests_per_day",
              "default": 20,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_day"
            },
            {
              "type": "events_per_minute",
              "default": 12,
              "configurable": true,
              "quota_source": "webhook_quotas.max_events_per_minute"
            },
            {
              "type": "max_subscriptions",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscriptions"
            }
          ]
        }
      },
      "post": {
        "summary": "Create webhook subscription",
        "description": "Create a new webhook subscription. Requires administrator privileges. The subscription will be in pending_verification status until the challenge is completed.",
        "operationId": "createWebhookSubscription",
        "tags": [
          "webhooks"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/WebhookSubscriptionInput"
              }
            }
          },
          "description": "Webhook subscription configuration"
        },
        "responses": {
          "201": {
            "description": "Webhook subscription created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookSubscription"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "description": "Too Many Requests",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "webhooks",
          "limits": [
            {
              "type": "subscription_requests_per_minute",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_minute"
            },
            {
              "type": "subscription_requests_per_day",
              "default": 20,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_day"
            },
            {
              "type": "events_per_minute",
              "default": 12,
              "configurable": true,
              "quota_source": "webhook_quotas.max_events_per_minute"
            },
            {
              "type": "max_subscriptions",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscriptions"
            }
          ]
        }
      }
    },
    "/webhooks/subscriptions/{webhook_id}": {
      "get": {
        "summary": "Get webhook subscription",
        "description": "Retrieve details of a specific webhook subscription. Requires administrator privileges.",
        "operationId": "getWebhookSubscription",
        "tags": [
          "webhooks"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/WebhookId"
          }
        ],
        "responses": {
          "200": {
            "description": "Webhook subscription details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookSubscription"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "webhooks",
          "limits": [
            {
              "type": "subscription_requests_per_minute",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_minute"
            },
            {
              "type": "subscription_requests_per_day",
              "default": 20,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_day"
            },
            {
              "type": "events_per_minute",
              "default": 12,
              "configurable": true,
              "quota_source": "webhook_quotas.max_events_per_minute"
            },
            {
              "type": "max_subscriptions",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscriptions"
            }
          ]
        }
      },
      "delete": {
        "summary": "Delete webhook subscription",
        "description": "Delete a webhook subscription and all its associated deliveries. Requires administrator privileges.",
        "operationId": "deleteWebhookSubscription",
        "tags": [
          "webhooks"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/WebhookId"
          }
        ],
        "responses": {
          "204": {
            "description": "Webhook subscription deleted",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "webhooks",
          "limits": [
            {
              "type": "subscription_requests_per_minute",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_minute"
            },
            {
              "type": "subscription_requests_per_day",
              "default": 20,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_day"
            },
            {
              "type": "events_per_minute",
              "default": 12,
              "configurable": true,
              "quota_source": "webhook_quotas.max_events_per_minute"
            },
            {
              "type": "max_subscriptions",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscriptions"
            }
          ]
        }
      }
    },
    "/webhooks/subscriptions/{webhook_id}/test": {
      "post": {
        "summary": "Test webhook subscription",
        "description": "Send a test event to the webhook endpoint. Requires administrator privileges. Returns a delivery ID that can be used to track the test delivery status.",
        "operationId": "testWebhookSubscription",
        "tags": [
          "webhooks"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/WebhookId"
          }
        ],
        "requestBody": {
          "required": false,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/WebhookTestRequest"
              }
            }
          },
          "description": "Webhook test request configuration"
        },
        "responses": {
          "200": {
            "description": "Test webhook sent",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookTestResponse"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "webhooks",
          "limits": [
            {
              "type": "subscription_requests_per_minute",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_minute"
            },
            {
              "type": "subscription_requests_per_day",
              "default": 20,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_day"
            },
            {
              "type": "events_per_minute",
              "default": 12,
              "configurable": true,
              "quota_source": "webhook_quotas.max_events_per_minute"
            },
            {
              "type": "max_subscriptions",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscriptions"
            }
          ]
        }
      }
    },
    "/webhooks/deliveries": {
      "get": {
        "summary": "List webhook deliveries",
        "description": "List webhook deliveries. Requires administrator privileges. Optionally filter by subscription_id.",
        "operationId": "listWebhookDeliveries",
        "tags": [
          "webhooks"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SubscriptionIdQueryParam"
          },
          {
            "$ref": "#/components/parameters/PaginationOffset"
          },
          {
            "$ref": "#/components/parameters/PaginationLimit"
          }
        ],
        "responses": {
          "200": {
            "description": "List of webhook deliveries",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListWebhookDeliveriesResponse"
                },
                "example": {
                  "deliveries": [
                    {
                      "id": "aa0e8400-e29b-41d4-a716-446655440005",
                      "subscription_id": "550e8400-e29b-41d4-a716-446655440000",
                      "event_type": "diagram.updated",
                      "status": "delivered",
                      "attempts": 1,
                      "created_at": "2024-01-20T15:45:30Z",
                      "delivered_at": "2024-01-20T15:45:31Z"
                    }
                  ],
                  "total": 100,
                  "limit": 20,
                  "offset": 0
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "webhooks",
          "limits": [
            {
              "type": "subscription_requests_per_minute",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_minute"
            },
            {
              "type": "subscription_requests_per_day",
              "default": 20,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_day"
            },
            {
              "type": "events_per_minute",
              "default": 12,
              "configurable": true,
              "quota_source": "webhook_quotas.max_events_per_minute"
            },
            {
              "type": "max_subscriptions",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscriptions"
            }
          ]
        }
      }
    },
    "/webhooks/deliveries/{delivery_id}": {
      "get": {
        "summary": "Get webhook delivery",
        "description": "Retrieve details of a specific webhook delivery including payload and delivery attempts. Requires administrator privileges.",
        "operationId": "getWebhookDelivery",
        "tags": [
          "webhooks"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/DeliveryId"
          }
        ],
        "responses": {
          "200": {
            "description": "Webhook delivery details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookDelivery"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "webhooks",
          "limits": [
            {
              "type": "subscription_requests_per_minute",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_minute"
            },
            {
              "type": "subscription_requests_per_day",
              "default": 20,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_day"
            },
            {
              "type": "events_per_minute",
              "default": 12,
              "configurable": true,
              "quota_source": "webhook_quotas.max_events_per_minute"
            },
            {
              "type": "max_subscriptions",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscriptions"
            }
          ]
        }
      }
    },
    "/addons": {
      "post": {
        "operationId": "createAddon",
        "summary": "Create add-on",
        "description": "Create a new add-on (administrators only)",
        "tags": [
          "Addons"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        },
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateAddonRequest"
              }
            }
          },
          "description": "Addon registration details"
        },
        "responses": {
          "201": {
            "description": "Add-on created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AddonResponse"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Webhook not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        }
      },
      "get": {
        "operationId": "listAddons",
        "summary": "List add-ons",
        "description": "List all add-ons (authenticated users)",
        "tags": [
          "Addons"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        },
        "parameters": [
          {
            "$ref": "#/components/parameters/PaginationLimit"
          },
          {
            "$ref": "#/components/parameters/PaginationOffset"
          },
          {
            "$ref": "#/components/parameters/ThreatModelIdQueryParam"
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListAddonsResponse"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        }
      }
    },
    "/addons/{id}": {
      "get": {
        "operationId": "getAddon",
        "summary": "Get add-on",
        "description": "Get a single add-on by ID",
        "tags": [
          "Addons"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        },
        "parameters": [
          {
            "$ref": "#/components/parameters/GenericId"
          }
        ],
        "responses": {
          "200": {
            "description": "Add-on details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AddonResponse"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Add-on not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        }
      },
      "delete": {
        "operationId": "deleteAddon",
        "summary": "Delete add-on",
        "description": "Delete an add-on (administrators only)",
        "tags": [
          "Addons"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        },
        "parameters": [
          {
            "$ref": "#/components/parameters/GenericId"
          }
        ],
        "responses": {
          "204": {
            "description": "Add-on deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Add-on not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Conflict - cannot delete add-on with active invocations",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        }
      }
    },
    "/addons/{id}/invoke": {
      "post": {
        "operationId": "invokeAddon",
        "summary": "Invoke add-on",
        "description": "Trigger an add-on invocation (authenticated users)",
        "tags": [
          "Addons"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        },
        "parameters": [
          {
            "$ref": "#/components/parameters/GenericId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/InvokeAddonRequest"
              }
            }
          },
          "description": "Addon invocation parameters"
        },
        "responses": {
          "202": {
            "description": "Invocation accepted and queued",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InvokeAddonResponse"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Add-on not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "description": "Rate limit exceeded (quota: 1 active invocation or 10 per hour)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        }
      }
    },
    "/invocations": {
      "get": {
        "operationId": "listInvocations",
        "summary": "List invocations",
        "description": "List add-on invocations (users see own, admins see all)",
        "tags": [
          "Addons"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        },
        "parameters": [
          {
            "$ref": "#/components/parameters/PaginationLimit"
          },
          {
            "$ref": "#/components/parameters/PaginationOffset"
          },
          {
            "$ref": "#/components/parameters/StatusQueryParam"
          },
          {
            "$ref": "#/components/parameters/AddonIdQueryParam"
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListInvocationsResponse"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "405": {
            "$ref": "#/components/responses/MethodNotAllowed"
          },
          "406": {
            "$ref": "#/components/responses/NotAcceptable"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        }
      }
    },
    "/invocations/{id}": {
      "get": {
        "operationId": "getInvocation",
        "summary": "Get invocation",
        "description": "Get a single invocation by ID (own invocations or admin)",
        "tags": [
          "Addons"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        },
        "parameters": [
          {
            "$ref": "#/components/parameters/GenericId"
          }
        ],
        "responses": {
          "200": {
            "description": "Invocation details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InvocationResponse"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - not your invocation and not admin",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Invocation not found or expired",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        }
      }
    },
    "/invocations/{id}/status": {
      "post": {
        "operationId": "updateInvocationStatus",
        "summary": "Update invocation status",
        "description": "Update invocation status (webhook callback with HMAC authentication)",
        "tags": [
          "Addons"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/GenericId"
          },
          {
            "$ref": "#/components/parameters/X-Webhook-SignatureHeaderParam"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateInvocationStatusRequest"
              }
            }
          },
          "description": "Invocation status update"
        },
        "responses": {
          "200": {
            "description": "Status updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UpdateInvocationStatusResponse"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - invalid HMAC signature",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Invocation not found or expired",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Conflict - invalid status transition",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/saml/providers": {
      "get": {
        "tags": [
          "Authentication"
        ],
        "summary": "List available SAML providers",
        "description": "Returns a list of configured SAML providers available for authentication",
        "operationId": "getSAMLProviders",
        "responses": {
          "200": {
            "description": "List of available SAML providers",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "providers": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/SAMLProviderInfo"
                      },
                      "maxItems": 1000,
                      "example": [
                        {
                          "id": "okta",
                          "name": "Okta",
                          "icon": "okta",
                          "auth_url": "http://localhost:8080/saml/okta/login",
                          "metadata_url": "http://localhost:8080/saml/okta/metadata",
                          "entity_id": "urn:example:tmi",
                          "acs_url": "http://localhost:8080/saml/acs",
                          "initialized": true
                        }
                      ]
                    }
                  },
                  "required": [
                    "providers"
                  ],
                  "additionalProperties": false
                },
                "example": {
                  "providers": [
                    {
                      "id": "okta",
                      "name": "Okta",
                      "icon": "okta",
                      "auth_url": "http://localhost:8080/saml/okta/login",
                      "metadata_url": "http://localhost:8080/saml/okta/metadata",
                      "entity_id": "urn:example:tmi",
                      "acs_url": "http://localhost:8080/saml/acs",
                      "initialized": true
                    }
                  ]
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "$ref": "#/components/responses/Error"
          }
        },
        "security": [],
        "x-rate-limit": {
          "scope": "ip",
          "tier": "public-discovery",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 10,
              "configurable": false,
              "tracking_method": "Source IP address"
            }
          ]
        },
        "x-public-endpoint": true,
        "x-authentication-required": false,
        "x-public-endpoint-purpose": "SAML Flow",
        "x-cacheable-endpoint": true,
        "x-cacheable-endpoint-reason": "SAML provider list is static configuration data"
      }
    },
    "/saml/{provider}/login": {
      "get": {
        "tags": [
          "Authentication"
        ],
        "summary": "Initiate SAML authentication",
        "description": "Starts SAML authentication flow by redirecting to IdP",
        "operationId": "initiateSAMLLogin",
        "parameters": [
          {
            "$ref": "#/components/parameters/ClientCallbackQueryParam"
          },
          {
            "$ref": "#/components/parameters/ProviderPathParam"
          }
        ],
        "responses": {
          "302": {
            "description": "Redirect to SAML IdP for authentication"
          },
          "500": {
            "description": "Failed to initiate SAML authentication",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          },
          "400": {
            "description": "Bad Request - Invalid provider name or client_callback URL format",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "format": "int32"
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "format": "int32"
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "format": "int64"
                }
              }
            }
          }
        },
        "security": [],
        "x-rate-limit": {
          "strategy": "multi-scope",
          "tier": "auth-flows",
          "scopes": [
            {
              "name": "session",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 5,
                  "configurable": false,
                  "tracking_method": "OAuth state parameter or SAML request ID"
                }
              ]
            },
            {
              "name": "ip",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 100,
                  "configurable": false,
                  "tracking_method": "Source IP address"
                }
              ]
            },
            {
              "name": "user_identifier",
              "limits": [
                {
                  "type": "attempts_per_hour",
                  "default": 10,
                  "configurable": false,
                  "tracking_method": "login_hint parameter or email address"
                }
              ]
            }
          ],
          "enforcement": "Most restrictive limit applies"
        },
        "x-public-endpoint": true,
        "x-authentication-required": false,
        "x-public-endpoint-purpose": "SAML Flow"
      }
    },
    "/saml/{provider}/metadata": {
      "get": {
        "tags": [
          "Authentication"
        ],
        "summary": "Get SAML service provider metadata",
        "description": "Returns the SP metadata XML for SAML configuration",
        "operationId": "getSAMLMetadata",
        "responses": {
          "200": {
            "description": "SAML metadata XML",
            "content": {
              "application/samlmetadata+xml": {
                "schema": {
                  "type": "string",
                  "format": "xml",
                  "maxLength": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "500": {
            "description": "Failed to generate metadata",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          },
          "400": {
            "description": "Bad Request - Invalid provider name format",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "format": "int32"
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "format": "int32"
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "format": "int64"
                }
              }
            }
          }
        },
        "security": [],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        },
        "parameters": [
          {
            "$ref": "#/components/parameters/ProviderPathParam"
          }
        ],
        "x-public-endpoint": true,
        "x-authentication-required": false,
        "x-public-endpoint-purpose": "SAML Flow"
      }
    },
    "/admin/quotas/users/{user_id}": {
      "get": {
        "tags": [
          "Administration"
        ],
        "summary": "Get user API quota",
        "description": "Retrieves the API rate limit quota for a specific user",
        "operationId": "getUserAPIQuota",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/UserIdPathParam"
          }
        ],
        "responses": {
          "200": {
            "description": "User API quota",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserAPIQuota"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad request - Invalid user ID",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        },
        "x-admin-only": true
      },
      "put": {
        "tags": [
          "Administration"
        ],
        "summary": "Update user API quota",
        "description": "Creates or updates the API rate limit quota for a specific user",
        "operationId": "updateUserAPIQuota",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/UserIdPathParam"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UserQuotaUpdate"
              },
              "example": {
                "max_requests_per_minute": 60,
                "max_requests_per_hour": 1000
              }
            }
          },
          "description": "User quota update configuration"
        },
        "responses": {
          "200": {
            "description": "Quota updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserAPIQuota"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "201": {
            "description": "Quota created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserAPIQuota"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        },
        "x-admin-only": true
      },
      "delete": {
        "tags": [
          "Administration"
        ],
        "summary": "Delete user API quota",
        "description": "Deletes the custom API quota for a user, reverting to system defaults",
        "operationId": "deleteUserAPIQuota",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/UserIdPathParam"
          }
        ],
        "responses": {
          "204": {
            "description": "Quota deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad request - Invalid user ID",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Quota not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          }
        },
        "x-admin-only": true
      }
    },
    "/admin/quotas/webhooks/{user_id}": {
      "get": {
        "tags": [
          "Administration"
        ],
        "summary": "Get webhook quota",
        "description": "Retrieves the webhook quota for a specific user",
        "operationId": "getWebhookQuota",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/UserIdPathParam"
          }
        ],
        "responses": {
          "200": {
            "description": "Webhook quota",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookQuota"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad request - Invalid user ID",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        },
        "x-admin-only": true
      },
      "put": {
        "tags": [
          "Administration"
        ],
        "summary": "Update webhook quota",
        "description": "Creates or updates the webhook quota for a specific user",
        "operationId": "updateWebhookQuota",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/UserIdPathParam"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/WebhookQuotaUpdate"
              },
              "example": {
                "max_subscriptions": 10,
                "max_events_per_minute": 100,
                "max_subscription_requests_per_minute": 10,
                "max_subscription_requests_per_day": 100
              }
            }
          },
          "description": "Webhook quota update configuration"
        },
        "responses": {
          "200": {
            "description": "Quota updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookQuota"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "201": {
            "description": "Quota created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookQuota"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        },
        "x-admin-only": true
      },
      "delete": {
        "tags": [
          "Administration"
        ],
        "summary": "Delete webhook quota",
        "description": "Deletes the custom webhook quota for a user, reverting to system defaults",
        "operationId": "deleteWebhookQuota",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/UserIdPathParam"
          }
        ],
        "responses": {
          "204": {
            "description": "Quota deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad request - Invalid user ID",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Quota not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          }
        },
        "x-admin-only": true
      }
    },
    "/admin/users": {
      "get": {
        "tags": [
          "Administration"
        ],
        "summary": "List users",
        "description": "Returns a paginated list of users with optional filtering by provider, email, and date ranges. Includes enriched data (admin status, groups, threat model counts).",
        "operationId": "listAdminUsers",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ProviderQueryParam"
          },
          {
            "$ref": "#/components/parameters/EmailQueryParam"
          },
          {
            "$ref": "#/components/parameters/CreatedAfterQueryParam"
          },
          {
            "$ref": "#/components/parameters/CreatedBeforeQueryParam"
          },
          {
            "$ref": "#/components/parameters/LastLoginAfterQueryParam"
          },
          {
            "$ref": "#/components/parameters/LastLoginBeforeQueryParam"
          },
          {
            "$ref": "#/components/parameters/LimitQueryParam"
          },
          {
            "$ref": "#/components/parameters/OffsetQueryParam"
          },
          {
            "$ref": "#/components/parameters/SortByQueryParam"
          },
          {
            "$ref": "#/components/parameters/SortOrderQueryParam"
          }
        ],
        "responses": {
          "200": {
            "description": "Paginated list of users",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminUserListResponse"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          }
        },
        "x-admin-only": true
      }
    },
    "/admin/users/{internal_uuid}": {
      "get": {
        "tags": [
          "Administration"
        ],
        "summary": "Get user details",
        "description": "Returns detailed information about a specific user, including enriched data (admin status, groups, threat model counts).",
        "operationId": "getAdminUser",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/InternalUuidPathParam"
          }
        ],
        "responses": {
          "200": {
            "description": "User details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminUser"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad request - Invalid UUID format",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "User not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          }
        },
        "x-admin-only": true
      },
      "patch": {
        "tags": [
          "Administration"
        ],
        "summary": "Update user metadata",
        "description": "Updates user metadata fields (email, name, email_verified). Only provided fields are updated.",
        "operationId": "updateAdminUser",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/InternalUuidPathParam"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateAdminUserRequest"
              }
            }
          },
          "description": "User profile update"
        },
        "responses": {
          "200": {
            "description": "User updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminUser"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "User not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          }
        },
        "x-admin-only": true
      },
      "delete": {
        "tags": [
          "Administration"
        ],
        "summary": "Delete user",
        "description": "Deletes a user and all associated data. Transfers sole-owned threat models or deletes them if no other owners exist.",
        "operationId": "deleteAdminUser",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/InternalUuidPathParam"
          }
        ],
        "responses": {
          "204": {
            "description": "User deleted successfully (no content)",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "User not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          }
        },
        "x-admin-only": true
      }
    },
    "/admin/groups": {
      "get": {
        "tags": [
          "Administration"
        ],
        "summary": "List groups",
        "description": "Returns a paginated list of groups with optional filtering by provider, name, and usage. Includes enriched data (usage in authorizations and admin grants).",
        "operationId": "listAdminGroups",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ProviderQueryParam"
          },
          {
            "$ref": "#/components/parameters/GroupNameQueryParam"
          },
          {
            "$ref": "#/components/parameters/UsedInAuthorizationsQueryParam"
          },
          {
            "$ref": "#/components/parameters/LimitQueryParam"
          },
          {
            "$ref": "#/components/parameters/OffsetQueryParam"
          },
          {
            "$ref": "#/components/parameters/SortByQueryParam"
          },
          {
            "$ref": "#/components/parameters/SortOrderQueryParam"
          }
        ],
        "responses": {
          "200": {
            "description": "Paginated list of groups",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminGroupListResponse"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              },
              "text/plain": {
                "schema": {
                  "type": "string",
                  "description": "Plain text error from transport layer",
                  "example": "400 Bad Request"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          }
        },
        "x-admin-only": true
      },
      "post": {
        "tags": [
          "Administration"
        ],
        "summary": "Create provider-independent group",
        "description": "Creates a new provider-independent group (provider=\"*\"). These groups can be used across all providers for authorization and administration.",
        "operationId": "createAdminGroup",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateAdminGroupRequest"
              }
            }
          },
          "description": "Group creation request"
        },
        "responses": {
          "201": {
            "description": "Group created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminGroup"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Conflict - Group already exists",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          }
        },
        "x-admin-only": true
      }
    },
    "/admin/groups/{internal_uuid}": {
      "get": {
        "tags": [
          "Administration"
        ],
        "summary": "Get group details",
        "description": "Returns detailed information about a specific group, including enriched data (usage in authorizations and admin grants).",
        "operationId": "getAdminGroup",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/InternalUuidPathParam"
          }
        ],
        "responses": {
          "200": {
            "description": "Group details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminGroup"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad request - Invalid UUID format",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Group not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          }
        },
        "x-admin-only": true
      },
      "patch": {
        "tags": [
          "Administration"
        ],
        "summary": "Update group metadata",
        "description": "Updates group metadata fields (name, description). Only provided fields are updated.",
        "operationId": "updateAdminGroup",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/InternalUuidPathParam"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateAdminGroupRequest"
              }
            }
          },
          "description": "Group update details"
        },
        "responses": {
          "200": {
            "description": "Group updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminGroup"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Group not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          }
        },
        "x-admin-only": true
      },
      "delete": {
        "tags": [
          "Administration"
        ],
        "summary": "Delete group",
        "description": "Deletes a TMI-managed group and handles threat model cleanup. Protected groups like 'everyone' cannot be deleted.",
        "operationId": "deleteAdminGroup",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/InternalUuidPathParam"
          }
        ],
        "responses": {
          "204": {
            "description": "Group deleted successfully (no content)",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid UUID format",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Cannot delete protected group or insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Group not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          }
        },
        "x-admin-only": true
      }
    },
    "/saml/providers/{idp}/users": {
      "get": {
        "tags": [
          "SAML"
        ],
        "summary": "List SAML users for UI autocomplete",
        "description": "Returns a lightweight list of active users for a specific SAML provider. Intended for UI autocomplete/search features. Only accessible to users from the same provider.",
        "operationId": "listSAMLUsers",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/IdpPathParam"
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                },
                "example": {
                  "users": [
                    {
                      "id": "user-1",
                      "email": "alice@example.com",
                      "name": "Alice Smith"
                    }
                  ]
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - User is not from the same SAML provider",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        },
        "x-same-provider-required": true
      }
    },
    "/admin/groups/{internal_uuid}/members": {
      "get": {
        "tags": [
          "Administration"
        ],
        "summary": "List group members",
        "description": "Returns a paginated list of users who are members of the specified group. Includes user details (email, name, provider information).",
        "operationId": "listGroupMembers",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/InternalUuidPathParam"
          },
          {
            "$ref": "#/components/parameters/LimitQueryParam"
          },
          {
            "$ref": "#/components/parameters/OffsetQueryParam"
          }
        ],
        "responses": {
          "200": {
            "description": "Paginated list of group members",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GroupMemberListResponse"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Group not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          }
        },
        "x-admin-only": true
      },
      "post": {
        "tags": [
          "Administration"
        ],
        "summary": "Add member to group",
        "description": "Adds a user to a group. The user must exist in the system. Cannot add members to the special 'everyone' pseudo-group.",
        "operationId": "addGroupMember",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/InternalUuidPathParam"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AddGroupMemberRequest"
              }
            }
          },
          "description": "Group membership update"
        },
        "responses": {
          "201": {
            "description": "Member added successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GroupMember"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Group or user not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Conflict - User is already a member of this group",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          }
        },
        "x-admin-only": true
      }
    },
    "/admin/groups/{internal_uuid}/members/{member_uuid}": {
      "delete": {
        "tags": [
          "Administration"
        ],
        "summary": "Remove member from group",
        "description": "Removes a user or nested group from a group. Use the subject_type query parameter to specify whether the member is a user (default) or a group. Cannot remove members from the special 'everyone' pseudo-group.",
        "operationId": "removeGroupMember",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/InternalUuidPathParam"
          },
          {
            "$ref": "#/components/parameters/MemberUuidPathParam"
          },
          {
            "name": "subject_type",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "enum": [
                "user",
                "group"
              ],
              "default": "user"
            },
            "description": "Type of member to remove: 'user' (default) for a user member, 'group' for a nested group member"
          }
        ],
        "responses": {
          "204": {
            "description": "Member removed successfully (no content)",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad request - Invalid UUID format",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Group, member, or membership not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          }
        },
        "x-admin-only": true
      }
    },
    "/admin/quotas/users": {
      "get": {
        "tags": [
          "Administration"
        ],
        "summary": "List all user API quotas",
        "description": "Retrieves all custom API rate limit quotas (users with non-default quotas)",
        "operationId": "listUserAPIQuotas",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/LimitQueryParam"
          },
          {
            "$ref": "#/components/parameters/OffsetQueryParam"
          }
        ],
        "responses": {
          "200": {
            "description": "List of user API quotas",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListUserQuotasResponse"
                },
                "example": {
                  "quotas": [
                    {
                      "user_id": "550e8400-e29b-41d4-a716-446655440000",
                      "max_requests_per_minute": 60,
                      "created_at": "2024-01-01T00:00:00Z",
                      "modified_at": "2024-01-01T00:00:00Z"
                    }
                  ],
                  "total": 25,
                  "limit": 20,
                  "offset": 0
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          }
        },
        "x-admin-only": true
      }
    },
    "/admin/quotas/webhooks": {
      "get": {
        "tags": [
          "Administration"
        ],
        "summary": "List all webhook quotas",
        "description": "Retrieves all custom webhook quotas (users with non-default quotas)",
        "operationId": "listWebhookQuotas",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/LimitQueryParam"
          },
          {
            "$ref": "#/components/parameters/OffsetQueryParam"
          }
        ],
        "responses": {
          "200": {
            "description": "List of webhook quotas",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListWebhookQuotasResponse"
                },
                "example": {
                  "quotas": [
                    {
                      "owner_id": "550e8400-e29b-41d4-a716-446655440000",
                      "max_subscriptions": 20,
                      "max_events_per_minute": 100,
                      "max_subscription_requests_per_minute": 10,
                      "max_subscription_requests_per_day": 1000,
                      "created_at": "2024-01-01T00:00:00Z",
                      "modified_at": "2024-01-01T00:00:00Z"
                    }
                  ],
                  "total": 15,
                  "limit": 20,
                  "offset": 0
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          }
        },
        "x-admin-only": true
      }
    },
    "/admin/quotas/addons": {
      "get": {
        "tags": [
          "Administration"
        ],
        "summary": "List all addon invocation quotas",
        "description": "Retrieves all custom addon invocation quotas (users with non-default quotas)",
        "operationId": "listAddonInvocationQuotas",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/LimitQueryParam"
          },
          {
            "$ref": "#/components/parameters/OffsetQueryParam"
          }
        ],
        "responses": {
          "200": {
            "description": "List of addon invocation quotas",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListAddonQuotasResponse"
                },
                "example": {
                  "quotas": [
                    {
                      "owner_id": "550e8400-e29b-41d4-a716-446655440000",
                      "max_active_invocations": 10,
                      "max_invocations_per_hour": 100,
                      "created_at": "2024-01-01T00:00:00Z",
                      "modified_at": "2024-01-01T00:00:00Z"
                    }
                  ],
                  "total": 8,
                  "limit": 20,
                  "offset": 0
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          }
        },
        "x-admin-only": true
      }
    },
    "/admin/quotas/addons/{user_id}": {
      "get": {
        "tags": [
          "Administration"
        ],
        "summary": "Get addon invocation quota",
        "description": "Retrieves the addon invocation quota for a specific user",
        "operationId": "getAddonInvocationQuota",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/UserIdPathParam"
          }
        ],
        "responses": {
          "200": {
            "description": "Addon invocation quota",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AddonInvocationQuota"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad request - Invalid user ID",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        },
        "x-admin-only": true
      },
      "put": {
        "tags": [
          "Administration"
        ],
        "summary": "Update addon invocation quota",
        "description": "Creates or updates the addon invocation quota for a specific user",
        "operationId": "updateAddonInvocationQuota",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/UserIdPathParam"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AddonQuotaUpdate"
              },
              "example": {
                "max_active_invocations": 5,
                "max_invocations_per_hour": 100
              }
            }
          },
          "description": "Addon quota update configuration"
        },
        "responses": {
          "200": {
            "description": "Quota updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AddonInvocationQuota"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "201": {
            "description": "Quota created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AddonInvocationQuota"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        },
        "x-admin-only": true
      },
      "delete": {
        "tags": [
          "Administration"
        ],
        "summary": "Delete addon invocation quota",
        "description": "Deletes the custom addon invocation quota for a user, reverting to system defaults",
        "operationId": "deleteAddonInvocationQuota",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/UserIdPathParam"
          }
        ],
        "responses": {
          "204": {
            "description": "Quota deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad request - Invalid user ID",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Quota not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          }
        },
        "x-admin-only": true
      }
    },
    "/threat_models/{threat_model_id}/diagrams/{diagram_id}/model": {
      "get": {
        "operationId": "getDiagramModel",
        "summary": "Get minimal diagram model for automated analysis",
        "description": "Returns a minimal representation of the diagram optimized for automated threat modeling. Strips all visual styling, layout, and rendering properties. Includes threat model context, computed parent-child relationships, and flattened metadata.\n\nContent negotiation: Use the Accept header (application/json, application/x-yaml, application/xml) or the ?format query parameter. Query parameter takes precedence if both are specified. Default: application/json.",
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ThreatModelIdPathParam"
          },
          {
            "$ref": "#/components/parameters/DiagramIdPathParam"
          },
          {
            "$ref": "#/components/parameters/FormatQueryParam"
          }
        ],
        "responses": {
          "200": {
            "description": "Minimal diagram model successfully retrieved in requested format",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MinimalDiagramModel"
                }
              },
              "application/x-yaml": {
                "schema": {
                  "type": "string",
                  "description": "YAML serialization of MinimalDiagramModel. The response body contains raw YAML text."
                }
              },
              "application/xml": {
                "schema": {
                  "type": "string",
                  "description": "GraphML 1.0 XML serialization of the diagram. The response body contains raw XML text."
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid UUID format or invalid format parameter",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - insufficient permissions (requires at least reader role)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Threat model or diagram not found, or diagram not associated with threat model",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "description": "Rate limit exceeded",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "schema": {
                  "type": "integer"
                },
                "description": "Request limit per window"
              },
              "X-RateLimit-Remaining": {
                "schema": {
                  "type": "integer"
                },
                "description": "Remaining requests in current window"
              },
              "X-RateLimit-Reset": {
                "schema": {
                  "type": "integer"
                },
                "description": "Unix timestamp when limit resets"
              },
              "Retry-After": {
                "schema": {
                  "type": "integer"
                },
                "description": "Seconds until retry allowed"
              }
            }
          },
          "500": {
            "description": "Internal server error (e.g., serialization failure)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/me/client_credentials": {
      "post": {
        "summary": "Create client credential",
        "description": "Creates a new OAuth 2.0 client credential for machine-to-machine authentication. The client_secret is ONLY returned once at creation and cannot be retrieved later.",
        "operationId": "createCurrentUserClientCredential",
        "tags": [
          "Authentication"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "name"
                ],
                "properties": {
                  "name": {
                    "type": "string",
                    "minLength": 1,
                    "maxLength": 100,
                    "description": "Human-readable name for the credential",
                    "example": "CI/CD Pipeline"
                  },
                  "description": {
                    "type": "string",
                    "maxLength": 500,
                    "description": "Optional description of the credential's purpose",
                    "example": "CI/CD pipeline automation credential"
                  },
                  "expires_at": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Optional expiration timestamp (ISO 8601)",
                    "example": "2027-01-17T00:00:00Z"
                  }
                }
              },
              "example": {
                "name": "CI/CD Pipeline",
                "description": "Automated security scanning",
                "expires_at": "2027-01-01T00:00:00Z"
              }
            }
          },
          "description": "Client credential creation request"
        },
        "responses": {
          "201": {
            "description": "Created - Resource successfully created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ClientCredentialResponse"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - missing or invalid JWT token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - quota exceeded",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          }
        }
      },
      "get": {
        "summary": "List client credentials",
        "description": "Retrieves all client credentials owned by the authenticated user. Secrets are never returned.",
        "operationId": "listCurrentUserClientCredentials",
        "tags": [
          "Authentication"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListClientCredentialsResponse"
                },
                "example": {
                  "credentials": [
                    {
                      "id": "970eabcd-e89b-41d4-a716-446655440016",
                      "owner_id": "550e8400-e29b-41d4-a716-446655440000",
                      "name": "Monitoring Service",
                      "description": "Metrics collection service",
                      "client_id": "tmi_cc_monitoring123",
                      "is_active": true,
                      "created_at": "2024-01-15T10:00:00Z",
                      "modified_at": "2024-01-15T10:00:00Z"
                    }
                  ],
                  "total": 4,
                  "limit": 20,
                  "offset": 0
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - missing or invalid JWT token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          }
        },
        "parameters": [
          {
            "$ref": "#/components/parameters/PaginationLimit"
          },
          {
            "$ref": "#/components/parameters/PaginationOffset"
          }
        ]
      }
    },
    "/me/client_credentials/{id}": {
      "delete": {
        "summary": "Delete client credential",
        "description": "Permanently deletes a client credential. All tokens issued with this credential will immediately become invalid.",
        "operationId": "deleteCurrentUserClientCredential",
        "tags": [
          "Authentication"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/IdPathParam"
          }
        ],
        "responses": {
          "204": {
            "description": "No Content - Resource successfully deleted",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid credential ID format",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - missing or invalid JWT token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Client credential not found or not owned by user",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          }
        }
      }
    },
    "/me/preferences": {
      "get": {
        "operationId": "getCurrentUserPreferences",
        "summary": "Get user preferences",
        "description": "Retrieves the current user's preferences. Returns an empty object {} if no preferences have been set.",
        "tags": [
          "User Account"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "User preferences",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserPreferences"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - invalid or missing authentication",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "429": {
            "description": "Too many requests",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 0
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until the rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad request - malformed request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit-tier": "user",
        "x-rate-limit-category": "resource-operations"
      },
      "post": {
        "operationId": "createCurrentUserPreferences",
        "summary": "Create user preferences",
        "description": "Creates preferences for the current user. Fails with 409 Conflict if preferences already exist (use PUT to update).",
        "tags": [
          "User Account"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UserPreferences"
              }
            }
          },
          "description": "User preferences to create. Must be valid JSON not exceeding 1KB. Client keys must follow the pattern client-id:key-name."
        },
        "responses": {
          "201": {
            "description": "Preferences created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserPreferences"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid request - malformed JSON, exceeds 1KB limit, or invalid client key format",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - invalid or missing authentication",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "409": {
            "description": "Conflict - preferences already exist (use PUT to update)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "429": {
            "description": "Too many requests",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 0
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until the rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit-tier": "user",
        "x-rate-limit-category": "resource-operations"
      },
      "put": {
        "operationId": "updateCurrentUserPreferences",
        "summary": "Update user preferences",
        "description": "Creates or replaces the current user's preferences. This is an upsert operation - creates if not exists, replaces entirely if exists.",
        "tags": [
          "User Account"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UserPreferences"
              }
            }
          },
          "description": "User preferences to create or replace. Must be valid JSON not exceeding 1KB. Client keys must follow the pattern client-id:key-name."
        },
        "responses": {
          "200": {
            "description": "Preferences updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserPreferences"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid request - malformed JSON, exceeds 1KB limit, or invalid client key format",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - invalid or missing authentication",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "429": {
            "description": "Too many requests",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 0
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until the rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit-tier": "user",
        "x-rate-limit-category": "resource-operations"
      }
    },
    "/me/logout": {
      "post": {
        "tags": [
          "Users"
        ],
        "summary": "Logout current user",
        "description": "Revokes the authenticated user's current JWT token. This is a convenience endpoint that automatically revokes the token used to authenticate the request, without requiring the token to be passed in the request body. The token is immediately added to the blacklist and cannot be used for further requests.",
        "operationId": "logoutCurrentUser",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "204": {
            "description": "Logout successful - the JWT token has been revoked and added to the blacklist",
            "headers": {
              "X-Request-ID": {
                "description": "Unique request identifier for tracking",
                "schema": {
                  "type": "string",
                  "example": "req_abc123def456"
                }
              },
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Authentication failed - missing or invalid token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "examples": {
                  "missing_token": {
                    "summary": "Missing Authorization header",
                    "value": {
                      "error": "unauthorized",
                      "error_description": "Missing or invalid Authorization header"
                    }
                  },
                  "invalid_token": {
                    "summary": "Invalid token",
                    "value": {
                      "error": "unauthorized",
                      "error_description": "Invalid token"
                    }
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "description": "Internal server error - token revocation failed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "error": "server_error",
                  "error_description": "Failed to revoke token"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad request - malformed request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/config": {
      "get": {
        "tags": [
          "Configuration"
        ],
        "summary": "Get client configuration",
        "description": "Returns configuration settings for client applications such as tmi-ux. This endpoint is public and cacheable.",
        "operationId": "getClientConfig",
        "responses": {
          "200": {
            "description": "Client configuration",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ClientConfig"
                }
              }
            },
            "headers": {
              "Cache-Control": {
                "description": "Cache control directive for the response",
                "schema": {
                  "type": "string",
                  "example": "public, max-age=300"
                }
              },
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "security": [],
        "x-public-endpoint": true,
        "x-authentication-required": false,
        "x-public-endpoint-purpose": "Client Configuration",
        "x-cacheable-endpoint": true
      }
    },
    "/admin/settings": {
      "get": {
        "tags": [
          "Administration"
        ],
        "summary": "List system settings",
        "description": "Returns all system settings. Requires administrator privileges.",
        "operationId": "listSystemSettings",
        "responses": {
          "200": {
            "description": "List of system settings",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/SystemSetting"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/settings/migrate": {
      "post": {
        "tags": [
          "Administration"
        ],
        "summary": "Migrate settings from configuration",
        "description": "Migrates settings from the server configuration (config file or environment variables) to the database. When overwrite is false (default), only settings that don't already exist in the database are added. When overwrite is true, all settings are imported, overwriting existing values. Requires administrator privileges.",
        "operationId": "migrateSystemSettings",
        "parameters": [
          {
            "name": "overwrite",
            "in": "query",
            "description": "If true, overwrite existing settings in the database with values from configuration. If false or omitted, only add settings that don't already exist.",
            "required": false,
            "schema": {
              "type": "boolean",
              "default": false
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Settings migration completed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "migrated": {
                      "type": "integer",
                      "description": "Number of settings migrated (created or updated)",
                      "example": 5
                    },
                    "skipped": {
                      "type": "integer",
                      "description": "Number of settings skipped (already exist and overwrite=false)",
                      "example": 2
                    },
                    "settings": {
                      "type": "array",
                      "description": "List of settings that were migrated",
                      "items": {
                        "$ref": "#/components/schemas/SystemSetting"
                      },
                      "maxItems": 100,
                      "example": [
                        {
                          "key": "rate_limit.requests_per_minute",
                          "value": "60",
                          "type": "int",
                          "description": "Maximum API requests per minute",
                          "modified_at": "2024-01-15T10:00:00Z"
                        }
                      ]
                    }
                  },
                  "required": [
                    "migrated",
                    "skipped",
                    "settings"
                  ]
                },
                "example": {
                  "migrated": 5,
                  "skipped": 2,
                  "settings": [
                    {
                      "key": "rate_limit.requests_per_minute",
                      "value": "60",
                      "type": "int",
                      "description": "Maximum API requests per minute",
                      "modified_at": "2024-01-15T10:00:00Z"
                    }
                  ]
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Invalid request body or parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "error": "invalid_request",
                  "error_description": "Invalid request body"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/settings/{key}": {
      "get": {
        "tags": [
          "Administration"
        ],
        "summary": "Get system setting",
        "description": "Returns a specific system setting by key. Requires administrator privileges.",
        "operationId": "getSystemSetting",
        "parameters": [
          {
            "name": "key",
            "in": "path",
            "required": true,
            "description": "The setting key",
            "schema": {
              "type": "string",
              "maxLength": 256,
              "pattern": "^[a-z][a-z0-9_.]*$"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "System setting",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SystemSetting"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid key format (must match pattern ^[a-z][a-z0-9_.]*$)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Administration"
        ],
        "summary": "Update system setting",
        "description": "Creates or updates a system setting. Requires administrator privileges.",
        "operationId": "updateSystemSetting",
        "parameters": [
          {
            "name": "key",
            "in": "path",
            "required": true,
            "description": "The setting key",
            "schema": {
              "type": "string",
              "maxLength": 256,
              "pattern": "^[a-z][a-z0-9_.]*$"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SystemSettingUpdate"
              }
            }
          },
          "description": "The system setting value to create or update"
        },
        "responses": {
          "200": {
            "description": "Setting updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SystemSetting"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Administration"
        ],
        "summary": "Delete system setting",
        "description": "Deletes a system setting. Requires administrator privileges.",
        "operationId": "deleteSystemSetting",
        "parameters": [
          {
            "name": "key",
            "in": "path",
            "required": true,
            "description": "The setting key",
            "schema": {
              "type": "string",
              "maxLength": 256,
              "pattern": "^[a-z][a-z0-9_.]*$"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Setting deleted",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid key format (must match pattern ^[a-z][a-z0-9_.]*$)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/surveys": {
      "get": {
        "tags": [
          "Survey Administration"
        ],
        "summary": "List surveys",
        "description": "Returns a paginated list of all surveys with optional filtering by status.",
        "operationId": "listAdminSurveys",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyStatusQueryParam"
          },
          {
            "$ref": "#/components/parameters/PaginationLimit"
          },
          {
            "$ref": "#/components/parameters/PaginationOffset"
          },
          {
            "$ref": "#/components/parameters/SortQueryParam"
          },
          {
            "$ref": "#/components/parameters/CreatedAfter"
          },
          {
            "$ref": "#/components/parameters/CreatedBefore"
          },
          {
            "$ref": "#/components/parameters/ModifiedAfter"
          },
          {
            "$ref": "#/components/parameters/ModifiedBefore"
          }
        ],
        "responses": {
          "200": {
            "description": "Paginated list of surveys",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListSurveysResponse"
                },
                "example": {
                  "total": 1,
                  "limit": 20,
                  "offset": 0,
                  "surveys": [
                    {
                      "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                      "name": "Security Review Intake",
                      "description": "Standard security review intake questionnaire",
                      "version": "2024-Q1",
                      "status": "active",
                      "created_at": "2024-01-15T10:30:00Z",
                      "modified_at": "2024-02-01T14:00:00Z",
                      "created_by": {
                        "principal_type": "user",
                        "provider": "google",
                        "provider_id": "118234567890123456789",
                        "display_name": "Admin User",
                        "email": "admin@example.com"
                      }
                    }
                  ]
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "x-admin-only": true,
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Survey Administration"
        ],
        "summary": "Create a survey",
        "description": "Creates a new survey. Surveys are created in inactive status by default.",
        "operationId": "createAdminSurvey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SurveyInput"
              }
            }
          },
          "description": "Survey definition to create"
        },
        "responses": {
          "201": {
            "description": "Survey created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Survey"
                },
                "example": {
                  "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                  "name": "Security Review Intake",
                  "description": "Standard security review intake questionnaire for new projects",
                  "version": "2024-Q1",
                  "status": "active",
                  "settings": {
                    "allow_threat_model_linking": true
                  },
                  "survey_json": {
                    "pages": [
                      {
                        "name": "project_info",
                        "elements": [
                          {
                            "type": "text",
                            "name": "project_name",
                            "title": "Project Name"
                          }
                        ]
                      }
                    ]
                  },
                  "metadata": [],
                  "created_at": "2024-01-15T10:30:00Z",
                  "modified_at": "2024-02-01T14:00:00Z",
                  "created_by": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "118234567890123456789",
                    "display_name": "Admin User",
                    "email": "admin@example.com"
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "409": {
            "description": "Conflict - survey name/version already exists",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "x-admin-only": true,
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/admin/surveys/{survey_id}": {
      "get": {
        "tags": [
          "Survey Administration"
        ],
        "summary": "Get a survey",
        "description": "Returns a specific survey by ID.",
        "operationId": "getAdminSurvey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyId"
          }
        ],
        "responses": {
          "200": {
            "description": "Survey details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Survey"
                },
                "example": {
                  "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                  "name": "Security Review Intake",
                  "description": "Standard security review intake questionnaire for new projects",
                  "version": "2024-Q1",
                  "status": "active",
                  "settings": {
                    "allow_threat_model_linking": true
                  },
                  "survey_json": {
                    "pages": [
                      {
                        "name": "project_info",
                        "elements": [
                          {
                            "type": "text",
                            "name": "project_name",
                            "title": "Project Name"
                          }
                        ]
                      }
                    ]
                  },
                  "metadata": [],
                  "created_at": "2024-01-15T10:30:00Z",
                  "modified_at": "2024-02-01T14:00:00Z",
                  "created_by": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "118234567890123456789",
                    "display_name": "Admin User",
                    "email": "admin@example.com"
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-admin-only": true,
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Survey Administration"
        ],
        "summary": "Update a survey",
        "description": "Fully updates a survey. All fields are replaced.",
        "operationId": "updateAdminSurvey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SurveyInput"
              }
            }
          },
          "description": "Complete survey definition to replace existing"
        },
        "responses": {
          "200": {
            "description": "Survey updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Survey"
                },
                "example": {
                  "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                  "name": "Security Review Intake",
                  "description": "Standard security review intake questionnaire for new projects",
                  "version": "2024-Q1",
                  "status": "active",
                  "settings": {
                    "allow_threat_model_linking": true
                  },
                  "survey_json": {
                    "pages": [
                      {
                        "name": "project_info",
                        "elements": [
                          {
                            "type": "text",
                            "name": "project_name",
                            "title": "Project Name"
                          }
                        ]
                      }
                    ]
                  },
                  "metadata": [],
                  "created_at": "2024-01-15T10:30:00Z",
                  "modified_at": "2024-02-01T14:00:00Z",
                  "created_by": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "118234567890123456789",
                    "display_name": "Admin User",
                    "email": "admin@example.com"
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "409": {
            "description": "Conflict",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "x-admin-only": true,
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "tags": [
          "Survey Administration"
        ],
        "summary": "Partially update a survey",
        "description": "Partially updates a survey using JSON Patch (RFC 6902).",
        "operationId": "patchAdminSurvey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json-patch+json": {
              "schema": {
                "$ref": "#/components/schemas/JsonPatchDocument"
              },
              "example": [
                {
                  "op": "replace",
                  "path": "/name",
                  "value": "Updated Survey Name"
                },
                {
                  "op": "replace",
                  "path": "/status",
                  "value": "active"
                }
              ]
            }
          },
          "description": "JSON Patch operations to apply to the survey"
        },
        "responses": {
          "200": {
            "description": "Survey patched successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Survey"
                },
                "example": {
                  "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                  "name": "Security Review Intake",
                  "description": "Standard security review intake questionnaire for new projects",
                  "version": "2024-Q1",
                  "status": "active",
                  "settings": {
                    "allow_threat_model_linking": true
                  },
                  "survey_json": {
                    "pages": [
                      {
                        "name": "project_info",
                        "elements": [
                          {
                            "type": "text",
                            "name": "project_name",
                            "title": "Project Name"
                          }
                        ]
                      }
                    ]
                  },
                  "metadata": [],
                  "created_at": "2024-01-15T10:30:00Z",
                  "modified_at": "2024-02-01T14:00:00Z",
                  "created_by": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "118234567890123456789",
                    "display_name": "Admin User",
                    "email": "admin@example.com"
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "409": {
            "description": "Conflict - survey has been modified by another request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-admin-only": true,
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Survey Administration"
        ],
        "summary": "Delete a survey",
        "description": "Deletes a survey. Surveys with existing responses cannot be deleted.",
        "operationId": "deleteAdminSurvey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyId"
          }
        ],
        "responses": {
          "204": {
            "description": "Survey deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "409": {
            "description": "Conflict - survey has responses",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-admin-only": true,
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/intake/surveys": {
      "get": {
        "tags": [
          "Survey Intake"
        ],
        "summary": "List available surveys",
        "description": "Returns a list of active surveys available for developers to fill out.",
        "operationId": "listIntakeSurveys",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/PaginationLimit"
          },
          {
            "$ref": "#/components/parameters/PaginationOffset"
          },
          {
            "$ref": "#/components/parameters/CreatedAfter"
          },
          {
            "$ref": "#/components/parameters/CreatedBefore"
          },
          {
            "$ref": "#/components/parameters/ModifiedAfter"
          },
          {
            "$ref": "#/components/parameters/ModifiedBefore"
          }
        ],
        "responses": {
          "200": {
            "description": "List of active surveys",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListSurveysResponse"
                },
                "example": {
                  "total": 1,
                  "limit": 20,
                  "offset": 0,
                  "surveys": [
                    {
                      "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                      "name": "Security Review Intake",
                      "description": "Standard security review intake questionnaire",
                      "version": "2024-Q1",
                      "status": "active",
                      "created_at": "2024-01-15T10:30:00Z",
                      "modified_at": "2024-02-01T14:00:00Z",
                      "created_by": {
                        "principal_type": "user",
                        "provider": "google",
                        "provider_id": "118234567890123456789",
                        "display_name": "Admin User",
                        "email": "admin@example.com"
                      }
                    }
                  ]
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "$ref": "#/components/responses/Error"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/intake/surveys/{survey_id}": {
      "get": {
        "tags": [
          "Survey Intake"
        ],
        "summary": "Get an available survey",
        "description": "Returns a specific active survey with all questions for the developer to fill out.",
        "operationId": "getIntakeSurvey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyId"
          }
        ],
        "responses": {
          "200": {
            "description": "Survey details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Survey"
                },
                "example": {
                  "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                  "name": "Security Review Intake",
                  "description": "Standard security review intake questionnaire for new projects",
                  "version": "2024-Q1",
                  "status": "active",
                  "settings": {
                    "allow_threat_model_linking": true
                  },
                  "survey_json": {
                    "pages": [
                      {
                        "name": "project_info",
                        "elements": [
                          {
                            "type": "text",
                            "name": "project_name",
                            "title": "Project Name"
                          }
                        ]
                      }
                    ]
                  },
                  "metadata": [],
                  "created_at": "2024-01-15T10:30:00Z",
                  "modified_at": "2024-02-01T14:00:00Z",
                  "created_by": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "118234567890123456789",
                    "display_name": "Admin User",
                    "email": "admin@example.com"
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/intake/survey_responses": {
      "get": {
        "tags": [
          "Survey Intake"
        ],
        "summary": "List user's survey responses",
        "description": "Returns a paginated list of the current user's survey responses.",
        "operationId": "listIntakeSurveyResponses",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseStatusQueryParam"
          },
          {
            "$ref": "#/components/parameters/SurveyIdQueryParam"
          },
          {
            "$ref": "#/components/parameters/PaginationLimit"
          },
          {
            "$ref": "#/components/parameters/PaginationOffset"
          },
          {
            "$ref": "#/components/parameters/SortQueryParam"
          },
          {
            "$ref": "#/components/parameters/CreatedAfter"
          },
          {
            "$ref": "#/components/parameters/CreatedBefore"
          },
          {
            "$ref": "#/components/parameters/ModifiedAfter"
          },
          {
            "$ref": "#/components/parameters/ModifiedBefore"
          }
        ],
        "responses": {
          "200": {
            "description": "List of user's survey responses",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListSurveyResponsesResponse"
                },
                "example": {
                  "total": 1,
                  "limit": 20,
                  "offset": 0,
                  "survey_responses": [
                    {
                      "id": "b2c3d4e5-f6a7-8901-bcde-f12345678901",
                      "survey_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                      "survey_name": "Security Review Intake",
                      "survey_version": "2024-Q1",
                      "status": "submitted",
                      "is_confidential": false,
                      "owner": {
                        "principal_type": "user",
                        "provider": "google",
                        "provider_id": "109876543210987654321",
                        "display_name": "Alice Developer",
                        "email": "alice@example.com"
                      },
                      "created_at": "2024-02-15T09:00:00Z",
                      "submitted_at": "2024-02-15T10:30:00Z",
                      "modified_at": "2024-02-15T10:30:00Z"
                    }
                  ]
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "$ref": "#/components/responses/Error"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        },
        "x-skip-idor-check": true
      },
      "post": {
        "tags": [
          "Survey Intake"
        ],
        "summary": "Create survey response",
        "description": "Creates a new survey response in draft status. The secret_project flag can only be set here.",
        "operationId": "createIntakeSurveyResponse",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SurveyResponseCreateRequest"
              }
            }
          },
          "description": "Survey response to create"
        },
        "responses": {
          "201": {
            "description": "Response created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SurveyResponse"
                },
                "example": {
                  "id": "b2c3d4e5-f6a7-8901-bcde-f12345678901",
                  "survey_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                  "survey_version": "2024-Q1",
                  "status": "draft",
                  "is_confidential": false,
                  "answers": {
                    "project_name": "My New Service",
                    "data_classification": "confidential"
                  },
                  "authorization": [
                    {
                      "principal_type": "user",
                      "provider": "google",
                      "provider_id": "109876543210987654321",
                      "role": "owner"
                    }
                  ],
                  "survey_json": {
                    "pages": [
                      {
                        "elements": [
                          {
                            "name": "project_name",
                            "title": "Project Name",
                            "type": "text"
                          }
                        ],
                        "name": "project_info"
                      }
                    ]
                  },
                  "metadata": null,
                  "owner": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "109876543210987654321",
                    "display_name": "Alice Developer",
                    "email": "alice@example.com"
                  },
                  "created_by": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "109876543210987654321",
                    "display_name": "Alice Developer",
                    "email": "alice@example.com"
                  },
                  "created_at": "2024-02-15T09:00:00Z",
                  "modified_at": "2024-02-15T09:00:00Z",
                  "submitted_at": null,
                  "reviewed_at": null,
                  "revision_notes": null,
                  "created_threat_model_id": null,
                  "linked_threat_model_id": null,
                  "ui_state": null
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/intake/survey_responses/{survey_response_id}": {
      "get": {
        "tags": [
          "Survey Intake"
        ],
        "summary": "Get survey response",
        "description": "Returns a specific survey response. Requires reader access.",
        "operationId": "getIntakeSurveyResponse",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          }
        ],
        "responses": {
          "200": {
            "description": "Survey response details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SurveyResponse"
                },
                "example": {
                  "id": "b2c3d4e5-f6a7-8901-bcde-f12345678901",
                  "survey_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                  "survey_version": "2024-Q1",
                  "status": "submitted",
                  "is_confidential": false,
                  "answers": {
                    "project_name": "My New Service",
                    "data_classification": "confidential"
                  },
                  "authorization": [
                    {
                      "principal_type": "user",
                      "provider": "google",
                      "provider_id": "109876543210987654321",
                      "role": "writer"
                    }
                  ],
                  "metadata": [],
                  "owner": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "109876543210987654321",
                    "display_name": "Alice Developer",
                    "email": "alice@example.com"
                  },
                  "created_at": "2024-02-15T09:00:00Z",
                  "submitted_at": "2024-02-15T10:30:00Z",
                  "modified_at": "2024-02-15T10:30:00Z",
                  "created_by": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "109876543210987654321",
                    "display_name": "Alice Developer",
                    "email": "alice@example.com"
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Survey Intake"
        ],
        "summary": "Update survey response",
        "description": "Fully updates a survey response. Only allowed in draft or needs_revision status. Requires writer access.",
        "operationId": "updateIntakeSurveyResponse",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SurveyResponseInput"
              }
            }
          },
          "description": "Complete survey response to replace existing"
        },
        "responses": {
          "200": {
            "description": "Response updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SurveyResponse"
                },
                "example": {
                  "id": "b2c3d4e5-f6a7-8901-bcde-f12345678901",
                  "survey_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                  "survey_version": "2024-Q1",
                  "status": "submitted",
                  "is_confidential": false,
                  "answers": {
                    "project_name": "My New Service",
                    "data_classification": "confidential"
                  },
                  "authorization": [
                    {
                      "principal_type": "user",
                      "provider": "google",
                      "provider_id": "109876543210987654321",
                      "role": "writer"
                    }
                  ],
                  "metadata": [],
                  "owner": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "109876543210987654321",
                    "display_name": "Alice Developer",
                    "email": "alice@example.com"
                  },
                  "created_at": "2024-02-15T09:00:00Z",
                  "submitted_at": "2024-02-15T10:30:00Z",
                  "modified_at": "2024-02-15T10:30:00Z",
                  "created_by": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "109876543210987654321",
                    "display_name": "Alice Developer",
                    "email": "alice@example.com"
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "409": {
            "description": "Conflict - invalid status for edit",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "tags": [
          "Survey Intake"
        ],
        "summary": "Partial update survey response",
        "description": "Partially updates a survey response using JSON Patch (RFC 6902). Status transitions are allowed via /status path. Valid statuses: draft, submitted, needs_revision, ready_for_review, review_created. Transitioning to needs_revision requires revision_notes.",
        "operationId": "patchIntakeSurveyResponse",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json-patch+json": {
              "schema": {
                "$ref": "#/components/schemas/JsonPatchDocument"
              },
              "example": [
                {
                  "op": "replace",
                  "path": "/answers/project_name",
                  "value": "Updated Project"
                },
                {
                  "op": "replace",
                  "path": "/status",
                  "value": "submitted"
                }
              ]
            }
          },
          "description": "JSON Patch operations to apply to the survey response"
        },
        "responses": {
          "200": {
            "description": "Response patched successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SurveyResponse"
                },
                "example": {
                  "id": "b2c3d4e5-f6a7-8901-bcde-f12345678901",
                  "survey_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                  "survey_version": "2024-Q1",
                  "status": "submitted",
                  "is_confidential": false,
                  "answers": {
                    "project_name": "My New Service",
                    "data_classification": "confidential"
                  },
                  "authorization": [
                    {
                      "principal_type": "user",
                      "provider": "google",
                      "provider_id": "109876543210987654321",
                      "role": "writer"
                    }
                  ],
                  "metadata": [],
                  "owner": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "109876543210987654321",
                    "display_name": "Alice Developer",
                    "email": "alice@example.com"
                  },
                  "created_at": "2024-02-15T09:00:00Z",
                  "submitted_at": "2024-02-15T10:30:00Z",
                  "modified_at": "2024-02-15T10:30:00Z",
                  "created_by": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "109876543210987654321",
                    "display_name": "Alice Developer",
                    "email": "alice@example.com"
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "409": {
            "description": "Conflict - invalid status for edit",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Survey Intake"
        ],
        "summary": "Delete survey response",
        "description": "Deletes a survey response. Requires owner access.",
        "operationId": "deleteIntakeSurveyResponse",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          }
        ],
        "responses": {
          "204": {
            "description": "Response deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/triage/survey_responses": {
      "get": {
        "tags": [
          "Survey Triage"
        ],
        "summary": "List survey responses for triage",
        "description": "Returns a paginated list of survey responses for security engineers to triage. Filter by status=submitted to see the triage queue.",
        "operationId": "listTriageSurveyResponses",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseStatusQueryParam"
          },
          {
            "$ref": "#/components/parameters/SurveyIdQueryParam"
          },
          {
            "$ref": "#/components/parameters/IsConfidentialQueryParam"
          },
          {
            "$ref": "#/components/parameters/PaginationLimit"
          },
          {
            "$ref": "#/components/parameters/PaginationOffset"
          },
          {
            "$ref": "#/components/parameters/SortQueryParam"
          },
          {
            "$ref": "#/components/parameters/CreatedAfter"
          },
          {
            "$ref": "#/components/parameters/CreatedBefore"
          },
          {
            "$ref": "#/components/parameters/ModifiedAfter"
          },
          {
            "$ref": "#/components/parameters/ModifiedBefore"
          }
        ],
        "responses": {
          "200": {
            "description": "List of survey responses",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListSurveyResponsesResponse"
                },
                "example": {
                  "total": 1,
                  "limit": 20,
                  "offset": 0,
                  "survey_responses": [
                    {
                      "id": "b2c3d4e5-f6a7-8901-bcde-f12345678901",
                      "survey_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                      "survey_name": "Security Review Intake",
                      "survey_version": "2024-Q1",
                      "status": "submitted",
                      "is_confidential": false,
                      "owner": {
                        "principal_type": "user",
                        "provider": "google",
                        "provider_id": "109876543210987654321",
                        "display_name": "Alice Developer",
                        "email": "alice@example.com"
                      },
                      "created_at": "2024-02-15T09:00:00Z",
                      "submitted_at": "2024-02-15T10:30:00Z",
                      "modified_at": "2024-02-15T10:30:00Z"
                    }
                  ]
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/triage/survey_responses/{survey_response_id}": {
      "get": {
        "tags": [
          "Survey Triage"
        ],
        "summary": "Get survey response for triage",
        "description": "Returns a specific survey response for security engineer review.",
        "operationId": "getTriageSurveyResponse",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          }
        ],
        "responses": {
          "200": {
            "description": "Survey response details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SurveyResponse"
                },
                "example": {
                  "id": "b2c3d4e5-f6a7-8901-bcde-f12345678901",
                  "survey_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                  "survey_version": "2024-Q1",
                  "status": "submitted",
                  "is_confidential": false,
                  "answers": {
                    "project_name": "My New Service",
                    "data_classification": "confidential"
                  },
                  "authorization": [
                    {
                      "principal_type": "user",
                      "provider": "google",
                      "provider_id": "109876543210987654321",
                      "role": "writer"
                    }
                  ],
                  "metadata": [],
                  "owner": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "109876543210987654321",
                    "display_name": "Alice Developer",
                    "email": "alice@example.com"
                  },
                  "created_at": "2024-02-15T09:00:00Z",
                  "submitted_at": "2024-02-15T10:30:00Z",
                  "modified_at": "2024-02-15T10:30:00Z",
                  "created_by": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "109876543210987654321",
                    "display_name": "Alice Developer",
                    "email": "alice@example.com"
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "tags": [
          "Survey Triage"
        ],
        "summary": "Partial update survey response for triage",
        "description": "Partially updates a survey response using JSON Patch (RFC 6902). Security Reviewers can change status via /status path. Valid statuses: draft, submitted, needs_revision, ready_for_review, review_created. Transitioning to needs_revision requires revision_notes.",
        "operationId": "patchTriageSurveyResponse",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json-patch+json": {
              "schema": {
                "$ref": "#/components/schemas/JsonPatchDocument"
              },
              "example": [
                {
                  "op": "replace",
                  "path": "/status",
                  "value": "ready_for_review"
                }
              ]
            }
          },
          "description": "JSON Patch operations to apply to the survey response during triage"
        },
        "responses": {
          "200": {
            "description": "Response patched successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SurveyResponse"
                },
                "example": {
                  "id": "b2c3d4e5-f6a7-8901-bcde-f12345678901",
                  "survey_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                  "survey_version": "2024-Q1",
                  "status": "submitted",
                  "is_confidential": false,
                  "answers": {
                    "project_name": "My New Service",
                    "data_classification": "confidential"
                  },
                  "authorization": [
                    {
                      "principal_type": "user",
                      "provider": "google",
                      "provider_id": "109876543210987654321",
                      "role": "writer"
                    }
                  ],
                  "metadata": [],
                  "owner": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "109876543210987654321",
                    "display_name": "Alice Developer",
                    "email": "alice@example.com"
                  },
                  "created_at": "2024-02-15T09:00:00Z",
                  "submitted_at": "2024-02-15T10:30:00Z",
                  "modified_at": "2024-02-15T10:30:00Z",
                  "created_by": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "109876543210987654321",
                    "display_name": "Alice Developer",
                    "email": "alice@example.com"
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "409": {
            "description": "Conflict - invalid status for edit",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "x-admin-only": true,
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/triage/survey_responses/{survey_response_id}/create_threat_model": {
      "post": {
        "tags": [
          "Survey Triage"
        ],
        "summary": "Create threat model from survey response",
        "description": "Creates a new threat model from an approved survey response. Copies answers to TM metadata, sets owner to survey owner, and transitions response to review_created.",
        "operationId": "createThreatModelFromSurveyResponse",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          }
        ],
        "responses": {
          "201": {
            "description": "Threat model created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateThreatModelFromSurveyResponse"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "409": {
            "description": "Conflict - not in ready_for_review status",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/admin/surveys/{survey_id}/metadata": {
      "get": {
        "tags": [
          "Survey Administration"
        ],
        "summary": "Get all metadata for a survey",
        "description": "Returns all metadata key-value pairs for the specified survey",
        "operationId": "getAdminSurveyMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyId"
          }
        ],
        "responses": {
          "200": {
            "description": "Resource metadata",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        },
        "x-admin-only": true
      },
      "post": {
        "tags": [
          "Survey Administration"
        ],
        "summary": "Add metadata to a survey",
        "description": "Adds a new metadata key-value pair to the specified survey. Returns 409 Conflict if the key already exists.",
        "operationId": "createAdminSurveyMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyId"
          }
        ],
        "requestBody": {
          "required": true,
          "description": "Metadata key-value pair to create",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Metadata created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Conflict - Metadata key already exists for this entity",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        },
        "x-admin-only": true
      }
    },
    "/admin/surveys/{survey_id}/metadata/{key}": {
      "get": {
        "tags": [
          "Survey Administration"
        ],
        "summary": "Get metadata by key for a survey",
        "description": "Returns a specific metadata entry by key for the specified survey",
        "operationId": "getAdminSurveyMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "responses": {
          "200": {
            "description": "Metadata entry",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        },
        "x-admin-only": true
      },
      "put": {
        "tags": [
          "Survey Administration"
        ],
        "summary": "Update metadata by key for a survey",
        "description": "Updates or creates a metadata entry by key for the specified survey",
        "operationId": "updateAdminSurveyMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "requestBody": {
          "required": true,
          "description": "Metadata key-value pair to update",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Metadata entry",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        },
        "x-admin-only": true
      },
      "delete": {
        "tags": [
          "Survey Administration"
        ],
        "summary": "Delete metadata by key for a survey",
        "description": "Deletes a specific metadata entry by key for the specified survey",
        "operationId": "deleteAdminSurveyMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "responses": {
          "204": {
            "description": "Metadata deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        },
        "x-admin-only": true
      }
    },
    "/admin/surveys/{survey_id}/metadata/bulk": {
      "post": {
        "tags": [
          "Survey Administration"
        ],
        "summary": "Bulk create metadata for a survey",
        "description": "Creates multiple metadata key-value pairs for the specified survey. Returns 409 Conflict if any of the specified keys already exist.",
        "operationId": "bulkCreateAdminSurveyMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyId"
          }
        ],
        "requestBody": {
          "required": true,
          "description": "Array of metadata key-value pairs to create",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 100
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Metadata created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Conflict - One or more metadata keys already exist for this entity",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        },
        "x-admin-only": true
      },
      "put": {
        "tags": [
          "Survey Administration"
        ],
        "summary": "Bulk replace metadata for a survey",
        "description": "Replaces all metadata for the entity. All existing metadata is deleted and replaced with the provided set. To clear all metadata, send an empty array.",
        "operationId": "bulkReplaceAdminSurveyMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyId"
          }
        ],
        "requestBody": {
          "required": true,
          "description": "Complete set of metadata key-value pairs to replace existing metadata",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 100
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Metadata replaced successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        },
        "x-admin-only": true
      },
      "patch": {
        "tags": [
          "Survey Administration"
        ],
        "summary": "Bulk upsert metadata for a survey",
        "description": "Creates or updates only the provided metadata keys. Keys not included in the request are left unchanged. This is a merge/upsert operation.",
        "operationId": "bulkUpsertAdminSurveyMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyId"
          }
        ],
        "requestBody": {
          "required": true,
          "description": "Metadata key-value pairs to create or update (merge)",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 100
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Metadata upserted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        },
        "x-admin-only": true
      }
    },
    "/intake/survey_responses/{survey_response_id}/metadata": {
      "get": {
        "tags": [
          "Survey Intake"
        ],
        "summary": "Get all metadata for a survey response",
        "description": "Returns all metadata key-value pairs for the specified survey response",
        "operationId": "getIntakeSurveyResponseMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          }
        ],
        "responses": {
          "200": {
            "description": "Resource metadata",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Survey Intake"
        ],
        "summary": "Add metadata to a survey response",
        "description": "Adds a new metadata key-value pair to the specified survey response. Returns 409 Conflict if the key already exists.",
        "operationId": "createIntakeSurveyResponseMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          }
        ],
        "requestBody": {
          "required": true,
          "description": "Metadata key-value pair to create",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Metadata created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Conflict - Metadata key already exists for this entity",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/intake/survey_responses/{survey_response_id}/metadata/{key}": {
      "get": {
        "tags": [
          "Survey Intake"
        ],
        "summary": "Get metadata by key for a survey response",
        "description": "Returns a specific metadata entry by key for the specified survey response",
        "operationId": "getIntakeSurveyResponseMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "responses": {
          "200": {
            "description": "Metadata entry",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Survey Intake"
        ],
        "summary": "Update metadata by key for a survey response",
        "description": "Updates or creates a metadata entry by key for the specified survey response",
        "operationId": "updateIntakeSurveyResponseMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "requestBody": {
          "required": true,
          "description": "Metadata key-value pair to update",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Metadata entry",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Survey Intake"
        ],
        "summary": "Delete metadata by key for a survey response",
        "description": "Deletes a specific metadata entry by key for the specified survey response",
        "operationId": "deleteIntakeSurveyResponseMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "responses": {
          "204": {
            "description": "Metadata deleted successfully",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/intake/survey_responses/{survey_response_id}/metadata/bulk": {
      "post": {
        "tags": [
          "Survey Intake"
        ],
        "summary": "Bulk create metadata for a survey response",
        "description": "Creates multiple metadata key-value pairs for the specified survey response. Returns 409 Conflict if any of the specified keys already exist.",
        "operationId": "bulkCreateIntakeSurveyResponseMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          }
        ],
        "requestBody": {
          "required": true,
          "description": "Array of metadata key-value pairs to create",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 100
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Metadata created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Conflict - One or more metadata keys already exist for this entity",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Survey Intake"
        ],
        "summary": "Bulk replace metadata for a survey response",
        "description": "Replaces all metadata for the entity. All existing metadata is deleted and replaced with the provided set. To clear all metadata, send an empty array.",
        "operationId": "bulkReplaceIntakeSurveyResponseMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          }
        ],
        "requestBody": {
          "required": true,
          "description": "Complete set of metadata key-value pairs to replace existing metadata",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 100
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Metadata replaced successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "tags": [
          "Survey Intake"
        ],
        "summary": "Bulk upsert metadata for a survey response",
        "description": "Creates or updates only the provided metadata keys. Keys not included in the request are left unchanged. This is a merge/upsert operation.",
        "operationId": "bulkUpsertIntakeSurveyResponseMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          }
        ],
        "requestBody": {
          "required": true,
          "description": "Metadata key-value pairs to create or update (merge)",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 100
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Metadata upserted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/triage/survey_responses/{survey_response_id}/metadata": {
      "get": {
        "tags": [
          "Survey Triage"
        ],
        "summary": "Get all metadata for a survey response",
        "description": "Returns all metadata key-value pairs for the specified survey response (read-only triage access)",
        "operationId": "getTriageSurveyResponseMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          }
        ],
        "responses": {
          "200": {
            "description": "Resource metadata",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/triage/survey_responses/{survey_response_id}/metadata/{key}": {
      "get": {
        "tags": [
          "Survey Triage"
        ],
        "summary": "Get metadata by key for a survey response",
        "description": "Returns a specific metadata entry by key for the specified survey response (read-only triage access)",
        "operationId": "getTriageSurveyResponseMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          },
          {
            "$ref": "#/components/parameters/MetadataKey"
          }
        ],
        "responses": {
          "200": {
            "description": "Metadata entry",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/triage/survey_responses/{survey_response_id}/triage_notes": {
      "get": {
        "tags": [
          "Survey Triage"
        ],
        "summary": "List triage notes for a survey response",
        "description": "Returns a paginated list of triage notes attached to the specified survey response. Only accessible to security reviewers.",
        "operationId": "listTriageSurveyResponseTriageNotes",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          },
          {
            "$ref": "#/components/parameters/PaginationLimit"
          },
          {
            "$ref": "#/components/parameters/PaginationOffset"
          }
        ],
        "responses": {
          "200": {
            "description": "List of triage notes",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListTriageNotesResponse"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Survey Triage"
        ],
        "summary": "Create a triage note",
        "description": "Creates a new triage note on the specified survey response. Only accessible to security reviewers.",
        "operationId": "createTriageSurveyResponseTriageNote",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TriageNoteInput"
              }
            }
          },
          "description": "Triage note creation data"
        },
        "responses": {
          "201": {
            "description": "Triage note created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TriageNote"
                },
                "example": {
                  "id": 1,
                  "name": "Initial Triage Assessment",
                  "content": "Reviewed survey response. Key observations:\n- Data classification is confidential\n- Requires security architecture review",
                  "created_at": "2024-02-20T14:30:00Z",
                  "created_by": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "109876543210987654321",
                    "display_name": "Alice Developer",
                    "email": "alice@example.com"
                  },
                  "modified_at": "2024-02-20T14:30:00Z"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/triage/survey_responses/{survey_response_id}/triage_notes/{triage_note_id}": {
      "get": {
        "tags": [
          "Survey Triage"
        ],
        "summary": "Get a specific triage note",
        "description": "Returns details of a specific triage note within the survey response. Only accessible to security reviewers.",
        "operationId": "getTriageSurveyResponseTriageNote",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          },
          {
            "$ref": "#/components/parameters/TriageNoteId"
          }
        ],
        "responses": {
          "200": {
            "description": "Triage note details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TriageNote"
                },
                "example": {
                  "id": 1,
                  "name": "Initial Triage Assessment",
                  "content": "Reviewed survey response. Key observations:\n- Data classification is confidential\n- Requires security architecture review",
                  "created_at": "2024-02-20T14:30:00Z",
                  "created_by": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "109876543210987654321",
                    "display_name": "Alice Developer",
                    "email": "alice@example.com"
                  },
                  "modified_at": "2024-02-20T15:00:00Z",
                  "modified_by": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "109876543210987654321",
                    "display_name": "Alice Developer",
                    "email": "alice@example.com"
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/intake/survey_responses/{survey_response_id}/triage_notes": {
      "get": {
        "tags": [
          "Survey Intake"
        ],
        "summary": "List triage notes for a survey response",
        "description": "Returns a paginated list of triage notes for the specified survey response. Read-only access for survey response submitters.",
        "operationId": "listIntakeSurveyResponseTriageNotes",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          },
          {
            "$ref": "#/components/parameters/PaginationLimit"
          },
          {
            "$ref": "#/components/parameters/PaginationOffset"
          }
        ],
        "responses": {
          "200": {
            "description": "List of triage notes",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListTriageNotesResponse"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/intake/survey_responses/{survey_response_id}/triage_notes/{triage_note_id}": {
      "get": {
        "tags": [
          "Survey Intake"
        ],
        "summary": "Get a specific triage note",
        "description": "Returns details of a specific triage note. Read-only access for survey response submitters.",
        "operationId": "getIntakeSurveyResponseTriageNote",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SurveyResponseId"
          },
          {
            "$ref": "#/components/parameters/TriageNoteId"
          }
        ],
        "responses": {
          "200": {
            "description": "Triage note details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TriageNote"
                },
                "example": {
                  "id": 1,
                  "name": "Initial Triage Assessment",
                  "content": "Reviewed survey response. Key observations:\n- Data classification is confidential\n- Requires security architecture review",
                  "created_at": "2024-02-20T14:30:00Z",
                  "created_by": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "109876543210987654321",
                    "display_name": "Alice Developer",
                    "email": "alice@example.com"
                  },
                  "modified_at": "2024-02-20T15:00:00Z",
                  "modified_by": {
                    "principal_type": "user",
                    "provider": "google",
                    "provider_id": "109876543210987654321",
                    "display_name": "Alice Developer",
                    "email": "alice@example.com"
                  }
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid parameters, malformed UUIDs, or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/admin/settings/reencrypt": {
      "post": {
        "tags": [
          "Administration"
        ],
        "summary": "Re-encrypt all system settings",
        "description": "Re-encrypts all system settings with the current encryption key. Use this after rotating the encryption key or when first enabling encryption on existing settings. Requires administrator privileges. Settings that cannot be decrypted are reported as errors but do not prevent other settings from being processed.",
        "operationId": "reencryptSystemSettings",
        "responses": {
          "200": {
            "description": "Re-encryption completed",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "reencrypted": {
                      "type": "integer",
                      "description": "Number of settings successfully re-encrypted",
                      "example": 8
                    },
                    "errors": {
                      "type": "array",
                      "description": "Settings that failed re-encryption",
                      "items": {
                        "type": "object",
                        "properties": {
                          "key": {
                            "type": "string",
                            "description": "The setting key that failed"
                          },
                          "error": {
                            "type": "string",
                            "description": "Description of the failure"
                          }
                        },
                        "required": [
                          "key",
                          "error"
                        ]
                      },
                      "maxItems": 1000,
                      "example": [
                        {
                          "key": "smtp.password",
                          "error": "decryption failed: invalid key"
                        }
                      ]
                    },
                    "total": {
                      "type": "integer",
                      "description": "Total number of settings processed",
                      "example": 8
                    }
                  },
                  "required": [
                    "reencrypted",
                    "errors",
                    "total"
                  ]
                },
                "example": {
                  "reencrypted": 8,
                  "errors": [],
                  "total": 8
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "409": {
            "description": "Conflict - Encryption is not enabled on this server",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "error": "encryption_not_enabled",
                  "error_description": "Encryption is not enabled"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad request - Invalid or malformed request body",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/me/transfer": {
      "post": {
        "summary": "Transfer ownership of all owned resources",
        "description": "Transfers ownership of all threat models and survey responses owned by the current user to the specified target user. The current user is downgraded to writer role on all transferred items.",
        "operationId": "transferCurrentUserOwnership",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TransferOwnershipRequest"
              }
            }
          },
          "description": "Ownership transfer request specifying the target user"
        },
        "responses": {
          "200": {
            "description": "Ownership transferred successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TransferOwnershipResult"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid target user ID or attempting to transfer to self",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - missing or invalid JWT token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Target user not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          }
        }
      }
    },
    "/admin/users/{internal_uuid}/transfer": {
      "post": {
        "summary": "Transfer user ownership to another user",
        "description": "Transfers ownership of all threat models and survey responses owned by the specified user to the target user. The source user is downgraded to writer role on all transferred items. Requires administrator privileges.",
        "operationId": "transferAdminUserOwnership",
        "tags": [
          "Administration"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/InternalUuidPathParam"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TransferOwnershipRequest"
              }
            }
          },
          "description": "Ownership transfer request specifying the target user"
        },
        "responses": {
          "200": {
            "description": "Ownership transferred successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TransferOwnershipResult"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters or attempting to transfer to same user",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions to access this resource",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Source or target user not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "description": "Too many requests - rate limit exceeded",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message",
                      "example": "rate_limit_exceeded"
                    },
                    "retry_after": {
                      "type": "integer",
                      "description": "Seconds until rate limit resets",
                      "example": 60
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "example": {
                  "error": "Rate limit exceeded. Please try again later.",
                  "retry_after": 60
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        },
        "x-admin-only": true
      }
    },
    "/teams": {
      "get": {
        "summary": "List teams",
        "description": "Returns a paginated list of teams. Non-admin users see only teams they are members of.",
        "operationId": "ListTeams",
        "tags": [
          "Teams"
        ],
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 20,
              "minimum": 1,
              "maximum": 1000
            },
            "description": "Maximum number of results per page"
          },
          {
            "name": "offset",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 0,
              "minimum": 0
            },
            "description": "Number of results to skip"
          },
          {
            "name": "name",
            "in": "query",
            "schema": {
              "type": "string",
              "maxLength": 256
            },
            "description": "Filter by team name (partial match)"
          },
          {
            "name": "status",
            "in": "query",
            "schema": {
              "type": "string",
              "maxLength": 256
            },
            "description": "Filter by status (exact match, comma-separated for multiple)"
          },
          {
            "name": "member_user_id",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Filter teams that include this user as a member"
          },
          {
            "name": "related_to",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Include teams related to this team ID"
          },
          {
            "name": "relationship",
            "in": "query",
            "schema": {
              "$ref": "#/components/schemas/RelationshipType"
            },
            "description": "Filter related teams by relationship type. Only used with related_to."
          },
          {
            "name": "transitive",
            "in": "query",
            "schema": {
              "type": "boolean",
              "default": false
            },
            "description": "When true with related_to + relationship, follow parent/child chains transitively (max depth 10)"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListTeamsResponse"
                },
                "example": {
                  "teams": [
                    {
                      "id": "550e8400-e29b-41d4-a716-446655440000",
                      "name": "Platform Engineering",
                      "description": "Core platform infrastructure team",
                      "status": "active",
                      "created_at": "2025-01-15T10:30:00Z",
                      "modified_at": "2025-06-20T14:22:00Z"
                    }
                  ],
                  "total": 1,
                  "limit": 20,
                  "offset": 0
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "summary": "Create a team",
        "description": "Creates a new team. The creating user is automatically added as a member.",
        "operationId": "CreateTeam",
        "tags": [
          "Teams"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TeamInput"
              },
              "example": {
                "name": "Platform Engineering",
                "description": "Core platform infrastructure team"
              }
            }
          },
          "description": "Team creation data"
        },
        "responses": {
          "201": {
            "description": "Team created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Team"
                },
                "example": {
                  "id": "550e8400-e29b-41d4-a716-446655440000",
                  "name": "Platform Engineering",
                  "description": "Core platform infrastructure team",
                  "status": "active",
                  "created_at": "2025-01-15T10:30:00Z",
                  "modified_at": "2025-01-15T10:30:00Z"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid input",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Conflict (e.g., relationship cycle detected)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/teams/{team_id}": {
      "get": {
        "summary": "Get a team",
        "description": "Returns a team by ID. Requires team membership or admin access.",
        "operationId": "GetTeam",
        "tags": [
          "Teams"
        ],
        "parameters": [
          {
            "name": "team_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Team UUID"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Team"
                },
                "example": {
                  "id": "550e8400-e29b-41d4-a716-446655440000",
                  "name": "Platform Engineering",
                  "description": "Core platform infrastructure team",
                  "status": "active",
                  "created_at": "2025-01-15T10:30:00Z",
                  "modified_at": "2025-06-20T14:22:00Z"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Team not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid parameters or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "summary": "Update a team",
        "description": "Full replacement update of a team. Requires team membership or admin access.",
        "operationId": "UpdateTeam",
        "tags": [
          "Teams"
        ],
        "parameters": [
          {
            "name": "team_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Team UUID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TeamInput"
              },
              "example": {
                "name": "Platform Engineering",
                "description": "Core platform infrastructure team - updated"
              }
            }
          },
          "description": "Complete team data for replacement"
        },
        "responses": {
          "200": {
            "description": "Team updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Team"
                },
                "example": {
                  "id": "550e8400-e29b-41d4-a716-446655440000",
                  "name": "Platform Engineering",
                  "description": "Core platform infrastructure team - updated",
                  "status": "active",
                  "created_at": "2025-01-15T10:30:00Z",
                  "modified_at": "2025-08-01T11:00:00Z"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid input",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Team not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Conflict (e.g., relationship cycle detected)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "patch": {
        "summary": "Patch a team",
        "description": "Partial update of a team using JSON Patch (RFC 6902). Requires team membership or admin access.",
        "operationId": "PatchTeam",
        "tags": [
          "Teams"
        ],
        "parameters": [
          {
            "name": "team_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Team UUID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json-patch+json": {
              "schema": {
                "$ref": "#/components/schemas/JsonPatchDocument"
              },
              "example": [
                {
                  "op": "replace",
                  "path": "/description",
                  "value": "Updated team description"
                }
              ]
            }
          },
          "description": "Partial team data for update"
        },
        "responses": {
          "200": {
            "description": "Team patched",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Team"
                },
                "example": {
                  "id": "550e8400-e29b-41d4-a716-446655440000",
                  "name": "Platform Engineering",
                  "description": "Updated team description",
                  "status": "active",
                  "created_at": "2025-01-15T10:30:00Z",
                  "modified_at": "2025-08-01T11:00:00Z"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid patch",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Team not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Conflict",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "summary": "Delete a team",
        "description": "Deletes a team. Requires owner role or admin access. Returns 409 if the team is referenced by projects.",
        "operationId": "DeleteTeam",
        "tags": [
          "Teams"
        ],
        "parameters": [
          {
            "name": "team_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Team UUID"
          }
        ],
        "responses": {
          "204": {
            "description": "Team deleted",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Team not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Conflict - team is referenced by projects",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid parameters or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/teams/{team_id}/metadata": {
      "get": {
        "summary": "Get team metadata",
        "operationId": "GetTeamMetadata",
        "tags": [
          "Teams"
        ],
        "parameters": [
          {
            "name": "team_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Team identifier (UUID)"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 100
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Team not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid parameters or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "summary": "Create team metadata",
        "operationId": "CreateTeamMetadata",
        "tags": [
          "Teams"
        ],
        "parameters": [
          {
            "name": "team_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Team identifier (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          },
          "description": "Metadata entry to create"
        },
        "responses": {
          "201": {
            "description": "Metadata created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid input",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Team not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Key already exists",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/teams/{team_id}/metadata/{key}": {
      "put": {
        "summary": "Update team metadata",
        "operationId": "UpdateTeamMetadata",
        "tags": [
          "Teams"
        ],
        "parameters": [
          {
            "name": "team_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Team identifier (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 128
            },
            "description": "Metadata key"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          },
          "description": "Metadata value to set for the specified key"
        },
        "responses": {
          "200": {
            "description": "Metadata updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid input",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Team or key not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "summary": "Delete team metadata",
        "operationId": "DeleteTeamMetadata",
        "tags": [
          "Teams"
        ],
        "parameters": [
          {
            "name": "team_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Team identifier (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 128
            },
            "description": "Metadata key"
          }
        ],
        "responses": {
          "204": {
            "description": "Metadata deleted",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Team or key not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/teams/{team_id}/metadata/bulk": {
      "post": {
        "summary": "Bulk create team metadata",
        "operationId": "BulkCreateTeamMetadata",
        "tags": [
          "Teams"
        ],
        "parameters": [
          {
            "name": "team_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Team identifier (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 100
              }
            }
          },
          "description": "Bulk metadata entries to create"
        },
        "responses": {
          "201": {
            "description": "Metadata created",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 100
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid input",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Team not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Duplicate keys",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "patch": {
        "summary": "Bulk upsert team metadata",
        "operationId": "BulkUpsertTeamMetadata",
        "tags": [
          "Teams"
        ],
        "parameters": [
          {
            "name": "team_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Team identifier (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BulkPatchRequest"
              }
            }
          },
          "description": "Metadata entries to update"
        },
        "responses": {
          "200": {
            "description": "Metadata upserted",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 100
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid input",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Team not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "summary": "Bulk replace team metadata",
        "operationId": "BulkReplaceTeamMetadata",
        "tags": [
          "Teams"
        ],
        "parameters": [
          {
            "name": "team_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Team identifier (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 100
              }
            }
          },
          "description": "Complete set of metadata entries for replacement"
        },
        "responses": {
          "200": {
            "description": "Metadata replaced",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 100
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid input",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Team not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/projects": {
      "get": {
        "summary": "List projects",
        "description": "Returns a paginated list of projects. Non-admin users see only projects belonging to teams they are members of.",
        "operationId": "ListProjects",
        "tags": [
          "Projects"
        ],
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 20,
              "minimum": 1,
              "maximum": 1000
            },
            "description": "Maximum number of results per page"
          },
          {
            "name": "offset",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 0,
              "minimum": 0
            },
            "description": "Number of results to skip"
          },
          {
            "name": "name",
            "in": "query",
            "schema": {
              "type": "string",
              "maxLength": 256
            },
            "description": "Filter by project name (partial match)"
          },
          {
            "name": "status",
            "in": "query",
            "schema": {
              "type": "string",
              "maxLength": 256
            },
            "description": "Filter by status (exact match, comma-separated for multiple)"
          },
          {
            "name": "team_id",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Filter by team"
          },
          {
            "name": "related_to",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Include projects related to this project ID"
          },
          {
            "name": "relationship",
            "in": "query",
            "schema": {
              "$ref": "#/components/schemas/RelationshipType"
            },
            "description": "Filter related projects by relationship type. Only used with related_to."
          },
          {
            "name": "transitive",
            "in": "query",
            "schema": {
              "type": "boolean",
              "default": false
            },
            "description": "When true with related_to + relationship, follow parent/child chains transitively (max depth 10)"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListProjectsResponse"
                },
                "example": {
                  "projects": [
                    {
                      "id": "660e8400-e29b-41d4-a716-446655440001",
                      "name": "API Gateway Modernization",
                      "description": "Migrate legacy API gateway to cloud-native architecture",
                      "team_id": "550e8400-e29b-41d4-a716-446655440000",
                      "status": "active",
                      "created_at": "2025-02-01T09:00:00Z",
                      "modified_at": "2025-07-10T16:45:00Z"
                    }
                  ],
                  "total": 1,
                  "limit": 20,
                  "offset": 0
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "400": {
            "description": "Bad Request - Invalid parameters or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "summary": "Create a project",
        "description": "Creates a new project. Requires membership in the referenced team.",
        "operationId": "CreateProject",
        "tags": [
          "Projects"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProjectInput"
              },
              "example": {
                "name": "API Gateway Modernization",
                "description": "Migrate legacy API gateway to cloud-native architecture",
                "team_id": "550e8400-e29b-41d4-a716-446655440000"
              }
            }
          },
          "description": "Project creation data"
        },
        "responses": {
          "201": {
            "description": "Project created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Project"
                },
                "example": {
                  "id": "660e8400-e29b-41d4-a716-446655440001",
                  "name": "API Gateway Modernization",
                  "description": "Migrate legacy API gateway to cloud-native architecture",
                  "team_id": "550e8400-e29b-41d4-a716-446655440000",
                  "status": "active",
                  "created_at": "2025-02-01T09:00:00Z",
                  "modified_at": "2025-02-01T09:00:00Z"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid input",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - not a member of the referenced team",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Conflict (e.g., relationship cycle detected)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/projects/{project_id}": {
      "get": {
        "summary": "Get a project",
        "description": "Returns a project by ID. Requires membership in the project's team or admin access.",
        "operationId": "GetProject",
        "tags": [
          "Projects"
        ],
        "parameters": [
          {
            "name": "project_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Project UUID"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Project"
                },
                "example": {
                  "id": "660e8400-e29b-41d4-a716-446655440001",
                  "name": "API Gateway Modernization",
                  "description": "Migrate legacy API gateway to cloud-native architecture",
                  "team_id": "550e8400-e29b-41d4-a716-446655440000",
                  "status": "active",
                  "created_at": "2025-02-01T09:00:00Z",
                  "modified_at": "2025-07-10T16:45:00Z"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Project not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid parameters or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "summary": "Update a project",
        "description": "Full replacement update of a project. Requires membership in the project's team or admin access.",
        "operationId": "UpdateProject",
        "tags": [
          "Projects"
        ],
        "parameters": [
          {
            "name": "project_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Project UUID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProjectInput"
              },
              "example": {
                "name": "API Gateway Modernization",
                "description": "Updated project description",
                "team_id": "550e8400-e29b-41d4-a716-446655440000"
              }
            }
          },
          "description": "Complete project data for replacement"
        },
        "responses": {
          "200": {
            "description": "Project updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Project"
                },
                "example": {
                  "id": "660e8400-e29b-41d4-a716-446655440001",
                  "name": "API Gateway Modernization",
                  "description": "Updated project description",
                  "team_id": "550e8400-e29b-41d4-a716-446655440000",
                  "status": "active",
                  "created_at": "2025-02-01T09:00:00Z",
                  "modified_at": "2025-08-05T13:30:00Z"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid input",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Project not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Conflict",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "patch": {
        "summary": "Patch a project",
        "description": "Partial update of a project using JSON Patch (RFC 6902). Requires membership in the project's team or admin access.",
        "operationId": "PatchProject",
        "tags": [
          "Projects"
        ],
        "parameters": [
          {
            "name": "project_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Project UUID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json-patch+json": {
              "schema": {
                "$ref": "#/components/schemas/JsonPatchDocument"
              },
              "example": [
                {
                  "op": "replace",
                  "path": "/description",
                  "value": "Updated project description"
                }
              ]
            }
          },
          "description": "Partial project data for update"
        },
        "responses": {
          "200": {
            "description": "Project patched",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Project"
                },
                "example": {
                  "id": "660e8400-e29b-41d4-a716-446655440001",
                  "name": "API Gateway Modernization",
                  "description": "Updated project description",
                  "team_id": "550e8400-e29b-41d4-a716-446655440000",
                  "status": "active",
                  "created_at": "2025-02-01T09:00:00Z",
                  "modified_at": "2025-08-05T13:30:00Z"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid patch",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Project not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Conflict",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "summary": "Delete a project",
        "description": "Deletes a project. Requires owner role or admin access. Returns 409 if the project is referenced by threat models.",
        "operationId": "DeleteProject",
        "tags": [
          "Projects"
        ],
        "parameters": [
          {
            "name": "project_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Project UUID"
          }
        ],
        "responses": {
          "204": {
            "description": "Project deleted",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Project not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Conflict - project is referenced by threat models",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid parameters or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/projects/{project_id}/metadata": {
      "get": {
        "summary": "Get project metadata",
        "operationId": "GetProjectMetadata",
        "tags": [
          "Projects"
        ],
        "parameters": [
          {
            "name": "project_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Project identifier (UUID)"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 100
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Project not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "400": {
            "description": "Bad Request - Invalid parameters or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "summary": "Create project metadata",
        "operationId": "CreateProjectMetadata",
        "tags": [
          "Projects"
        ],
        "parameters": [
          {
            "name": "project_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Project identifier (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          },
          "description": "Metadata entry to create"
        },
        "responses": {
          "201": {
            "description": "Metadata created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid input",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Project not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Key already exists",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/projects/{project_id}/metadata/{key}": {
      "put": {
        "summary": "Update project metadata",
        "operationId": "UpdateProjectMetadata",
        "tags": [
          "Projects"
        ],
        "parameters": [
          {
            "name": "project_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Project identifier (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 128
            },
            "description": "Metadata key"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          },
          "description": "Metadata value to set for the specified key"
        },
        "responses": {
          "200": {
            "description": "Metadata updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid input",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Project or key not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "summary": "Delete project metadata",
        "operationId": "DeleteProjectMetadata",
        "tags": [
          "Projects"
        ],
        "parameters": [
          {
            "name": "project_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Project identifier (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 128
            },
            "description": "Metadata key"
          }
        ],
        "responses": {
          "204": {
            "description": "Metadata deleted",
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Project or key not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters or validation failures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/projects/{project_id}/metadata/bulk": {
      "post": {
        "summary": "Bulk create project metadata",
        "operationId": "BulkCreateProjectMetadata",
        "tags": [
          "Projects"
        ],
        "parameters": [
          {
            "name": "project_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Project identifier (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 100
              }
            }
          },
          "description": "Bulk metadata entries to create"
        },
        "responses": {
          "201": {
            "description": "Metadata created",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 100
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid input",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Project not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "409": {
            "description": "Duplicate keys",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "patch": {
        "summary": "Bulk upsert project metadata",
        "operationId": "BulkUpsertProjectMetadata",
        "tags": [
          "Projects"
        ],
        "parameters": [
          {
            "name": "project_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Project identifier (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BulkPatchRequest"
              }
            }
          },
          "description": "Metadata entries to update"
        },
        "responses": {
          "200": {
            "description": "Metadata upserted",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 100
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid input",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Project not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "summary": "Bulk replace project metadata",
        "operationId": "BulkReplaceProjectMetadata",
        "tags": [
          "Projects"
        ],
        "parameters": [
          {
            "name": "project_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Project identifier (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 100
              }
            }
          },
          "description": "Complete set of metadata entries for replacement"
        },
        "responses": {
          "200": {
            "description": "Metadata replaced",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 100
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Invalid input",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "404": {
            "description": "Project not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1640995200
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/me/groups": {
      "get": {
        "operationId": "listMyGroups",
        "summary": "List my groups",
        "description": "Returns the TMI-managed groups that the authenticated user belongs to. Returns direct memberships only (excludes the implicit everyone pseudo-group). Each group includes its internal_uuid which can be used to query group members via GET /me/groups/{internal_uuid}/members.",
        "tags": [
          "Authentication"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "List of groups the user belongs to",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MyGroupListResponse"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - invalid or missing authentication",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "429": {
            "description": "Too many requests",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 0
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until the rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit-tier": "user",
        "x-rate-limit-category": "resource-operations"
      }
    },
    "/me/groups/{internal_uuid}/members": {
      "get": {
        "operationId": "listMyGroupMembers",
        "summary": "List members of my group",
        "description": "Returns a paginated list of members for a group that the authenticated user belongs to. Only effective members (direct or via nested group membership) can list a group's members. Admin audit fields (added_by, notes) are redacted from the response.",
        "tags": [
          "Authentication"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/InternalUuidPathParam"
          },
          {
            "$ref": "#/components/parameters/LimitQueryParam"
          },
          {
            "$ref": "#/components/parameters/OffsetQueryParam"
          }
        ],
        "responses": {
          "200": {
            "description": "Paginated list of group members",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GroupMemberListResponse"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid parameters or malformed UUIDs",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - invalid or missing authentication",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - not a member of this group",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "404": {
            "description": "Group not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          },
          "429": {
            "description": "Too many requests",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 0
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              },
              "Retry-After": {
                "description": "Seconds until the rate limit resets",
                "schema": {
                  "type": "integer",
                  "example": 60
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "headers": {
              "X-RateLimit-Limit": {
                "description": "Maximum number of requests allowed in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 1000
                }
              },
              "X-RateLimit-Remaining": {
                "description": "Number of requests remaining in the current time window",
                "schema": {
                  "type": "integer",
                  "example": 999
                }
              },
              "X-RateLimit-Reset": {
                "description": "Unix epoch seconds when the rate limit window resets",
                "schema": {
                  "type": "integer",
                  "example": 1735689600
                }
              }
            }
          }
        },
        "x-rate-limit-tier": "user",
        "x-rate-limit-category": "resource-operations"
      }
    }
  },
  "tags": [
    {
      "name": "General",
      "description": "General API information and health check endpoints"
    },
    {
      "name": "OIDC Discovery",
      "description": "OpenID Connect (OIDC) discovery endpoints per RFC 8414"
    },
    {
      "name": "OAuth Discovery",
      "description": "OAuth 2.0 authorization server metadata per RFC 8414"
    },
    {
      "name": "Authentication",
      "description": "OAuth 2.0 and authentication endpoints including authorization, token exchange, and provider management"
    },
    {
      "name": "SAML",
      "description": "SAML 2.0 single sign-on (SSO) and single logout (SLO) endpoints"
    },
    {
      "name": "Threat Models",
      "description": "Threat model CRUD operations and management"
    },
    {
      "name": "Threat Model Sub-Resources",
      "description": "Sub-resources of threat models including diagrams, threats, assets, documents, notes, and repositories"
    },
    {
      "name": "Threats",
      "description": "Threat entity management within threat models"
    },
    {
      "name": "Assets",
      "description": "Asset entity management within threat models"
    },
    {
      "name": "Documents",
      "description": "Document entity management within threat models"
    },
    {
      "name": "Notes",
      "description": "Note entity management within threat models"
    },
    {
      "name": "Repositories",
      "description": "Source code repository linking within threat models"
    },
    {
      "name": "Collaboration",
      "description": "Real-time collaboration session management for diagrams via WebSocket"
    },
    {
      "name": "Users",
      "description": "User profile and account management"
    },
    {
      "name": "User Account",
      "description": "Current user account operations including preferences and logout"
    },
    {
      "name": "webhooks",
      "description": "Webhook subscription management for event notifications"
    },
    {
      "name": "Addons",
      "description": "Add-on registration and invocation for extending threat modeling capabilities"
    },
    {
      "name": "Administration",
      "description": "Administrative endpoints for user management, groups, and quota configuration (admin-only)"
    },
    {
      "name": "Configuration",
      "description": "Client configuration endpoints for application settings"
    },
    {
      "name": "Survey Administration",
      "description": "Administrative endpoints for managing surveys"
    },
    {
      "name": "Survey Intake",
      "description": "Developer-facing endpoints for filling out and submitting survey responses"
    },
    {
      "name": "Survey Triage",
      "description": "Security engineer endpoints for triaging and processing survey responses"
    },
    {
      "name": "Teams",
      "description": "Team management endpoints"
    },
    {
      "name": "Projects",
      "description": "Project management endpoints"
    }
  ],
  "security": [
    {
      "bearerAuth": []
    }
  ]
}
