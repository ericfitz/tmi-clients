openapi: 3.0.3
info:
  title: TMI (Threat Modeling Improved) API
  description: |
    A RESTful API for collaborative threat modeling with full X6 graph library compatibility. This API provides schemas that align with AntV X6 cell object models for seamless integration with modern diagramming libraries. Supports OAuth 2.0 authentication with client callback integration for seamless single-page application authentication flows.

    ## API Design v1.0.0

    ### Authorization Model
    TMI uses hierarchical authorization: access control is defined at the ThreatModel level via the authorization field (readers, writers, owners). All child resources (Assets, Diagrams, Documents, Notes, Repositories, Threats) inherit permissions from their parent ThreatModel. This simplifies permission management and ensures consistent access control.

    ### Bulk Operations
    Notes and Diagrams do not support bulk operations due to their unique creation workflows and lack of valid bulk use cases. All other resources (Threats, Assets, Documents, Repositories) support full bulk operations: POST (create), PUT (upsert), PATCH (partial update), DELETE (batch delete).

    All resources support bulk metadata operations regardless of resource-level bulk support.

    ### List Response Strategy
    - ThreatModels return summary information (TMListItem) because they contain many child objects that can be large.
    - Diagrams return summary information (DiagramListItem) because diagram data (cells, images) can be large.
    - Notes return summary information (NoteListItem) because the content field can be large.
    - Threats, Assets, Documents, Repositories return full schemas as they are relatively small and static.

    ### PATCH Support
    All resources support PATCH for partial updates using JSON Patch (RFC 6902). This is particularly useful for:
    - Assets: Array field updates (affected_assets, trust_boundaries) ensuring no duplicates
    - Notes: Updating name/description without changing content field
    - All resources: Efficient updates without full object replacement
  contact:
    name: TMI Development Team
    url: https://github.com/ericfitz/tmi
    email: api@tmi.dev
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html
  version: 1.0.0
externalDocs:
  description: Find more information here
  url: https://github.com/ericfitz/tmi/wiki
servers:
- url: https://api.tmi.dev
  description: Production server
security:
- bearerAuth: []
tags:
- name: General
  description: General API information and health check endpoints
- name: OIDC Discovery
  description: OpenID Connect (OIDC) discovery endpoints per RFC 8414
- name: OAuth Discovery
  description: OAuth 2.0 authorization server metadata per RFC 8414
- name: Authentication
  description: "OAuth 2.0 and authentication endpoints including authorization, token\
    \ exchange, and provider management"
- name: SAML
  description: SAML 2.0 single sign-on (SSO) and single logout (SLO) endpoints
- name: Threat Models
  description: Threat model CRUD operations and management
- name: Threat Model Sub-Resources
  description: "Sub-resources of threat models including diagrams, threats, assets,\
    \ documents, notes, and repositories"
- name: Threats
  description: Threat entity management within threat models
- name: Assets
  description: Asset entity management within threat models
- name: Documents
  description: Document entity management within threat models
- name: Notes
  description: Note entity management within threat models
- name: Repositories
  description: Source code repository linking within threat models
- name: Collaboration
  description: Real-time collaboration session management for diagrams via WebSocket
- name: Users
  description: User profile and account management
- name: webhooks
  description: Webhook subscription management for event notifications
- name: Addons
  description: Add-on registration and invocation for extending threat modeling capabilities
- name: Administration
  description: "Administrative endpoints for user management, groups, and quota configuration\
    \ (admin-only)"
paths:
  /:
    get:
      tags:
      - General
      summary: Get API information
      description: "Returns service, API, and operator information without authentication"
      operationId: getApiInfo
      responses:
        "200":
          description: Service and API information
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiInfo"
        "400":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security: []
      x-rate-limit:
        scope: ip
        tier: public-discovery
        limits:
        - type: requests_per_minute
          default: 10
          configurable: false
          tracking_method: Source IP address
      x-public-endpoint: true
      x-authentication-required: false
      x-public-endpoint-purpose: Health Check
  /.well-known/openid-configuration:
    get:
      tags:
      - OIDC Discovery
      summary: OpenID Connect Discovery Configuration
      description: Returns OpenID Connect provider configuration metadata as per RFC
        8414
      operationId: getOpenIDConfiguration
      responses:
        "200":
          description: OpenID Connect configuration metadata
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200"
        "400":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security: []
      x-rate-limit:
        scope: ip
        tier: public-discovery
        limits:
        - type: requests_per_minute
          default: 10
          configurable: false
          tracking_method: Source IP address
      x-public-endpoint: true
      x-authentication-required: false
      x-public-endpoint-purpose: OIDC Discovery
  /.well-known/oauth-authorization-server:
    get:
      tags:
      - OIDC Discovery
      summary: OAuth 2.0 Authorization Server Metadata
      description: Returns OAuth 2.0 authorization server metadata as per RFC 8414
      operationId: getOAuthAuthorizationServerMetadata
      responses:
        "200":
          description: OAuth 2.0 authorization server metadata
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200_1"
        "400":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security: []
      x-rate-limit:
        scope: ip
        tier: public-discovery
        limits:
        - type: requests_per_minute
          default: 10
          configurable: false
          tracking_method: Source IP address
      x-public-endpoint: true
      x-authentication-required: false
      x-public-endpoint-purpose: OIDC Discovery
  /.well-known/jwks.json:
    get:
      tags:
      - OIDC Discovery
      summary: JSON Web Key Set
      description: Returns the JSON Web Key Set (JWKS) for JWT signature verification
      operationId: getJWKS
      responses:
        "200":
          description: JSON Web Key Set
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200_2"
        "400":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security: []
      x-rate-limit:
        scope: ip
        tier: public-discovery
        limits:
        - type: requests_per_minute
          default: 10
          configurable: false
          tracking_method: Source IP address
      x-public-endpoint: true
      x-authentication-required: false
      x-public-endpoint-purpose: OIDC Discovery
  /.well-known/oauth-protected-resource:
    get:
      tags:
      - OAuth Discovery
      summary: OAuth 2.0 Protected Resource Metadata
      description: Returns OAuth 2.0 protected resource metadata as per RFC 9728
      operationId: getOAuthProtectedResourceMetadata
      responses:
        "200":
          description: OAuth 2.0 protected resource metadata
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OAuthProtectedResourceMetadata"
        "400":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security: []
      x-rate-limit:
        scope: ip
        tier: public-discovery
        limits:
        - type: requests_per_minute
          default: 10
          configurable: false
          tracking_method: Source IP address
      x-public-endpoint: true
      x-authentication-required: false
      x-public-endpoint-purpose: OIDC Discovery
  /oauth2/introspect:
    post:
      tags:
      - Authentication
      summary: Token Introspection
      description: Introspects a JWT token to determine its validity and metadata
        as per RFC 7662
      operationId: introspectToken
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              $ref: "#/components/schemas/TokenIntrospectionRequest"
        required: true
      responses:
        "200":
          description: Token introspection result
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200_3"
        "400":
          description: Invalid request
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
      security: []
      x-rate-limit:
        strategy: multi-scope
        tier: auth-flows
        scopes:
        - name: session
          limits:
          - type: requests_per_minute
            default: 5
            configurable: false
            tracking_method: OAuth state parameter or SAML request ID
        - name: ip
          limits:
          - type: requests_per_minute
            default: 100
            configurable: false
            tracking_method: Source IP address
        - name: user_identifier
          limits:
          - type: attempts_per_hour
            default: 10
            configurable: false
            tracking_method: login_hint parameter or email address
        enforcement: Most restrictive limit applies
      x-public-endpoint: true
      x-authentication-required: false
      x-public-endpoint-purpose: OAuth Flow
  /oauth2/providers:
    get:
      tags:
      - Authentication
      summary: List available OAuth providers
      description: Returns a list of configured OAuth providers available for authentication
      operationId: getAuthProviders
      responses:
        "200":
          description: List of available OAuth providers
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200_4"
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
      x-public-endpoint: true
      x-authentication-required: false
      x-public-endpoint-purpose: OAuth Flow
  /oauth2/providers/{idp}/groups:
    get:
      tags:
      - Authentication
      summary: Get groups for identity provider
      description: Returns groups available from a specific identity provider for
        autocomplete and discovery
      operationId: getProviderGroups
      parameters:
      - name: idp
        in: path
        description: "Identity provider ID (e.g., saml_okta, saml_azure)"
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 100
          pattern: "^[a-zA-Z][a-zA-Z0-9_-]*$"
          type: string
      responses:
        "200":
          description: List of groups from the identity provider
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200_5"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /oauth2/authorize:
    get:
      tags:
      - Authentication
      summary: Initiate OAuth authorization flow
      description: Redirects user to OAuth provider's authorization page. Supports
        client callback URL for seamless client integration. Generates state parameter
        for CSRF protection.
      operationId: authorizeOAuthProvider
      parameters:
      - name: idp
        in: query
        description: OAuth provider identifier. Defaults to 'test' provider in non-production
          builds if not specified.
        required: false
        style: form
        explode: true
        schema:
          maxLength: 100
          pattern: "^[a-zA-Z][a-zA-Z0-9_-]*$"
          type: string
      - name: client_callback
        in: query
        description: "Client callback URL where TMI should redirect after successful\
          \ OAuth completion with tokens in URL fragment (#access_token=...). If not\
          \ provided, tokens are returned as JSON response. Per OAuth 2.0 implicit\
          \ flow spec, tokens are in fragments to prevent logging."
        required: false
        style: form
        explode: true
        schema:
          maxLength: 1000
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          format: uri
          example: http://localhost:4200/oauth2/callback
      - name: state
        in: query
        description: CSRF protection state parameter. Recommended for security. Will
          be included in the callback response.
        required: false
        style: form
        explode: true
        schema:
          maxLength: 256
          pattern: "^[a-zA-Z0-9_~.+/=-]*$"
          type: string
          example: random_state_abc123
      - name: login_hint
        in: query
        description: "User identity hint for test OAuth provider. Allows specifying\
          \ a desired user identity for testing and automation. Only supported by\
          \ the test provider (ignored by production providers like Google, GitHub,\
          \ etc.). Must be 3-20 characters, alphanumeric and hyphens only."
        required: false
        style: form
        explode: true
        schema:
          maxLength: 1000
          pattern: "^[a-zA-Z0-9-]{3,20}$"
          type: string
          example: alice
      - name: scope
        in: query
        description: "OAuth 2.0 scope parameter. For OpenID Connect, must include\
          \ \"openid\". Supports \"profile\" and \"email\" scopes. Other scopes are\
          \ silently ignored. Space-separated values."
        required: true
        style: form
        explode: true
        schema:
          maxLength: 256
          pattern: "^[a-zA-Z0-9_][a-zA-Z0-9_ ]*[a-zA-Z0-9_]$"
          type: string
          example: openid profile email
      - name: code_challenge
        in: query
        description: "PKCE code challenge (RFC 7636) - Base64url-encoded SHA256 hash\
          \ of the code_verifier. Must be 43-128 characters using unreserved characters\
          \ [A-Za-z0-9-._~]. The server associates this with the authorization code\
          \ for later verification during token exchange."
        required: true
        style: form
        explode: true
        schema:
          maxLength: 128
          minLength: 43
          pattern: "^[A-Za-z0-9\\-._~]{43,128}$"
          type: string
          example: E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM
      - name: code_challenge_method
        in: query
        description: PKCE code challenge method (RFC 7636) - Specifies the transformation
          applied to the code_verifier. Only "S256" (SHA256) is supported for security.
          The "plain" method is not supported.
        required: true
        style: form
        explode: true
        schema:
          type: string
          example: S256
          enum:
          - S256
      responses:
        "302":
          description: Redirect to OAuth provider authorization page
          headers:
            Location:
              description: "OAuth provider authorization URL with client_id, redirect_uri,\
                \ response_type, scope, and state parameters"
              style: simple
              explode: false
              schema:
                maxLength: 1000
                pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
                  .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\\
                  /[^\\s]*)?\\s*$"
                type: string
                format: uri
        "400":
          description: Invalid provider or provider not configured
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error generating authorization URL
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security: []
      x-rate-limit:
        strategy: multi-scope
        tier: auth-flows
        scopes:
        - name: session
          limits:
          - type: requests_per_minute
            default: 5
            configurable: false
            tracking_method: OAuth state parameter or SAML request ID
        - name: ip
          limits:
          - type: requests_per_minute
            default: 100
            configurable: false
            tracking_method: Source IP address
        - name: user_identifier
          limits:
          - type: attempts_per_hour
            default: 10
            configurable: false
            tracking_method: login_hint parameter or email address
        enforcement: Most restrictive limit applies
      x-public-endpoint: true
      x-authentication-required: false
      x-public-endpoint-purpose: OAuth Flow
  /oauth2/token:
    post:
      tags:
      - Authentication
      summary: Exchange OAuth credentials for JWT tokens
      description: "Provider-neutral endpoint to exchange OAuth credentials for TMI\
        \ JWT tokens. Supports three grant types: (1) authorization_code for OAuth\
        \ provider flows (Google, GitHub, Microsoft), (2) client_credentials for machine-to-machine\
        \ authentication (RFC 6749 Section 4.4), and (3) refresh_token for token renewal.\
        \ Accepts both application/json and application/x-www-form-urlencoded content\
        \ types."
      operationId: exchangeOAuthCode
      parameters:
      - name: idp
        in: query
        description: OAuth provider identifier. Defaults to 'test' provider in non-production
          builds if not specified.
        required: false
        style: form
        explode: true
        schema:
          maxLength: 100
          pattern: "^[a-zA-Z][a-zA-Z0-9_-]*$"
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/oauth2_token_body"
          application/x-www-form-urlencoded:
            schema:
              $ref: "#/components/schemas/TokenRequest"
        required: true
      responses:
        "200":
          description: "OAuth exchange successful, TMI JWT tokens issued"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthTokenResponse"
        "400":
          description: "Bad request - invalid provider, missing parameters, or invalid\
            \ state"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                invalid_provider:
                  summary: Invalid provider
                  value:
                    error: "Invalid provider: invalid_provider"
                    error_description: Provider 'invalid_provider' is not configured
                      or supported
                missing_code:
                  summary: Missing authorization code
                  value:
                    error: "Invalid request: missing required fields"
                    error_description: The 'code' parameter is required
                invalid_state:
                  summary: Invalid state parameter
                  value:
                    error: Invalid state parameter
                    error_description: State parameter validation failed - possible
                      CSRF attack
        "500":
          description: Internal server error - OAuth provider communication failed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                provider_error:
                  summary: OAuth provider communication failed
                  value:
                    error: "Failed to exchange authorization code: oauth2: cannot\
                      \ fetch token: 400 Bad Request"
                    error_description: Unable to communicate with OAuth provider or
                      invalid authorization code
                user_info_error:
                  summary: Failed to get user information
                  value:
                    error: "Failed to get user info: 401 Unauthorized"
                    error_description: OAuth provider denied access to user information
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security: []
      x-rate-limit:
        strategy: multi-scope
        tier: auth-flows
        scopes:
        - name: session
          limits:
          - type: requests_per_minute
            default: 5
            configurable: false
            tracking_method: OAuth state parameter or SAML request ID
        - name: ip
          limits:
          - type: requests_per_minute
            default: 100
            configurable: false
            tracking_method: Source IP address
        - name: user_identifier
          limits:
          - type: attempts_per_hour
            default: 10
            configurable: false
            tracking_method: login_hint parameter or email address
        enforcement: Most restrictive limit applies
      x-public-endpoint: true
      x-authentication-required: false
      x-public-endpoint-purpose: OAuth Flow
  /oauth2/refresh:
    post:
      tags:
      - Authentication
      summary: Refresh JWT token
      description: Exchanges a refresh token for a new JWT access token
      operationId: refreshToken
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/TokenRefreshRequest"
      responses:
        "200":
          description: New JWT issued successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthTokenResponse"
        "400":
          description: Bad request - missing or invalid refresh token
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                missing_token:
                  summary: Missing refresh token
                  value:
                    error: "Invalid request: missing required fields"
                    error_description: The 'refresh_token' parameter is required
                invalid_format:
                  summary: Invalid token format
                  value:
                    error: Invalid refresh token format
                    error_description: Refresh token must be a valid UUID string
        "401":
          description: Unauthorized - invalid or expired refresh token
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                expired_token:
                  summary: Expired refresh token
                  value:
                    error: Invalid refresh token
                    error_description: The refresh token has expired or has been revoked
                invalid_token:
                  summary: Invalid refresh token
                  value:
                    error: Invalid refresh token
                    error_description: The provided refresh token is not valid
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security: []
      x-rate-limit:
        strategy: multi-scope
        tier: auth-flows
        scopes:
        - name: session
          limits:
          - type: requests_per_minute
            default: 5
            configurable: false
            tracking_method: OAuth state parameter or SAML request ID
        - name: ip
          limits:
          - type: requests_per_minute
            default: 100
            configurable: false
            tracking_method: Source IP address
        - name: user_identifier
          limits:
          - type: attempts_per_hour
            default: 10
            configurable: false
            tracking_method: login_hint parameter or email address
        enforcement: Most restrictive limit applies
      x-public-endpoint: true
      x-authentication-required: false
      x-public-endpoint-purpose: OAuth Flow
  /oauth2/userinfo:
    get:
      tags:
      - Authentication
      summary: Get current user information
      description: Returns information about the currently authenticated user
      operationId: getCurrentUser
      responses:
        "200":
          description: Current user information
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200_6"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /oauth2/callback:
    get:
      tags:
      - Authentication
      summary: Handle OAuth callback
      description: "Exchanges OAuth authorization code for JWT tokens. If client_callback\
        \ was provided during authorization, redirects to client with tokens. Otherwise\
        \ returns tokens as JSON response."
      operationId: handleOAuthCallback
      parameters:
      - name: code
        in: query
        description: Authorization code from the OAuth provider
        required: true
        style: form
        explode: true
        schema:
          maxLength: 512
          pattern: "^[a-zA-Z0-9_~.+/=-]*$"
          type: string
      - name: state
        in: query
        description: CSRF protection state parameter. Recommended for security. Will
          be included in the callback response.
        required: false
        style: form
        explode: true
        schema:
          maxLength: 256
          pattern: "^[a-zA-Z0-9_~.+/=-]*$"
          type: string
          example: random_state_abc123
      responses:
        "200":
          description: JWT tokens issued successfully (legacy mode when no client_callback
            provided)
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthTokenResponse"
        "302":
          description: Redirect to client callback URL with tokens (when client_callback
            was provided)
          headers:
            Location:
              description: "Client callback URL with access_token, refresh_token,\
                \ expires_in, token_type, and state in URL fragment (after #)"
              style: simple
              explode: false
              schema:
                maxLength: 1000
                pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
                  .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\\
                  /[^\\s]*)?\\s*$"
                type: string
                format: uri
                example: http://localhost:4200/oauth2/callback#access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...&refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...&expires_in=3600&token_type=Bearer&state=random_state_abc123
        "400":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security: []
      x-rate-limit:
        strategy: multi-scope
        tier: auth-flows
        scopes:
        - name: session
          limits:
          - type: requests_per_minute
            default: 5
            configurable: false
            tracking_method: OAuth state parameter or SAML request ID
        - name: ip
          limits:
          - type: requests_per_minute
            default: 100
            configurable: false
            tracking_method: Source IP address
        - name: user_identifier
          limits:
          - type: attempts_per_hour
            default: 10
            configurable: false
            tracking_method: login_hint parameter or email address
        enforcement: Most restrictive limit applies
      x-public-endpoint: true
      x-authentication-required: false
      x-public-endpoint-purpose: OAuth Flow
  /oauth2/revoke:
    post:
      tags:
      - Authentication
      summary: Logout user
      description: "Invalidates the user's JWT token by adding it to a blacklist,\
        \ effectively ending the session. Once logged out, the token cannot be used\
        \ for further authenticated requests until it naturally expires. The token\
        \ blacklist is maintained in Redis with automatic cleanup based on token expiration\
        \ times."
      operationId: logoutUser
      requestBody:
        description: Empty request body - token is provided via Authorization header
        content:
          application/json:
            schema:
              type: object
              properties: {}
              additionalProperties: false
              example: {}
        required: false
      responses:
        "204":
          description: User logged out successfully. The JWT token has been invalidated
            and added to the blacklist.
          headers:
            X-Request-ID:
              description: Unique request identifier for tracking
              style: simple
              explode: false
              schema:
                type: string
                example: req_abc123def456
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "401":
          description: "Authentication failed - invalid, missing, or malformed token"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                missing_token:
                  summary: Missing Authorization header
                  value:
                    error: unauthorized
                    error_description: Missing Authorization header
                invalid_format:
                  summary: Invalid Authorization header format
                  value:
                    error: unauthorized
                    error_description: Invalid Authorization header format
                malformed_token:
                  summary: Malformed JWT token
                  value:
                    error: unauthorized
                    error_description: Invalid token format
                blacklisted_token:
                  summary: Token already blacklisted
                  value:
                    error: unauthorized
                    error_description: Token has been revoked
        "500":
          description: Internal server error - token blacklisting failed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "200":
          description: Success - Token successfully revoked
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200_7"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /collaboration/sessions:
    get:
      tags:
      - Collaboration
      summary: List active collaboration sessions
      description: Returns all currently active collaboration sessions for diagrams.
        Clients can use this endpoint to discover existing sessions before connecting
        via WebSocket.
      operationId: getCollaborationSessions
      responses:
        "200":
          description: Success
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                type: object
                x-content-type: application/json
        "401":
          description: "Authentication failed - invalid, missing, or malformed token"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models:
    get:
      tags:
      - Threat Models
      summary: List threat models
      description: Returns a list of threat models accessible to the authenticated
        user with enhanced metadata and entity counts
      operationId: listThreatModels
      parameters:
      - name: limit
        in: query
        description: Maximum number of results to return
        required: false
        style: form
        explode: true
        schema:
          maximum: 100
          minimum: 1
          type: integer
          default: 20
      - name: offset
        in: query
        description: Number of results to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      - name: owner
        in: query
        description: Filter by owner name or email
        required: false
        style: form
        explode: true
        schema:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
      - name: name
        in: query
        description: Filter by threat model name (partial match)
        required: false
        style: form
        explode: true
        schema:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
      - name: description
        in: query
        description: Filter by threat model description (partial match)
        required: false
        style: form
        explode: true
        schema:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
      - name: issue_uri
        in: query
        description: Filter by issue URI (partial match)
        required: false
        style: form
        explode: true
        schema:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
      - name: created_after
        in: query
        description: Filter results created after this timestamp (ISO 8601)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      - name: created_before
        in: query
        description: Filter results created before this timestamp (ISO 8601)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      - name: modified_after
        in: query
        description: Filter results modified after this timestamp (ISO 8601)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      - name: modified_before
        in: query
        description: Filter results modified before this timestamp (ISO 8601)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      - name: status
        in: query
        description: "Filter by status value (exact match). To filter by multiple\
          \ statuses, use multiple status parameters or comma-separated values."
        required: false
        style: form
        explode: true
        schema:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
      - name: status_updated_after
        in: query
        description: Filter threat models where status was updated after this timestamp
          (RFC3339)
        required: false
        style: form
        explode: true
        schema:
          maxLength: 64
          pattern: "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$"
          type: string
          format: date-time
      - name: status_updated_before
        in: query
        description: Filter threat models where status was updated before this timestamp
          (RFC3339)
        required: false
        style: form
        explode: true
        schema:
          maxLength: 64
          pattern: "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$"
          type: string
          format: date-time
      responses:
        "200":
          description: Paginated list of threat models with enhanced metadata and
            entity counts
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/TMListItem"
                x-content-type: application/json
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Models
      summary: Create a threat model
      description: Creates a new threat model with the authenticated user as owner
      operationId: createThreatModel
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ThreatModelInput"
        required: true
      responses:
        "201":
          description: Threat model created successfully
          headers:
            Location:
              description: URL of the new threat model
              style: simple
              explode: false
              schema:
                type: string
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ThreatModel"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}:
    get:
      tags:
      - Threat Models
      summary: Retrieve a threat model
      description: Retrieves the full details of a specific threat model if the user
        has access
      operationId: getThreatModel
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Full threat model details
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ThreatModel"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    put:
      tags:
      - Threat Models
      summary: Update a threat model
      description: Fully updates a threat model; restricted to writer/owner roles
      operationId: updateThreatModel
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ThreatModelInput"
        required: true
      responses:
        "200":
          description: Threat model updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ThreatModel"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    delete:
      tags:
      - Threat Models
      summary: Delete a threat model
      description: Deletes a threat model; restricted to owner role
      operationId: deleteThreatModel
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "204":
          description: Threat model deleted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "409":
          description: Conflict - Cannot delete threat model while a diagram has an
            active collaboration session
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    patch:
      tags:
      - Threat Models
      summary: Partially update a threat model
      description: Applies JSON Patch operations to a threat model; restricted to
        writer/owner roles
      operationId: patchThreatModel
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json-patch+json:
            schema:
              $ref: "#/components/schemas/JsonPatchDocument"
      responses:
        "200":
          description: Threat model updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ThreatModel"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/threats:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: List threats in a threat model
      description: Returns a paginated list of threats within the specified threat
        model
      operationId: getThreatModelThreats
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: limit
        in: query
        description: Maximum number of results to return
        required: false
        style: form
        explode: true
        schema:
          maximum: 100
          minimum: 1
          type: integer
          default: 20
      - name: offset
        in: query
        description: Number of results to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      - name: sort
        in: query
        description: "Sort order (e.g., created_at:desc, name:asc, severity:desc,\
          \ score:desc)"
        required: false
        style: form
        explode: true
        schema:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          default: created_at:desc
      - name: name
        in: query
        description: Filter by threat model name (partial match)
        required: false
        style: form
        explode: true
        schema:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
      - name: description
        in: query
        description: Filter by threat model description (partial match)
        required: false
        style: form
        explode: true
        schema:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
      - name: threat_type
        in: query
        description: "Filter by threat types (AND logic). Threat must contain ALL\
          \ specified types. Example: ?threat_type=Tampering&threat_type=Spoofing"
        required: false
        style: form
        explode: true
        schema:
          type: array
          items:
            type: string
      - name: severity
        in: query
        description: Filter by severity level (exact match)
        required: false
        style: form
        explode: true
        schema:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          enum:
          - Unknown
          - None
          - Low
          - Medium
          - High
          - Critical
      - name: priority
        in: query
        description: Filter by priority (exact match)
        required: false
        style: form
        explode: true
        schema:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
      - name: status
        in: query
        description: "Filter by status value (exact match). To filter by multiple\
          \ statuses, use multiple status parameters or comma-separated values."
        required: false
        style: form
        explode: true
        schema:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
      - name: diagram_id
        in: query
        description: Filter by diagram ID (exact match)
        required: false
        style: form
        explode: true
        schema:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          format: uuid
      - name: cell_id
        in: query
        description: Filter by cell ID (exact match)
        required: false
        style: form
        explode: true
        schema:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          format: uuid
      - name: score_gt
        in: query
        description: Filter threats with score greater than this value
        required: false
        style: form
        explode: true
        schema:
          maximum: 10.0
          minimum: 0.0
          type: number
      - name: score_lt
        in: query
        description: Filter threats with score less than this value
        required: false
        style: form
        explode: true
        schema:
          maximum: 10.0
          minimum: 0.0
          type: number
      - name: score_eq
        in: query
        description: Filter threats with score equal to this value
        required: false
        style: form
        explode: true
        schema:
          maximum: 10.0
          minimum: 0.0
          type: number
      - name: score_ge
        in: query
        description: Filter threats with score greater than or equal to this value
        required: false
        style: form
        explode: true
        schema:
          maximum: 10.0
          minimum: 0.0
          type: number
      - name: score_le
        in: query
        description: Filter threats with score less than or equal to this value
        required: false
        style: form
        explode: true
        schema:
          maximum: 10.0
          minimum: 0.0
          type: number
      - name: created_after
        in: query
        description: Filter results created after this timestamp (ISO 8601)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      - name: created_before
        in: query
        description: Filter results created before this timestamp (ISO 8601)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      - name: modified_after
        in: query
        description: Filter results modified after this timestamp (ISO 8601)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      - name: modified_before
        in: query
        description: Filter results modified before this timestamp (ISO 8601)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      responses:
        "200":
          description: List of threats
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Threat"
                x-content-type: application/json
              examples:
                threatList:
                  summary: List of threats with metadata
                  value:
                  - id: 550e8400-e29b-41d4-a716-446655440003
                    threat_type:
                    - spoofing
                    name: SQL Injection Vulnerability
                    description: Database injection through malicious SQL queries
                    severity: High
                    priority: urgent
                    status: active
                    mitigated: false
                    threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                    created_at: 2025-01-15T10:30:00Z
                    modified_at: 2025-01-15T14:45:00Z
                    metadata: []
                  - id: 550e8400-e29b-41d4-a716-446655440004
                    threat_type:
                    - tampering
                    name: Cross-Site Scripting (XSS)
                    description: Client-side script injection vulnerability
                    severity: Medium
                    priority: medium
                    status: identified
                    mitigated: false
                    threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                    created_at: 2025-01-15T11:00:00Z
                    modified_at: 2025-01-15T11:00:00Z
                    metadata: []
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create a new threat
      description: Creates a new threat within the specified threat model
      operationId: createThreatModelThreat
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ThreatInput"
        required: true
      responses:
        "201":
          description: Threat created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Threat"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/threats/{threat_id}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get a specific threat
      description: Returns details of a specific threat within the threat model
      operationId: getThreatModelThreat
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Threat identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Threat details
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Threat"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update a threat
      description: Updates a specific threat within the threat model
      operationId: updateThreatModelThreat
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Threat identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ThreatInput"
        required: true
      responses:
        "200":
          description: Threat updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Threat"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete a threat
      description: Deletes a specific threat from the threat model
      operationId: deleteThreatModelThreat
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Threat identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "204":
          description: Threat deleted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    patch:
      tags:
      - Threat Model Sub-Resources
      summary: Partially update a threat
      description: Applies JSON patch operations to a specific threat within the threat
        model
      operationId: patchThreatModelThreat
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Threat identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json-patch+json:
            schema:
              $ref: "#/components/schemas/JsonPatchDocument"
            examples:
              updateThreatDetails:
                summary: Update threat name and severity
                value:
                - op: replace
                  path: /name
                  value: Updated SQL Injection Threat
                - op: replace
                  path: /severity
                  value: Critical
                - op: replace
                  path: /description
                  value: Updated description with more details
              addMetadata:
                summary: Add metadata to a threat
                value:
                - op: add
                  path: /metadata/-
                  value:
                    key: priority
                    value: urgent
                - op: add
                  path: /metadata/-
                  value:
                    key: assigned_to
                    value: security-team
              updateStatus:
                summary: Update threat status and mitigation
                value:
                - op: replace
                  path: /status
                  value: mitigated
                - op: replace
                  path: /mitigated
                  value: true
                - op: replace
                  path: /mitigation
                  value: Implemented input validation and parameterized queries
        required: true
      responses:
        "200":
          description: Threat patched successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Threat"
              examples:
                patchedThreat:
                  summary: Successfully patched threat with updated fields
                  value:
                    id: 550e8400-e29b-41d4-a716-446655440003
                    name: Updated SQL Injection Threat
                    description: Updated description with more details
                    severity: Critical
                    priority: urgent
                    status: active
                    mitigated: false
                    threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                    created_at: 2025-01-15T10:30:00Z
                    modified_at: 2025-01-15T14:45:00Z
                    metadata:
                    - key: priority
                      value: urgent
                    - key: assigned_to
                      value: security-team
                    - key: cve_reference
                      value: CVE-2024-1234
                    threat_type:
                    - tampering
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/threats/{threat_id}/metadata:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get threat metadata
      description: Returns all metadata key-value pairs for the specified threat
      operationId: getThreatMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Threat identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Threat metadata list
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create threat metadata
      description: Creates new metadata entry for the specified threat
      operationId: createThreatMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Threat identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entry created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/threats/{threat_id}/metadata/{key}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get threat metadata by key
      description: Returns a specific metadata entry by key for the specified threat
      operationId: getThreatMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Threat identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "200":
          description: Metadata entry
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update threat metadata by key
      description: Updates a specific metadata entry by key for the specified threat
      operationId: updateThreatMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Threat identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/metadata_key_body"
        required: true
      responses:
        "200":
          description: Metadata entry updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete threat metadata by key
      description: Deletes a specific metadata entry by key for the specified threat
      operationId: deleteThreatMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Threat identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "204":
          description: Metadata entry deleted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/threats/{threat_id}/metadata/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk upsert threat metadata
      description: Creates or updates multiple metadata key-value pairs for the specified
        threat
      operationId: bulkUpsertThreatMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Threat identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "200":
          description: Metadata upserted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create threat metadata
      description: Creates multiple metadata entries in a single operation for the
        specified threat
      operationId: bulkCreateThreatMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Threat identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entries created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/threats/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk update threats
      description: Updates multiple threats in a single operation for the specified
        threat model
      operationId: bulkUpdateThreatModelThreats
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              description: Array of threats to update (must include id field)
              items:
                $ref: "#/components/schemas/Threat"
            examples:
              bulkUpdateThreats:
                summary: Update multiple threats at once
                value:
                - id: 750e8400-e29b-41d4-a716-446655440001
                  name: Updated SQL Injection Attack
                  description: Updated description for SQL injection vulnerability
                  impact: High
                  likelihood: Low
                  risk_rating: Medium
                  metadata:
                  - key: category
                    value: injection
                  - key: mitigation
                    value: parameterized-queries
                  threat_type:
                  - tampering
        required: true
      responses:
        "200":
          description: Threats updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Threat"
                x-content-type: application/json
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create threats
      description: Creates multiple threats in a single operation for the specified
        threat model
      operationId: bulkCreateThreatModelThreats
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              description: Array of threats to create
              items:
                $ref: "#/components/schemas/Threat"
            examples:
              bulkCreateThreats:
                summary: Create multiple threats at once
                value:
                - name: SQL Injection Attack
                  description: Attacker injects malicious SQL code through user input
                  metadata:
                  - key: category
                    value: injection
                  - key: stride
                    value: tampering
                  threat_type:
                  - spoofing
                - name: Cross-Site Scripting (XSS)
                  threat_type:
                  - information-disclosure
                  description: Malicious scripts executed in user's browser
                  severity: Medium
                  status: identified
        required: true
      responses:
        "201":
          description: Threats created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Threat"
                x-content-type: application/json
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    delete:
      tags:
      - Threats
      summary: Bulk DELETE threats
      description: Delete multiple threats in a single request
      operationId: bulkDeleteThreatModelThreats
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: threat_ids
        in: query
        description: Comma-separated list of threat IDs to delete (UUID format)
        required: true
        style: form
        explode: false
        schema:
          maxItems: 20
          minItems: 1
          type: array
          items:
            maxLength: 36
            pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
            type: string
            format: uuid
      responses:
        "200":
          description: Successfully deleted threats
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200_8"
        "400":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    patch:
      tags:
      - Threats
      summary: Bulk PATCH threats
      description: Apply JSON Patch operations to multiple threats in a single request
      operationId: bulkPatchThreatModelThreats
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json-patch+json:
            schema:
              $ref: "#/components/schemas/JsonPatchDocument"
        required: true
      responses:
        "200":
          description: Successfully patched threats
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Threat"
                x-content-type: application/json
        "400":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/documents:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: List documents in a threat model
      description: Returns a paginated list of documents within the specified threat
        model
      operationId: getThreatModelDocuments
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: limit
        in: query
        description: Maximum number of results to return
        required: false
        style: form
        explode: true
        schema:
          maximum: 100
          minimum: 1
          type: integer
          default: 20
      - name: offset
        in: query
        description: Number of results to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      responses:
        "200":
          description: List of documents
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Document"
                x-content-type: application/json
              examples:
                documentList:
                  summary: List of documents with pagination
                  value:
                  - id: 770e8400-e29b-41d4-a716-446655440008
                    name: Security Architecture
                    description: System security architecture document
                    created_at: 2025-01-10T09:00:00Z
                    modified_at: 2025-01-10T09:00:00Z
                    uri: https://docs.example.com/security-arch.pdf
                emptyList:
                  summary: Empty document list
                  value: []
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create a new document
      description: Creates a new document within the specified threat model
      operationId: createThreatModelDocument
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DocumentInput"
            examples:
              createDocument:
                summary: Create a new security document
                value:
                  name: Security Requirements
                  description: Application security requirements specification
                  uri: https://docs.example.com/security-requirements.pdf
        required: true
      responses:
        "201":
          description: Document created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Document"
              examples:
                createdDocument:
                  summary: Successfully created document with generated ID
                  value:
                    name: Security Requirements Document
                    description: Detailed security requirements and compliance standards
                    uri: https://docs.company.com/security-requirements.pdf
                    id: 770e8400-e29b-41d4-a716-446655440008
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/documents/{document_id}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get a specific document
      description: Returns details of a specific document within the threat model
      operationId: getThreatModelDocument
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Document identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Document details
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Document"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update a document
      description: Updates a specific document within the threat model
      operationId: updateThreatModelDocument
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Document identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DocumentInput"
        required: true
      responses:
        "200":
          description: Document updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Document"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete a document
      description: Deletes a specific document from the threat model
      operationId: deleteThreatModelDocument
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Document identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "204":
          description: Document deleted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    patch:
      tags:
      - Documents
      summary: Partially update document
      description: Apply JSON Patch operations to partially update a document
      operationId: patchThreatModelDocument
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Document identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json-patch+json:
            schema:
              $ref: "#/components/schemas/JsonPatchDocument"
        required: true
      responses:
        "200":
          description: Successfully patched document
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Document"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/documents/{document_id}/metadata:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get document metadata
      description: Returns all metadata key-value pairs for the specified document
      operationId: getDocumentMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Document identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Document metadata list
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create document metadata
      description: Creates new metadata entry for the specified document
      operationId: createDocumentMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Document identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entry created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/documents/{document_id}/metadata/{key}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get document metadata by key
      description: Returns a specific metadata entry by key for the specified document
      operationId: getDocumentMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Document identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "200":
          description: Metadata entry
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update document metadata by key
      description: Updates a specific metadata entry by key for the specified document
      operationId: updateDocumentMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Document identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/metadata_key_body_1"
        required: true
      responses:
        "200":
          description: Metadata entry updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete document metadata by key
      description: Deletes a specific metadata entry by key for the specified document
      operationId: deleteDocumentMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Document identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "204":
          description: Metadata entry deleted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/documents/{document_id}/metadata/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk upsert document metadata
      description: Creates or updates multiple metadata key-value pairs for the specified
        document
      operationId: bulkUpsertDocumentMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Document identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "200":
          description: Metadata upserted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create document metadata
      description: Creates multiple metadata entries in a single operation for the
        specified document
      operationId: bulkCreateDocumentMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Document identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entries created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/documents/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk upsert documents
      description: Create or update multiple documents in a single request
      operationId: bulkUpsertThreatModelDocuments
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              description: Array of documents to create
              items:
                $ref: "#/components/schemas/Document"
            examples:
              bulkCreateDocuments:
                summary: Create multiple documents at once
                value:
                - id: 770e8400-e29b-41d4-a716-446655440010
                  name: Threat Model Report Updated
                  uri: https://docs.example.com/threat-report-v2.pdf
                  description: Updated threat assessment document
                  threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                  created_at: 2025-01-10T09:00:00Z
                  modified_at: 2025-01-10T09:00:00Z
                - name: Security Requirements
                  description: Security requirements and compliance standards
                  metadata:
                  - key: classification
                    value: internal
                  - key: department
                    value: security
                  uri: https://docs.company.com/security.pdf
        required: true
      responses:
        "201":
          description: Documents created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Document"
                x-content-type: application/json
              examples:
                bulkCreatedDocuments:
                  summary: Successfully created documents with generated IDs
                  value:
                  - name: Architecture Document
                    description: System architecture documentation
                    created_at: 2025-04-06T12:00:00Z
                    modified_at: 2025-04-06T12:00:00Z
                    uri: https://docs.company.com/architecture.pdf
                    id: 770e8400-e29b-41d4-a716-446655440021
                  - id: 550e8400-e29b-41d4-a716-446655440002
                    name: Security Requirements
                    description: Security requirements and compliance standards
                    metadata:
                    - key: classification
                      value: internal
                    - key: department
                      value: security
                    created_at: 2025-04-06T12:00:00Z
                    modified_at: 2025-04-06T12:00:00Z
                    uri: https://docs.company.com/security.pdf
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create documents
      description: Creates multiple documents in a single operation for the specified
        threat model
      operationId: bulkCreateThreatModelDocuments
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              description: Array of documents to create
              items:
                $ref: "#/components/schemas/Document"
            examples:
              bulkCreateDocuments:
                summary: Create multiple documents at once
                value:
                - id: 770e8400-e29b-41d4-a716-446655440009
                  name: Threat Model Report
                  uri: https://docs.example.com/threat-report-v1.pdf
                  description: Comprehensive threat assessment document
                  threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                  created_at: 2025-01-10T09:00:00Z
                  modified_at: 2025-01-10T09:00:00Z
                - name: Security Requirements
                  description: Security requirements and compliance standards
                  metadata:
                  - key: classification
                    value: internal
                  - key: department
                    value: security
                  uri: https://docs.company.com/security.pdf
        required: true
      responses:
        "201":
          description: Documents created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Document"
                x-content-type: application/json
              examples:
                bulkCreatedDocuments:
                  summary: Successfully created documents with generated IDs
                  value:
                  - name: Architecture Document
                    description: System architecture documentation
                    created_at: 2025-04-06T12:00:00Z
                    modified_at: 2025-04-06T12:00:00Z
                    uri: https://docs.company.com/architecture.pdf
                    id: 770e8400-e29b-41d4-a716-446655440020
                  - id: 550e8400-e29b-41d4-a716-446655440002
                    name: Security Requirements
                    description: Security requirements and compliance standards
                    metadata:
                    - key: classification
                      value: internal
                    - key: department
                      value: security
                    created_at: 2025-04-06T12:00:00Z
                    modified_at: 2025-04-06T12:00:00Z
                    uri: https://docs.company.com/security.pdf
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/repositories:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: List sources in a threat model
      description: Returns a paginated list of source code references within the specified
        threat model
      operationId: getThreatModelRepositories
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: limit
        in: query
        description: Maximum number of results to return
        required: false
        style: form
        explode: true
        schema:
          maximum: 100
          minimum: 1
          type: integer
          default: 20
      - name: offset
        in: query
        description: Number of results to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      responses:
        "200":
          description: List of source code references
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Repository"
                x-content-type: application/json
              examples:
                sourceList:
                  summary: List of source code references
                  value:
                  - id: 990e8400-e29b-41d4-a716-446655440011
                    name: Main Application Repository
                    description: Primary source code repository
                    uri: https://github.com/example/application
                    created_at: 2025-01-12T08:00:00Z
                    modified_at: 2025-01-12T08:00:00Z
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create a new source reference
      description: Creates a new source code reference within the specified threat
        model
      operationId: createThreatModelRepository
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RepositoryInput"
        required: true
      responses:
        "201":
          description: Source reference created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Repository"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/repositories/{repository_id}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get a specific source reference
      description: Returns details of a specific source code reference within the
        threat model
      operationId: getThreatModelRepository
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Repository identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Source reference details
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Repository"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update a source reference
      description: Updates a specific source code reference within the threat model
      operationId: updateThreatModelRepository
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Repository identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RepositoryInput"
        required: true
      responses:
        "200":
          description: Source reference updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Repository"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete a source reference
      description: Deletes a specific source code reference from the threat model
      operationId: deleteThreatModelRepository
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Repository identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "204":
          description: Source reference deleted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    patch:
      tags:
      - Repositories
      summary: Partially update repository
      description: Apply JSON Patch operations to partially update a repository
      operationId: patchThreatModelRepository
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Repository identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json-patch+json:
            schema:
              $ref: "#/components/schemas/JsonPatchDocument"
        required: true
      responses:
        "200":
          description: Successfully patched repository
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Repository"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/repositories/{repository_id}/metadata:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get source metadata
      description: Returns all metadata key-value pairs for the specified source reference
      operationId: getRepositoryMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Repository identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Source metadata list
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create source metadata
      description: Creates new metadata entry for the specified source reference
      operationId: createRepositoryMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Repository identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entry created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/repositories/{repository_id}/metadata/{key}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get source metadata by key
      description: Returns a specific metadata entry by key for the specified source
        reference
      operationId: getRepositoryMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Repository identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "200":
          description: Metadata entry
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update source metadata by key
      description: Updates a specific metadata entry by key for the specified source
        reference
      operationId: updateRepositoryMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Repository identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/metadata_key_body_2"
        required: true
      responses:
        "200":
          description: Metadata entry updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete source metadata by key
      description: Deletes a specific metadata entry by key for the specified source
        reference
      operationId: deleteRepositoryMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Repository identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "204":
          description: Metadata entry deleted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/repositories/{repository_id}/metadata/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk upsert repository metadata
      description: Creates or updates multiple metadata key-value pairs for the specified
        repository
      operationId: bulkUpsertRepositoryMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Repository identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "200":
          description: Metadata upserted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create source metadata
      description: Creates multiple metadata entries in a single operation for the
        specified source reference
      operationId: bulkCreateRepositoryMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Repository identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entries created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/repositories/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk upsert repositories
      description: Create or update multiple repositories in a single request
      operationId: bulkUpsertThreatModelRepositories
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              description: Array of source references to create
              items:
                $ref: "#/components/schemas/Repository"
            examples:
              bulkCreateSources:
                summary: Create multiple source references at once
                value:
                - id: 990e8400-e29b-41d4-a716-446655440013
                  name: API Repository Updated
                  uri: https://github.com/example/api-v2
                  description: Updated backend API source code
                  threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                  created_at: 2025-01-12T08:00:00Z
                  modified_at: 2025-01-12T08:00:00Z
                - name: Database Connection Pool
                  description: Database connection management
                  metadata:
                  - key: type
                    value: infrastructure
                  - key: criticality
                    value: high
                  uri: https://github.com/company/repo/blob/main/db/pool.go
        required: true
      responses:
        "201":
          description: Sources created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Repository"
                x-content-type: application/json
              examples:
                bulkCreatedSources:
                  summary: Successfully created sources with generated IDs
                  value:
                  - name: User Authentication Module
                    description: Core user authentication logic
                    created_at: 2025-04-06T12:00:00Z
                    modified_at: 2025-04-06T12:00:00Z
                    uri: https://github.com/company/repo/blob/main/oauth2/user.go
                    id: 990e8400-e29b-41d4-a716-446655440023
                  - id: 650e8400-e29b-41d4-a716-446655440002
                    name: Database Connection Pool
                    description: Database connection management
                    metadata:
                    - key: type
                      value: infrastructure
                    - key: criticality
                      value: high
                    created_at: 2025-04-06T12:00:00Z
                    modified_at: 2025-04-06T12:00:00Z
                    uri: https://github.com/company/repo/blob/main/db/pool.go
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create sources
      description: Creates multiple source references in a single operation for the
        specified threat model
      operationId: bulkCreateThreatModelRepositories
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              description: Array of source references to create
              items:
                $ref: "#/components/schemas/Repository"
            examples:
              bulkCreateSources:
                summary: Create multiple source references at once
                value:
                - id: 990e8400-e29b-41d4-a716-446655440012
                  name: API Repository
                  uri: https://github.com/example/api
                  description: Backend API source code
                  threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                  created_at: 2025-01-12T08:00:00Z
                  modified_at: 2025-01-12T08:00:00Z
                - name: Database Connection Pool
                  description: Database connection management
                  metadata:
                  - key: type
                    value: infrastructure
                  - key: criticality
                    value: high
                  uri: https://github.com/company/repo/blob/main/db/pool.go
        required: true
      responses:
        "201":
          description: Sources created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Repository"
                x-content-type: application/json
              examples:
                bulkCreatedSources:
                  summary: Successfully created sources with generated IDs
                  value:
                  - name: User Authentication Module
                    description: Core user authentication logic
                    created_at: 2025-04-06T12:00:00Z
                    modified_at: 2025-04-06T12:00:00Z
                    uri: https://github.com/company/repo/blob/main/oauth2/user.go
                    id: 990e8400-e29b-41d4-a716-446655440022
                  - id: 650e8400-e29b-41d4-a716-446655440002
                    name: Database Connection Pool
                    description: Database connection management
                    metadata:
                    - key: type
                      value: infrastructure
                    - key: criticality
                      value: high
                    created_at: 2025-04-06T12:00:00Z
                    modified_at: 2025-04-06T12:00:00Z
                    uri: https://github.com/company/repo/blob/main/db/pool.go
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/metadata:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get threat model metadata
      description: Returns all metadata key-value pairs for the specified threat model
      operationId: getThreatModelMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Threat model metadata list
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create threat model metadata
      description: Creates new metadata entry for the specified threat model
      operationId: createThreatModelMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entry created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/metadata/{key}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get threat model metadata by key
      description: Returns a specific metadata entry by key for the specified threat
        model
      operationId: getThreatModelMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "200":
          description: Metadata entry
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update threat model metadata by key
      description: Updates a specific metadata entry by key for the specified threat
        model
      operationId: updateThreatModelMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/metadata_key_body_3"
        required: true
      responses:
        "200":
          description: Metadata entry updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete threat model metadata by key
      description: Deletes a specific metadata entry by key for the specified threat
        model
      operationId: deleteThreatModelMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "204":
          description: Metadata entry deleted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/metadata/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk upsert threat model metadata
      description: Creates or updates multiple metadata key-value pairs for the specified
        threat model
      operationId: bulkUpsertThreatModelMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "200":
          description: Metadata upserted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create threat model metadata
      description: Creates multiple metadata entries in a single operation for the
        specified threat model
      operationId: bulkCreateThreatModelMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entries created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/diagrams:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: List threat model diagrams
      description: Returns all diagrams associated with a specific threat model
      operationId: getThreatModelDiagrams
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: limit
        in: query
        description: Maximum number of results to return
        required: false
        style: form
        explode: true
        schema:
          maximum: 100
          minimum: 1
          type: integer
          default: 20
      - name: offset
        in: query
        description: Number of results to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      responses:
        "200":
          description: List of diagrams
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/DiagramListItem"
                x-content-type: application/json
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create a new diagram
      description: Creates a new diagram within the specified threat model
      operationId: createThreatModelDiagram
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateDiagramRequest"
        required: true
      responses:
        "201":
          description: Diagram created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DfdDiagram"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/diagrams/{diagram_id}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get a specific diagram
      description: Retrieves a specific diagram from the threat model
      operationId: getThreatModelDiagram
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Diagram identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Diagram details
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DfdDiagram"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update a diagram
      description: "Completely replaces a diagram with new data. Use DfdDiagramInput\
        \ schema which excludes readOnly fields (id, created_at, modified_at, update_vector)."
      operationId: updateThreatModelDiagram
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Diagram identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DfdDiagramInput"
        required: true
      responses:
        "200":
          description: Diagram updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DfdDiagram"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "409":
          description: Conflict - Cannot modify diagram while collaboration session
            is active
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete a diagram
      description: Permanently removes a diagram from the threat model
      operationId: deleteThreatModelDiagram
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Diagram identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "204":
          description: Diagram deleted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "409":
          description: Conflict - Cannot delete diagram while collaboration session
            is active
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    patch:
      tags:
      - Threat Model Sub-Resources
      summary: Partially update a diagram
      description: Apply JSON Patch operations to update specific parts of a diagram
      operationId: patchThreatModelDiagram
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Diagram identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json-patch+json:
            schema:
              $ref: "#/components/schemas/JsonPatchDocument"
            examples:
              updateName:
                summary: Update diagram name
                value:
                - op: replace
                  path: /name
                  value: Updated Diagram Name
              addCell:
                summary: Add a new cell to the diagram
                value:
                - op: add
                  path: /cells/-
                  value:
                    id: new-cell-id
                    shape: process
                    x: 100
                    "y": 100
                    width: 120
                    height: 60
                    label: New Process
              addMetadata:
                summary: Add metadata to diagram
                value:
                - op: add
                  path: /metadata/-
                  value:
                    key: version
                    value: "2.0"
        required: true
      responses:
        "200":
          description: Diagram updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DfdDiagram"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "422":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "409":
          description: Conflict - Cannot modify diagram while collaboration session
            is active
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/diagrams/{diagram_id}/collaborate:
    get:
      tags:
      - Collaboration
      summary: Get diagram collaboration session
      description: "Retrieves the current collaboration session details for a diagram.\
        \ The session payload indicates who has been authorized to the session, not\
        \ who is currently active in the WebSocket session. The 200 status indicates\
        \ successful retrieval - clients must NOT evaluate the payload to determine\
        \ session status."
      operationId: getDiagramCollaborationSession
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Diagram identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Collaboration session details
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CollaborationSession"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Collaboration
      summary: Create diagram collaboration session
      description: "Creates a new collaboration session for real-time diagram editing.\
        \ Only one collaboration session can exist per diagram at a time. If a session\
        \ already exists, returns 409 with a link to join the existing session."
      operationId: createDiagramCollaborationSession
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Diagram identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "201":
          description: Collaboration session created successfully. The 201 status
            indicates successful creation - clients must NOT evaluate the payload
            to determine success.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CollaborationSession"
        "400":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "409":
          description: Collaboration session already exists for this diagram
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_409"
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    delete:
      tags:
      - Collaboration
      summary: End diagram collaboration session
      description: Terminates the active collaboration session for a diagram
      operationId: endDiagramCollaborationSession
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Diagram identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "204":
          description: Collaboration session ended successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/diagrams/{diagram_id}/metadata:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get diagram metadata
      description: Retrieves all metadata entries for the specified diagram
      operationId: getDiagramMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Diagram identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: List of metadata entries
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create diagram metadata
      description: Creates a new metadata entry for the specified diagram
      operationId: createDiagramMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Diagram identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entry created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/diagrams/{diagram_id}/metadata/{key}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get diagram metadata by key
      description: Retrieves a specific metadata entry for the diagram by key
      operationId: getDiagramMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Diagram identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "200":
          description: Metadata entry
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update diagram metadata by key
      description: Updates or creates a metadata entry for the diagram with the specified
        key
      operationId: updateDiagramMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Diagram identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/metadata_key_body_4"
        required: true
      responses:
        "200":
          description: Metadata entry updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete diagram metadata by key
      description: Removes a specific metadata entry for the diagram by key
      operationId: deleteDiagramMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Diagram identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "204":
          description: Metadata entry deleted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/diagrams/{diagram_id}/metadata/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk upsert diagram metadata
      description: Creates or updates multiple metadata key-value pairs for the specified
        diagram
      operationId: bulkUpsertDiagramMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Diagram identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "200":
          description: Metadata upserted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create diagram metadata
      description: Creates multiple metadata entries in a single operation for the
        specified diagram
      operationId: bulkCreateDiagramMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Diagram identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entries created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /users/me:
    get:
      tags:
      - Authentication
      summary: Get current user profile
      description: Returns detailed information about the currently authenticated
        user including groups and identity provider
      operationId: getCurrentUserProfile
      responses:
        "200":
          description: Current user profile
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserWithAdminStatus"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    delete:
      tags:
      - Users
      summary: Delete authenticated user account and all data
      description: |-
        Two-step deletion process:
        1. First call (no challenge parameter) - Returns challenge string
        2. Second call (with challenge parameter) - Confirms deletion

        Ownership behavior:
        - Shared threat models: Transfers ownership to another owner from authorization list
        - Unshared threat models: Deletes completely along with all child resources
      operationId: deleteUserAccount
      parameters:
      - name: challenge
        in: query
        description: Challenge string from first request (step 2 only). Must match
          exactly.
        required: false
        style: form
        explode: true
        schema:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
      responses:
        "200":
          description: Challenge issued (step 1)
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeletionChallenge"
        "204":
          description: User deleted successfully (step 2)
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "400":
          description: "Invalid or expired challenge, or challenge provided on first\
            \ request"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - valid JWT token required
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/notes:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: List notes in a threat model
      description: Returns a paginated list of notes within the specified threat model
      operationId: getThreatModelNotes
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: limit
        in: query
        description: Maximum number of results to return
        required: false
        style: form
        explode: true
        schema:
          maximum: 100
          minimum: 1
          type: integer
          default: 20
      - name: offset
        in: query
        description: Number of results to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      responses:
        "200":
          description: List of notes
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/NoteListItem"
                x-content-type: application/json
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create a new note
      description: Creates a new note within the specified threat model
      operationId: createThreatModelNote
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/NoteInput"
        required: true
      responses:
        "201":
          description: Note created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Note"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/notes/{note_id}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get a specific note
      description: Returns details of a specific note within the threat model
      operationId: getThreatModelNote
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Note identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Note details
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Note"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update a note
      description: Updates a specific note within the threat model
      operationId: updateThreatModelNote
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Note identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/NoteInput"
        required: true
      responses:
        "200":
          description: Note updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Note"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete a note
      description: Deletes a specific note from the threat model
      operationId: deleteThreatModelNote
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Note identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "204":
          description: Note deleted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    patch:
      tags:
      - Notes
      summary: Partially update note
      description: Apply JSON Patch operations to partially update a note
      operationId: patchThreatModelNote
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Note identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json-patch+json:
            schema:
              $ref: "#/components/schemas/JsonPatchDocument"
        required: true
      responses:
        "200":
          description: Successfully patched note
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Note"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/notes/{note_id}/metadata:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get note metadata
      description: Returns all metadata key-value pairs for the specified note
      operationId: getNoteMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Note identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Note metadata list
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create note metadata
      description: Creates new metadata entry for the specified note
      operationId: createNoteMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Note identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entry created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/notes/{note_id}/metadata/{key}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get note metadata by key
      description: Returns a specific metadata entry by key for the specified note
      operationId: getNoteMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Note identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "200":
          description: Metadata entry
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update note metadata by key
      description: Updates a specific metadata entry by key for the specified note
      operationId: updateNoteMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Note identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/metadata_key_body_5"
        required: true
      responses:
        "200":
          description: Metadata entry updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete note metadata by key
      description: Deletes a specific metadata entry by key for the specified note
      operationId: deleteNoteMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Note identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "204":
          description: Metadata entry deleted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/notes/{note_id}/metadata/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk update note metadata
      description: Updates multiple metadata entries for the specified note in a single
        operation
      operationId: bulkUpdateNoteMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Note identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 100
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "200":
          description: Metadata entries updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create note metadata
      description: Creates multiple metadata key-value pairs for the specified note
      operationId: bulkCreateNoteMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Note identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 100
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/assets:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: List assets in a threat model
      description: Returns a paginated list of assets within the specified threat
        model
      operationId: getThreatModelAssets
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: limit
        in: query
        description: Maximum number of results to return
        required: false
        style: form
        explode: true
        schema:
          maximum: 100
          minimum: 1
          type: integer
          default: 20
      - name: offset
        in: query
        description: Number of results to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      responses:
        "200":
          description: List of assets
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Asset"
                x-content-type: application/json
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create a new asset
      description: Creates a new asset within the specified threat model
      operationId: createThreatModelAsset
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AssetInput"
        required: true
      responses:
        "201":
          description: Asset created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Asset"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/assets/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk upsert assets
      description: Create or update multiple assets in a single request
      operationId: bulkUpsertThreatModelAssets
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 50
              type: array
              items:
                $ref: "#/components/schemas/Asset"
        required: true
      responses:
        "201":
          description: Assets created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Asset"
                x-content-type: application/json
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create assets
      description: Creates multiple assets within the specified threat model (maximum
        50 per request)
      operationId: bulkCreateThreatModelAssets
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 50
              type: array
              items:
                $ref: "#/components/schemas/Asset"
        required: true
      responses:
        "201":
          description: Assets created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Asset"
                x-content-type: application/json
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/assets/{asset_id}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get a specific asset
      description: Returns a single asset by its ID
      operationId: getThreatModelAsset
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Asset identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Asset details
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Asset"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update an asset
      description: Updates an existing asset within the specified threat model
      operationId: updateThreatModelAsset
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Asset identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AssetInput"
        required: true
      responses:
        "200":
          description: Asset updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Asset"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete an asset
      description: Deletes an asset from the specified threat model
      operationId: deleteThreatModelAsset
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Asset identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "204":
          description: Asset deleted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    patch:
      tags:
      - Assets
      summary: Partially update asset
      description: Apply JSON Patch operations to partially update a asset
      operationId: patchThreatModelAsset
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Asset identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json-patch+json:
            schema:
              $ref: "#/components/schemas/JsonPatchDocument"
        required: true
      responses:
        "200":
          description: Successfully patched asset
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Asset"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/assets/{asset_id}/metadata:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get all metadata for an asset
      description: Returns all metadata key-value pairs for the specified asset
      operationId: getThreatModelAssetMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Asset identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Asset metadata
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Add metadata to an asset
      description: Adds a new metadata key-value pair to the specified asset
      operationId: createThreatModelAssetMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Asset identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/assets/{asset_id}/metadata/{key}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get specific metadata for an asset
      description: Returns a single metadata value by its key
      operationId: getThreatModelAssetMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Asset identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "200":
          description: Metadata value
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update asset metadata
      description: Updates an existing metadata value by its key
      operationId: updateThreatModelAssetMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Asset identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "200":
          description: Metadata updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete asset metadata
      description: Deletes a metadata key-value pair from the specified asset
      operationId: deleteThreatModelAssetMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Asset identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "204":
          description: Metadata deleted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /threat_models/{threat_model_id}/assets/{asset_id}/metadata/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk upsert asset metadata
      description: Creates or updates multiple metadata key-value pairs for the specified
        asset
      operationId: bulkUpsertThreatModelAssetMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Asset identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 100
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "200":
          description: Metadata upserted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create asset metadata
      description: Creates multiple metadata key-value pairs for the specified asset
      operationId: bulkCreateThreatModelAssetMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Asset identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 100
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "403":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "404":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /saml/acs:
    post:
      tags:
      - Authentication
      summary: SAML Assertion Consumer Service
      description: Processes SAML responses from IdP after authentication
      operationId: processSAMLResponse
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              $ref: "#/components/schemas/SamlAssertionConsumerRequest"
      responses:
        "200":
          description: Authentication successful
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthTokenResponse"
        "302":
          description: Redirect to client callback with token
        "400":
          description: Invalid SAML response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Authentication failed
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
      security: []
      x-rate-limit:
        strategy: multi-scope
        tier: auth-flows
        scopes:
        - name: session
          limits:
          - type: requests_per_minute
            default: 5
            configurable: false
            tracking_method: OAuth state parameter or SAML request ID
        - name: ip
          limits:
          - type: requests_per_minute
            default: 100
            configurable: false
            tracking_method: Source IP address
        - name: user_identifier
          limits:
          - type: attempts_per_hour
            default: 10
            configurable: false
            tracking_method: login_hint parameter or email address
        enforcement: Most restrictive limit applies
      x-public-endpoint: true
      x-authentication-required: false
      x-public-endpoint-purpose: SAML Flow
  /saml/slo:
    get:
      tags:
      - Authentication
      summary: SAML Single Logout
      description: Handles SAML logout requests from IdP
      operationId: processSAMLLogout
      parameters:
      - name: SAMLRequest
        in: query
        description: Base64-encoded SAML logout request
        required: true
        style: form
        explode: true
        schema:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
      responses:
        "200":
          description: Logout successful
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200_9"
        "400":
          description: Invalid SAML logout request
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
      security: []
      x-rate-limit:
        strategy: multi-scope
        tier: auth-flows
        scopes:
        - name: session
          limits:
          - type: requests_per_minute
            default: 5
            configurable: false
            tracking_method: OAuth state parameter or SAML request ID
        - name: ip
          limits:
          - type: requests_per_minute
            default: 100
            configurable: false
            tracking_method: Source IP address
        - name: user_identifier
          limits:
          - type: attempts_per_hour
            default: 10
            configurable: false
            tracking_method: login_hint parameter or email address
        enforcement: Most restrictive limit applies
      x-public-endpoint: true
      x-authentication-required: false
      x-public-endpoint-purpose: SAML Flow
    post:
      tags:
      - Authentication
      summary: SAML Single Logout (POST)
      description: Handles SAML logout requests from IdP via POST
      operationId: processSAMLLogoutPost
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              $ref: "#/components/schemas/SamlSingleLogoutRequest"
      responses:
        "200":
          description: Logout successful
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200_9"
        "400":
          description: Invalid SAML logout request
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
      security: []
      x-rate-limit:
        strategy: multi-scope
        tier: auth-flows
        scopes:
        - name: session
          limits:
          - type: requests_per_minute
            default: 5
            configurable: false
            tracking_method: OAuth state parameter or SAML request ID
        - name: ip
          limits:
          - type: requests_per_minute
            default: 100
            configurable: false
            tracking_method: Source IP address
        - name: user_identifier
          limits:
          - type: attempts_per_hour
            default: 10
            configurable: false
            tracking_method: login_hint parameter or email address
        enforcement: Most restrictive limit applies
      x-public-endpoint: true
      x-authentication-required: false
      x-public-endpoint-purpose: SAML Flow
  /webhooks/subscriptions:
    get:
      tags:
      - webhooks
      summary: List webhook subscriptions
      description: List all webhook subscriptions owned by the authenticated user.
        Optionally filter by threat_model_id.
      operationId: listWebhookSubscriptions
      parameters:
      - name: threat_model_id
        in: query
        description: Filter subscriptions by threat model ID
        required: false
        style: form
        explode: true
        schema:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          format: uuid
      - name: offset
        in: query
        description: Number of results to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      - name: limit
        in: query
        description: Maximum number of results to return
        required: false
        style: form
        explode: true
        schema:
          maximum: 100
          minimum: 1
          type: integer
          default: 20
      responses:
        "200":
          description: List of webhook subscriptions
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/WebhookSubscription"
                x-content-type: application/json
        "401":
          description: Unauthorized
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: webhooks
        limits:
        - type: subscription_requests_per_minute
          default: 10
          configurable: true
          quota_source: webhook_quotas.max_subscription_requests_per_minute
        - type: subscription_requests_per_day
          default: 20
          configurable: true
          quota_source: webhook_quotas.max_subscription_requests_per_day
        - type: events_per_minute
          default: 12
          configurable: true
          quota_source: webhook_quotas.max_events_per_minute
        - type: max_subscriptions
          default: 10
          configurable: true
          quota_source: webhook_quotas.max_subscriptions
    post:
      tags:
      - webhooks
      summary: Create webhook subscription
      description: Create a new webhook subscription. The subscription will be in
        pending_verification status until the challenge is completed.
      operationId: createWebhookSubscription
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/WebhookSubscriptionInput"
        required: true
      responses:
        "201":
          description: Webhook subscription created
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WebhookSubscription"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: webhooks
        limits:
        - type: subscription_requests_per_minute
          default: 10
          configurable: true
          quota_source: webhook_quotas.max_subscription_requests_per_minute
        - type: subscription_requests_per_day
          default: 20
          configurable: true
          quota_source: webhook_quotas.max_subscription_requests_per_day
        - type: events_per_minute
          default: 12
          configurable: true
          quota_source: webhook_quotas.max_events_per_minute
        - type: max_subscriptions
          default: 10
          configurable: true
          quota_source: webhook_quotas.max_subscriptions
  /webhooks/subscriptions/{webhook_id}:
    get:
      tags:
      - webhooks
      summary: Get webhook subscription
      description: Get a specific webhook subscription by ID
      operationId: getWebhookSubscription
      parameters:
      - name: webhook_id
        in: path
        description: Webhook subscription identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Webhook subscription details
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WebhookSubscription"
        "401":
          description: Unauthorized
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Not Found
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: webhooks
        limits:
        - type: subscription_requests_per_minute
          default: 10
          configurable: true
          quota_source: webhook_quotas.max_subscription_requests_per_minute
        - type: subscription_requests_per_day
          default: 20
          configurable: true
          quota_source: webhook_quotas.max_subscription_requests_per_day
        - type: events_per_minute
          default: 12
          configurable: true
          quota_source: webhook_quotas.max_events_per_minute
        - type: max_subscriptions
          default: 10
          configurable: true
          quota_source: webhook_quotas.max_subscriptions
    delete:
      tags:
      - webhooks
      summary: Delete webhook subscription
      description: Delete a webhook subscription. Only the owner can delete a subscription.
      operationId: deleteWebhookSubscription
      parameters:
      - name: webhook_id
        in: path
        description: Webhook subscription identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "204":
          description: Webhook subscription deleted
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "401":
          description: Unauthorized
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Not Found
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: webhooks
        limits:
        - type: subscription_requests_per_minute
          default: 10
          configurable: true
          quota_source: webhook_quotas.max_subscription_requests_per_minute
        - type: subscription_requests_per_day
          default: 20
          configurable: true
          quota_source: webhook_quotas.max_subscription_requests_per_day
        - type: events_per_minute
          default: 12
          configurable: true
          quota_source: webhook_quotas.max_events_per_minute
        - type: max_subscriptions
          default: 10
          configurable: true
          quota_source: webhook_quotas.max_subscriptions
  /webhooks/subscriptions/{webhook_id}/test:
    post:
      tags:
      - webhooks
      summary: Test webhook subscription
      description: Send a test event to the webhook URL to verify it's working correctly
      operationId: testWebhookSubscription
      parameters:
      - name: webhook_id
        in: path
        description: Webhook subscription identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/WebhookTestRequest"
        required: false
      responses:
        "200":
          description: Test webhook sent
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WebhookTestResponse"
        "401":
          description: Unauthorized
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Not Found
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: webhooks
        limits:
        - type: subscription_requests_per_minute
          default: 10
          configurable: true
          quota_source: webhook_quotas.max_subscription_requests_per_minute
        - type: subscription_requests_per_day
          default: 20
          configurable: true
          quota_source: webhook_quotas.max_subscription_requests_per_day
        - type: events_per_minute
          default: 12
          configurable: true
          quota_source: webhook_quotas.max_events_per_minute
        - type: max_subscriptions
          default: 10
          configurable: true
          quota_source: webhook_quotas.max_subscriptions
  /webhooks/deliveries:
    get:
      tags:
      - webhooks
      summary: List webhook deliveries
      description: List webhook deliveries for the authenticated user's subscriptions
      operationId: listWebhookDeliveries
      parameters:
      - name: subscription_id
        in: query
        description: Filter by subscription ID
        required: false
        style: form
        explode: true
        schema:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          format: uuid
      - name: offset
        in: query
        description: Number of results to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      - name: limit
        in: query
        description: Maximum number of results to return
        required: false
        style: form
        explode: true
        schema:
          maximum: 100
          minimum: 1
          type: integer
          default: 20
      responses:
        "200":
          description: List of webhook deliveries
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                maxItems: 1000
                type: array
                items:
                  $ref: "#/components/schemas/WebhookDelivery"
                x-content-type: application/json
        "401":
          description: Unauthorized
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: webhooks
        limits:
        - type: subscription_requests_per_minute
          default: 10
          configurable: true
          quota_source: webhook_quotas.max_subscription_requests_per_minute
        - type: subscription_requests_per_day
          default: 20
          configurable: true
          quota_source: webhook_quotas.max_subscription_requests_per_day
        - type: events_per_minute
          default: 12
          configurable: true
          quota_source: webhook_quotas.max_events_per_minute
        - type: max_subscriptions
          default: 10
          configurable: true
          quota_source: webhook_quotas.max_subscriptions
  /webhooks/deliveries/{delivery_id}:
    get:
      tags:
      - webhooks
      summary: Get webhook delivery
      description: Get details of a specific webhook delivery
      operationId: getWebhookDelivery
      parameters:
      - name: delivery_id
        in: path
        description: Webhook delivery identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Webhook delivery details
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WebhookDelivery"
        "401":
          description: Unauthorized
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Not Found
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: webhooks
        limits:
        - type: subscription_requests_per_minute
          default: 10
          configurable: true
          quota_source: webhook_quotas.max_subscription_requests_per_minute
        - type: subscription_requests_per_day
          default: 20
          configurable: true
          quota_source: webhook_quotas.max_subscription_requests_per_day
        - type: events_per_minute
          default: 12
          configurable: true
          quota_source: webhook_quotas.max_events_per_minute
        - type: max_subscriptions
          default: 10
          configurable: true
          quota_source: webhook_quotas.max_subscriptions
  /addons:
    get:
      tags:
      - Addons
      summary: List add-ons
      description: List all add-ons (authenticated users)
      operationId: listAddons
      parameters:
      - name: limit
        in: query
        description: Maximum number of results to return
        required: false
        style: form
        explode: true
        schema:
          maximum: 100
          minimum: 1
          type: integer
          default: 20
      - name: offset
        in: query
        description: Number of results to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      - name: threat_model_id
        in: query
        description: Filter subscriptions by threat model ID
        required: false
        style: form
        explode: true
        schema:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          format: uuid
      responses:
        "200":
          description: Success
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ListAddonsResponse"
        "401":
          description: Unauthorized - authentication required
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    post:
      tags:
      - Addons
      summary: Create add-on
      description: Create a new add-on (administrators only)
      operationId: createAddon
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateAddonRequest"
        required: true
      responses:
        "201":
          description: Add-on created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AddonResponse"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - authentication required
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Webhook not found
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /addons/{id}:
    get:
      tags:
      - Addons
      summary: Get add-on
      description: Get a single add-on by ID
      operationId: getAddon
      parameters:
      - name: id
        in: path
        description: Resource identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Add-on details
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AddonResponse"
        "401":
          description: Unauthorized - authentication required
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Add-on not found
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
    delete:
      tags:
      - Addons
      summary: Delete add-on
      description: Delete an add-on (administrators only)
      operationId: deleteAddon
      parameters:
      - name: id
        in: path
        description: Resource identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "204":
          description: Add-on deleted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "401":
          description: Unauthorized - authentication required
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Add-on not found
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "409":
          description: Conflict - cannot delete add-on with active invocations
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /addons/{id}/invoke:
    post:
      tags:
      - Addons
      summary: Invoke add-on
      description: Trigger an add-on invocation (authenticated users)
      operationId: invokeAddon
      parameters:
      - name: id
        in: path
        description: Resource identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/InvokeAddonRequest"
        required: true
      responses:
        "202":
          description: Invocation accepted and queued
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvokeAddonResponse"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - authentication required
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Add-on not found
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: "Rate limit exceeded (quota: 1 active invocation or 10 per\
            \ hour)"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /invocations:
    get:
      tags:
      - Addons
      summary: List invocations
      description: "List add-on invocations (users see own, admins see all)"
      operationId: listInvocations
      parameters:
      - name: limit
        in: query
        description: Maximum number of results to return
        required: false
        style: form
        explode: true
        schema:
          maximum: 100
          minimum: 1
          type: integer
          default: 20
      - name: offset
        in: query
        description: Number of results to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      - name: status
        in: query
        description: "Filter by status value (exact match). To filter by multiple\
          \ statuses, use multiple status parameters or comma-separated values."
        required: false
        style: form
        explode: true
        schema:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
      - name: addon_id
        in: query
        description: Filter by add-on
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Success
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ListInvocationsResponse"
        "401":
          description: Unauthorized - authentication required
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "405":
          description: Method Not Allowed - The HTTP method is not supported for this
            endpoint
          headers:
            Allow:
              description: List of allowed HTTP methods for this endpoint
              style: simple
              explode: false
              schema:
                type: string
                example: "GET, POST"
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: method_not_allowed
                error_description: The HTTP method is not supported for this endpoint
        "406":
          description: Not Acceptable - The requested media type is not supported.
            This API only supports application/json
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: not_acceptable
                error_description: "The requested Accept header media type is not\
                  \ supported. Supported types: application/json"
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /invocations/{id}:
    get:
      tags:
      - Addons
      summary: Get invocation
      description: Get a single invocation by ID (own invocations or admin)
      operationId: getInvocation
      parameters:
      - name: id
        in: path
        description: Resource identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Invocation details
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvocationResponse"
        "401":
          description: Unauthorized - authentication required
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - not your invocation and not admin
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Invocation not found or expired
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /invocations/{id}/status:
    post:
      tags:
      - Addons
      summary: Update invocation status
      description: Update invocation status (webhook callback with HMAC authentication)
      operationId: updateInvocationStatus
      parameters:
      - name: id
        in: path
        description: Resource identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: X-Webhook-Signature
        in: header
        description: "HMAC-SHA256 signature (format: sha256={hex_signature})"
        required: true
        style: simple
        explode: false
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateInvocationStatusRequest"
        required: true
      responses:
        "200":
          description: Status updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UpdateInvocationStatusResponse"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - invalid HMAC signature
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Invocation not found or expired
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "409":
          description: Conflict - invalid status transition
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /saml/providers:
    get:
      tags:
      - Authentication
      summary: List available SAML providers
      description: Returns a list of configured SAML providers available for authentication
      operationId: getSAMLProviders
      responses:
        "200":
          description: List of available SAML providers
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200_10"
        "500":
          description: Error response
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      code: INSUFFICIENT_PERMISSIONS
                      context:
                        required_role: writer
                        user_role: reader
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                        resource_type: threat
                      suggestion: Request write access from the threat model owner
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      code: RESOURCE_NOT_FOUND
                      context:
                        resource_id: 550e8400-e29b-41d4-a716-446655440999
                        resource_type: document
                        threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      suggestion: Verify the resource ID and threat model association
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      code: VALIDATION_FAILED
                      context:
                        field_errors:
                        - field: name
                          error: must not be empty
                      suggestion: Correct the validation errors and retry the request
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security: []
      x-rate-limit:
        scope: ip
        tier: public-discovery
        limits:
        - type: requests_per_minute
          default: 10
          configurable: false
          tracking_method: Source IP address
      x-public-endpoint: true
      x-authentication-required: false
      x-public-endpoint-purpose: SAML Flow
  /saml/{provider}/login:
    get:
      tags:
      - Authentication
      summary: Initiate SAML authentication
      description: Starts SAML authentication flow by redirecting to IdP
      operationId: initiateSAMLLogin
      parameters:
      - name: client_callback
        in: query
        description: "Client callback URL where TMI should redirect after successful\
          \ OAuth completion with tokens in URL fragment (#access_token=...). If not\
          \ provided, tokens are returned as JSON response. Per OAuth 2.0 implicit\
          \ flow spec, tokens are in fragments to prevent logging."
        required: false
        style: form
        explode: true
        schema:
          maxLength: 1000
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          format: uri
          example: http://localhost:4200/oauth2/callback
      - name: provider
        in: path
        description: SAML provider identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
      responses:
        "302":
          description: Redirect to SAML IdP for authentication
        "500":
          description: Failed to initiate SAML authentication
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security: []
      x-rate-limit:
        strategy: multi-scope
        tier: auth-flows
        scopes:
        - name: session
          limits:
          - type: requests_per_minute
            default: 5
            configurable: false
            tracking_method: OAuth state parameter or SAML request ID
        - name: ip
          limits:
          - type: requests_per_minute
            default: 100
            configurable: false
            tracking_method: Source IP address
        - name: user_identifier
          limits:
          - type: attempts_per_hour
            default: 10
            configurable: false
            tracking_method: login_hint parameter or email address
        enforcement: Most restrictive limit applies
      x-public-endpoint: true
      x-authentication-required: false
      x-public-endpoint-purpose: SAML Flow
  /saml/{provider}/metadata:
    get:
      tags:
      - Authentication
      summary: Get SAML service provider metadata
      description: Returns the SP metadata XML for SAML configuration
      operationId: getSAMLMetadata
      parameters:
      - name: provider
        in: path
        description: SAML provider identifier
        required: true
        style: simple
        explode: false
        schema:
          type: string
      responses:
        "200":
          description: SAML metadata XML
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/samlmetadata+xml:
              schema:
                maxLength: 1000
                type: string
                format: xml
                x-content-type: application/samlmetadata+xml
        "500":
          description: Failed to generate metadata
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too Many Requests - Rate limit exceeded. The client has sent
            too many requests in a given amount of time. See rate limit headers for
            details.
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              description: Unix timestamp (seconds since epoch) when the rate limit
                window resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640000000
            Retry-After:
              description: Number of seconds to wait before retrying the request
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error: rate_limit_exceeded
                error_description: "Rate limit exceeded: 100 requests per minute.\
                  \ Retry after 45 seconds."
                details:
                  code: RATE_LIMIT_EXCEEDED
                  context:
                    limit: 100
                    window: minute
                    retry_after: 45
      security: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
      x-public-endpoint: true
      x-authentication-required: false
      x-public-endpoint-purpose: SAML Flow
  /admin/administrators:
    get:
      tags:
      - Administration
      summary: List administrators
      description: "Returns a list of administrator grants with optional filtering\
        \ by provider, user, or group"
      operationId: listAdministrators
      parameters:
      - name: provider
        in: query
        description: Filter by OAuth/SAML provider
        required: false
        style: form
        explode: true
        schema:
          maxLength: 256
          type: string
      - name: user_id
        in: query
        description: Filter by user ID
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: uuid
      - name: group_id
        in: query
        description: Filter by group ID
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: uuid
      - name: limit
        in: query
        description: Maximum number of results to return
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 50
      - name: offset
        in: query
        description: Number of results to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      responses:
        "200":
          description: List of administrator grants
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ListAdministratorsResponse"
        "401":
          description: Unauthorized - Invalid or missing authentication token
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
    post:
      tags:
      - Administration
      summary: Create administrator grant
      description: "Grants administrator privileges to a user or group for a specific\
        \ provider. Exactly one of email, provider_user_id, or group_name must be\
        \ specified."
      operationId: createAdministrator
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateAdministratorRequest"
        required: true
      responses:
        "201":
          description: Administrator grant created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Administrator"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - Invalid or missing authentication token
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "409":
          description: Conflict - Administrator grant already exists
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
  /admin/administrators/{id}:
    delete:
      tags:
      - Administration
      summary: Delete administrator grant
      description: Revokes administrator privileges. Users cannot revoke their own
        privileges or privileges for groups they belong to.
      operationId: deleteAdministrator
      parameters:
      - name: id
        in: path
        description: Administrator grant ID
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "204":
          description: Administrator grant deleted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "400":
          description: Bad request - Invalid grant ID
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - Invalid or missing authentication token
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Not found - Administrator grant does not exist
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
  /admin/quotas/users/{user_id}:
    get:
      tags:
      - Administration
      summary: Get user API quota
      description: Retrieves the API rate limit quota for a specific user
      operationId: getUserAPIQuota
      parameters:
      - name: user_id
        in: path
        description: User ID
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: User API quota
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserAPIQuota"
        "400":
          description: Bad request - Invalid user ID
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
    put:
      tags:
      - Administration
      summary: Update user API quota
      description: Creates or updates the API rate limit quota for a specific user
      operationId: updateUserAPIQuota
      parameters:
      - name: user_id
        in: path
        description: User ID
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UserQuotaUpdate"
        required: true
      responses:
        "200":
          description: Quota updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserAPIQuota"
        "201":
          description: Quota created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserAPIQuota"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
    delete:
      tags:
      - Administration
      summary: Delete user API quota
      description: "Deletes the custom API quota for a user, reverting to system defaults"
      operationId: deleteUserAPIQuota
      parameters:
      - name: user_id
        in: path
        description: User ID
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "204":
          description: Quota deleted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "400":
          description: Bad request - Invalid user ID
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Quota not found
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
  /admin/quotas/webhooks/{user_id}:
    get:
      tags:
      - Administration
      summary: Get webhook quota
      description: Retrieves the webhook quota for a specific user
      operationId: getWebhookQuota
      parameters:
      - name: user_id
        in: path
        description: User ID
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Webhook quota
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WebhookQuota"
        "400":
          description: Bad request - Invalid user ID
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
    put:
      tags:
      - Administration
      summary: Update webhook quota
      description: Creates or updates the webhook quota for a specific user
      operationId: updateWebhookQuota
      parameters:
      - name: user_id
        in: path
        description: User ID
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/WebhookQuotaUpdate"
        required: true
      responses:
        "200":
          description: Quota updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WebhookQuota"
        "201":
          description: Quota created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WebhookQuota"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
    delete:
      tags:
      - Administration
      summary: Delete webhook quota
      description: "Deletes the custom webhook quota for a user, reverting to system\
        \ defaults"
      operationId: deleteWebhookQuota
      parameters:
      - name: user_id
        in: path
        description: User ID
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "204":
          description: Quota deleted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "400":
          description: Bad request - Invalid user ID
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Quota not found
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
  /admin/users:
    get:
      tags:
      - Administration
      summary: List users
      description: "Returns a paginated list of users with optional filtering by provider,\
        \ email, and date ranges. Includes enriched data (admin status, groups, threat\
        \ model counts)."
      operationId: listAdminUsers
      parameters:
      - name: provider
        in: query
        description: Filter by OAuth/SAML provider
        required: false
        style: form
        explode: true
        schema:
          maxLength: 256
          type: string
      - name: email
        in: query
        description: Filter by email (case-insensitive substring match)
        required: false
        style: form
        explode: true
        schema:
          type: string
      - name: created_after
        in: query
        description: Filter users created after this timestamp (RFC3339)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      - name: created_before
        in: query
        description: Filter users created before this timestamp (RFC3339)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      - name: last_login_after
        in: query
        description: Filter users who logged in after this timestamp (RFC3339)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      - name: last_login_before
        in: query
        description: Filter users who logged in before this timestamp (RFC3339)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      - name: limit
        in: query
        description: Maximum number of results to return
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 50
      - name: offset
        in: query
        description: Number of results to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      - name: sort_by
        in: query
        description: Field to sort by
        required: false
        style: form
        explode: true
        schema:
          type: string
          enum:
          - created_at
          - last_login
          - email
          default: created_at
      - name: sort_order
        in: query
        description: Sort direction
        required: false
        style: form
        explode: true
        schema:
          type: string
          enum:
          - asc
          - desc
          default: desc
      responses:
        "200":
          description: Paginated list of users
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AdminUserListResponse"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - Invalid or missing authentication token
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
  /admin/users/{internal_uuid}:
    get:
      tags:
      - Administration
      summary: Get user details
      description: "Returns detailed information about a specific user, including\
        \ enriched data (admin status, groups, threat model counts)."
      operationId: getAdminUser
      parameters:
      - name: internal_uuid
        in: path
        description: Internal system UUID of the user
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: User details
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AdminUser"
        "400":
          description: Bad request - Invalid UUID format
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - Invalid or missing authentication token
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: User not found
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
    delete:
      tags:
      - Administration
      summary: Delete user
      description: Deletes a user and all associated data. Transfers sole-owned threat
        models or deletes them if no other owners exist.
      operationId: deleteAdminUser
      parameters:
      - name: internal_uuid
        in: path
        description: Internal system UUID of the user
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "204":
          description: User deleted successfully (no content)
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - Invalid or missing authentication token
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: User not found
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
    patch:
      tags:
      - Administration
      summary: Update user metadata
      description: "Updates user metadata fields (email, name, email_verified). Only\
        \ provided fields are updated."
      operationId: updateAdminUser
      parameters:
      - name: internal_uuid
        in: path
        description: Internal system UUID of the user
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateAdminUserRequest"
        required: true
      responses:
        "200":
          description: User updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AdminUser"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - Invalid or missing authentication token
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: User not found
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
  /admin/groups:
    get:
      tags:
      - Administration
      summary: List groups
      description: "Returns a paginated list of groups with optional filtering by\
        \ provider, name, and usage. Includes enriched data (usage in authorizations\
        \ and admin grants)."
      operationId: listAdminGroups
      parameters:
      - name: provider
        in: query
        description: Filter by OAuth/SAML provider
        required: false
        style: form
        explode: true
        schema:
          maxLength: 256
          type: string
      - name: group_name
        in: query
        description: Filter by group name (case-insensitive substring match)
        required: false
        style: form
        explode: true
        schema:
          type: string
      - name: used_in_authorizations
        in: query
        description: Filter groups used (true) or not used (false) in authorizations
        required: false
        style: form
        explode: true
        schema:
          type: boolean
      - name: limit
        in: query
        description: Maximum number of results to return
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 50
      - name: offset
        in: query
        description: Number of results to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      - name: sort_by
        in: query
        description: Field to sort by
        required: false
        style: form
        explode: true
        schema:
          type: string
          enum:
          - created_at
          - last_login
          - email
          default: created_at
      - name: sort_order
        in: query
        description: Sort direction
        required: false
        style: form
        explode: true
        schema:
          type: string
          enum:
          - asc
          - desc
          default: desc
      responses:
        "200":
          description: Paginated list of groups
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AdminGroupListResponse"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - Invalid or missing authentication token
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
    post:
      tags:
      - Administration
      summary: Create provider-independent group
      description: Creates a new provider-independent group (provider="*"). These
        groups can be used across all providers for authorization and administration.
      operationId: createAdminGroup
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateAdminGroupRequest"
        required: true
      responses:
        "201":
          description: Group created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AdminGroup"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - Invalid or missing authentication token
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "409":
          description: Conflict - Group already exists
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
  /admin/groups/{internal_uuid}:
    get:
      tags:
      - Administration
      summary: Get group details
      description: "Returns detailed information about a specific group, including\
        \ enriched data (usage in authorizations and admin grants)."
      operationId: getAdminGroup
      parameters:
      - name: internal_uuid
        in: path
        description: Internal system UUID of the user
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Group details
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AdminGroup"
        "400":
          description: Bad request - Invalid UUID format
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - Invalid or missing authentication token
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Group not found
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
    delete:
      tags:
      - Administration
      summary: Delete group
      description: Deletes a TMI-managed group and handles threat model cleanup. Protected
        groups like 'everyone' cannot be deleted.
      operationId: deleteAdminGroup
      parameters:
      - name: internal_uuid
        in: path
        description: Internal system UUID of the user
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "204":
          description: Group deleted successfully (no content)
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "400":
          description: Bad Request - Invalid UUID format
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - Invalid or missing authentication token
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Cannot delete protected group or insufficient permissions
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Group not found
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
    patch:
      tags:
      - Administration
      summary: Update group metadata
      description: "Updates group metadata fields (name, description). Only provided\
        \ fields are updated."
      operationId: updateAdminGroup
      parameters:
      - name: internal_uuid
        in: path
        description: Internal system UUID of the user
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateAdminGroupRequest"
        required: true
      responses:
        "200":
          description: Group updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AdminGroup"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - Invalid or missing authentication token
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Group not found
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
  /saml/providers/{idp}/users:
    get:
      tags:
      - SAML
      summary: List SAML users for UI autocomplete
      description: Returns a lightweight list of active users for a specific SAML
        provider. Intended for UI autocomplete/search features. Only accessible to
        users from the same provider.
      operationId: listSAMLUsers
      parameters:
      - name: idp
        in: path
        description: "Identity provider ID (e.g., saml_okta, saml_azure)"
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 100
          pattern: "^[a-zA-Z][a-zA-Z0-9_-]*$"
          type: string
      responses:
        "200":
          description: Success
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                type: object
                x-content-type: application/json
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - Invalid or missing authentication token
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - User is not from the same SAML provider
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-same-provider-required: true
  /admin/groups/{internal_uuid}/members:
    get:
      tags:
      - Administration
      summary: List group members
      description: "Returns a paginated list of users who are members of the specified\
        \ group. Includes user details (email, name, provider information)."
      operationId: listGroupMembers
      parameters:
      - name: internal_uuid
        in: path
        description: Internal system UUID of the user
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: limit
        in: query
        description: Maximum number of results to return
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 50
      - name: offset
        in: query
        description: Number of results to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      responses:
        "200":
          description: Paginated list of group members
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GroupMemberListResponse"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - Invalid or missing authentication token
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Group not found
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
    post:
      tags:
      - Administration
      summary: Add member to group
      description: Adds a user to a group. The user must exist in the system. Cannot
        add members to the special 'everyone' pseudo-group.
      operationId: addGroupMember
      parameters:
      - name: internal_uuid
        in: path
        description: Internal system UUID of the user
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AddGroupMemberRequest"
        required: true
      responses:
        "201":
          description: Member added successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GroupMember"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - Invalid or missing authentication token
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Group or user not found
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "409":
          description: Conflict - User is already a member of this group
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
  /admin/groups/{internal_uuid}/members/{user_uuid}:
    delete:
      tags:
      - Administration
      summary: Remove member from group
      description: Removes a user from a group. Cannot remove members from the special
        'everyone' pseudo-group.
      operationId: removeGroupMember
      parameters:
      - name: internal_uuid
        in: path
        description: Internal system UUID of the user
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      - name: user_uuid
        in: path
        description: Internal system UUID of the user to remove
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "204":
          description: Member removed successfully (no content)
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "400":
          description: Bad request - Invalid UUID format
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - Invalid or missing authentication token
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: "Group, user, or membership not found"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
  /admin/quotas/users:
    get:
      tags:
      - Administration
      summary: List all user API quotas
      description: Retrieves all custom API rate limit quotas (users with non-default
        quotas)
      operationId: listUserAPIQuotas
      parameters:
      - name: limit
        in: query
        description: Maximum number of results to return
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 50
      - name: offset
        in: query
        description: Number of results to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      responses:
        "200":
          description: List of user API quotas
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/UserAPIQuota"
                x-content-type: application/json
        "401":
          description: Unauthorized
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
  /admin/quotas/webhooks:
    get:
      tags:
      - Administration
      summary: List all webhook quotas
      description: Retrieves all custom webhook quotas (users with non-default quotas)
      operationId: listWebhookQuotas
      parameters:
      - name: limit
        in: query
        description: Maximum number of results to return
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 50
      - name: offset
        in: query
        description: Number of results to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      responses:
        "200":
          description: List of webhook quotas
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/WebhookQuota"
                x-content-type: application/json
        "401":
          description: Unauthorized
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
  /admin/quotas/addons:
    get:
      tags:
      - Administration
      summary: List all addon invocation quotas
      description: Retrieves all custom addon invocation quotas (users with non-default
        quotas)
      operationId: listAddonInvocationQuotas
      parameters:
      - name: limit
        in: query
        description: Maximum number of results to return
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 50
      - name: offset
        in: query
        description: Number of results to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      responses:
        "200":
          description: List of addon invocation quotas
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/AddonInvocationQuota"
                x-content-type: application/json
        "401":
          description: Unauthorized
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
  /admin/quotas/addons/{user_id}:
    get:
      tags:
      - Administration
      summary: Get addon invocation quota
      description: Retrieves the addon invocation quota for a specific user
      operationId: getAddonInvocationQuota
      parameters:
      - name: user_id
        in: path
        description: User ID
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: Addon invocation quota
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AddonInvocationQuota"
        "400":
          description: Bad request - Invalid user ID
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
    put:
      tags:
      - Administration
      summary: Update addon invocation quota
      description: Creates or updates the addon invocation quota for a specific user
      operationId: updateAddonInvocationQuota
      parameters:
      - name: user_id
        in: path
        description: User ID
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AddonQuotaUpdate"
        required: true
      responses:
        "200":
          description: Quota updated successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AddonInvocationQuota"
        "201":
          description: Quota created successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AddonInvocationQuota"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
    delete:
      tags:
      - Administration
      summary: Delete addon invocation quota
      description: "Deletes the custom addon invocation quota for a user, reverting\
        \ to system defaults"
      operationId: deleteAddonInvocationQuota
      parameters:
      - name: user_id
        in: path
        description: User ID
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "204":
          description: Quota deleted successfully
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "400":
          description: Bad request - Invalid user ID
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - Insufficient permissions to access this resource
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Quota not found
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
      x-admin-only: true
  /threat_models/{threat_model_id}/diagrams/{diagram_id}/model:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get minimal diagram model for automated analysis
      description: "Returns a minimal representation of the diagram optimized for\
        \ automated threat modeling. Strips all visual styling, layout, and rendering\
        \ properties. Includes threat model context, computed parent-child relationships,\
        \ and flattened metadata. Supports JSON, YAML, and GraphML output formats."
      operationId: getDiagramModel
      parameters:
      - name: threat_model_id
        in: path
        description: Threat model UUID
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Diagram UUID
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          format: uuid
      - name: format
        in: query
        description: Output format for the diagram model (case-insensitive). Defaults
          to json if not specified.
        required: false
        style: form
        explode: true
        schema:
          type: string
          enum:
          - json
          - yaml
          - graphml
          default: json
      responses:
        "200":
          description: Minimal diagram model successfully retrieved in requested format
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MinimalDiagramModel"
            application/x-yaml:
              schema:
                type: string
                description: YAML representation of MinimalDiagramModel
            application/xml:
              schema:
                type: string
                description: GraphML XML representation of diagram model
        "400":
          description: Bad Request - Invalid UUID format or invalid format parameter
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - authentication required
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - insufficient permissions (requires at least reader
            role)
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: "Threat model or diagram not found, or diagram not associated\
            \ with threat model"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: Request limit per window
              style: simple
              explode: false
              schema:
                type: integer
            X-RateLimit-Remaining:
              description: Remaining requests in current window
              style: simple
              explode: false
              schema:
                type: integer
            X-RateLimit-Reset:
              description: Unix timestamp when limit resets
              style: simple
              explode: false
              schema:
                type: integer
            Retry-After:
              description: Seconds until retry allowed
              style: simple
              explode: false
              schema:
                type: integer
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: "Internal server error (e.g., serialization failure)"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
      x-rate-limit:
        scope: user
        tier: resource-operations
        limits:
        - type: requests_per_minute
          default: 100
          configurable: true
          quota_source: user_api_quotas
  /users/me/client_credentials:
    get:
      tags:
      - Authentication
      summary: List client credentials
      description: Retrieves all client credentials owned by the authenticated user.
        Secrets are never returned.
      operationId: listCurrentUserClientCredentials
      responses:
        "200":
          description: Success
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ClientCredentialInfo"
                x-content-type: application/json
        "401":
          description: Unauthorized - missing or invalid JWT token
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
    post:
      tags:
      - Authentication
      summary: Create client credential
      description: Creates a new OAuth 2.0 client credential for machine-to-machine
        authentication. The client_secret is ONLY returned once at creation and cannot
        be retrieved later.
      operationId: createCurrentUserClientCredential
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/me_client_credentials_body"
        required: true
      responses:
        "201":
          description: Created - Resource successfully created
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ClientCredentialResponse"
        "400":
          description: "Bad Request - Invalid parameters, malformed UUIDs, or validation\
            \ failures"
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - missing or invalid JWT token
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - quota exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
  /users/me/client_credentials/{id}:
    delete:
      tags:
      - Authentication
      summary: Delete client credential
      description: Permanently deletes a client credential. All tokens issued with
        this credential will immediately become invalid.
      operationId: deleteCurrentUserClientCredential
      parameters:
      - name: id
        in: path
        description: Administrator grant ID
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      responses:
        "204":
          description: No Content - Resource successfully deleted
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
        "400":
          description: Invalid credential ID format
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - missing or invalid JWT token
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Client credential not found or not owned by user
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix timestamp)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1640995200
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_500"
              example:
                error: An internal server error occurred
                request_id: 550e8400-e29b-41d4-a716-446655440000
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              description: The maximum number of requests allowed in the current time
                window
              style: simple
              explode: false
              schema:
                type: integer
                example: 1000
            X-RateLimit-Remaining:
              description: The number of requests remaining in the current time window
              style: simple
              explode: false
              schema:
                type: integer
                example: 999
            X-RateLimit-Reset:
              description: The time at which the current rate limit window resets
                (Unix epoch seconds)
              style: simple
              explode: false
              schema:
                type: integer
                example: 1735689600
            Retry-After:
              description: Number of seconds until the rate limit resets
              style: simple
              explode: false
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_429"
              example:
                error: Rate limit exceeded. Please try again later.
                retry_after: 60
      security:
      - bearerAuth: []
components:
  schemas:
    ApiInfo:
      required:
      - api
      - operator
      - service
      - status
      type: object
      properties:
        status:
          $ref: "#/components/schemas/ApiInfo_status"
        service:
          $ref: "#/components/schemas/ApiInfo_service"
        api:
          $ref: "#/components/schemas/ApiInfo_api"
        operator:
          $ref: "#/components/schemas/ApiInfo_operator"
      additionalProperties: false
      description: API information response for the root endpoint
      example:
        status:
          code: OK
          time: 2025-04-09T12:00:00Z
        service:
          name: TMI
          build: 1.0.0-386eea0
        api:
          version: 1.0.0
          specification: https://github.com/ericfitz/tmi/blob/main/docs/reference/apis/tmi-openapi.json
        operator:
          name: Example Organization
          contact: api-support@example.com
    OAuthProtectedResourceMetadata:
      required:
      - resource
      type: object
      properties:
        resource:
          maxLength: 1000
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          description: The protected resource's resource identifier URL
          format: uri
          example: http://localhost:8080
        scopes_supported:
          maxItems: 100
          type: array
          description: JSON array of OAuth scope values supported by this protected
            resource
          example:
          - openid
          - email
          - profile
          items:
            maxLength: 64
            pattern: "^[\\x21\\x23-\\x5B\\x5D-\\x7E]*$"
            type: string
            description: OAuth 2.0 scope token (RFC 6749 Section 3.3 - printable ASCII
              excluding whitespace and double-quote)
        authorization_servers:
          maxItems: 100
          type: array
          description: List of authorization server issuer identifiers that can issue
            tokens for this resource
          example:
          - http://localhost:8080
          items:
            maxLength: 1000
            pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
              .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\\
              s]*)?\\s*$"
            type: string
            format: uri
        jwks_url:
          maxLength: 1024
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          description: URL of the protected resource's JSON Web Key Set
          format: uri
          example: http://localhost:8080/.well-known/jwks.json
        bearer_methods_supported:
          maxItems: 100
          type: array
          description: Supported token presentation methods for bearer tokens
          example:
          - header
          - body
          - query
          items:
            maxLength: 1000
            type: string
            description: OAuth 2.0 bearer token transmission method (RFC 6750)
            enum:
            - header
            - body
            - query
        resource_name:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Human-readable name of the protected resource
          example: TMI (Threat Modeling Improved) API
        resource_documentation:
          maxLength: 1000
          pattern: "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$"
          type: string
          description: URL with information for developers on how to use this protected
            resource
          format: uri
          example: https://github.com/ericfitz/tmi
        tls_client_certificate_bound_access_tokens:
          type: boolean
          description: Whether the protected resource supports TLS client certificate
            bound access tokens
          example: false
      additionalProperties: false
      description: OAuth 2.0 protected resource metadata as defined in RFC 9728
      example:
        resource: http://localhost:8080
        scopes_supported:
        - openid
        - email
        - profile
        authorization_servers:
        - http://localhost:8080
        jwks_url: http://localhost:8080/.well-known/jwks.json
        bearer_methods_supported:
        - header
        resource_name: TMI (Threat Modeling Improved) API
        resource_documentation: https://github.com/ericfitz/tmi
        tls_client_certificate_bound_access_tokens: false
    Document:
      description: Complete Document schema with server-generated fields
      example:
        id: 567e89ab-e89b-41d4-a716-446655440004
        threat_model_id: 123e4567-e89b-41d4-a716-446655440000
        name: Security Architecture Review
        description: Q1 2024 security review findings
        content: |-
          # Security Review

          Key findings from architecture review...
        format: markdown
        metadata:
        - key: reviewer
          value: Security Team
        created_at: 2024-01-17T14:00:00Z
        modified_at: 2024-01-17T14:00:00Z
      allOf:
      - $ref: "#/components/schemas/DocumentBase"
      - required:
        - id
        type: object
        properties:
          id:
            maxLength: 36
            pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
            type: string
            description: Unique identifier for the document
            format: uuid
            readOnly: true
          metadata:
            maxItems: 100
            type: array
            description: Optional metadata key-value pairs
            readOnly: true
            items:
              $ref: "#/components/schemas/Metadata"
          created_at:
            maxLength: 24
            pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
            type: string
            description: Creation timestamp (RFC3339)
            format: date-time
            readOnly: true
          modified_at:
            maxLength: 24
            pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
            type: string
            description: Last modification timestamp (RFC3339)
            format: date-time
            readOnly: true
    BaseDiagram:
      required:
      - created_at
      - id
      - modified_at
      - name
      - type
      type: object
      properties:
        id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          type: string
          description: Unique identifier for the diagram (UUID)
          format: uuid
          readOnly: true
        name:
          maxLength: 256
          minLength: 1
          pattern: "^[^<>\"'&]*$"
          type: string
          description: Name of the diagram
        type:
          maxLength: 64
          type: string
          description: Type of diagram with version
          enum:
          - DFD-1.0.0
        created_at:
          maxLength: 36
          pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          type: string
          description: Creation timestamp (ISO3339)
          format: date-time
          readOnly: true
        modified_at:
          maxLength: 36
          pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          type: string
          description: Last modification timestamp (ISO3339)
          format: date-time
          readOnly: true
        metadata:
          maxItems: 10000
          type: array
          description: Key-value pairs for additional diagram metadata
          nullable: true
          items:
            $ref: "#/components/schemas/Metadata"
        update_vector:
          minimum: 0
          type: integer
          description: "Server-managed monotonic version counter, incremented on each\
            \ diagram update"
          format: int64
          readOnly: true
        image:
          $ref: "#/components/schemas/BaseDiagram_image"
        description:
          maxLength: 1024
          pattern: "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          type: string
          description: Optional description of the diagram
          nullable: true
      additionalProperties: false
      description: Base diagram object with common properties - used for API responses
      example:
        id: 550e8400-e29b-41d4-a716-446655440000
        type: DFD-1.0.0
        name: System Architecture
        description: High-level system architecture diagram
        created_at: 2024-01-15T10:00:00Z
        modified_at: 2024-01-15T10:00:00Z
      discriminator:
        propertyName: type
        mapping:
          DFD-1.0.0: "#/components/schemas/DfdDiagram"
    BaseDiagramInput:
      required:
      - name
      - type
      type: object
      properties:
        name:
          maxLength: 256
          minLength: 1
          pattern: "^[^<>\"'&]*$"
          type: string
          description: Name of the diagram
        type:
          maxLength: 64
          type: string
          description: Type of diagram with version
          enum:
          - DFD-1.0.0
        metadata:
          maxItems: 10000
          type: array
          description: Key-value pairs for additional diagram metadata
          nullable: true
          items:
            $ref: "#/components/schemas/Metadata"
        image:
          $ref: "#/components/schemas/BaseDiagram_image"
        description:
          maxLength: 1024
          pattern: "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          type: string
          description: Optional description of the diagram
          nullable: true
      additionalProperties: false
      description: Base diagram input for PUT/PATCH requests - excludes readOnly server-managed
        fields
      example:
        type: DFD-1.0.0
        name: New Architecture Diagram
        description: Draft architecture for microservices migration
      discriminator:
        propertyName: type
        mapping:
          DFD-1.0.0: "#/components/schemas/DfdDiagramInput"
    DfdDiagram:
      example:
        name: Payment Data Flow
        description: Data flow through payment processing
        diagram_type: dfd
        version: 2
        model:
          cells: []
      allOf:
      - $ref: "#/components/schemas/BaseDiagram"
      - required:
        - cells
        type: object
        properties:
          type:
            maxLength: 1000
            type: string
            description: DFD diagram type with version
            enum:
            - DFD-1.0.0
          cells:
            maxItems: 10000
            type: array
            description: List of diagram cells (nodes and edges) following X6 structure
            items:
              discriminator:
                propertyName: shape
                mapping:
                  actor: "#/components/schemas/Node"
                  process: "#/components/schemas/Node"
                  store: "#/components/schemas/Node"
                  security-boundary: "#/components/schemas/Node"
                  text-box: "#/components/schemas/Node"
                  edge: "#/components/schemas/Edge"
              oneOf:
              - $ref: "#/components/schemas/Node"
              - $ref: "#/components/schemas/Edge"
        additionalProperties: false
        description: Data Flow Diagram (DFD) with cells - API response schema
      x-discriminator-value: DFD-1.0.0
    DfdDiagramInput:
      example:
        name: Authentication Flow
        description: User authentication data flow
        diagram_type: dfd
        model:
          cells: []
      allOf:
      - $ref: "#/components/schemas/BaseDiagramInput"
      - required:
        - cells
        type: object
        properties:
          type:
            maxLength: 1000
            type: string
            description: DFD diagram type with version
            enum:
            - DFD-1.0.0
          cells:
            maxItems: 10000
            type: array
            description: List of diagram cells (nodes and edges) following X6 structure
            items:
              discriminator:
                propertyName: shape
                mapping:
                  actor: "#/components/schemas/Node"
                  process: "#/components/schemas/Node"
                  store: "#/components/schemas/Node"
                  security-boundary: "#/components/schemas/Node"
                  text-box: "#/components/schemas/Node"
                  edge: "#/components/schemas/Edge"
              oneOf:
              - $ref: "#/components/schemas/Node"
              - $ref: "#/components/schemas/Edge"
        additionalProperties: false
        description: Data Flow Diagram (DFD) input for PUT requests - excludes readOnly
          fields
      x-discriminator-value: DFD-1.0.0
    CreateDiagramRequest:
      required:
      - name
      - type
      type: object
      properties:
        name:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Name of the diagram
        type:
          maxLength: 64
          type: string
          description: Type of diagram with version
          enum:
          - DFD-1.0.0
      additionalProperties: false
      description: Request body for creating a new diagram - only includes client-provided
        fields
      example:
        name: Payment Flow Data Flow Diagram
        type: DFD-1.0.0
    Diagram:
      description: "DEPRECATED: Empty wrapper schema for polymorphic diagram types.\
        \ Use DfdDiagram directly instead. This schema is kept for backward compatibility\
        \ but generates empty classes in client libraries."
      example:
        id: 234e5678-e89b-41d4-a716-446655440001
        threat_model_id: 123e4567-e89b-41d4-a716-446655440000
        name: Payment Flow Architecture
        description: Data flow diagram showing payment processing
        diagram_type: dfd
        version: 3
        model:
          cells: []
        created_at: 2024-01-15T10:35:00Z
        modified_at: 2024-01-20T16:00:00Z
      deprecated: true
      discriminator:
        propertyName: type
        mapping:
          DFD-1.0.0: "#/components/schemas/DfdDiagram"
      oneOf:
      - $ref: "#/components/schemas/DfdDiagram"
    Cell:
      required:
      - id
      - shape
      type: object
      properties:
        id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          type: string
          description: Unique identifier of the cell (UUID)
          format: uuid
          example: 37eaedfa-bf37-4996-8665-242fec34bbff
        shape:
          maxLength: 64
          pattern: "^[a-z][a-z0-9-]*$"
          type: string
          description: Shape type identifier that determines cell structure and behavior
          example: process
        zIndex:
          minimum: 0
          type: number
          description: Z-order layer for rendering (higher values render on top)
          default: 1
        visible:
          type: boolean
          description: Whether the cell is visible in the diagram
          default: true
        data:
          $ref: "#/components/schemas/Cell_data"
        markup:
          maxItems: 1000
          type: array
          description: SVG/HTML markup definition for custom shape rendering in X6
          items:
            $ref: "#/components/schemas/MarkupElement"
      additionalProperties: false
      description: "Base schema for all diagram cells (nodes and edges) in AntV X6\
        \ native format. This schema matches X6's toJSON() output exactly, enabling\
        \ zero-transformation persistence. X6-specific properties like markup, tools,\
        \ router, and connector are fully supported."
      example:
        id: f60eabcd-e89b-41d4-a716-446655440015
        shape: process
      discriminator:
        propertyName: shape
    Node:
      example:
        id: m30eabcd-e89b-41d4-a716-446655440022
        shape: process
        position:
          x: 150
          "y": 250
        size:
          width: 140
          height: 70
        attrs:
          label:
            text: Database Service
          body:
            fill: "#e3f2fd"
        ports:
          items: []
      allOf:
      - $ref: "#/components/schemas/Cell"
      - type: object
        properties:
          shape:
            maxLength: 1000
            type: string
            description: Node type determining its visual representation and behavior
            enum:
            - actor
            - process
            - store
            - security-boundary
            - text-box
          position:
            $ref: "#/components/schemas/Node_position"
          size:
            $ref: "#/components/schemas/Node_size"
          angle:
            type: number
            description: Rotation angle in degrees
            default: 0
          attrs:
            description: Visual styling attributes for the node
            allOf:
            - $ref: "#/components/schemas/NodeAttrs"
          ports:
            description: Port configuration for connections
            allOf:
            - $ref: "#/components/schemas/PortConfiguration"
          parent:
            maxLength: 36
            pattern: "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            type: string
            description: ID of the parent cell for nested/grouped nodes (UUID)
            format: uuid
            nullable: true
          x:
            type: number
            description: "X coordinate (flat format). Use either this with y, width,\
              \ height OR use position/size objects."
          "y":
            type: number
            description: Y coordinate (flat format)
          width:
            minimum: 40
            type: number
            description: Width in pixels (flat format)
          height:
            minimum: 30
            type: number
            description: Height in pixels (flat format)
        additionalProperties: false
        description: "A diagram node representing an entity, process, store, or boundary.\
          \ Supports both X6 position/size object format and flat x/y/width/height\
          \ format. Input accepts either format. Output always uses flat format (x,\
          \ y, width, height)."
    Edge:
      example:
        id: i90eabcd-e89b-41d4-a716-446655440018
        shape: edge
        source:
          cell: f60eabcd-e89b-41d4-a716-446655440015
        target:
          cell: j00eabcd-e89b-41d4-a716-446655440019
        labels:
        - attrs:
            text:
              text: HTTPS Request
      allOf:
      - $ref: "#/components/schemas/Cell"
      - required:
        - source
        - target
        type: object
        properties:
          shape:
            maxLength: 1000
            type: string
            description: Edge type identifier
            enum:
            - edge
          source:
            description: Source connection point
            allOf:
            - $ref: "#/components/schemas/EdgeTerminal"
          target:
            description: Target connection point
            allOf:
            - $ref: "#/components/schemas/EdgeTerminal"
          attrs:
            description: Visual styling attributes for the edge
            allOf:
            - $ref: "#/components/schemas/EdgeAttrs"
          labels:
            maxItems: 1000
            type: array
            description: Text labels positioned along the edge
            items:
              $ref: "#/components/schemas/EdgeLabel"
          vertices:
            maxItems: 1000
            type: array
            description: Intermediate waypoints for edge routing
            items:
              $ref: "#/components/schemas/Point"
          router:
            description: Edge routing algorithm configuration for path calculation
            allOf:
            - $ref: "#/components/schemas/EdgeRouter"
          connector:
            description: Edge connector style configuration for visual appearance
            allOf:
            - $ref: "#/components/schemas/EdgeConnector"
          defaultLabel:
            description: Default label configuration applied to edges without explicit
              labels
            allOf:
            - $ref: "#/components/schemas/EdgeLabel"
        additionalProperties: false
        description: "A diagram edge representing a connection or data flow between\
          \ nodes. Fully compatible with X6 Edge objects and supports X6 routing algorithms\
          \ (manhattan, orth, oneSide, metro, er), connector styles (normal, rounded,\
          \ smooth, jumpover), custom markup, tools, and convenience properties (label,\
          \ style) for easier integration."
    ThreatModel:
      example:
        id: 123e4567-e89b-41d4-a716-446655440000
        name: E-commerce Platform Threat Model
        description: Threat analysis for the payment processing subsystem
        owner:
          user_id: 550e8400-e29b-41d4-a716-446655440000
          email: alice@example.com
          name: Alice Johnson
          provider: github
        threat_model_framework: STRIDE
        authorization:
        - user_id: 660e8400-e29b-41d4-a716-446655440001
          email: bob@example.com
          name: Bob Smith
          role: reader
        metadata:
        - key: project
          value: Payment Gateway v2
        issue_uri: https://github.com/example/repo/issues/123
        status: In progress
        created_at: 2024-01-15T10:30:00Z
        modified_at: 2024-01-20T15:45:00Z
      allOf:
      - $ref: "#/components/schemas/ThreatModelBase"
      - type: object
        properties:
          id:
            maxLength: 36
            pattern: "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            type: string
            description: Unique identifier for the threat model (UUID)
            format: uuid
            readOnly: true
          created_at:
            maxLength: 24
            pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
            type: string
            description: Creation timestamp (RFC3339)
            format: date-time
            readOnly: true
          modified_at:
            maxLength: 24
            pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
            type: string
            description: Last modification timestamp (RFC3339)
            format: date-time
            readOnly: true
          created_by:
            description: User who created the threat model
            readOnly: true
            allOf:
            - $ref: "#/components/schemas/User"
          documents:
            maxItems: 1000
            type: array
            description: List of documents related to the threat model
            readOnly: true
            items:
              $ref: "#/components/schemas/Document"
          repositories:
            maxItems: 1000
            type: array
            description: List of source code repositories related to the threat model
            readOnly: true
            items:
              $ref: "#/components/schemas/Repository"
          diagrams:
            maxItems: 10000
            type: array
            description: List of diagram objects associated with this threat model
            readOnly: true
            items:
              $ref: "#/components/schemas/Diagram"
          threats:
            maxItems: 1000
            type: array
            description: List of threats within the threat model
            readOnly: true
            items:
              $ref: "#/components/schemas/Threat"
          notes:
            maxItems: 1000
            type: array
            description: List of notes associated with the threat model
            readOnly: true
            items:
              $ref: "#/components/schemas/Note"
          assets:
            maxItems: 1000
            type: array
            description: List of assets associated with the threat model
            readOnly: true
            items:
              $ref: "#/components/schemas/ExtendedAsset"
          status_updated:
            maxLength: 24
            pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
            type: string
            description: Timestamp when the status field was last modified (RFC3339).
              Automatically updated by the server when status changes.
            format: date-time
            nullable: true
            readOnly: true
        description: Complete ThreatModel with server-generated fields
    Threat:
      example:
        id: 345e6789-e89b-41d4-a716-446655440002
        threat_model_id: 123e4567-e89b-41d4-a716-446655440000
        name: SQL Injection in Payment Query
        description: Unsanitized input in payment lookup query could allow SQL injection
        severity: High
        stride_category: Tampering
        status: Open
        metadata:
        - key: cwe
          value: CWE-89
        created_at: 2024-01-16T09:00:00Z
        modified_at: 2024-01-16T09:00:00Z
      allOf:
      - $ref: "#/components/schemas/ThreatBase"
      - type: object
        properties:
          id:
            maxLength: 36
            pattern: "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            type: string
            description: Unique identifier for the threat (UUID)
            format: uuid
            readOnly: true
          threat_model_id:
            maxLength: 36
            pattern: "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            type: string
            description: Unique identifier of the parent threat model (UUID)
            format: uuid
            readOnly: true
          created_at:
            maxLength: 24
            pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
            type: string
            description: Creation timestamp (RFC3339)
            format: date-time
            readOnly: true
          modified_at:
            maxLength: 24
            pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
            type: string
            description: Last modification timestamp (RFC3339)
            format: date-time
            readOnly: true
        description: Complete Threat with server-generated fields
    Authorization:
      example:
        user_id: 550e8400-e29b-41d4-a716-446655440000
        email: bob@example.com
        name: Bob Smith
        role: writer
      allOf:
      - $ref: "#/components/schemas/Principal"
      - required:
        - role
        type: object
        properties:
          role:
            maxLength: 6
            type: string
            description: "Role: reader (view), writer (edit), owner (full control)"
            enum:
            - reader
            - writer
            - owner
            x-oapi-codegen-extra-tags:
              binding: required
        description: Authorization entry with principal identity and role
    Metadata:
      required:
      - key
      - value
      type: object
      properties:
        key:
          maxLength: 256
          minLength: 1
          pattern: "^[a-zA-Z0-9_./:-]+$"
          type: string
          description: Metadata key
          x-oapi-codegen-extra-tags:
            binding: required
        value:
          maxLength: 1024
          minLength: 1
          pattern: "^[^<>]*$"
          type: string
          description: Metadata value
          x-oapi-codegen-extra-tags:
            binding: required
      additionalProperties: false
      description: A key-value pair for extensible metadata
      example:
        key: environment
        value: production
    Error:
      required:
      - error
      - error_description
      type: object
      properties:
        error:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Error code
        error_description:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Human-readable error description
        error_uri:
          maxLength: 1000
          pattern: "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$"
          type: string
          description: URI to documentation about the error
          format: uri
        details:
          $ref: "#/components/schemas/Error_details"
      additionalProperties: false
      description: Standard error response format
      example:
        error: invalid_request
        error_description: The request is missing a required parameter
        error_uri: https://docs.example.com/oauth2/errors/invalid_request
    AuthTokenResponse:
      required:
      - access_token
      - expires_in
      - refresh_token
      - token_type
      type: object
      properties:
        access_token:
          maxLength: 4096
          pattern: "^[a-zA-Z0-9_.-]*$"
          type: string
          description: JWT access token
        refresh_token:
          maxLength: 1024
          pattern: "^[a-zA-Z0-9_.-]*$"
          type: string
          description: Refresh token for obtaining new access tokens
        token_type:
          maxLength: 1000
          type: string
          description: Token type
          enum:
          - Bearer
        expires_in:
          type: integer
          description: Access token expiration time in seconds
      additionalProperties: false
      description: JWT token response for authentication endpoints
      example:
        access_token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        refresh_token: def456...
        token_type: Bearer
        expires_in: 3600
    CollaborationSession:
      required:
      - diagram_id
      - diagram_name
      - host
      - participants
      - session_id
      - threat_model_id
      - threat_model_name
      - websocket_url
      type: object
      properties:
        session_id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          type: string
          description: Unique identifier for the session (UUID)
          format: uuid
          readOnly: true
        host:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Email address of the session host
          readOnly: true
        presenter:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Email address of the current presenter
          readOnly: true
        threat_model_id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          type: string
          description: Unique identifier of the associated threat model (UUID)
          format: uuid
        threat_model_name:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Name of the associated threat model
        diagram_id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          type: string
          description: Unique identifier of the associated diagram (UUID)
          format: uuid
        diagram_name:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Name of the associated diagram
        participants:
          maxItems: 1000
          type: array
          description: List of active participants
          items:
            $ref: "#/components/schemas/Participant"
        websocket_url:
          maxLength: 1024
          pattern: "^\\s*wss?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          description: WebSocket URL for real-time updates
      additionalProperties: false
      description: Details of an active collaboration session for a diagram
      example:
        session_id: D7744D3A-ED22-40AF-862B-29786CAD0007
        host: admin@example.com
        threat_model_id: 5311D207-AFD5-4A1A-BA83-14C1445DC257
        threat_model_name: E-commerce Platform Security Analysis
        diagram_id: DFF7F4A9-CBCE-4001-9198-2706C86F7EF3
        diagram_name: User Authentication Flow
        participants:
        - user:
            principal_type: user
            provider: test
            provider_id: admin@example.com
            email: admin@example.com
            display_name: Admin User
          last_activity: 2025-04-06T12:02:00Z
          permissions: writer
        websocket_url: wss://api.example.com/threat_models/5311D207-AFD5-4A1A-BA83-14C1445DC257/diagrams/DFF7F4A9-CBCE-4001-9198-2706C86F7EF3/ws
    DiagramListItem:
      required:
      - id
      - name
      - type
      type: object
      properties:
        id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          type: string
          description: Unique identifier of the diagram (UUID)
          format: uuid
          readOnly: true
        name:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Name of the diagram
        type:
          maxLength: 1000
          type: string
          description: Type of the diagram
          enum:
          - DFD-1.0.0
      additionalProperties: false
      description: "Summary diagram object for GET /diagrams list endpoints. Excludes\
        \ large fields (cells, image) for performance. Full diagram details available\
        \ via GET /diagrams/{id} which returns DfdDiagram."
      example:
        id: 880e8400-e29b-41d4-a716-446655440003
        name: Payment Flow Data Flow Diagram
        type: DFD-1.0.0
    TMListItem:
      required:
      - asset_count
      - created_at
      - created_by
      - diagram_count
      - document_count
      - id
      - modified_at
      - name
      - note_count
      - owner
      - repo_count
      - threat_count
      - threat_model_framework
      type: object
      properties:
        id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          type: string
          description: Unique identifier of the threat model (UUID)
          format: uuid
          readOnly: true
        name:
          maxLength: 256
          minLength: 1
          pattern: "^[^<>\"'&]*$"
          type: string
          description: Name of the threat model
        description:
          maxLength: 1024
          pattern: "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          type: string
          description: Description of the threat model
        created_at:
          maxLength: 24
          pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          type: string
          description: Creation timestamp (RFC3339)
          format: date-time
        modified_at:
          maxLength: 24
          pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          type: string
          description: Last modification timestamp (RFC3339)
          format: date-time
        owner:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Email address of the current owner
        created_by:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: "Email address, name or identifier of the creator"
        threat_model_framework:
          maxLength: 30
          pattern: "^[A-Za-z0-9_-]*$"
          type: string
          description: The framework used for this threat model
        document_count:
          minimum: 0
          type: integer
          description: Number of documents associated with this threat model
        repo_count:
          minimum: 0
          type: integer
          description: Number of source code repository entries associated with this
            threat model
        diagram_count:
          minimum: 0
          type: integer
          description: Number of diagrams associated with this threat model
        threat_count:
          minimum: 0
          type: integer
          description: Number of threats defined in this threat model
        issue_uri:
          maxLength: 1000
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          description: URL to an issue in an issue tracking system
          format: uri
        asset_count:
          minimum: 0
          type: integer
          description: Number of assets associated with this threat model
        note_count:
          minimum: 0
          type: integer
          description: Number of notes associated with this threat model
        status:
          maxLength: 128
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: "Status of the threat model in the organization's threat modeling\
            \ or SDLC process. Examples: \"Not started\", \"In progress\", \"Review\"\
            , \"Approved\", \"Closed\""
          nullable: true
        status_updated:
          maxLength: 24
          pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          type: string
          description: Timestamp when the status field was last modified (RFC3339).
            Automatically updated by the server when status changes.
          format: date-time
          nullable: true
          readOnly: true
      additionalProperties: false
      description: Enhanced item for threat model list endpoints with key metadata
        and counts
      example:
        id: 660e8400-e29b-41d4-a716-446655440001
        name: Payment Gateway Threat Model
        owner: alice@example.com
        created_by: alice@example.com
        threat_model_framework: STRIDE
        created_at: 2024-01-15T10:30:00Z
        modified_at: 2024-01-20T15:45:30Z
        document_count: 3
        repo_count: 2
        diagram_count: 1
        threat_count: 5
        asset_count: 4
        note_count: 2
    Point:
      required:
      - x
      - "y"
      type: object
      properties:
        x:
          type: number
          description: X coordinate
        "y":
          type: number
          description: Y coordinate
      additionalProperties: false
      description: A 2D point with x and y coordinates
      example:
        x: 100
        "y": 200
    EdgeTerminal:
      required:
      - cell
      type: object
      properties:
        cell:
          maxLength: 36
          pattern: "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          type: string
          description: ID of the connected node (UUID)
          format: uuid
        port:
          maxLength: 64
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: ID of the specific port on the node (optional)
          nullable: true
      additionalProperties: false
      description: Connection point for an edge (source or target)
      example:
        cell: 233598D2-8C6D-4A73-AFE1-647081C4F7AA
        port: port_out_1
    NodeAttrs:
      type: object
      properties:
        body:
          $ref: "#/components/schemas/NodeAttrs_body"
        text:
          $ref: "#/components/schemas/NodeAttrs_text"
      additionalProperties: false
      description: Visual attributes for a node
      example:
        body:
          fill: "#e0e0e0"
        text:
          fill: "#333333"
    EdgeAttrs:
      type: object
      properties:
        line:
          $ref: "#/components/schemas/EdgeAttrs_line"
      additionalProperties: false
      description: Visual attributes for an edge
      example:
        line:
          stroke: "#666666"
          strokeWidth: 2
    EdgeLabel:
      type: object
      properties:
        attrs:
          $ref: "#/components/schemas/EdgeLabel_attrs"
        position:
          oneOf:
          - type: number
            description: "Simple position: 0-1 for percentage, >1 for pixels from\
              \ start, <0 for pixels from end"
          - required:
            - distance
            type: object
            properties:
              distance:
                type: number
                description: "Position along the edge: 0-1 for percentage, >1 for\
                  \ pixels from start, <0 for pixels from end"
              offset:
                oneOf:
                - type: number
                  description: "Perpendicular offset from edge (positive = down/right,\
                    \ negative = up/left)"
                - type: object
                  properties:
                    x:
                      type: number
                    "y":
                      type: number
                  additionalProperties: false
                  description: "Absolute x,y offset"
              angle:
                type: number
                description: Rotation angle in degrees (clockwise)
              options:
                type: object
                properties:
                  absoluteDistance:
                    type: boolean
                    description: Forces absolute coordinates for distance
                  reverseDistance:
                    type: boolean
                    description: Forces reverse absolute coordinates
                  absoluteOffset:
                    type: boolean
                    description: Forces absolute coordinates for offset
                  keepGradient:
                    type: boolean
                    description: Auto-adjusts angle to match path gradient
                  ensureLegibility:
                    type: boolean
                    description: Rotates labels to avoid upside-down text
                additionalProperties: false
                description: Advanced positioning options
            additionalProperties: false
            description: Advanced position with offset and angle (X6 LabelPositionObject
              format)
      additionalProperties: false
      description: Label positioned along an edge
      example:
        attrs:
          text:
            text: Data Flow
            fontSize: 12
            fill: "#333333"
        position: 0.5
    PortConfiguration:
      type: object
      properties:
        groups:
          type: object
          additionalProperties:
            $ref: "#/components/schemas/PortConfiguration_groups"
          description: Port group definitions
        items:
          maxItems: 1000
          type: array
          description: Individual port instances
          items:
            $ref: "#/components/schemas/PortConfiguration_items"
      additionalProperties: false
      description: Port configuration for node connections
      example:
        groups:
          in:
            position: left
          out:
            position: right
        items:
        - group: in
          id: port-in-1
        - group: out
          id: port-out-1
    MarkupElement:
      required:
      - tagName
      type: object
      properties:
        tagName:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: "SVG or HTML tag name (e.g., 'rect', 'circle', 'path', 'text')"
          example: rect
        selector:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: CSS selector for targeting this element in styling
          example: body
        attrs:
          type: object
          additionalProperties: true
          description: Element attributes and styling properties
          example:
            fill: "#ffffff"
            stroke: "#000000"
            stroke-width: 2
        children:
          maxItems: 1000
          type: array
          description: Nested child elements
          items:
            $ref: "#/components/schemas/MarkupElement"
      additionalProperties: false
      description: SVG/HTML markup element for custom shape definitions in X6
      example:
        tagName: text
        selector: label
    EdgeRouter:
      description: Edge routing algorithm configuration for pathfinding
      example:
        name: manhattan
      oneOf:
      - maxLength: 1000
        type: string
        description: Built-in router name
        enum:
        - normal
        - orth
        - oneSide
        - manhattan
        - metro
        - er
      - required:
        - name
        type: object
        properties:
          name:
            maxLength: 256
            pattern: "^[\\u0020-\\uFFFF]*$"
            type: string
            description: Router algorithm name
            enum:
            - normal
            - orth
            - oneSide
            - manhattan
            - metro
            - er
          args:
            $ref: "#/components/schemas/EdgeRouter_args"
        additionalProperties: false
        description: Router with custom configuration
    EdgeConnector:
      description: Edge connector style configuration for visual appearance
      example:
        name: normal
      oneOf:
      - maxLength: 1000
        type: string
        description: Built-in connector name
        enum:
        - normal
        - rounded
        - smooth
        - jumpover
      - required:
        - name
        type: object
        properties:
          name:
            maxLength: 256
            pattern: "^[\\u0020-\\uFFFF]*$"
            type: string
            description: Connector style name
            enum:
            - normal
            - rounded
            - smooth
            - jumpover
          args:
            $ref: "#/components/schemas/EdgeConnector_args"
        additionalProperties: false
        description: Connector with custom configuration
    ThreatModelBase:
      required:
      - authorization
      - name
      - owner
      - threat_model_framework
      type: object
      properties:
        name:
          maxLength: 256
          minLength: 1
          pattern: "^[^<>\"'&]*$"
          type: string
          description: Name of the threat model
          x-oapi-codegen-extra-tags:
            binding: required
        description:
          maxLength: 1024
          pattern: "^[^<>]*$"
          type: string
          description: Description of the threat model
        owner:
          description: User who owns the threat model (can be null for orphaned models)
          allOf:
          - $ref: "#/components/schemas/User"
        threat_model_framework:
          maxLength: 30
          pattern: "^[A-Za-z0-9_-]*$"
          type: string
          description: The framework used for this threat model
        authorization:
          maxItems: 1000
          type: array
          description: List of users and their roles for this threat model
          items:
            $ref: "#/components/schemas/Authorization"
        metadata:
          maxItems: 100
          type: array
          description: Key-value pairs for additional threat model metadata
          nullable: true
          items:
            $ref: "#/components/schemas/Metadata"
        issue_uri:
          maxLength: 1000
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          description: URL to an issue in an issue tracking system for this threat
            model
          format: uri
        status:
          maxLength: 128
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: "Status of the threat model in the organization's threat modeling\
            \ or SDLC process. Examples: \"Not started\", \"In progress\", \"Review\"\
            , \"Approved\", \"Closed\""
          nullable: true
      additionalProperties: false
      description: Base schema for ThreatModel with client-writable fields
      example:
        name: Payment Gateway Threat Model
        owner:
          principal_type: user
          provider: github
          provider_id: alice@example.com
          display_name: Alice Johnson
          email: alice@example.com
        description: Threat analysis for payment processing
        threat_model_framework: STRIDE
        authorization:
        - principal_type: user
          provider: test
          provider_id: alice@example.com
          display_name: Alice Anderson
          email: alice@example.com
          role: owner
    ThreatModelInput:
      required:
      - name
      type: object
      properties:
        name:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Name of the threat model
        description:
          maxLength: 1024
          pattern: "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          type: string
          description: Description of the threat model and its purpose
          nullable: true
        threat_model_framework:
          maxLength: 30
          pattern: "^[A-Za-z0-9_-]*$"
          type: string
          description: The framework used for this threat model
        authorization:
          maxItems: 1000
          type: array
          description: List of users and their roles for this threat model
          items:
            $ref: "#/components/schemas/Authorization"
        metadata:
          maxItems: 100
          type: array
          description: Key-value pairs for additional threat model metadata
          nullable: true
          items:
            $ref: "#/components/schemas/Metadata"
        issue_uri:
          maxLength: 1000
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          description: URL to an issue in an issue tracking system for this threat
            model
          format: uri
          nullable: true
      additionalProperties: false
      description: Input schema for creating/updating ThreatModel
      example:
        name: Payment Gateway Threat Model
        description: Threat analysis for the payment processing system
        threat_model_framework: STRIDE
        metadata:
        - key: project
          value: payment-service
        - key: version
          value: "2.0"
        issue_uri: https://github.com/example/project/issues/123
    ThreatBase:
      required:
      - name
      - threat_type
      type: object
      properties:
        name:
          maxLength: 256
          minLength: 1
          pattern: "^[^<>\"'&]*$"
          type: string
          description: Name of the threat
        description:
          maxLength: 1024
          pattern: "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          type: string
          description: Description of the threat and risk to the organization
        mitigation:
          maxLength: 1024
          pattern: "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          type: string
          description: Recommended or planned mitigation(s) for the threat
        diagram_id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          type: string
          description: Unique identifier of the associated diagram (if applicable)
            (UUID)
          format: uuid
          nullable: true
        cell_id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          type: string
          description: Unique identifier of the associated cell (if applicable) (UUID)
          format: uuid
          nullable: true
        severity:
          maxLength: 50
          pattern: "^[\\u0020-\\uFFFF_().-]*$"
          type: string
          description: Severity level of the threat
        score:
          maximum: 10.0
          minimum: 0.0
          type: number
          description: Numeric score representing the risk or impact of the threat
        priority:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Priority level for addressing the threat
        mitigated:
          type: boolean
          description: Whether the threat has been mitigated
        status:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Current status of the threat
        threat_type:
          maxItems: 20
          minItems: 0
          uniqueItems: true
          type: array
          description: "Types or categories of the threat. Supports multiple classifications\
            \ within the same framework (e.g., ['Spoofing', 'Tampering']). Empty array\
            \ indicates no types assigned."
          items:
            maxLength: 256
            minLength: 1
            pattern: "^[\\u0020-\\uFFFF]*$"
            type: string
          default: []
        metadata:
          maxItems: 100
          type: array
          description: Key-value pairs for additional threat metadata
          nullable: true
          items:
            $ref: "#/components/schemas/Metadata"
        issue_uri:
          maxLength: 1000
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          description: URL to an issue in an issue tracking system for this threat
          format: uri
        asset_id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          type: string
          description: Unique identifier of the associated asset (if applicable) (UUID)
          format: uuid
          nullable: true
      description: Base schema for Threat with client-writable fields
      example:
        name: SQL Injection via Payment Form
        threat_type:
        - Tampering
        description: Attacker could inject malicious SQL through payment form fields
        priority: high
    ThreatInput:
      description: Input schema for creating/updating Threat
      example:
        name: Cross-Site Scripting (XSS)
        description: User input not properly sanitized in dashboard
        severity: Medium
        stride_category: Tampering
        status: Open
        metadata:
        - key: cwe
          value: CWE-79
      allOf:
      - $ref: "#/components/schemas/ThreatBase"
    User:
      example:
        user_id: 550e8400-e29b-41d4-a716-446655440000
        email: alice@example.com
        name: Alice Johnson
        provider: github
      allOf:
      - $ref: "#/components/schemas/Principal"
      - required:
        - display_name
        - email
        type: object
        properties:
          principal_type:
            type: string
            description: Always "user" for User objects
            enum:
            - user
          email:
            maxLength: 320
            type: string
            description: User email address (required)
            format: email
          display_name:
            maxLength: 256
            minLength: 1
            pattern: "^[\\u0020-\\uFFFF]*$"
            type: string
            description: User full name for display
        description: User principal with required email address
    Participant:
      required:
      - last_activity
      - permissions
      - user
      type: object
      properties:
        user:
          $ref: "#/components/schemas/User"
        last_activity:
          maxLength: 36
          pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          type: string
          description: Last activity timestamp
          format: date-time
        permissions:
          maxLength: 1000
          type: string
          description: Access permissions in the collaboration session
          enum:
          - reader
          - writer
      additionalProperties: false
      description: A participant in a collaboration session
      example:
        user:
          principal_type: user
          provider: test
          provider_id: bob@example.com
          email: bob@example.com
          display_name: Bob Smith
        last_activity: 2024-01-20T15:50:00Z
        permissions: writer
    DeletionChallenge:
      required:
      - challenge_text
      - expires_at
      type: object
      properties:
        challenge_text:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: The exact challenge string that must be provided to confirm
            deletion
        expires_at:
          maxLength: 64
          pattern: "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$"
          type: string
          description: When the challenge expires (3 minutes from issuance)
          format: date-time
      additionalProperties: false
      description: Challenge response for user account deletion
      example:
        challenge_text: delete-660e8400-e29b-41d4-a716-446655440001
        expires_at: 2024-01-20T16:00:00Z
    Repository:
      description: Complete Repository schema with server-generated fields
      example:
        id: 789eabcd-e89b-41d4-a716-446655440006
        threat_model_id: 123e4567-e89b-41d4-a716-446655440000
        name: payment-service
        description: Main payment processing microservice
        url: https://github.com/example/payment-service
        repo_type: github
        metadata:
        - key: language
          value: Go
        created_at: 2024-01-15T10:00:00Z
        modified_at: 2024-01-15T10:00:00Z
      allOf:
      - $ref: "#/components/schemas/RepositoryBase"
      - required:
        - id
        type: object
        properties:
          id:
            maxLength: 36
            pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
            type: string
            description: Unique identifier for the repository
            format: uuid
            readOnly: true
          metadata:
            maxItems: 100
            type: array
            description: Optional metadata key-value pairs
            readOnly: true
            items:
              $ref: "#/components/schemas/Metadata"
          created_at:
            maxLength: 24
            pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
            type: string
            description: Creation timestamp (RFC3339)
            format: date-time
            readOnly: true
          modified_at:
            maxLength: 24
            pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
            type: string
            description: Last modification timestamp (RFC3339)
            format: date-time
            readOnly: true
    Note:
      description: Complete Note schema with server-generated fields
      example:
        id: 678e9abc-e89b-41d4-a716-446655440005
        threat_model_id: 123e4567-e89b-41d4-a716-446655440000
        title: "Meeting Notes: Security Review"
        content: |-
          Attendees: Alice, Bob, Charlie
          Decisions: Prioritize authentication fixes
        metadata:
        - key: meeting_date
          value: 2024-01-18
        created_at: 2024-01-18T16:30:00Z
        modified_at: 2024-01-18T16:30:00Z
      allOf:
      - $ref: "#/components/schemas/NoteBase"
      - required:
        - id
        type: object
        properties:
          id:
            maxLength: 36
            pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
            type: string
            description: Unique identifier for the note
            format: uuid
            readOnly: true
          metadata:
            maxItems: 100
            type: array
            description: Optional metadata key-value pairs
            readOnly: true
            items:
              $ref: "#/components/schemas/Metadata"
          created_at:
            maxLength: 24
            pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
            type: string
            description: Creation timestamp (RFC3339)
            format: date-time
            readOnly: true
          modified_at:
            maxLength: 24
            pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
            type: string
            description: Last modification timestamp (RFC3339)
            format: date-time
            readOnly: true
        additionalProperties: false
    Asset:
      description: Complete Asset schema with server-generated fields
      example:
        id: 456e789a-e89b-41d4-a716-446655440003
        threat_model_id: 123e4567-e89b-41d4-a716-446655440000
        name: Customer Payment Information
        description: PCI DSS Level 1 cardholder data
        asset_type: data
        security_controls: "Encryption at rest and in transit, tokenization"
        metadata:
        - key: classification
          value: Confidential
        created_at: 2024-01-15T11:00:00Z
        modified_at: 2024-01-15T11:00:00Z
      allOf:
      - $ref: "#/components/schemas/AssetBase"
      - required:
        - id
        type: object
        properties:
          id:
            maxLength: 36
            pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
            type: string
            description: Unique identifier for the asset
            format: uuid
            readOnly: true
          metadata:
            maxItems: 100
            type: array
            description: Optional metadata key-value pairs
            readOnly: true
            items:
              $ref: "#/components/schemas/Metadata"
          created_at:
            maxLength: 24
            pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
            type: string
            description: Creation timestamp (RFC3339)
            format: date-time
            readOnly: true
          modified_at:
            maxLength: 24
            pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
            type: string
            description: Last modification timestamp (RFC3339)
            format: date-time
            readOnly: true
        additionalProperties: false
    ExtendedAsset:
      example:
        id: k10eabcd-e89b-41d4-a716-446655440020
        threat_model_id: 123e4567-e89b-41d4-a716-446655440000
        name: API Keys
        description: Third-party service API credentials
        asset_type: data
        security_controls: "Secrets manager, rotation policy"
        metadata:
        - key: rotation_period
          value: 90 days
        threat_count: 3
        created_at: 2024-01-16T11:00:00Z
        modified_at: 2024-01-16T11:00:00Z
      allOf:
      - $ref: "#/components/schemas/Asset"
      - required:
        - created_at
        - modified_at
        - threat_model_id
        type: object
        properties:
          threat_model_id:
            maxLength: 36
            pattern: "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            type: string
            description: ID of the threat model this asset belongs to
            format: uuid
          created_at:
            maxLength: 36
            pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
            type: string
            description: Creation timestamp (ISO3339)
            format: date-time
          modified_at:
            maxLength: 36
            pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
            type: string
            description: Last modification timestamp (ISO3339)
            format: date-time
        additionalProperties: false
    AssetBase:
      required:
      - name
      - type
      type: object
      properties:
        name:
          maxLength: 256
          minLength: 1
          pattern: "^[^<>\"'&]*$"
          type: string
          description: Asset name
          x-oapi-codegen-extra-tags:
            binding: required
        description:
          maxLength: 1024
          pattern: "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          type: string
          description: Description of the asset
          nullable: true
        type:
          maxLength: 64
          type: string
          description: Type of asset
          enum:
          - data
          - hardware
          - software
          - infrastructure
          - service
          - personnel
          x-oapi-codegen-extra-tags:
            binding: required
        criticality:
          maxLength: 128
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Criticality level of the asset
          nullable: true
        classification:
          maxItems: 50
          type: array
          description: Classification tags for the asset
          nullable: true
          items:
            maxLength: 128
            pattern: "^[\\u0020-\\uFFFF]*$"
            type: string
        sensitivity:
          maxLength: 128
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Sensitivity label for the asset
          nullable: true
      additionalProperties: false
      description: Base fields for Asset (user-writable only)
      example:
        name: Payment Database
        type: data
        description: PostgreSQL database storing customer payment information
        criticality: high
    AssetInput:
      description: Input schema for creating or updating Asset
      example:
        name: User Credentials Database
        description: PostgreSQL database storing encrypted user credentials
        asset_type: data
        security_controls: "Encryption, access controls, audit logging"
        metadata:
        - key: owner
          value: Platform Team
      allOf:
      - $ref: "#/components/schemas/AssetBase"
    DocumentBase:
      required:
      - name
      - uri
      type: object
      properties:
        name:
          maxLength: 256
          minLength: 1
          pattern: "^[^<>\"'&]*$"
          type: string
          description: Document name
          x-oapi-codegen-extra-tags:
            binding: required
        description:
          maxLength: 1024
          pattern: "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          type: string
          description: Description of document purpose or content
          nullable: true
        uri:
          maxLength: 1000
          pattern: "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$"
          type: string
          description: URL location of the document
          format: uri
          x-oapi-codegen-extra-tags:
            binding: "required,url"
      description: Base fields for Document (user-writable only)
      example:
        name: Payment System Architecture
        uri: https://docs.example.com/architecture/payment-system.pdf
        description: High-level architecture diagram and documentation
    DocumentInput:
      description: Input schema for creating or updating Document
      example:
        name: Penetration Test Results
        description: External security assessment findings
        content: |-
          # Penetration Test Report

          ## Executive Summary

          Key findings...
        format: markdown
        metadata:
        - key: vendor
          value: SecureTest Inc
      allOf:
      - $ref: "#/components/schemas/DocumentBase"
    NoteBase:
      required:
      - content
      - name
      type: object
      properties:
        name:
          maxLength: 256
          minLength: 1
          pattern: "^[^<>\"'&]*$"
          type: string
          description: Note name
          x-oapi-codegen-extra-tags:
            binding: required
        content:
          maxLength: 65536
          minLength: 1
          pattern: "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          type: string
          description: Note content in markdown format
          x-oapi-codegen-extra-tags:
            binding: required
        description:
          maxLength: 1024
          pattern: "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          type: string
          description: Description of note purpose or context
          nullable: true
      additionalProperties: false
      description: Base fields for Note (user-writable only)
      example:
        name: Security Review Notes
        content: |-
          Reviewed payment flow with security team. Key findings:
          - Need additional input validation
          - Consider rate limiting on payment endpoint
    NoteInput:
      description: Input schema for creating or updating Note
      example:
        title: Architecture Decision Record
        content: |-
          Decision: Use event-driven architecture
          Rationale: Better scalability and decoupling
        metadata:
        - key: decision_date
          value: 2024-01-19
      allOf:
      - $ref: "#/components/schemas/NoteBase"
    NoteListItem:
      required:
      - id
      - name
      type: object
      properties:
        name:
          maxLength: 256
          minLength: 1
          pattern: "^[^<>\"'&]*$"
          type: string
          description: Note name
          x-oapi-codegen-extra-tags:
            binding: required
        description:
          maxLength: 1024
          pattern: "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          type: string
          description: Description of note purpose or context
          nullable: true
        metadata:
          maxItems: 100
          type: array
          description: Key-value pairs for additional note metadata
          nullable: true
          items:
            $ref: "#/components/schemas/Metadata"
        id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          description: Unique identifier for the note
          format: uuid
          readOnly: true
        created_at:
          maxLength: 24
          pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          type: string
          description: Creation timestamp (RFC3339)
          format: date-time
          readOnly: true
        modified_at:
          maxLength: 24
          pattern: "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          type: string
          description: Last modification timestamp (RFC3339)
          format: date-time
          readOnly: true
      additionalProperties: false
      description: Summary information for Note in list responses
      example:
        id: ff0e8400-e29b-41d4-a716-44665544000a
        name: Security Review Notes
        created_at: 2024-01-17T14:30:00Z
        modified_at: 2024-01-17T15:00:00Z
    RepositoryBase:
      required:
      - uri
      type: object
      properties:
        name:
          maxLength: 256
          minLength: 1
          pattern: "^[^<>\"'&]*$"
          type: string
          description: Name for the source code reference
        description:
          maxLength: 1024
          pattern: "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          type: string
          description: Description of the referenced source code
          nullable: true
        type:
          maxLength: 16
          type: string
          description: Source code repository type
          enum:
          - git
          - svn
          - mercurial
          - other
        parameters:
          $ref: "#/components/schemas/RepositoryBase_parameters"
        uri:
          maxLength: 1000
          pattern: "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$"
          type: string
          description: URL to retrieve the referenced source code
          format: uri
      description: Base fields for Repository (user-writable only)
      example:
        uri: https://github.com/example/payment-service
        description: Main repository for payment processing service
    RepositoryInput:
      description: Input schema for creating or updating Repository
      example:
        name: authentication-service
        description: OAuth and SAML authentication microservice
        url: https://github.com/example/auth-service
        repo_type: github
        metadata:
        - key: team
          value: Security
      allOf:
      - $ref: "#/components/schemas/RepositoryBase"
    WebhookSubscription:
      required:
      - created_at
      - events
      - id
      - modified_at
      - name
      - owner_id
      - status
      - url
      type: object
      properties:
        id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          description: Unique identifier
          format: uuid
        owner_id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          description: Owner user ID
          format: uuid
        threat_model_id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          description: Optional threat model filter (null means all threat models)
          format: uuid
          nullable: true
        name:
          maxLength: 255
          minLength: 1
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Descriptive name
        url:
          maxLength: 1024
          minLength: 8
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          description: Webhook endpoint URL (must be HTTPS)
          format: uri
        events:
          maxItems: 1000
          minItems: 1
          type: array
          description: List of event types to subscribe to. See WebhookEventType for
            available events.
          items:
            $ref: "#/components/schemas/WebhookEventType"
        secret:
          maxLength: 128
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: HMAC secret for signing payloads (not returned in GET responses)
        status:
          maxLength: 1000
          type: string
          description: Subscription status
          enum:
          - pending_verification
          - active
          - pending_delete
        challenges_sent:
          minimum: 0
          type: integer
          description: Number of verification challenges sent
        created_at:
          maxLength: 64
          pattern: "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$"
          type: string
          description: Creation timestamp
          format: date-time
        modified_at:
          maxLength: 64
          pattern: "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$"
          type: string
          description: Last modification timestamp
          format: date-time
        last_successful_use:
          maxLength: 64
          pattern: "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$"
          type: string
          description: Last successful delivery timestamp
          format: date-time
          nullable: true
        publication_failures:
          minimum: 0
          type: integer
          description: Count of consecutive failed deliveries
      additionalProperties: false
      example:
        id: 550e8400-e29b-41d4-a716-446655440000
        owner_id: 550e8400-e29b-41d4-a716-446655440020
        threat_model_id: 660e8400-e29b-41d4-a716-446655440001
        name: Production Slack Notifications
        url: https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXX
        events:
        - diagram.updated
        - threat_model.created
        status: active
        secret: whsec_abc123def456
        created_at: 2024-01-15T10:30:00Z
        modified_at: 2024-01-15T10:30:00Z
        last_successful_use: 2024-01-20T14:22:15Z
        challenges_sent: 0
        publication_failures: 0
    WebhookSubscriptionInput:
      required:
      - events
      - name
      - url
      type: object
      properties:
        threat_model_id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          description: Optional threat model filter
          format: uuid
          nullable: true
        name:
          maxLength: 255
          minLength: 1
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Descriptive name for the subscription
        url:
          maxLength: 1024
          minLength: 8
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          description: Webhook endpoint URL (must be HTTPS)
          format: uri
        events:
          maxItems: 50
          minItems: 1
          type: array
          description: List of event types to subscribe to
          items:
            maxLength: 1000
            pattern: "^[\\u0020-\\uFFFF]*$"
            type: string
        secret:
          maxLength: 128
          minLength: 16
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Optional HMAC secret for signing payloads (auto-generated if
            not provided)
      additionalProperties: false
      example:
        name: Production Slack Notifications
        url: https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXX
        events:
        - diagram.updated
        - threat_model.created
        threat_model_id: 660e8400-e29b-41d4-a716-446655440001
    WebhookDelivery:
      required:
      - attempts
      - created_at
      - event_type
      - id
      - status
      - subscription_id
      type: object
      properties:
        id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          description: Unique identifier (UUIDv7)
          format: uuid
        subscription_id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          description: Subscription that triggered this delivery
          format: uuid
        event_type:
          $ref: "#/components/schemas/WebhookEventType"
        payload:
          type: object
          additionalProperties: false
          description: Event payload (JSON)
        status:
          maxLength: 1000
          type: string
          description: Delivery status
          enum:
          - pending
          - delivered
          - failed
        attempts:
          minimum: 0
          type: integer
          description: Number of delivery attempts
        next_retry_at:
          maxLength: 64
          pattern: "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$"
          type: string
          description: Next retry timestamp
          format: date-time
          nullable: true
        last_error:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Last error message
        created_at:
          maxLength: 64
          pattern: "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$"
          type: string
          description: Creation timestamp
          format: date-time
        delivered_at:
          maxLength: 64
          pattern: "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$"
          type: string
          description: Successful delivery timestamp
          format: date-time
          nullable: true
      additionalProperties: false
      example:
        id: aa0e8400-e29b-41d4-a716-446655440005
        subscription_id: 550e8400-e29b-41d4-a716-446655440000
        event_type: diagram.updated
        status: delivered
        attempts: 1
        created_at: 2024-01-20T15:45:30Z
        delivered_at: 2024-01-20T15:45:31Z
        payload: {}
    WebhookTestRequest:
      type: object
      properties:
        event_type:
          maxLength: 1000
          type: string
          description: "Webhook event type following {resource}.{action} pattern"
          enum:
          - threat_model.created
          - threat_model.updated
          - threat_model.deleted
          - diagram.created
          - diagram.updated
          - diagram.deleted
          - document.created
          - document.updated
          - document.deleted
          - note.created
          - note.updated
          - note.deleted
          - repository.created
          - repository.updated
          - repository.deleted
          - asset.created
          - asset.updated
          - asset.deleted
          - threat.created
          - threat.updated
          - threat.deleted
          - metadata.created
          - metadata.updated
          - metadata.deleted
      additionalProperties: false
      example:
        event_type: diagram.updated
    WebhookTestResponse:
      required:
      - delivery_id
      - status
      type: object
      properties:
        delivery_id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          description: Test delivery ID
          format: uuid
        status:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Test result status
        message:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Result message
      additionalProperties: false
      example:
        delivery_id: bb0e8400-e29b-41d4-a716-446655440006
        status: success
        message: Test webhook delivered successfully
    CreateAddonRequest:
      required:
      - name
      - webhook_id
      type: object
      properties:
        name:
          maxLength: 255
          type: string
          description: Display name for the add-on
        webhook_id:
          type: string
          description: UUID of the associated webhook subscription
          format: uuid
        description:
          type: string
          description: Description of what the add-on does
        icon:
          maxLength: 60
          pattern: "^(material-symbols:[a-z]([a-z0-9_]*[a-z0-9])?|fa-[a-z]([a-z]*[a-z])?(\\\
            -[a-z]+)? fa-([a-z]+)(-[a-z]+)*)$"
          type: string
          description: Icon identifier (Material Symbols or FontAwesome format)
        objects:
          type: array
          description: TMI object types this add-on can operate on
          items:
            type: string
            enum:
            - threat_model
            - diagram
            - asset
            - threat
            - document
            - note
            - repository
            - metadata
        threat_model_id:
          type: string
          description: "Optional: Scope add-on to specific threat model"
          format: uuid
      example:
        name: Security Scanner
        description: Automated security vulnerability scanner for threat models
        webhook_id: 550e8400-e29b-41d4-a716-446655440000
        threat_model_id: 660e8400-e29b-41d4-a716-446655440001
        icon: material-symbols:security
        objects:
        - threat_model
        - diagram
    AddonResponse:
      required:
      - created_at
      - id
      - name
      - webhook_id
      type: object
      properties:
        id:
          type: string
          description: Add-on identifier
          format: uuid
        created_at:
          type: string
          description: Creation timestamp
          format: date-time
        name:
          type: string
          description: Display name
        webhook_id:
          type: string
          description: Associated webhook subscription ID
          format: uuid
        description:
          type: string
          description: Add-on description
        icon:
          type: string
          description: Icon identifier
        objects:
          type: array
          description: Supported TMI object types
          items:
            type: string
        threat_model_id:
          type: string
          description: Threat model scope (if scoped)
          format: uuid
      example:
        id: 770e8400-e29b-41d4-a716-446655440002
        name: Security Scanner
        description: Automated security vulnerability scanner for threat models
        webhook_id: 550e8400-e29b-41d4-a716-446655440000
        threat_model_id: 660e8400-e29b-41d4-a716-446655440001
        icon: https://example.com/icons/scanner.svg
        objects:
        - threat_model
        - diagram
        created_at: 2024-01-15T10:30:00Z
    ListAddonsResponse:
      required:
      - addons
      - limit
      - offset
      - total
      type: object
      properties:
        addons:
          type: array
          items:
            $ref: "#/components/schemas/AddonResponse"
        total:
          type: integer
          description: Total number of add-ons matching criteria
        limit:
          type: integer
          description: Pagination limit
        offset:
          type: integer
          description: Pagination offset
      example:
        addons:
        - id: 770e8400-e29b-41d4-a716-446655440002
          name: Security Scanner
          description: Automated security vulnerability scanner
          webhook_id: 550e8400-e29b-41d4-a716-446655440000
          created_at: 2024-01-15T10:30:00Z
        total: 1
        limit: 50
        offset: 0
    InvokeAddonRequest:
      required:
      - threat_model_id
      type: object
      properties:
        threat_model_id:
          type: string
          description: Threat model context for invocation
          format: uuid
        object_type:
          type: string
          description: "Optional: Specific object type to operate on"
          enum:
          - threat_model
          - diagram
          - asset
          - threat
          - document
          - note
          - repository
          - metadata
        object_id:
          type: string
          description: "Optional: Specific object ID to operate on"
          format: uuid
        payload:
          type: object
          additionalProperties: true
          description: User-provided data for the add-on (max 1KB JSON-serialized)
      example:
        threat_model_id: 660e8400-e29b-41d4-a716-446655440001
        object_type: diagram
        object_id: 880e8400-e29b-41d4-a716-446655440003
        payload:
          scan_type: full
          include_recommendations: true
    InvokeAddonResponse:
      required:
      - created_at
      - invocation_id
      - status
      type: object
      properties:
        invocation_id:
          type: string
          description: Invocation identifier for tracking
          format: uuid
        status:
          type: string
          description: Current invocation status
          enum:
          - pending
          - in_progress
          - completed
          - failed
        created_at:
          type: string
          description: Invocation creation timestamp
          format: date-time
      example:
        invocation_id: 990e8400-e29b-41d4-a716-446655440004
        status: pending
        created_at: 2024-01-20T15:45:30Z
    InvocationResponse:
      required:
      - addon_id
      - created_at
      - id
      - invoked_by
      - status
      - status_percent
      - status_updated_at
      - threat_model_id
      type: object
      properties:
        id:
          type: string
          description: Invocation identifier
          format: uuid
        addon_id:
          type: string
          description: Add-on that was invoked
          format: uuid
        threat_model_id:
          type: string
          description: Threat model context
          format: uuid
        object_type:
          type: string
          description: Object type (if specified)
        object_id:
          type: string
          description: Object ID (if specified)
          format: uuid
        invoked_by:
          description: User who triggered the invocation
          allOf:
          - $ref: "#/components/schemas/User"
        payload:
          type: string
          description: JSON-encoded payload
        status:
          type: string
          description: Current status
          enum:
          - pending
          - in_progress
          - completed
          - failed
        status_percent:
          maximum: 100
          minimum: 0
          type: integer
          description: Progress percentage (0-100)
        status_message:
          type: string
          description: Optional status description
        created_at:
          type: string
          description: Creation timestamp
          format: date-time
        status_updated_at:
          type: string
          description: Last status update timestamp
          format: date-time
      example:
        id: 990e8400-e29b-41d4-a716-446655440004
        addon_id: 770e8400-e29b-41d4-a716-446655440002
        threat_model_id: 660e8400-e29b-41d4-a716-446655440001
        object_type: diagram
        object_id: 880e8400-e29b-41d4-a716-446655440003
        invoked_by:
          principal_type: user
          provider: test
          provider_id: alice@example.com
          email: alice@example.com
          display_name: Alice Anderson
        status: completed
        status_percent: 100
        status_message: Security scan completed successfully
        created_at: 2024-01-20T15:45:30Z
        status_updated_at: 2024-01-20T15:50:00Z
        completed_at: 2024-01-20T15:50:00Z
    ListInvocationsResponse:
      required:
      - invocations
      - limit
      - offset
      - total
      type: object
      properties:
        invocations:
          type: array
          items:
            $ref: "#/components/schemas/InvocationResponse"
        total:
          type: integer
          description: Total number of invocations
        limit:
          type: integer
          description: Pagination limit
        offset:
          type: integer
          description: Pagination offset
      example:
        invocations:
        - id: 990e8400-e29b-41d4-a716-446655440004
          addon_id: 770e8400-e29b-41d4-a716-446655440002
          threat_model_id: 660e8400-e29b-41d4-a716-446655440001
          invoked_by:
            principal_type: user
            provider: test
            provider_id: alice@example.com
            email: alice@example.com
            display_name: Alice Anderson
          status: completed
          status_percent: 100
          created_at: 2024-01-20T15:45:30Z
          status_updated_at: 2024-01-20T15:50:00Z
        total: 1
        limit: 50
        offset: 0
    UpdateInvocationStatusRequest:
      required:
      - status
      type: object
      properties:
        status:
          type: string
          description: New status (cannot transition back to pending)
          enum:
          - in_progress
          - completed
          - failed
        status_percent:
          maximum: 100
          minimum: 0
          type: integer
          description: Progress percentage
        status_message:
          type: string
          description: Optional status description
      example:
        status: completed
        status_percent: 100
        status_message: Security scan completed successfully. Found 3 vulnerabilities.
    UpdateInvocationStatusResponse:
      required:
      - id
      - status
      - status_percent
      - status_updated_at
      type: object
      properties:
        id:
          type: string
          description: Invocation identifier
          format: uuid
        status:
          type: string
          description: Current status
          enum:
          - pending
          - in_progress
          - completed
          - failed
        status_percent:
          maximum: 100
          minimum: 0
          type: integer
          description: Progress percentage
        status_updated_at:
          type: string
          description: Status update timestamp
          format: date-time
      example:
        id: 990e8400-e29b-41d4-a716-446655440004
        status: completed
        status_percent: 100
        status_updated_at: 2024-01-20T15:50:00Z
    Principal:
      required:
      - principal_type
      - provider
      - provider_id
      type: object
      properties:
        principal_type:
          type: string
          description: "Type of principal: user (individual) or group"
          enum:
          - user
          - group
        provider:
          maxLength: 100
          pattern: "^[a-zA-Z][a-zA-Z0-9_*-]*$"
          type: string
          description: "Identity provider name (e.g., \"google\", \"github\", \"microsoft\"\
            , \"test\"). Use \"*\" for provider-independent groups."
        provider_id:
          maxLength: 500
          minLength: 1
          pattern: "^[^<>\"'&]*$"
          type: string
          description: "Provider-assigned identifier. For users: provider_user_id\
            \ (e.g., email or OAuth sub). For groups: group_name."
        display_name:
          maxLength: 256
          minLength: 1
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Human-readable display name for UI presentation
        email:
          maxLength: 320
          type: string
          description: "Email address (required for users, optional for groups)"
          format: email
      description: "Base identity representation for users and groups with portable,\
        \ globally-unique identifiers"
      example:
        principal_type: user
        provider: google
        provider_id: alice@example.com
        display_name: Alice Anderson
        email: alice@example.com
    SAMLProviderInfo:
      required:
      - acs_url
      - auth_url
      - entity_id
      - icon
      - id
      - metadata_url
      - name
      type: object
      properties:
        id:
          maxLength: 1000
          type: string
          description: Provider identifier
        name:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Display name of the provider
        icon:
          maxLength: 1000
          type: string
          description: "Icon identifier for the provider (Font Awesome class, URL,\
            \ or path)"
        auth_url:
          maxLength: 1024
          pattern: "^(https?|wss?|file)://[^\\s]*$"
          type: string
          description: TMI SAML login endpoint URL
          format: uri
        metadata_url:
          maxLength: 1024
          pattern: "^(https?|wss?|file)://[^\\s]*$"
          type: string
          description: SAML service provider metadata URL
          format: uri
        entity_id:
          maxLength: 1000
          type: string
          description: Service Provider entity ID
        acs_url:
          maxLength: 1024
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          description: Assertion Consumer Service URL
          format: uri
        slo_url:
          maxLength: 1024
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          description: Single Logout URL
          format: uri
      additionalProperties: false
      example:
        id: azure-ad
        name: Azure Active Directory
        icon: https://example.com/icons/azure.png
        auth_url: https://login.microsoftonline.com/common/saml2
        metadata_url: https://login.microsoftonline.com/common/FederationMetadata/2007-06/FederationMetadata.xml
        entity_id: https://sts.windows.net/common/
        acs_url: https://tmi.example.com/saml/acs
    Administrator:
      required:
      - created_at
      - id
      - provider
      type: object
      properties:
        id:
          type: string
          description: Administrator grant identifier
          format: uuid
        user_id:
          type: string
          description: User ID (if user-based grant)
          format: uuid
          nullable: true
        user_email:
          type: string
          description: User email (enriched)
          nullable: true
        group_id:
          type: string
          description: Group ID (if group-based grant)
          format: uuid
          nullable: true
        group_name:
          type: string
          description: Group name (enriched)
          nullable: true
        provider:
          type: string
          description: OAuth/SAML provider
        created_at:
          type: string
          description: Creation timestamp
          format: date-time
        user_name:
          type: string
          description: User display name (enriched)
          nullable: true
      example:
        id: 550e8400-e29b-41d4-a716-446655440000
        user_id: 550e8400-e29b-41d4-a716-446655440000
        email: alice@example.com
        name: Alice Johnson
        provider: github
        created_at: 2024-01-01T00:00:00Z
    CreateAdministratorRequest:
      required:
      - provider
      type: object
      properties:
        email:
          type: string
          description: User email to grant admin privileges (mutually exclusive with
            provider_user_id and group_name)
          format: email
        provider_user_id:
          type: string
          description: Provider's user ID to grant admin privileges (mutually exclusive
            with email and group_name)
        group_name:
          type: string
          description: Group name to grant admin privileges (mutually exclusive with
            email and provider_user_id)
        provider:
          type: string
          description: OAuth/SAML provider
      example:
        user_id: h80eabcd-e89b-41d4-a716-446655440017
        provider: github
    ListAdministratorsResponse:
      required:
      - administrators
      - total
      type: object
      properties:
        administrators:
          type: array
          description: List of administrator grants
          items:
            $ref: "#/components/schemas/Administrator"
        total:
          type: integer
          description: Total number of grants matching filter
      example:
        administrators:
        - user_id: 550e8400-e29b-41d4-a716-446655440000
          email: admin@example.com
          name: System Administrator
          created_at: 2024-01-01T00:00:00Z
          id: 550e8400-e29b-41d4-a716-446655440001
          provider: google
        total: 1
        limit: 50
        offset: 0
    UserWithAdminStatus:
      example:
        user_id: 550e8400-e29b-41d4-a716-446655440000
        email: alice@example.com
        name: Alice Johnson
        provider: github
        is_admin: false
      allOf:
      - $ref: "#/components/schemas/User"
      - required:
        - is_admin
        type: object
        properties:
          is_admin:
            type: boolean
            description: Whether the user has administrator privileges (computed dynamically
              based on administrators table)
            example: false
        description: User profile with admin status (only returned by GET /users/me)
    UserAPIQuota:
      required:
      - created_at
      - max_requests_per_minute
      - modified_at
      - user_id
      type: object
      properties:
        user_id:
          type: string
          description: User ID
          format: uuid
        max_requests_per_minute:
          minimum: 1
          type: integer
          description: Maximum API requests per minute
        max_requests_per_hour:
          minimum: 1
          type: integer
          description: Maximum API requests per hour (optional)
          nullable: true
        created_at:
          type: string
          description: Creation timestamp
          format: date-time
        modified_at:
          type: string
          description: Last modification timestamp
          format: date-time
      example:
        user_id: 550e8400-e29b-41d4-a716-446655440000
        max_requests_per_minute: 60
        created_at: 2024-01-01T00:00:00Z
        modified_at: 2024-01-01T00:00:00Z
    WebhookQuota:
      required:
      - max_events_per_minute
      - max_subscription_requests_per_day
      - max_subscription_requests_per_minute
      - max_subscriptions
      - owner_id
      type: object
      properties:
        owner_id:
          type: string
          description: Owner ID
          format: uuid
        max_subscriptions:
          minimum: 1
          type: integer
          description: Maximum number of webhook subscriptions
        max_events_per_minute:
          minimum: 1
          type: integer
          description: Maximum webhook events per minute
        max_subscription_requests_per_minute:
          minimum: 1
          type: integer
          description: Maximum subscription requests per minute
        max_subscription_requests_per_day:
          minimum: 1
          type: integer
          description: Maximum subscription requests per day
      example:
        user_id: 550e8400-e29b-41d4-a716-446655440000
        owner_id: 550e8400-e29b-41d4-a716-446655440000
        max_subscriptions: 20
        max_events_per_minute: 100
        max_subscription_requests_per_minute: 10
        max_subscription_requests_per_day: 1000
        created_at: 2024-01-01T00:00:00Z
        modified_at: 2024-01-01T00:00:00Z
    AdminUser:
      required:
      - created_at
      - email
      - email_verified
      - internal_uuid
      - modified_at
      - name
      - provider
      - provider_user_id
      type: object
      properties:
        internal_uuid:
          type: string
          description: Internal system UUID for the user
          format: uuid
        provider:
          maxLength: 256
          type: string
          description: OAuth/SAML provider identifier
        provider_user_id:
          maxLength: 500
          type: string
          description: Provider-assigned user identifier
        email:
          maxLength: 320
          type: string
          description: User email address
          format: email
        name:
          maxLength: 256
          type: string
          description: User display name
        email_verified:
          type: boolean
          description: Whether the email has been verified
        created_at:
          type: string
          description: Account creation timestamp
          format: date-time
        modified_at:
          type: string
          description: Last modification timestamp
          format: date-time
        last_login:
          type: string
          description: Last login timestamp
          format: date-time
          nullable: true
        is_admin:
          type: boolean
          description: Whether the user has administrator privileges (enriched)
          readOnly: true
        groups:
          type: array
          description: List of group names the user belongs to (enriched)
          readOnly: true
          items:
            type: string
        active_threat_models:
          minimum: 0
          type: integer
          description: Number of active threat models owned by user (enriched)
          readOnly: true
      description: User object with administrative fields and enriched data
      example:
        internal_uuid: 550e8400-e29b-41d4-a716-446655440000
        user_id: alice@example.com
        email: alice@example.com
        name: Alice Johnson
        provider: github
        provider_user_id: alice-github-123
        email_verified: true
        is_admin: false
        created_at: 2024-01-01T00:00:00Z
        modified_at: 2024-01-01T00:00:00Z
    AdminUserListResponse:
      required:
      - limit
      - offset
      - total
      - users
      type: object
      properties:
        users:
          type: array
          description: List of users
          items:
            $ref: "#/components/schemas/AdminUser"
        total:
          minimum: 0
          type: integer
          description: Total number of users matching the filter
        limit:
          minimum: 0
          type: integer
          description: Maximum number of results returned
        offset:
          minimum: 0
          type: integer
          description: Number of results skipped
      example:
        users:
        - user_id: 550e8400-e29b-41d4-a716-446655440000
          email: admin@example.com
          name: Admin User
          provider: github
          is_admin: true
          created_at: 2024-01-01T00:00:00Z
          internal_uuid: 123e4567-e89b-12d3-a456-426614174000
          provider_user_id: github_123456
          email_verified: true
          modified_at: 2024-01-15T00:00:00Z
        total: 1
        limit: 50
        offset: 0
    UpdateAdminUserRequest:
      type: object
      properties:
        email:
          maxLength: 320
          type: string
          description: Updated email address
          format: email
        name:
          maxLength: 256
          type: string
          description: Updated display name
        email_verified:
          type: boolean
          description: Updated email verification status
      additionalProperties: false
      description: Request body for updating user metadata
      example:
        email: alice.updated@example.com
        name: Alice Johnson Updated
    AdminGroup:
      required:
      - first_used
      - group_name
      - internal_uuid
      - last_used
      - provider
      - usage_count
      type: object
      properties:
        internal_uuid:
          type: string
          description: Internal system UUID for the group
          format: uuid
        provider:
          maxLength: 256
          type: string
          description: "OAuth/SAML provider identifier, or \"*\" for provider-independent\
            \ groups"
        group_name:
          maxLength: 500
          type: string
          description: Provider-assigned group name
        name:
          maxLength: 256
          type: string
          description: Human-readable group name
        description:
          maxLength: 1000
          type: string
          description: Group description
        first_used:
          type: string
          description: First time this group was referenced
          format: date-time
        last_used:
          type: string
          description: Last time this group was referenced
          format: date-time
        usage_count:
          minimum: 0
          type: integer
          description: Number of times this group has been referenced
        used_in_authorizations:
          type: boolean
          description: Whether this group is used in any authorizations (enriched)
          readOnly: true
        used_in_admin_grants:
          type: boolean
          description: Whether this group is used in any admin grants (enriched)
          readOnly: true
        member_count:
          minimum: 0
          type: integer
          description: "Number of members in the group from IdP (enriched, if available)"
          readOnly: true
      description: Group object with administrative fields and enriched data
      example:
        internal_uuid: e50eabcd-e89b-41d4-a716-446655440014
        group_name: engineering-team
        name: Engineering
        description: Engineering team members
        provider: github
        provider_group_id: org-engineering
        member_count: 25
        first_used: 2024-01-02T10:00:00Z
        last_used: 2024-01-20T15:00:00Z
        usage_count: 150
        created_at: 2024-01-02T10:00:00Z
        modified_at: 2024-01-02T10:00:00Z
    AdminGroupListResponse:
      required:
      - groups
      - limit
      - offset
      - total
      type: object
      properties:
        groups:
          type: array
          description: List of groups
          items:
            $ref: "#/components/schemas/AdminGroup"
        total:
          minimum: 0
          type: integer
          description: Total number of groups matching the filter
        limit:
          minimum: 0
          type: integer
          description: Maximum number of results returned
        offset:
          minimum: 0
          type: integer
          description: Number of results skipped
      example:
        groups:
        - internal_uuid: e50eabcd-e89b-41d4-a716-446655440014
          name: Engineering
          description: Engineering team members
          provider: github
          provider_group_id: org-engineering
          member_count: 25
          created_at: 2024-01-02T10:00:00Z
          modified_at: 2024-01-02T10:00:00Z
          group_name: Engineering
          first_used: 2024-01-02T10:00:00Z
          last_used: 2024-01-15T14:30:00Z
          usage_count: 150
        total: 1
        limit: 50
        offset: 0
    CreateAdminGroupRequest:
      required:
      - group_name
      - name
      type: object
      properties:
        group_name:
          maxLength: 500
          pattern: "^[a-zA-Z0-9_-]+$"
          type: string
          description: "Group identifier (alphanumeric, hyphens, underscores only)"
        name:
          maxLength: 256
          type: string
          description: Human-readable group name
        description:
          maxLength: 1000
          type: string
          description: Optional group description
      additionalProperties: false
      description: Request body for creating a provider-independent group
      example:
        group_name: devops-team
        name: DevOps Team
        description: Infrastructure and operations engineers
    UpdateAdminGroupRequest:
      type: object
      properties:
        name:
          maxLength: 256
          type: string
          description: Updated human-readable group name
        description:
          maxLength: 1000
          type: string
          description: Updated group description
      additionalProperties: false
      description: Request body for updating group metadata
      example:
        name: Platform Engineering
        description: Updated team name and scope
    WebhookEventType:
      maxLength: 1000
      type: string
      description: "Webhook event type following {resource}.{action} pattern. CRUD\
        \ events are emitted for resource lifecycle changes (created, updated, deleted).\
        \ The addon.invoked event is emitted when an add-on is invoked."
      example: threat_model.created
      enum:
      - threat_model.created
      - threat_model.updated
      - threat_model.deleted
      - diagram.created
      - diagram.updated
      - diagram.deleted
      - document.created
      - document.updated
      - document.deleted
      - note.created
      - note.updated
      - note.deleted
      - repository.created
      - repository.updated
      - repository.deleted
      - asset.created
      - asset.updated
      - asset.deleted
      - threat.created
      - threat.updated
      - threat.deleted
      - metadata.created
      - metadata.updated
      - metadata.deleted
      - addon.invoked
      x-event-categories:
        threat_model:
        - threat_model.created
        - threat_model.updated
        - threat_model.deleted
        diagram:
        - diagram.created
        - diagram.updated
        - diagram.deleted
        document:
        - document.created
        - document.updated
        - document.deleted
        note:
        - note.created
        - note.updated
        - note.deleted
        repository:
        - repository.created
        - repository.updated
        - repository.deleted
        asset:
        - asset.created
        - asset.updated
        - asset.deleted
        threat:
        - threat.created
        - threat.updated
        - threat.deleted
        metadata:
        - metadata.created
        - metadata.updated
        - metadata.deleted
        addon:
        - addon.invoked
    GroupMember:
      required:
      - added_at
      - group_internal_uuid
      - id
      - user_email
      - user_internal_uuid
      - user_name
      - user_provider
      - user_provider_user_id
      type: object
      properties:
        id:
          type: string
          description: Unique identifier for the membership record
          format: uuid
        group_internal_uuid:
          type: string
          description: Internal UUID of the group
          format: uuid
        user_internal_uuid:
          type: string
          description: Internal UUID of the user
          format: uuid
        user_email:
          type: string
          description: Email address of the user
          format: email
        user_name:
          type: string
          description: Display name of the user
        user_provider:
          type: string
          description: OAuth/SAML provider for the user
        user_provider_user_id:
          type: string
          description: Provider-specific user identifier
        added_by_internal_uuid:
          type: string
          description: Internal UUID of the administrator who added this member
          format: uuid
          nullable: true
        added_by_email:
          type: string
          description: Email of the administrator who added this member
          format: email
          nullable: true
        added_at:
          type: string
          description: Timestamp when the user was added to the group (RFC3339)
          format: date-time
        notes:
          type: string
          description: Optional notes about this membership
          nullable: true
      example:
        id: a10eabcd-e89b-41d4-a716-446655440001
        group_internal_uuid: e50eabcd-e89b-41d4-a716-446655440014
        user_internal_uuid: 660e8400-e29b-41d4-a716-446655440001
        user_id: bob@example.com
        user_email: bob@example.com
        user_name: Bob Smith
        user_provider: github
        user_provider_user_id: bob-github-456
        added_at: 2024-01-06T09:00:00Z
    GroupMemberListResponse:
      required:
      - limit
      - members
      - offset
      - total
      type: object
      properties:
        members:
          type: array
          items:
            $ref: "#/components/schemas/GroupMember"
        total:
          type: integer
          description: Total number of members in the group
        limit:
          type: integer
          description: Maximum number of results per page
        offset:
          type: integer
          description: Number of results skipped
      example:
        members:
        - id: 880e8400-e29b-41d4-a716-446655440020
          group_internal_uuid: e50eabcd-e89b-41d4-a716-446655440014
          user_internal_uuid: 123e4567-e89b-12d3-a456-426614174001
          user_email: bob@example.com
          user_name: Bob Smith
          user_provider: github
          user_provider_user_id: github_456789
          added_at: 2024-01-06T09:00:00Z
        total: 1
        limit: 50
        offset: 0
    AddGroupMemberRequest:
      required:
      - user_internal_uuid
      type: object
      properties:
        user_internal_uuid:
          type: string
          description: Internal UUID of the user to add to the group
          format: uuid
        notes:
          maxLength: 1000
          type: string
          description: Optional notes about this membership
      example:
        user_internal_uuid: 550e8400-e29b-41d4-a716-446655440000
    AddonInvocationQuota:
      required:
      - created_at
      - max_active_invocations
      - max_invocations_per_hour
      - modified_at
      - owner_id
      type: object
      properties:
        owner_id:
          type: string
          description: User ID
          format: uuid
        max_active_invocations:
          minimum: 1
          type: integer
          description: Maximum concurrent active addon invocations
        max_invocations_per_hour:
          minimum: 1
          type: integer
          description: Maximum addon invocations per hour
        created_at:
          type: string
          description: Creation timestamp
          format: date-time
        modified_at:
          type: string
          description: Last modification timestamp
          format: date-time
      description: Addon invocation quota for a user
      example:
        user_id: 550e8400-e29b-41d4-a716-446655440000
        owner_id: 550e8400-e29b-41d4-a716-446655440000
        max_active_invocations: 10
        max_invocations_per_hour: 100
        created_at: 2024-01-01T00:00:00Z
        modified_at: 2024-01-01T00:00:00Z
    ClientCredentialResponse:
      required:
      - client_id
      - client_secret
      - created_at
      - id
      - name
      type: object
      properties:
        id:
          type: string
          description: Unique identifier for the credential
          format: uuid
        client_id:
          pattern: "^tmi_cc_[A-Za-z0-9_-]+$"
          type: string
          description: "OAuth 2.0 client ID (format: tmi_cc_*)"
        client_secret:
          type: string
          description: "OAuth 2.0 client secret - ONLY returned at creation time,\
            \ cannot be retrieved later"
        name:
          type: string
          description: Human-readable name for the credential
        description:
          type: string
          description: Optional description of the credential's purpose
        created_at:
          type: string
          description: Creation timestamp (ISO 8601)
          format: date-time
        expires_at:
          type: string
          description: Optional expiration timestamp (ISO 8601)
          format: date-time
      description: "Response from creating a client credential. WARNING: The client_secret\
        \ is ONLY returned once and cannot be retrieved later."
      example:
        id: 990eabcd-e89b-41d4-a716-446655440008
        owner_id: 550e8400-e29b-41d4-a716-446655440000
        client_id: tmi_cc_abcdef1234567890
        client_secret: tmi_cs_1234567890abcdefghijklmnopqrstuvwxyz
        name: CI/CD Pipeline
        description: Automated testing and deployment
        is_active: true
        expires_at: 2025-12-31T23:59:59Z
        created_at: 2024-01-21T11:00:00Z
        modified_at: 2024-01-21T11:00:00Z
    ClientCredentialInfo:
      required:
      - client_id
      - created_at
      - id
      - is_active
      - modified_at
      - name
      type: object
      properties:
        id:
          type: string
          description: Unique identifier for the credential
          format: uuid
        client_id:
          pattern: "^tmi_cc_[A-Za-z0-9_-]+$"
          type: string
          description: "OAuth 2.0 client ID (format: tmi_cc_*)"
        name:
          type: string
          description: Human-readable name for the credential
        description:
          type: string
          description: Optional description of the credential's purpose
        is_active:
          type: boolean
          description: Whether the credential is active
        last_used_at:
          type: string
          description: Last time this credential was used (ISO 8601)
          format: date-time
        created_at:
          type: string
          description: Creation timestamp (ISO 8601)
          format: date-time
        modified_at:
          type: string
          description: Last modification timestamp (ISO 8601)
          format: date-time
        expires_at:
          type: string
          description: Optional expiration timestamp (ISO 8601)
          format: date-time
      description: Client credential information without the secret
      example:
        id: 970eabcd-e89b-41d4-a716-446655440016
        owner_id: 550e8400-e29b-41d4-a716-446655440000
        name: Monitoring Service
        description: Metrics collection service
        client_id: tmi_cc_monitoring123
        is_active: true
        last_used_at: 2024-01-21T09:00:00Z
        created_at: 2024-01-15T10:00:00Z
        modified_at: 2024-01-15T10:00:00Z
    MinimalDiagramModel:
      required:
      - cells
      - description
      - id
      - metadata
      - name
      type: object
      properties:
        id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          description: Threat model unique identifier
          format: uuid
        name:
          maxLength: 256
          type: string
          description: Threat model name
        description:
          maxLength: 4096
          type: string
          description: Threat model description
        metadata:
          type: object
          additionalProperties:
            type: string
          description: Flattened metadata from threat model (converted from array
            format to key-value pairs)
        cells:
          maxItems: 10000
          type: array
          description: Minimal cell data (nodes and edges) without visual styling
          items:
            $ref: "#/components/schemas/MinimalCell"
      additionalProperties: false
      description: "Minimal diagram representation optimized for automated threat\
        \ modeling, containing threat model context and simplified cell data without\
        \ visual styling"
      example:
        id: 550e8400-e29b-41d4-a716-446655440000
        name: Payment Processing System
        description: Threat model for credit card payment flow
        metadata:
          environment: production
          compliance: PCI-DSS
        cells: []
    MinimalCell:
      example:
        id: l20eabcd-e89b-41d4-a716-446655440021
        shape: process
      discriminator:
        propertyName: shape
        mapping:
          actor: "#/components/schemas/MinimalNode"
          process: "#/components/schemas/MinimalNode"
          store: "#/components/schemas/MinimalNode"
          security-boundary: "#/components/schemas/MinimalNode"
          text-box: "#/components/schemas/MinimalNode"
          edge: "#/components/schemas/MinimalEdge"
      oneOf:
      - $ref: "#/components/schemas/MinimalNode"
      - $ref: "#/components/schemas/MinimalEdge"
    MinimalNode:
      required:
      - children
      - id
      - labels
      - metadata
      - shape
      type: object
      properties:
        id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          description: Cell unique identifier
          format: uuid
        shape:
          maxLength: 64
          type: string
          description: Node shape type determining its semantic role in the diagram
          enum:
          - actor
          - process
          - store
          - security-boundary
          - text-box
        parent:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          description: Parent cell ID for nested nodes (null for top-level nodes)
          format: uuid
          nullable: true
        children:
          maxItems: 1000
          type: array
          description: Child cell IDs (computed bidirectional relationship including
            reverse parent references)
          items:
            maxLength: 36
            pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
            type: string
            format: uuid
        labels:
          maxItems: 100
          type: array
          description: Text labels extracted from node attrs and embedded text-box
            children
          items:
            maxLength: 1000
            type: string
        dataAssetId:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          description: Optional reference to a data asset entity
          format: uuid
          nullable: true
        metadata:
          type: object
          additionalProperties:
            type: string
          description: Flattened cell metadata (converted from _metadata array in
            cell.data)
      additionalProperties: false
      description: Minimal node representation without visual styling or layout information
      example:
        id: 760e8400-e29b-41d4-a716-446655440002
        shape: process
        parent: 550e8400-e29b-41d4-a716-446655440001
        children:
        - 860e8400-e29b-41d4-a716-446655440003
        labels:
        - Payment Gateway
        dataAssetId: 960e8400-e29b-41d4-a716-446655440004
        metadata:
          technology: Java
    MinimalEdge:
      required:
      - id
      - labels
      - metadata
      - shape
      - source
      - target
      type: object
      properties:
        id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          description: Cell unique identifier
          format: uuid
        shape:
          maxLength: 64
          type: string
          description: Edge shape type
          enum:
          - edge
        source:
          description: Source node connection details
          allOf:
          - $ref: "#/components/schemas/EdgeTerminal"
        target:
          description: Target node connection details
          allOf:
          - $ref: "#/components/schemas/EdgeTerminal"
        labels:
          maxItems: 100
          type: array
          description: Text labels extracted from edge labels array
          items:
            maxLength: 1000
            type: string
        dataAssetId:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          description: Optional reference to a data asset entity
          format: uuid
          nullable: true
        metadata:
          type: object
          additionalProperties:
            type: string
          description: Flattened edge metadata (converted from _metadata array in
            edge.data)
      additionalProperties: false
      description: Minimal edge representation without visual styling or routing information
      example:
        id: 970e8400-e29b-41d4-a716-446655440005
        shape: edge
        source:
          cell: 760e8400-e29b-41d4-a716-446655440002
        target:
          cell: a80e8400-e29b-41d4-a716-446655440006
        labels:
        - Credit Card Data
        dataAssetId: null
        metadata:
          protocol: https
    JsonPatchDocument:
      maxItems: 1000
      type: array
      description: JSON Patch document as defined in RFC 6902
      items:
        $ref: "#/components/schemas/JsonPatchDocument_inner"
    TokenRequest:
      required:
      - grant_type
      type: object
      properties:
        grant_type:
          type: string
          description: OAuth 2.0 grant type (RFC 6749)
          example: client_credentials
          enum:
          - authorization_code
          - client_credentials
          - refresh_token
        code:
          type: string
          description: Authorization code (required for authorization_code grant)
          nullable: true
          example: 0AX4XfWiXY2BZ_example_auth_code
        client_id:
          type: string
          description: Client identifier (required for client_credentials grant)
          nullable: true
          example: tmi_cc_AbCdEf123456
        client_secret:
          type: string
          description: Client secret (required for client_credentials grant)
          nullable: true
          example: secret_value
        refresh_token:
          type: string
          description: Refresh token (required for refresh_token grant)
          nullable: true
          example: refresh_token_value
        redirect_uri:
          type: string
          description: Redirect URI (required for authorization_code grant)
          nullable: true
        code_verifier:
          type: string
          description: PKCE code verifier (required for authorization_code grant)
          nullable: true
        state:
          type: string
          description: State parameter for CSRF protection
          nullable: true
    TokenIntrospectionRequest:
      required:
      - token
      type: object
      properties:
        token:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: The JWT token to introspect
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        token_type_hint:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Optional hint about the type of token being introspected
          nullable: true
          example: access_token
      additionalProperties: false
    AddonQuotaUpdate:
      required:
      - max_active_invocations
      - max_invocations_per_hour
      type: object
      properties:
        max_active_invocations:
          minimum: 1
          type: integer
          description: Maximum concurrent active addon invocations
        max_invocations_per_hour:
          minimum: 1
          type: integer
          description: Maximum addon invocations per hour
    UserQuotaUpdate:
      required:
      - max_requests_per_minute
      type: object
      properties:
        max_requests_per_minute:
          minimum: 1
          type: integer
          description: Maximum API requests per minute
        max_requests_per_hour:
          minimum: 1
          type: integer
          description: Maximum API requests per hour (optional)
          nullable: true
    WebhookQuotaUpdate:
      required:
      - max_events_per_minute
      - max_subscription_requests_per_day
      - max_subscription_requests_per_minute
      - max_subscriptions
      type: object
      properties:
        max_subscriptions:
          minimum: 1
          type: integer
          description: Maximum webhook subscriptions
        max_events_per_minute:
          minimum: 1
          type: integer
          description: Maximum webhook events per minute
        max_subscription_requests_per_minute:
          minimum: 1
          type: integer
          description: Maximum subscription requests per minute
        max_subscription_requests_per_day:
          minimum: 1
          type: integer
          description: Maximum subscription requests per day
    SamlAssertionConsumerRequest:
      required:
      - SAMLResponse
      type: object
      properties:
        SAMLResponse:
          maxLength: 100000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Base64-encoded SAML response
        RelayState:
          maxLength: 10000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: State parameter for CSRF protection
      additionalProperties: false
    SamlSingleLogoutRequest:
      required:
      - SAMLRequest
      type: object
      properties:
        SAMLRequest:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Base64-encoded SAML logout request
      additionalProperties: false
    TokenRefreshRequest:
      required:
      - refresh_token
      type: object
      properties:
        refresh_token:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Valid refresh token
          example: 8xLOxBtZp8_example_refresh_token
      additionalProperties: false
    inline_response_200:
      required:
      - authorization_endpoint
      - id_token_signing_alg_values_supported
      - issuer
      - jwks_uri
      - response_types_supported
      - subject_types_supported
      - token_endpoint
      type: object
      properties:
        issuer:
          maxLength: 1000
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          format: uri
          example: http://localhost:8080
        authorization_endpoint:
          maxLength: 1000
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          format: uri
          example: http://localhost:8080/oauth2/authorize
        token_endpoint:
          maxLength: 1000
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          format: uri
          example: http://localhost:8080/oauth2/token
        userinfo_endpoint:
          maxLength: 1000
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          format: uri
          example: http://localhost:8080/oauth2/userinfo
        jwks_uri:
          maxLength: 1000
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          format: uri
          example: http://localhost:8080/.well-known/jwks.json
        response_types_supported:
          maxItems: 1000
          type: array
          example:
          - code
          - token
          - id_token
          - code token
          - code id_token
          - token id_token
          - code token id_token
          items:
            maxLength: 1000
            type: string
        subject_types_supported:
          maxItems: 1000
          type: array
          example:
          - public
          items:
            maxLength: 1000
            type: string
        id_token_signing_alg_values_supported:
          maxItems: 1000
          type: array
          example:
          - HS256
          items:
            maxLength: 1000
            type: string
        scopes_supported:
          maxItems: 1000
          type: array
          example:
          - openid
          - email
          - profile
          items:
            maxLength: 1000
            type: string
        claims_supported:
          maxItems: 1000
          type: array
          example:
          - sub
          - email
          - email_verified
          - name
          - given_name
          - family_name
          - picture
          - locale
          items:
            maxLength: 1000
            type: string
        introspection_endpoint:
          maxLength: 1000
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          format: uri
          example: http://localhost:8080/oauth2/introspect
      additionalProperties: false
      example:
        response_types_supported:
        - code
        - token
        - id_token
        - code token
        - code id_token
        - token id_token
        - code token id_token
        claims_supported:
        - sub
        - email
        - email_verified
        - name
        - given_name
        - family_name
        - picture
        - locale
        introspection_endpoint: http://localhost:8080/oauth2/introspect
        jwks_uri: http://localhost:8080/.well-known/jwks.json
        subject_types_supported:
        - public
        id_token_signing_alg_values_supported:
        - HS256
        scopes_supported:
        - openid
        - email
        - profile
        issuer: http://localhost:8080
        authorization_endpoint: http://localhost:8080/oauth2/authorize
        token_endpoint: http://localhost:8080/oauth2/token
        userinfo_endpoint: http://localhost:8080/oauth2/userinfo
    inline_response_200_1:
      required:
      - authorization_endpoint
      - issuer
      - response_types_supported
      - token_endpoint
      type: object
      properties:
        issuer:
          maxLength: 1000
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          format: uri
          example: http://localhost:8080
        authorization_endpoint:
          maxLength: 1000
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          format: uri
          example: http://localhost:8080/oauth2/authorize
        token_endpoint:
          maxLength: 1000
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          format: uri
          example: http://localhost:8080/oauth2/token
        introspection_endpoint:
          maxLength: 1000
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          format: uri
          example: http://localhost:8080/oauth2/introspect
        response_types_supported:
          maxItems: 1000
          type: array
          example:
          - code
          - token
          - id_token
          items:
            maxLength: 1000
            type: string
        grant_types_supported:
          maxItems: 1000
          type: array
          example:
          - authorization_code
          - implicit
          - refresh_token
          items:
            maxLength: 1000
            type: string
        token_endpoint_auth_methods_supported:
          maxItems: 1000
          type: array
          example:
          - client_secret_post
          - none
          items:
            maxLength: 1000
            type: string
      additionalProperties: false
      example:
        response_types_supported:
        - code
        - token
        - id_token
        introspection_endpoint: http://localhost:8080/oauth2/introspect
        grant_types_supported:
        - authorization_code
        - implicit
        - refresh_token
        token_endpoint_auth_methods_supported:
        - client_secret_post
        - none
        issuer: http://localhost:8080
        authorization_endpoint: http://localhost:8080/oauth2/authorize
        token_endpoint: http://localhost:8080/oauth2/token
    inline_response_200_2:
      required:
      - keys
      type: object
      properties:
        keys:
          maxItems: 1000
          type: array
          items:
            $ref: "#/components/schemas/inline_response_200_2_keys"
      additionalProperties: false
      example:
        keys:
        - kty: oct
          use: sig
          kid: tmi-signing-key
          alg: HS256
        - kty: oct
          use: sig
          kid: tmi-signing-key
          alg: HS256
        - kty: oct
          use: sig
          kid: tmi-signing-key
          alg: HS256
        - kty: oct
          use: sig
          kid: tmi-signing-key
          alg: HS256
        - kty: oct
          use: sig
          kid: tmi-signing-key
          alg: HS256
        - kty: oct
          use: sig
          kid: tmi-signing-key
          alg: HS256
        - kty: oct
          use: sig
          kid: tmi-signing-key
          alg: HS256
        - kty: oct
          use: sig
          kid: tmi-signing-key
          alg: HS256
        - kty: oct
          use: sig
          kid: tmi-signing-key
          alg: HS256
        - kty: oct
          use: sig
          kid: tmi-signing-key
          alg: HS256
    inline_response_200_3:
      required:
      - active
      type: object
      properties:
        active:
          type: boolean
          description: Whether the token is active/valid
          example: true
        sub:
          maxLength: 1000
          type: string
          description: Subject (user identifier)
          example: user@example.com
        email:
          maxLength: 1000
          type: string
          description: User email address
          example: user@example.com
        email_verified:
          type: boolean
          description: Whether the email is verified
          example: true
        name:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: User's full name
          example: John Doe
        exp:
          type: integer
          description: Token expiration time (Unix timestamp)
          example: 1640995200
        iat:
          type: integer
          description: Token issued at time (Unix timestamp)
          example: 1640991600
        iss:
          maxLength: 1000
          type: string
          description: Token issuer
          example: http://localhost:8080
      additionalProperties: false
      example:
        sub: user@example.com
        email_verified: true
        name: John Doe
        iss: http://localhost:8080
        active: true
        exp: 1640995200
        iat: 1640991600
        email: user@example.com
    inline_response_500:
      required:
      - error
      type: object
      properties:
        error:
          type: string
          description: Error message describing what went wrong
        request_id:
          type: string
          description: Unique request identifier for troubleshooting
    inline_response_200_4:
      required:
      - providers
      type: object
      properties:
        providers:
          maxItems: 1000
          type: array
          items:
            $ref: "#/components/schemas/inline_response_200_4_providers"
      additionalProperties: false
      example:
        providers:
        - name: name
          icon: icon
          id: id
          auth_url: http://example.com/aeiou
          redirect_uri: http://example.com/aeiou
          token_url: http://example.com/aeiou
          client_id: client_id
        - name: name
          icon: icon
          id: id
          auth_url: http://example.com/aeiou
          redirect_uri: http://example.com/aeiou
          token_url: http://example.com/aeiou
          client_id: client_id
        - name: name
          icon: icon
          id: id
          auth_url: http://example.com/aeiou
          redirect_uri: http://example.com/aeiou
          token_url: http://example.com/aeiou
          client_id: client_id
        - name: name
          icon: icon
          id: id
          auth_url: http://example.com/aeiou
          redirect_uri: http://example.com/aeiou
          token_url: http://example.com/aeiou
          client_id: client_id
        - name: name
          icon: icon
          id: id
          auth_url: http://example.com/aeiou
          redirect_uri: http://example.com/aeiou
          token_url: http://example.com/aeiou
          client_id: client_id
        - name: name
          icon: icon
          id: id
          auth_url: http://example.com/aeiou
          redirect_uri: http://example.com/aeiou
          token_url: http://example.com/aeiou
          client_id: client_id
        - name: name
          icon: icon
          id: id
          auth_url: http://example.com/aeiou
          redirect_uri: http://example.com/aeiou
          token_url: http://example.com/aeiou
          client_id: client_id
        - name: name
          icon: icon
          id: id
          auth_url: http://example.com/aeiou
          redirect_uri: http://example.com/aeiou
          token_url: http://example.com/aeiou
          client_id: client_id
        - name: name
          icon: icon
          id: id
          auth_url: http://example.com/aeiou
          redirect_uri: http://example.com/aeiou
          token_url: http://example.com/aeiou
          client_id: client_id
        - name: name
          icon: icon
          id: id
          auth_url: http://example.com/aeiou
          redirect_uri: http://example.com/aeiou
          token_url: http://example.com/aeiou
          client_id: client_id
    inline_response_200_5:
      required:
      - groups
      - idp
      type: object
      properties:
        idp:
          maxLength: 100
          pattern: "^[a-zA-Z][a-zA-Z0-9_-]*$"
          type: string
          description: Identity provider ID
        groups:
          maxItems: 1000
          type: array
          items:
            $ref: "#/components/schemas/inline_response_200_5_groups"
      additionalProperties: false
      example:
        idp: idp
        groups:
        - used_in_authorizations: true
          name: name
          display_name: display_name
        - used_in_authorizations: true
          name: name
          display_name: display_name
        - used_in_authorizations: true
          name: name
          display_name: display_name
        - used_in_authorizations: true
          name: name
          display_name: display_name
        - used_in_authorizations: true
          name: name
          display_name: display_name
        - used_in_authorizations: true
          name: name
          display_name: display_name
        - used_in_authorizations: true
          name: name
          display_name: display_name
        - used_in_authorizations: true
          name: name
          display_name: display_name
        - used_in_authorizations: true
          name: name
          display_name: display_name
        - used_in_authorizations: true
          name: name
          display_name: display_name
    oauth2_token_body:
      required:
      - grant_type
      type: object
      properties:
        grant_type:
          type: string
          description: OAuth 2.0 grant type (RFC 6749)
          example: authorization_code
          enum:
          - authorization_code
          - client_credentials
          - refresh_token
        code:
          maxLength: 512
          pattern: "^[\\x20-\\x7E]+$"
          type: string
          description: "Authorization code received from OAuth provider. Per RFC 6749,\
            \ can contain any visible ASCII characters (VSCHAR: 0x20-0x7E)."
          nullable: true
          example: 0AX4XfWiXY2BZ_example_auth_code_from_google
        state:
          maxLength: 256
          pattern: "^[a-zA-Z0-9_=-]*$"
          type: string
          description: State parameter for CSRF protection (optional but recommended)
          nullable: true
          example: random_state_value_abc123
        redirect_uri:
          maxLength: 1000
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          description: Redirect URI used in the authorization request (must match
            exactly)
          format: uri
          nullable: true
          example: https://your-web-app.com/oauth2/callback
        code_verifier:
          maxLength: 128
          minLength: 43
          pattern: "^[A-Za-z0-9\\-._~]+$"
          type: string
          description: "PKCE code verifier (RFC 7636) - High-entropy cryptographic\
            \ random string used to mitigate authorization code interception attacks.\
            \ Must be 43-128 characters using [A-Za-z0-9-._~] characters."
          nullable: true
          example: dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk
        client_id:
          type: string
          description: Client identifier (required for client_credentials grant)
          nullable: true
          example: tmi_cc_AbCdEf123456
        client_secret:
          type: string
          description: Client secret (required for client_credentials grant)
          nullable: true
          example: secret_value
        refresh_token:
          type: string
          description: Refresh token (required for refresh_token grant)
          nullable: true
          example: refresh_token_value
      additionalProperties: false
    inline_response_200_6:
      required:
      - email
      - id
      - name
      type: object
      properties:
        sub:
          maxLength: 1000
          type: string
          description: Subject identifier (email or provider-assigned ID)
        id:
          maxLength: 36
          pattern: "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          type: string
          description: Unique identifier for the user (UUID)
          format: uuid
        email:
          maxLength: 254
          pattern: "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$"
          type: string
          description: User email address
          format: email
        name:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: User display name
        idp:
          maxLength: 100
          pattern: "^[a-zA-Z][a-zA-Z0-9_-]*$"
          type: string
          description: Current identity provider
        groups:
          maxItems: 1000
          type: array
          description: Groups the user belongs to
          items:
            maxLength: 1000
            type: string
        providers:
          maxItems: 1000
          type: array
          description: Linked OAuth providers
          items:
            $ref: "#/components/schemas/inline_response_200_6_providers"
      additionalProperties: false
      example:
        sub: sub
        idp: idp
        name: name
        groups:
        - groups
        - groups
        - groups
        - groups
        - groups
        - groups
        - groups
        - groups
        - groups
        - groups
        id: 046b6c7f-0b8a-43b9-b35d-6489e6daee91
        email: ""
        providers:
        - is_primary: true
          provider: provider
        - is_primary: true
          provider: provider
        - is_primary: true
          provider: provider
        - is_primary: true
          provider: provider
        - is_primary: true
          provider: provider
        - is_primary: true
          provider: provider
        - is_primary: true
          provider: provider
        - is_primary: true
          provider: provider
        - is_primary: true
          provider: provider
        - is_primary: true
          provider: provider
    inline_response_200_7:
      type: object
      properties:
        message:
          type: string
          example: Token revoked successfully
      example:
        message: Token revoked successfully
    metadata_key_body:
      required:
      - value
      type: object
      properties:
        value:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: New value for the metadata entry
      additionalProperties: false
    inline_response_200_8:
      type: object
      properties:
        deleted_count:
          type: integer
          description: Number of threats deleted
        deleted_ids:
          maxItems: 1000
          type: array
          description: IDs of deleted threats
          items:
            maxLength: 36
            pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
            type: string
            format: uuid
      additionalProperties: false
      example:
        deleted_count: 0
        deleted_ids:
        - 046b6c7f-0b8a-43b9-b35d-6489e6daee91
        - 046b6c7f-0b8a-43b9-b35d-6489e6daee91
        - 046b6c7f-0b8a-43b9-b35d-6489e6daee91
        - 046b6c7f-0b8a-43b9-b35d-6489e6daee91
        - 046b6c7f-0b8a-43b9-b35d-6489e6daee91
        - 046b6c7f-0b8a-43b9-b35d-6489e6daee91
        - 046b6c7f-0b8a-43b9-b35d-6489e6daee91
        - 046b6c7f-0b8a-43b9-b35d-6489e6daee91
        - 046b6c7f-0b8a-43b9-b35d-6489e6daee91
        - 046b6c7f-0b8a-43b9-b35d-6489e6daee91
    metadata_key_body_1:
      required:
      - value
      type: object
      properties:
        value:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: New value for the metadata entry
      additionalProperties: false
    metadata_key_body_2:
      required:
      - value
      type: object
      properties:
        value:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: New value for the metadata entry
      additionalProperties: false
    metadata_key_body_3:
      required:
      - value
      type: object
      properties:
        value:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: New value for the metadata entry
      additionalProperties: false
    inline_response_409:
      required:
      - error
      - join_url
      type: object
      properties:
        error:
          maxLength: 1000
          type: string
          description: Error message indicating session already exists
        join_url:
          maxLength: 1024
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          description: URL to join the existing collaboration session
          example: "http://localhost:8080/threat_models/{threat_model_id}/diagrams/{diagram_id}/collaborate"
      additionalProperties: false
    metadata_key_body_4:
      required:
      - value
      type: object
      properties:
        value:
          maxLength: 1024
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Metadata value
      additionalProperties: false
    metadata_key_body_5:
      required:
      - value
      type: object
      properties:
        value:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: New value for the metadata entry
      additionalProperties: false
    inline_response_200_9:
      type: object
      properties:
        message:
          maxLength: 1000
          type: string
      additionalProperties: false
      example:
        message: message
    inline_response_200_10:
      required:
      - providers
      type: object
      properties:
        providers:
          maxItems: 1000
          type: array
          items:
            $ref: "#/components/schemas/SAMLProviderInfo"
      additionalProperties: false
      example:
        providers:
        - id: azure-ad
          name: Azure Active Directory
          icon: https://example.com/icons/azure.png
          auth_url: https://login.microsoftonline.com/common/saml2
          metadata_url: https://login.microsoftonline.com/common/FederationMetadata/2007-06/FederationMetadata.xml
          entity_id: https://sts.windows.net/common/
          acs_url: https://tmi.example.com/saml/acs
        - id: azure-ad
          name: Azure Active Directory
          icon: https://example.com/icons/azure.png
          auth_url: https://login.microsoftonline.com/common/saml2
          metadata_url: https://login.microsoftonline.com/common/FederationMetadata/2007-06/FederationMetadata.xml
          entity_id: https://sts.windows.net/common/
          acs_url: https://tmi.example.com/saml/acs
        - id: azure-ad
          name: Azure Active Directory
          icon: https://example.com/icons/azure.png
          auth_url: https://login.microsoftonline.com/common/saml2
          metadata_url: https://login.microsoftonline.com/common/FederationMetadata/2007-06/FederationMetadata.xml
          entity_id: https://sts.windows.net/common/
          acs_url: https://tmi.example.com/saml/acs
        - id: azure-ad
          name: Azure Active Directory
          icon: https://example.com/icons/azure.png
          auth_url: https://login.microsoftonline.com/common/saml2
          metadata_url: https://login.microsoftonline.com/common/FederationMetadata/2007-06/FederationMetadata.xml
          entity_id: https://sts.windows.net/common/
          acs_url: https://tmi.example.com/saml/acs
        - id: azure-ad
          name: Azure Active Directory
          icon: https://example.com/icons/azure.png
          auth_url: https://login.microsoftonline.com/common/saml2
          metadata_url: https://login.microsoftonline.com/common/FederationMetadata/2007-06/FederationMetadata.xml
          entity_id: https://sts.windows.net/common/
          acs_url: https://tmi.example.com/saml/acs
        - id: azure-ad
          name: Azure Active Directory
          icon: https://example.com/icons/azure.png
          auth_url: https://login.microsoftonline.com/common/saml2
          metadata_url: https://login.microsoftonline.com/common/FederationMetadata/2007-06/FederationMetadata.xml
          entity_id: https://sts.windows.net/common/
          acs_url: https://tmi.example.com/saml/acs
        - id: azure-ad
          name: Azure Active Directory
          icon: https://example.com/icons/azure.png
          auth_url: https://login.microsoftonline.com/common/saml2
          metadata_url: https://login.microsoftonline.com/common/FederationMetadata/2007-06/FederationMetadata.xml
          entity_id: https://sts.windows.net/common/
          acs_url: https://tmi.example.com/saml/acs
        - id: azure-ad
          name: Azure Active Directory
          icon: https://example.com/icons/azure.png
          auth_url: https://login.microsoftonline.com/common/saml2
          metadata_url: https://login.microsoftonline.com/common/FederationMetadata/2007-06/FederationMetadata.xml
          entity_id: https://sts.windows.net/common/
          acs_url: https://tmi.example.com/saml/acs
        - id: azure-ad
          name: Azure Active Directory
          icon: https://example.com/icons/azure.png
          auth_url: https://login.microsoftonline.com/common/saml2
          metadata_url: https://login.microsoftonline.com/common/FederationMetadata/2007-06/FederationMetadata.xml
          entity_id: https://sts.windows.net/common/
          acs_url: https://tmi.example.com/saml/acs
        - id: azure-ad
          name: Azure Active Directory
          icon: https://example.com/icons/azure.png
          auth_url: https://login.microsoftonline.com/common/saml2
          metadata_url: https://login.microsoftonline.com/common/FederationMetadata/2007-06/FederationMetadata.xml
          entity_id: https://sts.windows.net/common/
          acs_url: https://tmi.example.com/saml/acs
    inline_response_429:
      required:
      - error
      type: object
      properties:
        error:
          type: string
          description: Error message
        retry_after:
          type: integer
          description: Seconds until rate limit resets
    me_client_credentials_body:
      required:
      - name
      type: object
      properties:
        name:
          maxLength: 100
          minLength: 1
          type: string
          description: Human-readable name for the credential
        description:
          maxLength: 500
          type: string
          description: Optional description of the credential's purpose
        expires_at:
          type: string
          description: Optional expiration timestamp (ISO 8601)
          format: date-time
    ApiInfo_status:
      required:
      - code
      - time
      type: object
      properties:
        code:
          maxLength: 512
          pattern: "^[a-zA-Z0-9_-]*$"
          type: string
          description: Status code indicating if the API is functioning correctly
          enum:
          - OK
          - ERROR
        time:
          maxLength: 64
          pattern: "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$"
          type: string
          description: "Current server time in UTC, formatted as RFC 3339"
          format: date-time
      additionalProperties: false
    ApiInfo_service:
      required:
      - build
      - name
      type: object
      properties:
        name:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Name of the service
        build:
          maxLength: 32
          pattern: "^[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}(-[a-zA-Z0-9]{7})?$"
          type: string
          description: Current build number
      additionalProperties: false
    ApiInfo_api:
      required:
      - specification
      - version
      type: object
      properties:
        version:
          maxLength: 32
          pattern: "^[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}$"
          type: string
          description: API version
        specification:
          maxLength: 1000
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          description: URL to the API specification
          format: uri
      additionalProperties: false
    ApiInfo_operator:
      required:
      - contact
      - name
      type: object
      properties:
        name:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Operator name from environment variables
        contact:
          maxLength: 1024
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Operator contact information from environment variables
      additionalProperties: false
    BaseDiagram_image:
      type: object
      properties:
        svg:
          maxLength: 102400
          pattern: "^[A-Za-z0-9+/]*=*$"
          type: string
          description: "BASE64 encoded SVG representation of the diagram, used for\
            \ thumbnails and reports"
          format: byte
        update_vector:
          minimum: 0
          type: integer
          description: "Version of the diagram when this SVG was generated. If not\
            \ provided when svg is updated, will be auto-set to BaseDiagram.update_vector"
          format: int64
      additionalProperties: false
      description: Image data with version information
      nullable: true
    Cell_data:
      type: object
      properties:
        _metadata:
          maxItems: 100
          type: array
          description: Reserved namespace for structured business metadata
          items:
            $ref: "#/components/schemas/Metadata"
      additionalProperties: true
      description: "Flexible data storage compatible with X6, with reserved metadata\
        \ namespace"
    Node_position:
      required:
      - x
      - "y"
      type: object
      properties:
        x:
          type: number
          description: X coordinate
        "y":
          type: number
          description: Y coordinate
      additionalProperties: false
      description: Node position in X6 nested format. Use either this with size object
        OR use flat x/y/width/height properties.
    Node_size:
      required:
      - height
      - width
      type: object
      properties:
        width:
          minimum: 40
          type: number
          description: Width in pixels
        height:
          minimum: 30
          type: number
          description: Height in pixels
      additionalProperties: false
      description: Node size in X6 nested format. Use either this with position object
        OR use flat x/y/width/height properties.
    Error_details:
      type: object
      properties:
        code:
          maxLength: 512
          pattern: "^[a-zA-Z0-9_-]*$"
          type: string
          description: Machine-readable error code for programmatic handling
          example: COLLABORATION_SESSION_NOT_FOUND
        context:
          type: object
          additionalProperties: true
          description: Contextual information about the error
          example:
            diagram_id: 550e8400-e29b-41d4-a716-446655440000
            requested_operation: end_session
        suggestion:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Human-readable suggestion for resolving the error
          example: "Start a collaboration session first using POST /diagrams/{id}/collaborate"
      additionalProperties: false
      description: Additional context-specific error information
      nullable: true
    NodeAttrs_body:
      type: object
      properties:
        fill:
          maxLength: 32
          pattern: "^(#[0-9a-fA-F]*|#[0-9a-fA-F]*|rgb\\([0-9]*,[0-9]*,[0-9]*\\)|[a-z]+)$"
          type: string
          description: Fill color
        stroke:
          maxLength: 32
          pattern: "^(#[0-9a-fA-F]*|#[0-9a-fA-F]*|rgb\\([0-9]*,[0-9]*,[0-9]*\\)|[a-z]+)$"
          type: string
          description: Stroke color
        strokeWidth:
          minimum: 0
          type: number
          description: Stroke width in pixels
        strokeDasharray:
          maxLength: 64
          pattern: "^[0-9]+(\\\\.[0-9]+)?(,[0-9]+(\\\\.[0-9]+)?)*$"
          type: string
          description: Dash pattern for strokes
          nullable: true
      additionalProperties: false
      description: Body/shape styling attributes
    NodeAttrs_text:
      type: object
      properties:
        text:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Label text content
        fontSize:
          minimum: 1
          type: number
          description: Font size in pixels
        fill:
          maxLength: 32
          pattern: "^(#[0-9a-fA-F]*|#[0-9a-fA-F]*|rgb\\([0-9]*,[0-9]*,[0-9]*\\)|[a-z]+)$"
          type: string
          description: Text color
        fontFamily:
          maxLength: 64
          pattern: "^[a-zA-Z0-9 ,'-]*$"
          type: string
          description: Font family
      additionalProperties: false
      description: Text/label styling attributes
    EdgeAttrs_line_targetMarker:
      type: object
      properties:
        name:
          maxLength: 32
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Marker type
          enum:
          - classic
          - block
          - diamond
          - circle
        size:
          minimum: 1
          type: number
          description: Marker size in pixels
      additionalProperties: false
      description: Arrowhead marker configuration
    EdgeAttrs_line_sourceMarker:
      type: object
      properties:
        name:
          maxLength: 32
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Marker type
          enum:
          - classic
          - block
          - diamond
          - circle
        size:
          minimum: 1
          type: number
          description: Marker size in pixels
      additionalProperties: false
      description: Source marker configuration
    EdgeAttrs_line:
      type: object
      properties:
        stroke:
          maxLength: 32
          pattern: "^(#[0-9a-fA-F]*|#[0-9a-fA-F]*|rgb\\([0-9]*,[0-9]*,[0-9]*\\)|[a-z]+)$"
          type: string
          description: Line color
        strokeWidth:
          minimum: 0
          type: number
          description: Line width in pixels
        strokeDasharray:
          maxLength: 64
          pattern: "^[0-9]+(\\\\.[0-9]+)?(,[0-9]+(\\\\.[0-9]+)?)*$"
          type: string
          description: Dash pattern for the line
          nullable: true
        targetMarker:
          $ref: "#/components/schemas/EdgeAttrs_line_targetMarker"
        sourceMarker:
          $ref: "#/components/schemas/EdgeAttrs_line_sourceMarker"
      additionalProperties: false
      description: Line styling attributes
    EdgeLabel_attrs_text:
      type: object
      properties:
        text:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Label text content
        fontSize:
          minimum: 1
          type: number
          description: Font size in pixels
        fill:
          maxLength: 32
          pattern: "^(#[0-9a-fA-F]*|#[0-9a-fA-F]*|rgb\\([0-9]*,[0-9]*,[0-9]*\\)|[a-z]+)$"
          type: string
          description: Text color
        fontFamily:
          maxLength: 64
          pattern: "^[a-zA-Z0-9 ,'-]*$"
          type: string
          description: Font family
      additionalProperties: false
      description: Text styling
    EdgeLabel_attrs:
      type: object
      properties:
        text:
          $ref: "#/components/schemas/EdgeLabel_attrs_text"
      additionalProperties: false
      description: Label styling attributes
    PortConfiguration_groups:
      type: object
      properties:
        position:
          type: string
          description: Port position on the node
          enum:
          - top
          - right
          - bottom
          - left
      additionalProperties: false
    PortConfiguration_items:
      required:
      - group
      - id
      type: object
      properties:
        id:
          maxLength: 64
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Unique port identifier
        group:
          maxLength: 32
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Port group this port belongs to
      additionalProperties: false
    EdgeRouter_args:
      type: object
      properties:
        padding:
          type: number
          description: Padding around obstacles for routing
        step:
          type: number
          description: Grid step size for orthogonal routing
        directions:
          maxItems: 1000
          type: array
          description: Allowed routing directions
          items:
            maxLength: 1000
            type: string
            enum:
            - top
            - right
            - bottom
            - left
      additionalProperties: true
      description: Router-specific arguments
    EdgeConnector_args:
      type: object
      properties:
        radius:
          type: number
          description: Radius for rounded connectors
        precision:
          type: number
          description: Precision for smooth connectors
        size:
          type: number
          description: Jump size for jumpover connectors
        jump:
          maxLength: 1000
          type: string
          description: Jump style for jumpover connectors
          enum:
          - arc
          - gap
          - cubic
      additionalProperties: true
      description: Connector-specific arguments
    RepositoryBase_parameters:
      required:
      - refType
      - refValue
      type: object
      properties:
        refType:
          maxLength: 6
          type: string
          description: "Reference type (branch, tag, or commit)"
          enum:
          - branch
          - tag
          - commit
        refValue:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: "Reference value (branch name, tag value, or commit id)"
        subPath:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Sub-path within the repository
      additionalProperties: false
      description: repo-specific parameters for retrieving the source
    JsonPatchDocument_inner:
      required:
      - op
      - path
      type: object
      properties:
        op:
          maxLength: 1000
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Patch operation type
          enum:
          - add
          - replace
          - remove
          - move
          - copy
          - test
        path:
          maxLength: 512
          pattern: "^(/[^/]*)*$"
          type: string
          description: JSON path to target
        value: {}
      additionalProperties: false
    inline_response_200_2_keys:
      required:
      - alg
      - kid
      - kty
      - use
      type: object
      properties:
        kty:
          maxLength: 1000
          type: string
          example: oct
        use:
          maxLength: 1000
          type: string
          example: sig
        alg:
          maxLength: 1000
          type: string
          example: HS256
        kid:
          maxLength: 1000
          type: string
          example: tmi-signing-key
      additionalProperties: false
      example:
        kty: oct
        use: sig
        kid: tmi-signing-key
        alg: HS256
    inline_response_200_4_providers:
      required:
      - auth_url
      - client_id
      - icon
      - id
      - name
      - redirect_uri
      - token_url
      type: object
      properties:
        id:
          maxLength: 1000
          type: string
          description: Provider identifier
        name:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Display name of the provider
        icon:
          maxLength: 1000
          type: string
          description: Icon identifier for the provider
        auth_url:
          maxLength: 1024
          pattern: "^(https?|wss?|file)://[^\\s]*$"
          type: string
          description: TMI authorization endpoint URL for this provider
          format: uri
        token_url:
          maxLength: 1024
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          description: TMI token exchange endpoint URL for this provider
          format: uri
        redirect_uri:
          maxLength: 1000
          pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
            .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
            s*$"
          type: string
          description: OAuth callback URI configured for this provider
          format: uri
        client_id:
          maxLength: 1000
          type: string
          description: OAuth client ID for this provider
      additionalProperties: false
      example:
        name: name
        icon: icon
        id: id
        auth_url: http://example.com/aeiou
        redirect_uri: http://example.com/aeiou
        token_url: http://example.com/aeiou
        client_id: client_id
    inline_response_200_5_groups:
      required:
      - name
      type: object
      properties:
        name:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Group name
        display_name:
          maxLength: 256
          pattern: "^[\\u0020-\\uFFFF]*$"
          type: string
          description: Display name for the group
        used_in_authorizations:
          type: boolean
          description: Whether this group is used in any threat model authorizations
      additionalProperties: false
      example:
        used_in_authorizations: true
        name: name
        display_name: display_name
    inline_response_200_6_providers:
      type: object
      properties:
        provider:
          maxLength: 1000
          type: string
          description: OAuth provider name
        is_primary:
          type: boolean
          description: Whether this is the primary authentication method
      additionalProperties: false
      example:
        is_primary: true
        provider: provider
  responses:
    Error:
      description: Error response
      headers:
        X-RateLimit-Limit:
          description: The maximum number of requests allowed in the current time
            window
          style: simple
          explode: false
          schema:
            type: integer
            example: 1000
        X-RateLimit-Remaining:
          description: The number of requests remaining in the current time window
          style: simple
          explode: false
          schema:
            type: integer
            example: 999
        X-RateLimit-Reset:
          description: The time at which the current rate limit window resets (Unix
            timestamp)
          style: simple
          explode: false
          schema:
            type: integer
            example: 1640995200
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
          examples:
            authorizationError:
              summary: Insufficient permissions for sub-resource access
              value:
                error: access_denied
                error_description: User does not have sufficient permissions to access
                  this sub-resource
                details:
                  code: INSUFFICIENT_PERMISSIONS
                  context:
                    required_role: writer
                    user_role: reader
                    threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                    resource_type: threat
                  suggestion: Request write access from the threat model owner
            notFoundError:
              summary: Sub-resource not found
              value:
                error: not_found
                error_description: The requested sub-resource does not exist or does
                  not belong to the specified threat model
                details:
                  code: RESOURCE_NOT_FOUND
                  context:
                    resource_id: 550e8400-e29b-41d4-a716-446655440999
                    resource_type: document
                    threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                  suggestion: Verify the resource ID and threat model association
            validationError:
              summary: Invalid input data
              value:
                error: invalid_input
                error_description: The provided data does not meet validation requirements
                details:
                  code: VALIDATION_FAILED
                  context:
                    field_errors:
                    - field: name
                      error: must not be empty
                  suggestion: Correct the validation errors and retry the request
    TooManyRequests:
      description: Too Many Requests - Rate limit exceeded. The client has sent too
        many requests in a given amount of time. See rate limit headers for details.
      headers:
        X-RateLimit-Limit:
          description: The maximum number of requests allowed in the current time
            window
          style: simple
          explode: false
          schema:
            type: integer
            example: 100
        X-RateLimit-Remaining:
          description: The number of requests remaining in the current time window
          style: simple
          explode: false
          schema:
            type: integer
            example: 0
        X-RateLimit-Reset:
          description: Unix timestamp (seconds since epoch) when the rate limit window
            resets
          style: simple
          explode: false
          schema:
            type: integer
            example: 1640000000
        Retry-After:
          description: Number of seconds to wait before retrying the request
          style: simple
          explode: false
          schema:
            type: integer
            example: 60
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
          example:
            error: rate_limit_exceeded
            error_description: "Rate limit exceeded: 100 requests per minute. Retry\
              \ after 45 seconds."
            details:
              code: RATE_LIMIT_EXCEEDED
              context:
                limit: 100
                window: minute
                retry_after: 45
    MethodNotAllowed:
      description: Method Not Allowed - The HTTP method is not supported for this
        endpoint
      headers:
        Allow:
          description: List of allowed HTTP methods for this endpoint
          style: simple
          explode: false
          schema:
            type: string
            example: "GET, POST"
        X-RateLimit-Limit:
          description: The maximum number of requests allowed in the current time
            window
          style: simple
          explode: false
          schema:
            type: integer
            example: 1000
        X-RateLimit-Remaining:
          description: The number of requests remaining in the current time window
          style: simple
          explode: false
          schema:
            type: integer
            example: 999
        X-RateLimit-Reset:
          description: The time at which the current rate limit window resets (Unix
            timestamp)
          style: simple
          explode: false
          schema:
            type: integer
            example: 1640995200
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
          example:
            error: method_not_allowed
            error_description: The HTTP method is not supported for this endpoint
    NotAcceptable:
      description: Not Acceptable - The requested media type is not supported. This
        API only supports application/json
      headers:
        X-RateLimit-Limit:
          description: The maximum number of requests allowed in the current time
            window
          style: simple
          explode: false
          schema:
            type: integer
            example: 1000
        X-RateLimit-Remaining:
          description: The number of requests remaining in the current time window
          style: simple
          explode: false
          schema:
            type: integer
            example: 999
        X-RateLimit-Reset:
          description: The time at which the current rate limit window resets (Unix
            timestamp)
          style: simple
          explode: false
          schema:
            type: integer
            example: 1640995200
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
          example:
            error: not_acceptable
            error_description: "The requested Accept header media type is not supported.\
              \ Supported types: application/json"
    InternalServerError:
      description: Internal server error
      headers:
        X-RateLimit-Limit:
          description: The maximum number of requests allowed in the current time
            window
          style: simple
          explode: false
          schema:
            type: integer
            example: 1000
        X-RateLimit-Remaining:
          description: The number of requests remaining in the current time window
          style: simple
          explode: false
          schema:
            type: integer
            example: 999
        X-RateLimit-Reset:
          description: The time at which the current rate limit window resets (Unix
            timestamp)
          style: simple
          explode: false
          schema:
            type: integer
            example: 1640995200
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/inline_response_500"
          example:
            error: An internal server error occurred
            request_id: 550e8400-e29b-41d4-a716-446655440000
  parameters:
    ThreatModelId:
      name: threat_model_id
      in: path
      description: Threat model identifier
      required: true
      style: simple
      explode: false
      schema:
        type: string
        format: uuid
    DiagramId:
      name: diagram_id
      in: path
      description: Diagram identifier
      required: true
      style: simple
      explode: false
      schema:
        type: string
        format: uuid
    ThreatId:
      name: threat_id
      in: path
      description: Threat identifier
      required: true
      style: simple
      explode: false
      schema:
        type: string
        format: uuid
    AssetId:
      name: asset_id
      in: path
      description: Asset identifier
      required: true
      style: simple
      explode: false
      schema:
        type: string
        format: uuid
    DocumentId:
      name: document_id
      in: path
      description: Document identifier
      required: true
      style: simple
      explode: false
      schema:
        type: string
        format: uuid
    NoteId:
      name: note_id
      in: path
      description: Note identifier
      required: true
      style: simple
      explode: false
      schema:
        type: string
        format: uuid
    RepositoryId:
      name: repository_id
      in: path
      description: Repository identifier
      required: true
      style: simple
      explode: false
      schema:
        type: string
        format: uuid
    MetadataKey:
      name: key
      in: path
      description: Metadata key
      required: true
      style: simple
      explode: false
      schema:
        maxLength: 255
        type: string
    GenericId:
      name: id
      in: path
      description: Resource identifier
      required: true
      style: simple
      explode: false
      schema:
        type: string
        format: uuid
    WebhookId:
      name: webhook_id
      in: path
      description: Webhook subscription identifier
      required: true
      style: simple
      explode: false
      schema:
        type: string
        format: uuid
    DeliveryId:
      name: delivery_id
      in: path
      description: Webhook delivery identifier
      required: true
      style: simple
      explode: false
      schema:
        type: string
        format: uuid
    PaginationLimit:
      name: limit
      in: query
      description: Maximum number of results to return
      required: false
      style: form
      explode: true
      schema:
        maximum: 100
        minimum: 1
        type: integer
        default: 20
    PaginationOffset:
      name: offset
      in: query
      description: Number of results to skip
      required: false
      style: form
      explode: true
      schema:
        minimum: 0
        type: integer
        default: 0
    CreatedAfter:
      name: created_after
      in: query
      description: Filter results created after this timestamp (ISO 8601)
      required: false
      style: form
      explode: true
      schema:
        type: string
        format: date-time
    CreatedBefore:
      name: created_before
      in: query
      description: Filter results created before this timestamp (ISO 8601)
      required: false
      style: form
      explode: true
      schema:
        type: string
        format: date-time
    ModifiedAfter:
      name: modified_after
      in: query
      description: Filter results modified after this timestamp (ISO 8601)
      required: false
      style: form
      explode: true
      schema:
        type: string
        format: date-time
    ModifiedBefore:
      name: modified_before
      in: query
      description: Filter results modified before this timestamp (ISO 8601)
      required: false
      style: form
      explode: true
      schema:
        type: string
        format: date-time
    IdpPathParam:
      name: idp
      in: path
      description: "Identity provider ID (e.g., saml_okta, saml_azure)"
      required: true
      style: simple
      explode: false
      schema:
        maxLength: 100
        pattern: "^[a-zA-Z][a-zA-Z0-9_-]*$"
        type: string
    IdpQueryParam:
      name: idp
      in: query
      description: OAuth provider identifier. Defaults to 'test' provider in non-production
        builds if not specified.
      required: false
      style: form
      explode: true
      schema:
        maxLength: 100
        pattern: "^[a-zA-Z][a-zA-Z0-9_-]*$"
        type: string
    ClientCallbackQueryParam:
      name: client_callback
      in: query
      description: "Client callback URL where TMI should redirect after successful\
        \ OAuth completion with tokens in URL fragment (#access_token=...). If not\
        \ provided, tokens are returned as JSON response. Per OAuth 2.0 implicit flow\
        \ spec, tokens are in fragments to prevent logging."
      required: false
      style: form
      explode: true
      schema:
        maxLength: 1000
        pattern: "^\\s*https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\\
          .[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?(\\/[^\\s]*)?\\\
          s*$"
        type: string
        format: uri
        example: http://localhost:4200/oauth2/callback
    StateQueryParam:
      name: state
      in: query
      description: CSRF protection state parameter. Recommended for security. Will
        be included in the callback response.
      required: false
      style: form
      explode: true
      schema:
        maxLength: 256
        pattern: "^[a-zA-Z0-9_~.+/=-]*$"
        type: string
        example: random_state_abc123
    LoginHintQueryParam:
      name: login_hint
      in: query
      description: "User identity hint for test OAuth provider. Allows specifying\
        \ a desired user identity for testing and automation. Only supported by the\
        \ test provider (ignored by production providers like Google, GitHub, etc.).\
        \ Must be 3-20 characters, alphanumeric and hyphens only."
      required: false
      style: form
      explode: true
      schema:
        maxLength: 1000
        pattern: "^[a-zA-Z0-9-]{3,20}$"
        type: string
        example: alice
    ScopeQueryParam:
      name: scope
      in: query
      description: "OAuth 2.0 scope parameter. For OpenID Connect, must include \"\
        openid\". Supports \"profile\" and \"email\" scopes. Other scopes are silently\
        \ ignored. Space-separated values."
      required: true
      style: form
      explode: true
      schema:
        maxLength: 256
        pattern: "^[a-zA-Z0-9_][a-zA-Z0-9_ ]*[a-zA-Z0-9_]$"
        type: string
        example: openid profile email
    CodeChallengeQueryParam:
      name: code_challenge
      in: query
      description: "PKCE code challenge (RFC 7636) - Base64url-encoded SHA256 hash\
        \ of the code_verifier. Must be 43-128 characters using unreserved characters\
        \ [A-Za-z0-9-._~]. The server associates this with the authorization code\
        \ for later verification during token exchange."
      required: true
      style: form
      explode: true
      schema:
        maxLength: 128
        minLength: 43
        pattern: "^[A-Za-z0-9\\-._~]{43,128}$"
        type: string
        example: E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM
    CodeChallengeMethodQueryParam:
      name: code_challenge_method
      in: query
      description: PKCE code challenge method (RFC 7636) - Specifies the transformation
        applied to the code_verifier. Only "S256" (SHA256) is supported for security.
        The "plain" method is not supported.
      required: true
      style: form
      explode: true
      schema:
        type: string
        example: S256
        enum:
        - S256
    CodeQueryParam:
      name: code
      in: query
      description: Authorization code from the OAuth provider
      required: true
      style: form
      explode: true
      schema:
        maxLength: 512
        pattern: "^[a-zA-Z0-9_~.+/=-]*$"
        type: string
    OwnerQueryParam:
      name: owner
      in: query
      description: Filter by owner name or email
      required: false
      style: form
      explode: true
      schema:
        maxLength: 256
        pattern: "^[\\u0020-\\uFFFF]*$"
        type: string
    NameQueryParam:
      name: name
      in: query
      description: Filter by threat model name (partial match)
      required: false
      style: form
      explode: true
      schema:
        maxLength: 256
        pattern: "^[\\u0020-\\uFFFF]*$"
        type: string
    DescriptionQueryParam:
      name: description
      in: query
      description: Filter by threat model description (partial match)
      required: false
      style: form
      explode: true
      schema:
        maxLength: 1000
        pattern: "^[\\u0020-\\uFFFF]*$"
        type: string
    IssueUriQueryParam:
      name: issue_uri
      in: query
      description: Filter by issue URI (partial match)
      required: false
      style: form
      explode: true
      schema:
        maxLength: 1000
        pattern: "^[\\u0020-\\uFFFF]*$"
        type: string
    StatusQueryParam:
      name: status
      in: query
      description: "Filter by status value (exact match). To filter by multiple statuses,\
        \ use multiple status parameters or comma-separated values."
      required: false
      style: form
      explode: true
      schema:
        maxLength: 256
        pattern: "^[\\u0020-\\uFFFF]*$"
        type: string
    StatusUpdatedAfterQueryParam:
      name: status_updated_after
      in: query
      description: Filter threat models where status was updated after this timestamp
        (RFC3339)
      required: false
      style: form
      explode: true
      schema:
        maxLength: 64
        pattern: "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$"
        type: string
        format: date-time
    StatusUpdatedBeforeQueryParam:
      name: status_updated_before
      in: query
      description: Filter threat models where status was updated before this timestamp
        (RFC3339)
      required: false
      style: form
      explode: true
      schema:
        maxLength: 64
        pattern: "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$"
        type: string
        format: date-time
    SortQueryParam:
      name: sort
      in: query
      description: "Sort order (e.g., created_at:desc, name:asc, severity:desc, score:desc)"
      required: false
      style: form
      explode: true
      schema:
        maxLength: 1000
        pattern: "^[\\u0020-\\uFFFF]*$"
        type: string
        default: created_at:desc
    ThreatTypeQueryParam:
      name: threat_type
      in: query
      description: "Filter by threat types (AND logic). Threat must contain ALL specified\
        \ types. Example: ?threat_type=Tampering&threat_type=Spoofing"
      required: false
      style: form
      explode: true
      schema:
        type: array
        items:
          type: string
    SeverityQueryParam:
      name: severity
      in: query
      description: Filter by severity level (exact match)
      required: false
      style: form
      explode: true
      schema:
        maxLength: 1000
        pattern: "^[\\u0020-\\uFFFF]*$"
        type: string
        enum:
        - Unknown
        - None
        - Low
        - Medium
        - High
        - Critical
    PriorityQueryParam:
      name: priority
      in: query
      description: Filter by priority (exact match)
      required: false
      style: form
      explode: true
      schema:
        maxLength: 256
        pattern: "^[\\u0020-\\uFFFF]*$"
        type: string
    DiagramIdQueryParam:
      name: diagram_id
      in: query
      description: Filter by diagram ID (exact match)
      required: false
      style: form
      explode: true
      schema:
        maxLength: 36
        pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
        type: string
        format: uuid
    CellIdQueryParam:
      name: cell_id
      in: query
      description: Filter by cell ID (exact match)
      required: false
      style: form
      explode: true
      schema:
        maxLength: 36
        pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
        type: string
        format: uuid
    ScoreGtQueryParam:
      name: score_gt
      in: query
      description: Filter threats with score greater than this value
      required: false
      style: form
      explode: true
      schema:
        maximum: 10.0
        minimum: 0.0
        type: number
    ScoreLtQueryParam:
      name: score_lt
      in: query
      description: Filter threats with score less than this value
      required: false
      style: form
      explode: true
      schema:
        maximum: 10.0
        minimum: 0.0
        type: number
    ScoreEqQueryParam:
      name: score_eq
      in: query
      description: Filter threats with score equal to this value
      required: false
      style: form
      explode: true
      schema:
        maximum: 10.0
        minimum: 0.0
        type: number
    ScoreGeQueryParam:
      name: score_ge
      in: query
      description: Filter threats with score greater than or equal to this value
      required: false
      style: form
      explode: true
      schema:
        maximum: 10.0
        minimum: 0.0
        type: number
    ScoreLeQueryParam:
      name: score_le
      in: query
      description: Filter threats with score less than or equal to this value
      required: false
      style: form
      explode: true
      schema:
        maximum: 10.0
        minimum: 0.0
        type: number
    ThreatIdsQueryParam:
      name: threat_ids
      in: query
      description: Comma-separated list of threat IDs to delete (UUID format)
      required: true
      style: form
      explode: false
      schema:
        maxItems: 20
        minItems: 1
        type: array
        items:
          maxLength: 36
          pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
          type: string
          format: uuid
    ChallengeQueryParam:
      name: challenge
      in: query
      description: Challenge string from first request (step 2 only). Must match exactly.
      required: false
      style: form
      explode: true
      schema:
        maxLength: 1000
        pattern: "^[\\u0020-\\uFFFF]*$"
        type: string
    SamlrequestQueryParam:
      name: SAMLRequest
      in: query
      description: Base64-encoded SAML logout request
      required: true
      style: form
      explode: true
      schema:
        maxLength: 1000
        pattern: "^[\\u0020-\\uFFFF]*$"
        type: string
    ThreatModelIdQueryParam:
      name: threat_model_id
      in: query
      description: Filter subscriptions by threat model ID
      required: false
      style: form
      explode: true
      schema:
        maxLength: 36
        pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
        type: string
        format: uuid
    SubscriptionIdQueryParam:
      name: subscription_id
      in: query
      description: Filter by subscription ID
      required: false
      style: form
      explode: true
      schema:
        maxLength: 36
        pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
        type: string
        format: uuid
    AddonIdQueryParam:
      name: addon_id
      in: query
      description: Filter by add-on
      required: false
      style: form
      explode: true
      schema:
        type: string
        format: uuid
    X-Webhook-SignatureHeaderParam:
      name: X-Webhook-Signature
      in: header
      description: "HMAC-SHA256 signature (format: sha256={hex_signature})"
      required: true
      style: simple
      explode: false
      schema:
        type: string
    ProviderPathParam:
      name: provider
      in: path
      description: SAML provider identifier
      required: true
      style: simple
      explode: false
      schema:
        type: string
    ProviderQueryParam:
      name: provider
      in: query
      description: Filter by OAuth/SAML provider
      required: false
      style: form
      explode: true
      schema:
        maxLength: 256
        type: string
    UserIdQueryParam:
      name: user_id
      in: query
      description: Filter by user ID
      required: false
      style: form
      explode: true
      schema:
        type: string
        format: uuid
    GroupIdQueryParam:
      name: group_id
      in: query
      description: Filter by group ID
      required: false
      style: form
      explode: true
      schema:
        type: string
        format: uuid
    LimitQueryParam:
      name: limit
      in: query
      description: Maximum number of results to return
      required: false
      style: form
      explode: true
      schema:
        minimum: 0
        type: integer
        default: 50
    OffsetQueryParam:
      name: offset
      in: query
      description: Number of results to skip
      required: false
      style: form
      explode: true
      schema:
        minimum: 0
        type: integer
        default: 0
    IdPathParam:
      name: id
      in: path
      description: Administrator grant ID
      required: true
      style: simple
      explode: false
      schema:
        type: string
        format: uuid
    UserIdPathParam:
      name: user_id
      in: path
      description: User ID
      required: true
      style: simple
      explode: false
      schema:
        type: string
        format: uuid
    EmailQueryParam:
      name: email
      in: query
      description: Filter by email (case-insensitive substring match)
      required: false
      style: form
      explode: true
      schema:
        type: string
    CreatedAfterQueryParam:
      name: created_after
      in: query
      description: Filter users created after this timestamp (RFC3339)
      required: false
      style: form
      explode: true
      schema:
        type: string
        format: date-time
    CreatedBeforeQueryParam:
      name: created_before
      in: query
      description: Filter users created before this timestamp (RFC3339)
      required: false
      style: form
      explode: true
      schema:
        type: string
        format: date-time
    LastLoginAfterQueryParam:
      name: last_login_after
      in: query
      description: Filter users who logged in after this timestamp (RFC3339)
      required: false
      style: form
      explode: true
      schema:
        type: string
        format: date-time
    LastLoginBeforeQueryParam:
      name: last_login_before
      in: query
      description: Filter users who logged in before this timestamp (RFC3339)
      required: false
      style: form
      explode: true
      schema:
        type: string
        format: date-time
    SortByQueryParam:
      name: sort_by
      in: query
      description: Field to sort by
      required: false
      style: form
      explode: true
      schema:
        type: string
        enum:
        - created_at
        - last_login
        - email
        default: created_at
    SortOrderQueryParam:
      name: sort_order
      in: query
      description: Sort direction
      required: false
      style: form
      explode: true
      schema:
        type: string
        enum:
        - asc
        - desc
        default: desc
    InternalUuidPathParam:
      name: internal_uuid
      in: path
      description: Internal system UUID of the user
      required: true
      style: simple
      explode: false
      schema:
        type: string
        format: uuid
    GroupNameQueryParam:
      name: group_name
      in: query
      description: Filter by group name (case-insensitive substring match)
      required: false
      style: form
      explode: true
      schema:
        type: string
    UsedInAuthorizationsQueryParam:
      name: used_in_authorizations
      in: query
      description: Filter groups used (true) or not used (false) in authorizations
      required: false
      style: form
      explode: true
      schema:
        type: boolean
    UserUuidPathParam:
      name: user_uuid
      in: path
      description: Internal system UUID of the user to remove
      required: true
      style: simple
      explode: false
      schema:
        type: string
        format: uuid
    ThreatModelIdPathParam:
      name: threat_model_id
      in: path
      description: Threat model UUID
      required: true
      style: simple
      explode: false
      schema:
        maxLength: 36
        pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
        type: string
        format: uuid
    DiagramIdPathParam:
      name: diagram_id
      in: path
      description: Diagram UUID
      required: true
      style: simple
      explode: false
      schema:
        maxLength: 36
        pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
        type: string
        format: uuid
    FormatQueryParam:
      name: format
      in: query
      description: Output format for the diagram model (case-insensitive). Defaults
        to json if not specified.
      required: false
      style: form
      explode: true
      schema:
        type: string
        enum:
        - json
        - yaml
        - graphml
        default: json
  securitySchemes:
    bearerAuth:
      type: http
      description: JWT token for authenticated requests
      scheme: bearer
      bearerFormat: JWT
